/*! For license information please see main.0b93bf03.js.LICENSE.txt */
!function(){var e={948:function(e){"use strict";var t=function(e){return function(e){return!!e&&"object"===typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===n}(e)}(e)};var n="function"===typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function r(e,t){return!1!==t.clone&&t.isMergeableObject(e)?u((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function o(e,t,n){return e.concat(t).map((function(e){return r(e,n)}))}function i(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return e.propertyIsEnumerable(t)})):[]}(e))}function a(e,t){try{return t in e}catch(n){return!1}}function s(e,t,n){var o={};return n.isMergeableObject(e)&&i(e).forEach((function(t){o[t]=r(e[t],n)})),i(t).forEach((function(i){(function(e,t){return a(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,i)||(a(e,i)&&n.isMergeableObject(t[i])?o[i]=function(e,t){if(!t.customMerge)return u;var n=t.customMerge(e);return"function"===typeof n?n:u}(i,n)(e[i],t[i],n):o[i]=r(t[i],n))})),o}function u(e,n,i){(i=i||{}).arrayMerge=i.arrayMerge||o,i.isMergeableObject=i.isMergeableObject||t,i.cloneUnlessOtherwiseSpecified=r;var a=Array.isArray(n);return a===Array.isArray(e)?a?i.arrayMerge(e,n,i):s(e,n,i):r(n,i)}u.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return u(e,n,t)}),{})};var l=u;e.exports=l},110:function(e,t,n){"use strict";var r=n(441),o={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function u(e){return r.isMemo(e)?a:s[e.$$typeof]||o}s[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[r.Memo]=a;var l=Object.defineProperty,c=Object.getOwnPropertyNames,f=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,h=Object.prototype;e.exports=function e(t,n,r){if("string"!==typeof n){if(h){var o=p(n);o&&o!==h&&e(t,o,r)}var a=c(n);f&&(a=a.concat(f(n)));for(var s=u(t),v=u(n),m=0;m<a.length;++m){var g=a[m];if(!i[g]&&(!r||!r[g])&&(!v||!v[g])&&(!s||!s[g])){var y=d(n,g);try{l(t,g,y)}catch(b){}}}}return t}},463:function(e,t,n){"use strict";var r=n(791),o=n(296);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,s={};function u(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(s[e]=t,e=0;e<t.length;e++)a.add(t[e])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),f=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},h={};function v(e,t,n,r,o,i,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new v(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new v(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new v(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new v(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new v(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new v(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)}));var g=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var o=m.hasOwnProperty(t)?m[t]:null;(null!==o?0!==o.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,o,r)&&(n=null),r||null===o?function(e){return!!f.call(h,e)||!f.call(p,e)&&(d.test(e)?h[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=null===n?3!==o.type&&"":n:(t=o.attributeName,r=o.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(o=o.type)||4===o&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),C=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),R=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),N=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var M=Symbol.iterator;function O(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=M&&e[M]||e["@@iterator"])?e:null}var F,L=Object.assign;function B(e){if(void 0===F)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);F=t&&t[1]||""}return"\n"+F+e}var z=!1;function W(e,t){if(!e||z)return"";z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&"string"===typeof l.stack){for(var o=l.stack.split("\n"),i=r.stack.split("\n"),a=o.length-1,s=i.length-1;1<=a&&0<=s&&o[a]!==i[s];)s--;for(;1<=a&&0<=s;a--,s--)if(o[a]!==i[s]){if(1!==a||1!==s)do{if(a--,0>--s||o[a]!==i[s]){var u="\n"+o[a].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=a&&0<=s);break}}}finally{z=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?B(e):""}function V(e){switch(e.tag){case 5:return B(e.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return e=W(e.type,!1);case 11:return e=W(e.type.render,!1);case 1:return e=W(e.type,!0);default:return""}}function U(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case E:return"Fragment";case C:return"Portal";case k:return"Profiler";case S:return"StrictMode";case T:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case R:return(e.displayName||"Context")+".Consumer";case _:return(e._context.displayName||"Context")+".Provider";case I:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case D:return null!==(t=e.displayName||null)?t:U(e.type)||"Memo";case N:t=e._payload,e=e._init;try{return U(e(t))}catch(n){}}return null}function j(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function q(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var o=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=G(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function X(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function $(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function J(e,t){Q(e,t);var n=H(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&X(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,o=0;o<e.length;o++){if(e[o].value===n)return e[o].selected=!0,void(r&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function oe(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function ie(e,t){var n=H(t.value),r=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ue(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var le,ce,fe=(ce=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((le=le||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=le.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ce(e,t)}))}:ce);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},he=["Webkit","ms","Moz","O"];function ve(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),o=ve(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}Object.keys(pe).forEach((function(e){he.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ge=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ge[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ce=null,Ee=null,Se=null;function ke(e){if(e=xo(e)){if("function"!==typeof Ce)throw Error(i(280));var t=e.stateNode;t&&(t=Co(t),Ce(e.stateNode,e.type,t))}}function _e(e){Ee?Se?Se.push(e):Se=[e]:Ee=e}function Re(){if(Ee){var e=Ee,t=Se;if(Se=Ee=null,ke(e),t)for(e=0;e<t.length;e++)ke(t[e])}}function Ie(e,t){return e(t)}function Te(){}var Ae=!1;function De(e,t,n){if(Ae)return e(t,n);Ae=!0;try{return Ie(e,t,n)}finally{Ae=!1,(null!==Ee||null!==Se)&&(Te(),Re())}}function Ne(e,t){var n=e.stateNode;if(null===n)return null;var r=Co(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var Pe=!1;if(c)try{var Me={};Object.defineProperty(Me,"passive",{get:function(){Pe=!0}}),window.addEventListener("test",Me,Me),window.removeEventListener("test",Me,Me)}catch(ce){Pe=!1}function Oe(e,t,n,r,o,i,a,s,u){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(c){this.onError(c)}}var Fe=!1,Le=null,Be=!1,ze=null,We={onError:function(e){Fe=!0,Le=e}};function Ve(e,t,n,r,o,i,a,s,u){Fe=!1,Le=null,Oe.apply(We,arguments)}function Ue(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function je(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(Ue(e)!==e)throw Error(i(188))}function Ge(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ue(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(null===o)break;var a=o.alternate;if(null===a){if(null!==(r=o.return)){n=r;continue}break}if(o.child===a.child){for(a=o.child;a;){if(a===n)return He(o),e;if(a===r)return He(o),t;a=a.sibling}throw Error(i(188))}if(n.return!==r.return)n=o,r=a;else{for(var s=!1,u=o.child;u;){if(u===n){s=!0,n=o,r=a;break}if(u===r){s=!0,r=o,n=a;break}u=u.sibling}if(!s){for(u=a.child;u;){if(u===n){s=!0,n=a,r=o;break}if(u===r){s=!0,r=a,n=o;break}u=u.sibling}if(!s)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?qe(e):null}function qe(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=qe(e);if(null!==t)return t;e=e.sibling}return null}var Ke=o.unstable_scheduleCallback,Xe=o.unstable_cancelCallback,$e=o.unstable_shouldYield,Ye=o.unstable_requestPaint,Qe=o.unstable_now,Je=o.unstable_getCurrentPriorityLevel,Ze=o.unstable_ImmediatePriority,et=o.unstable_UserBlockingPriority,tt=o.unstable_NormalPriority,nt=o.unstable_LowPriority,rt=o.unstable_IdlePriority,ot=null,it=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/ut|0)|0},st=Math.log,ut=Math.LN2;var lt=64,ct=4194304;function ft(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,o=e.suspendedLanes,i=e.pingedLanes,a=268435455&n;if(0!==a){var s=a&~o;0!==s?r=ft(s):0!==(i&=a)&&(r=ft(i))}else 0!==(a=n&~o)?r=ft(a):0!==i&&(r=ft(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&o)&&((o=r&-r)>=(i=t&-t)||16===o&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)o=1<<(n=31-at(t)),r|=e[n],t&=~o;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ht(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function vt(){var e=lt;return 0===(4194240&(lt<<=1))&&(lt=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function gt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-at(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}var bt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,Ct,Et,St,kt,_t=!1,Rt=[],It=null,Tt=null,At=null,Dt=new Map,Nt=new Map,Pt=[],Mt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ot(e,t){switch(e){case"focusin":case"focusout":It=null;break;case"dragenter":case"dragleave":Tt=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":Dt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nt.delete(t.pointerId)}}function Ft(e,t,n,r,o,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[o]},null!==t&&(null!==(t=xo(t))&&Ct(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o),e)}function Lt(e){var t=bo(e.target);if(null!==t){var n=Ue(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=je(n)))return e.blockedOn=t,void kt(e.priority,(function(){Et(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Bt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=$t(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=xo(n))&&Ct(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);xe=r,n.target.dispatchEvent(r),xe=null,t.shift()}return!0}function zt(e,t,n){Bt(e)&&n.delete(t)}function Wt(){_t=!1,null!==It&&Bt(It)&&(It=null),null!==Tt&&Bt(Tt)&&(Tt=null),null!==At&&Bt(At)&&(At=null),Dt.forEach(zt),Nt.forEach(zt)}function Vt(e,t){e.blockedOn===t&&(e.blockedOn=null,_t||(_t=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Wt)))}function Ut(e){function t(t){return Vt(t,e)}if(0<Rt.length){Vt(Rt[0],e);for(var n=1;n<Rt.length;n++){var r=Rt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==It&&Vt(It,e),null!==Tt&&Vt(Tt,e),null!==At&&Vt(At,e),Dt.forEach(t),Nt.forEach(t),n=0;n<Pt.length;n++)(r=Pt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Pt.length&&null===(n=Pt[0]).blockedOn;)Lt(n),null===n.blockedOn&&Pt.shift()}var jt=x.ReactCurrentBatchConfig,Ht=!0;function Gt(e,t,n,r){var o=bt,i=jt.transition;jt.transition=null;try{bt=1,Kt(e,t,n,r)}finally{bt=o,jt.transition=i}}function qt(e,t,n,r){var o=bt,i=jt.transition;jt.transition=null;try{bt=4,Kt(e,t,n,r)}finally{bt=o,jt.transition=i}}function Kt(e,t,n,r){if(Ht){var o=$t(e,t,n,r);if(null===o)Hr(e,t,r,Xt,n),Ot(e,r);else if(function(e,t,n,r,o){switch(t){case"focusin":return It=Ft(It,e,t,n,r,o),!0;case"dragenter":return Tt=Ft(Tt,e,t,n,r,o),!0;case"mouseover":return At=Ft(At,e,t,n,r,o),!0;case"pointerover":var i=o.pointerId;return Dt.set(i,Ft(Dt.get(i)||null,e,t,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,Nt.set(i,Ft(Nt.get(i)||null,e,t,n,r,o)),!0}return!1}(o,e,t,n,r))r.stopPropagation();else if(Ot(e,r),4&t&&-1<Mt.indexOf(e)){for(;null!==o;){var i=xo(o);if(null!==i&&wt(i),null===(i=$t(e,t,n,r))&&Hr(e,t,r,Xt,n),i===o)break;o=i}null!==o&&r.stopPropagation()}else Hr(e,t,r,null,n)}}var Xt=null;function $t(e,t,n,r){if(Xt=null,null!==(e=bo(e=we(r))))if(null===(t=Ue(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=je(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Qt=null,Jt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Jt,r=n.length,o="value"in Qt?Qt.value:Qt.textContent,i=o.length;for(e=0;e<r&&n[e]===o[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===o[i-t];t++);return Zt=o.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function on(e){function t(t,n,r,o,i){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=o,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(o):o[a]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,sn,un,ln={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cn=on(ln),fn=L({},ln,{view:0,detail:0}),dn=on(fn),pn=L({},fn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==un&&(un&&"mousemove"===e.type?(an=e.screenX-un.screenX,sn=e.screenY-un.screenY):sn=an=0,un=e),an)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),hn=on(pn),vn=on(L({},pn,{dataTransfer:0})),mn=on(L({},fn,{relatedTarget:0})),gn=on(L({},ln,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=L({},ln,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=on(yn),xn=on(L({},ln,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Cn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},En={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=En[e])&&!!t[e]}function kn(){return Sn}var _n=L({},fn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Cn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Rn=on(_n),In=on(L({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Tn=on(L({},fn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kn})),An=on(L({},ln,{propertyName:0,elapsedTime:0,pseudoElement:0})),Dn=L({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Nn=on(Dn),Pn=[9,13,27,32],Mn=c&&"CompositionEvent"in window,On=null;c&&"documentMode"in document&&(On=document.documentMode);var Fn=c&&"TextEvent"in window&&!On,Ln=c&&(!Mn||On&&8<On&&11>=On),Bn=String.fromCharCode(32),zn=!1;function Wn(e,t){switch(e){case"keyup":return-1!==Pn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Un=!1;var jn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!jn[e.type]:"textarea"===t}function Gn(e,t,n,r){_e(r),0<(t=qr(t,"onChange")).length&&(n=new cn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var qn=null,Kn=null;function Xn(e){Br(e,0)}function $n(e){if(K(wo(e)))return e}function Yn(e,t){if("change"===e)return t}var Qn=!1;if(c){var Jn;if(c){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Jn=Zn}else Jn=!1;Qn=Jn&&(!document.documentMode||9<document.documentMode)}function tr(){qn&&(qn.detachEvent("onpropertychange",nr),Kn=qn=null)}function nr(e){if("value"===e.propertyName&&$n(Kn)){var t=[];Gn(t,Kn,e,we(e)),De(Xn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(qn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function or(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return $n(Kn)}function ir(e,t){if("click"===e)return $n(t)}function ar(e,t){if("input"===e||"change"===e)return $n(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ur(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!f.call(t,o)||!sr(e[o],t[o]))return!1}return!0}function lr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cr(e,t){var n,r=lr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=lr(r)}}function fr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?fr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dr(){for(var e=window,t=X();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=X((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function hr(e){var t=dr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&fr(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var o=n.textContent.length,i=Math.min(r.start,o);r=void 0===r.end?i:Math.min(r.end,o),!e.extend&&i>r&&(o=r,r=i,i=o),o=cr(n,i);var a=cr(n,r);o&&a&&(1!==e.rangeCount||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(o.node,o.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vr=c&&"documentMode"in document&&11>=document.documentMode,mr=null,gr=null,yr=null,br=!1;function xr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==mr||mr!==X(r)||("selectionStart"in(r=mr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&ur(yr,r)||(yr=r,0<(r=qr(gr,"onSelect")).length&&(t=new cn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Cr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},Er={},Sr={};function kr(e){if(Er[e])return Er[e];if(!Cr[e])return e;var t,n=Cr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Sr)return Er[e]=n[t];return e}c&&(Sr=document.createElement("div").style,"AnimationEvent"in window||(delete Cr.animationend.animation,delete Cr.animationiteration.animation,delete Cr.animationstart.animation),"TransitionEvent"in window||delete Cr.transitionend.transition);var _r=kr("animationend"),Rr=kr("animationiteration"),Ir=kr("animationstart"),Tr=kr("transitionend"),Ar=new Map,Dr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Nr(e,t){Ar.set(e,t),u(t,[e])}for(var Pr=0;Pr<Dr.length;Pr++){var Mr=Dr[Pr];Nr(Mr.toLowerCase(),"on"+(Mr[0].toUpperCase()+Mr.slice(1)))}Nr(_r,"onAnimationEnd"),Nr(Rr,"onAnimationIteration"),Nr(Ir,"onAnimationStart"),Nr("dblclick","onDoubleClick"),Nr("focusin","onFocus"),Nr("focusout","onBlur"),Nr(Tr,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Or="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Or));function Lr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,o,a,s,u,l){if(Ve.apply(this,arguments),Fe){if(!Fe)throw Error(i(198));var c=Le;Fe=!1,Le=null,Be||(Be=!0,ze=c)}}(r,t,void 0,e),e.currentTarget=null}function Br(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],u=s.instance,l=s.currentTarget;if(s=s.listener,u!==i&&o.isPropagationStopped())break e;Lr(o,s,l),i=u}else for(a=0;a<r.length;a++){if(u=(s=r[a]).instance,l=s.currentTarget,s=s.listener,u!==i&&o.isPropagationStopped())break e;Lr(o,s,l),i=u}}}if(Be)throw e=ze,Be=!1,ze=null,e}function zr(e,t){var n=t[mo];void 0===n&&(n=t[mo]=new Set);var r=e+"__bubble";n.has(r)||(jr(t,e,2,!1),n.add(r))}function Wr(e,t,n){var r=0;t&&(r|=4),jr(n,e,r,t)}var Vr="_reactListening"+Math.random().toString(36).slice(2);function Ur(e){if(!e[Vr]){e[Vr]=!0,a.forEach((function(t){"selectionchange"!==t&&(Fr.has(t)||Wr(t,!1,e),Wr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Vr]||(t[Vr]=!0,Wr("selectionchange",!1,t))}}function jr(e,t,n,r){switch(Yt(t)){case 1:var o=Gt;break;case 4:o=qt;break;default:o=Kt}n=o.bind(null,t,n,e),o=void 0,!Pe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(o=!0),r?void 0!==o?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):void 0!==o?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function Hr(e,t,n,r,o){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var s=r.stateNode.containerInfo;if(s===o||8===s.nodeType&&s.parentNode===o)break;if(4===a)for(a=r.return;null!==a;){var u=a.tag;if((3===u||4===u)&&((u=a.stateNode.containerInfo)===o||8===u.nodeType&&u.parentNode===o))return;a=a.return}for(;null!==s;){if(null===(a=bo(s)))return;if(5===(u=a.tag)||6===u){r=i=a;continue e}s=s.parentNode}}r=r.return}De((function(){var r=i,o=we(n),a=[];e:{var s=Ar.get(e);if(void 0!==s){var u=cn,l=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":u=Rn;break;case"focusin":l="focus",u=mn;break;case"focusout":l="blur",u=mn;break;case"beforeblur":case"afterblur":u=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=hn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=vn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=Tn;break;case _r:case Rr:case Ir:u=gn;break;case Tr:u=An;break;case"scroll":u=dn;break;case"wheel":u=Nn;break;case"copy":case"cut":case"paste":u=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=In}var c=0!==(4&t),f=!c&&"scroll"===e,d=c?null!==s?s+"Capture":null:s;c=[];for(var p,h=r;null!==h;){var v=(p=h).stateNode;if(5===p.tag&&null!==v&&(p=v,null!==d&&(null!=(v=Ne(h,d))&&c.push(Gr(h,v,p)))),f)break;h=h.return}0<c.length&&(s=new u(s,l,null,n,o),a.push({event:s,listeners:c}))}}if(0===(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===xe||!(l=n.relatedTarget||n.fromElement)||!bo(l)&&!l[vo])&&(u||s)&&(s=o.window===o?o:(s=o.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=r,null!==(l=(l=n.relatedTarget||n.toElement)?bo(l):null)&&(l!==(f=Ue(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(u=null,l=r),u!==l)){if(c=hn,v="onMouseLeave",d="onMouseEnter",h="mouse","pointerout"!==e&&"pointerover"!==e||(c=In,v="onPointerLeave",d="onPointerEnter",h="pointer"),f=null==u?s:wo(u),p=null==l?s:wo(l),(s=new c(v,h+"leave",u,n,o)).target=f,s.relatedTarget=p,v=null,bo(o)===r&&((c=new c(d,h+"enter",l,n,o)).target=p,c.relatedTarget=f,v=c),f=v,u&&l)e:{for(d=l,h=0,p=c=u;p;p=Kr(p))h++;for(p=0,v=d;v;v=Kr(v))p++;for(;0<h-p;)c=Kr(c),h--;for(;0<p-h;)d=Kr(d),p--;for(;h--;){if(c===d||null!==d&&c===d.alternate)break e;c=Kr(c),d=Kr(d)}c=null}else c=null;null!==u&&Xr(a,s,u,c,!1),null!==l&&null!==f&&Xr(a,f,l,c,!0)}if("select"===(u=(s=r?wo(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var m=Yn;else if(Hn(s))if(Qn)m=ar;else{m=or;var g=rr}else(u=s.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(m=ir);switch(m&&(m=m(e,r))?Gn(a,m,n,o):(g&&g(e,s,r),"focusout"===e&&(g=s._wrapperState)&&g.controlled&&"number"===s.type&&ee(s,"number",s.value)),g=r?wo(r):window,e){case"focusin":(Hn(g)||"true"===g.contentEditable)&&(mr=g,gr=r,yr=null);break;case"focusout":yr=gr=mr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,xr(a,n,o);break;case"selectionchange":if(vr)break;case"keydown":case"keyup":xr(a,n,o)}var y;if(Mn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Un?Wn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Ln&&"ko"!==n.locale&&(Un||"onCompositionStart"!==b?"onCompositionEnd"===b&&Un&&(y=en()):(Jt="value"in(Qt=o)?Qt.value:Qt.textContent,Un=!0)),0<(g=qr(r,b)).length&&(b=new xn(b,e,null,n,o),a.push({event:b,listeners:g}),y?b.data=y:null!==(y=Vn(n))&&(b.data=y))),(y=Fn?function(e,t){switch(e){case"compositionend":return Vn(t);case"keypress":return 32!==t.which?null:(zn=!0,Bn);case"textInput":return(e=t.data)===Bn&&zn?null:e;default:return null}}(e,n):function(e,t){if(Un)return"compositionend"===e||!Mn&&Wn(e,t)?(e=en(),Zt=Jt=Qt=null,Un=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=qr(r,"onBeforeInput")).length&&(o=new xn("onBeforeInput","beforeinput",null,n,o),a.push({event:o,listeners:r}),o.data=y))}Br(a,t)}))}function Gr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function qr(e,t){for(var n=t+"Capture",r=[];null!==e;){var o=e,i=o.stateNode;5===o.tag&&null!==i&&(o=i,null!=(i=Ne(e,n))&&r.unshift(Gr(e,i,o)),null!=(i=Ne(e,t))&&r.push(Gr(e,i,o))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Xr(e,t,n,r,o){for(var i=t._reactName,a=[];null!==n&&n!==r;){var s=n,u=s.alternate,l=s.stateNode;if(null!==u&&u===r)break;5===s.tag&&null!==l&&(s=l,o?null!=(u=Ne(n,i))&&a.unshift(Gr(n,u,s)):o||null!=(u=Ne(n,i))&&a.push(Gr(n,u,s))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var $r=/\r\n?/g,Yr=/\u0000|\uFFFD/g;function Qr(e){return("string"===typeof e?e:""+e).replace($r,"\n").replace(Yr,"")}function Jr(e,t,n){if(t=Qr(t),Qr(e)!==t&&n)throw Error(i(425))}function Zr(){}var eo=null,to=null;function no(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ro="function"===typeof setTimeout?setTimeout:void 0,oo="function"===typeof clearTimeout?clearTimeout:void 0,io="function"===typeof Promise?Promise:void 0,ao="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof io?function(e){return io.resolve(null).then(e).catch(so)}:ro;function so(e){setTimeout((function(){throw e}))}function uo(e,t){var n=t,r=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&8===o.nodeType)if("/$"===(n=o.data)){if(0===r)return e.removeChild(o),void Ut(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=o}while(n);Ut(t)}function lo(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function co(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var fo=Math.random().toString(36).slice(2),po="__reactFiber$"+fo,ho="__reactProps$"+fo,vo="__reactContainer$"+fo,mo="__reactEvents$"+fo,go="__reactListeners$"+fo,yo="__reactHandles$"+fo;function bo(e){var t=e[po];if(t)return t;for(var n=e.parentNode;n;){if(t=n[vo]||n[po]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=co(e);null!==e;){if(n=e[po])return n;e=co(e)}return t}n=(e=n).parentNode}return null}function xo(e){return!(e=e[po]||e[vo])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wo(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function Co(e){return e[ho]||null}var Eo=[],So=-1;function ko(e){return{current:e}}function _o(e){0>So||(e.current=Eo[So],Eo[So]=null,So--)}function Ro(e,t){So++,Eo[So]=e.current,e.current=t}var Io={},To=ko(Io),Ao=ko(!1),Do=Io;function No(e,t){var n=e.type.contextTypes;if(!n)return Io;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o,i={};for(o in n)i[o]=t[o];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Po(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Mo(){_o(Ao),_o(To)}function Oo(e,t,n){if(To.current!==Io)throw Error(i(168));Ro(To,t),Ro(Ao,n)}function Fo(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in t))throw Error(i(108,j(e)||"Unknown",o));return L({},n,r)}function Lo(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Io,Do=To.current,Ro(To,e),Ro(Ao,Ao.current),!0}function Bo(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=Fo(e,t,Do),r.__reactInternalMemoizedMergedChildContext=e,_o(Ao),_o(To),Ro(To,e)):_o(Ao),Ro(Ao,n)}var zo=null,Wo=!1,Vo=!1;function Uo(e){null===zo?zo=[e]:zo.push(e)}function jo(){if(!Vo&&null!==zo){Vo=!0;var e=0,t=bt;try{var n=zo;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}zo=null,Wo=!1}catch(o){throw null!==zo&&(zo=zo.slice(e+1)),Ke(Ze,jo),o}finally{bt=t,Vo=!1}}return null}var Ho=[],Go=0,qo=null,Ko=0,Xo=[],$o=0,Yo=null,Qo=1,Jo="";function Zo(e,t){Ho[Go++]=Ko,Ho[Go++]=qo,qo=e,Ko=t}function ei(e,t,n){Xo[$o++]=Qo,Xo[$o++]=Jo,Xo[$o++]=Yo,Yo=e;var r=Qo;e=Jo;var o=32-at(r)-1;r&=~(1<<o),n+=1;var i=32-at(t)+o;if(30<i){var a=o-o%5;i=(r&(1<<a)-1).toString(32),r>>=a,o-=a,Qo=1<<32-at(t)+o|n<<o|r,Jo=i+e}else Qo=1<<i|n<<o|r,Jo=e}function ti(e){null!==e.return&&(Zo(e,1),ei(e,1,0))}function ni(e){for(;e===qo;)qo=Ho[--Go],Ho[Go]=null,Ko=Ho[--Go],Ho[Go]=null;for(;e===Yo;)Yo=Xo[--$o],Xo[$o]=null,Jo=Xo[--$o],Xo[$o]=null,Qo=Xo[--$o],Xo[$o]=null}var ri=null,oi=null,ii=!1,ai=null;function si(e,t){var n=Dl(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ui(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ri=e,oi=lo(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ri=e,oi=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Yo?{id:Qo,overflow:Jo}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Dl(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ri=e,oi=null,!0);default:return!1}}function li(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ci(e){if(ii){var t=oi;if(t){var n=t;if(!ui(e,t)){if(li(e))throw Error(i(418));t=lo(n.nextSibling);var r=ri;t&&ui(e,t)?si(r,n):(e.flags=-4097&e.flags|2,ii=!1,ri=e)}}else{if(li(e))throw Error(i(418));e.flags=-4097&e.flags|2,ii=!1,ri=e}}}function fi(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ri=e}function di(e){if(e!==ri)return!1;if(!ii)return fi(e),ii=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!no(e.type,e.memoizedProps)),t&&(t=oi)){if(li(e))throw pi(),Error(i(418));for(;t;)si(e,t),t=lo(t.nextSibling)}if(fi(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){oi=lo(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}oi=null}}else oi=ri?lo(e.stateNode.nextSibling):null;return!0}function pi(){for(var e=oi;e;)e=lo(e.nextSibling)}function hi(){oi=ri=null,ii=!1}function vi(e){null===ai?ai=[e]:ai.push(e)}var mi=x.ReactCurrentBatchConfig;function gi(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var yi=ko(null),bi=null,xi=null,wi=null;function Ci(){wi=xi=bi=null}function Ei(e){var t=yi.current;_o(yi),e._currentValue=t}function Si(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function ki(e,t){bi=e,wi=xi=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(xs=!0),e.firstContext=null)}function _i(e){var t=e._currentValue;if(wi!==e)if(e={context:e,memoizedValue:t,next:null},null===xi){if(null===bi)throw Error(i(308));xi=e,bi.dependencies={lanes:0,firstContext:e}}else xi=xi.next=e;return t}var Ri=null;function Ii(e){null===Ri?Ri=[e]:Ri.push(e)}function Ti(e,t,n,r){var o=t.interleaved;return null===o?(n.next=n,Ii(t)):(n.next=o.next,o.next=n),t.interleaved=n,Ai(e,r)}function Ai(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Di=!1;function Ni(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Pi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Mi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Oi(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Iu)){var o=r.pending;return null===o?t.next=t:(t.next=o.next,o.next=t),r.pending=t,Ai(e,n)}return null===(o=r.interleaved)?(t.next=t,Ii(r)):(t.next=o.next,o.next=t),r.interleaved=t,Ai(e,n)}function Fi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Li(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var o=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?o=i=a:i=i.next=a,n=n.next}while(null!==n);null===i?o=i=t:i=i.next=t}else o=i=t;return n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Bi(e,t,n,r){var o=e.updateQueue;Di=!1;var i=o.firstBaseUpdate,a=o.lastBaseUpdate,s=o.shared.pending;if(null!==s){o.shared.pending=null;var u=s,l=u.next;u.next=null,null===a?i=l:a.next=l,a=u;var c=e.alternate;null!==c&&((s=(c=c.updateQueue).lastBaseUpdate)!==a&&(null===s?c.firstBaseUpdate=l:s.next=l,c.lastBaseUpdate=u))}if(null!==i){var f=o.baseState;for(a=0,c=l=u=null,s=i;;){var d=s.lane,p=s.eventTime;if((r&d)===d){null!==c&&(c=c.next={eventTime:p,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var h=e,v=s;switch(d=t,p=n,v.tag){case 1:if("function"===typeof(h=v.payload)){f=h.call(p,f,d);break e}f=h;break e;case 3:h.flags=-65537&h.flags|128;case 0:if(null===(d="function"===typeof(h=v.payload)?h.call(p,f,d):h)||void 0===d)break e;f=L({},f,d);break e;case 2:Di=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(d=o.effects)?o.effects=[s]:d.push(s))}else p={eventTime:p,lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===c?(l=c=p,u=f):c=c.next=p,a|=d;if(null===(s=s.next)){if(null===(s=o.shared.pending))break;s=(d=s).next,d.next=null,o.lastBaseUpdate=d,o.shared.pending=null}}if(null===c&&(u=f),o.baseState=u,o.firstBaseUpdate=l,o.lastBaseUpdate=c,null!==(t=o.shared.interleaved)){o=t;do{a|=o.lane,o=o.next}while(o!==t)}else null===i&&(o.shared.lanes=0);Fu|=a,e.lanes=a,e.memoizedState=f}}function zi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(null!==o){if(r.callback=null,r=n,"function"!==typeof o)throw Error(i(191,o));o.call(r)}}}var Wi=(new r.Component).refs;function Vi(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Ui={isMounted:function(e){return!!(e=e._reactInternals)&&Ue(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=el(),o=tl(e),i=Mi(r,o);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Oi(e,i,o))&&(nl(t,e,o,r),Fi(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=el(),o=tl(e),i=Mi(r,o);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Oi(e,i,o))&&(nl(t,e,o,r),Fi(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=el(),r=tl(e),o=Mi(n,r);o.tag=2,void 0!==t&&null!==t&&(o.callback=t),null!==(t=Oi(e,o,r))&&(nl(t,e,r,n),Fi(t,e,r))}};function ji(e,t,n,r,o,i,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,a):!t.prototype||!t.prototype.isPureReactComponent||(!ur(n,r)||!ur(o,i))}function Hi(e,t,n){var r=!1,o=Io,i=t.contextType;return"object"===typeof i&&null!==i?i=_i(i):(o=Po(t)?Do:To.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?No(e,o):Io),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Ui,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=i),t}function Gi(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Ui.enqueueReplaceState(t,t.state,null)}function qi(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs=Wi,Ni(e);var i=t.contextType;"object"===typeof i&&null!==i?o.context=_i(i):(i=Po(t)?Do:To.current,o.context=No(e,i)),o.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(Vi(e,t,i,n),o.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof o.getSnapshotBeforeUpdate||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||(t=o.state,"function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),t!==o.state&&Ui.enqueueReplaceState(o,o.state,null),Bi(e,n,o,r),o.state=e.memoizedState),"function"===typeof o.componentDidMount&&(e.flags|=4194308)}function Ki(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var o=r,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=o.refs;t===Wi&&(t=o.refs={}),null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function Xi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function $i(e){return(0,e._init)(e._payload)}function Yi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=Pl(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=Ll(n,e.mode,r)).return=e,t):((t=o(t,n)).return=e,t)}function l(e,t,n,r){var i=n.type;return i===E?f(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===N&&$i(i)===t.type)?((r=o(t,n.props)).ref=Ki(e,t,n),r.return=e,r):((r=Ml(n.type,n.key,n.props,null,e.mode,r)).ref=Ki(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Bl(n,e.mode,r)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function f(e,t,n,r,i){return null===t||7!==t.tag?((t=Ol(n,e.mode,r,i)).return=e,t):((t=o(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Ll(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Ml(t.type,t.key,t.props,null,e.mode,n)).ref=Ki(e,null,t),n.return=e,n;case C:return(t=Bl(t,e.mode,n)).return=e,t;case N:return d(e,(0,t._init)(t._payload),n)}if(te(t)||O(t))return(t=Ol(t,e.mode,n,null)).return=e,t;Xi(e,t)}return null}function p(e,t,n,r){var o=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==o?null:u(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===o?l(e,t,n,r):null;case C:return n.key===o?c(e,t,n,r):null;case N:return p(e,t,(o=n._init)(n._payload),r)}if(te(n)||O(n))return null!==o?null:f(e,t,n,r,null);Xi(e,n)}return null}function h(e,t,n,r,o){if("string"===typeof r&&""!==r||"number"===typeof r)return u(t,e=e.get(n)||null,""+r,o);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return l(t,e=e.get(null===r.key?n:r.key)||null,r,o);case C:return c(t,e=e.get(null===r.key?n:r.key)||null,r,o);case N:return h(e,t,n,(0,r._init)(r._payload),o)}if(te(r)||O(r))return f(t,e=e.get(n)||null,r,o,null);Xi(t,r)}return null}function v(o,i,s,u){for(var l=null,c=null,f=i,v=i=0,m=null;null!==f&&v<s.length;v++){f.index>v?(m=f,f=null):m=f.sibling;var g=p(o,f,s[v],u);if(null===g){null===f&&(f=m);break}e&&f&&null===g.alternate&&t(o,f),i=a(g,i,v),null===c?l=g:c.sibling=g,c=g,f=m}if(v===s.length)return n(o,f),ii&&Zo(o,v),l;if(null===f){for(;v<s.length;v++)null!==(f=d(o,s[v],u))&&(i=a(f,i,v),null===c?l=f:c.sibling=f,c=f);return ii&&Zo(o,v),l}for(f=r(o,f);v<s.length;v++)null!==(m=h(f,o,v,s[v],u))&&(e&&null!==m.alternate&&f.delete(null===m.key?v:m.key),i=a(m,i,v),null===c?l=m:c.sibling=m,c=m);return e&&f.forEach((function(e){return t(o,e)})),ii&&Zo(o,v),l}function m(o,s,u,l){var c=O(u);if("function"!==typeof c)throw Error(i(150));if(null==(u=c.call(u)))throw Error(i(151));for(var f=c=null,v=s,m=s=0,g=null,y=u.next();null!==v&&!y.done;m++,y=u.next()){v.index>m?(g=v,v=null):g=v.sibling;var b=p(o,v,y.value,l);if(null===b){null===v&&(v=g);break}e&&v&&null===b.alternate&&t(o,v),s=a(b,s,m),null===f?c=b:f.sibling=b,f=b,v=g}if(y.done)return n(o,v),ii&&Zo(o,m),c;if(null===v){for(;!y.done;m++,y=u.next())null!==(y=d(o,y.value,l))&&(s=a(y,s,m),null===f?c=y:f.sibling=y,f=y);return ii&&Zo(o,m),c}for(v=r(o,v);!y.done;m++,y=u.next())null!==(y=h(v,o,m,y.value,l))&&(e&&null!==y.alternate&&v.delete(null===y.key?m:y.key),s=a(y,s,m),null===f?c=y:f.sibling=y,f=y);return e&&v.forEach((function(e){return t(o,e)})),ii&&Zo(o,m),c}return function e(r,i,a,u){if("object"===typeof a&&null!==a&&a.type===E&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case w:e:{for(var l=a.key,c=i;null!==c;){if(c.key===l){if((l=a.type)===E){if(7===c.tag){n(r,c.sibling),(i=o(c,a.props.children)).return=r,r=i;break e}}else if(c.elementType===l||"object"===typeof l&&null!==l&&l.$$typeof===N&&$i(l)===c.type){n(r,c.sibling),(i=o(c,a.props)).ref=Ki(r,c,a),i.return=r,r=i;break e}n(r,c);break}t(r,c),c=c.sibling}a.type===E?((i=Ol(a.props.children,r.mode,u,a.key)).return=r,r=i):((u=Ml(a.type,a.key,a.props,null,r.mode,u)).ref=Ki(r,i,a),u.return=r,r=u)}return s(r);case C:e:{for(c=a.key;null!==i;){if(i.key===c){if(4===i.tag&&i.stateNode.containerInfo===a.containerInfo&&i.stateNode.implementation===a.implementation){n(r,i.sibling),(i=o(i,a.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=Bl(a,r.mode,u)).return=r,r=i}return s(r);case N:return e(r,i,(c=a._init)(a._payload),u)}if(te(a))return v(r,i,a,u);if(O(a))return m(r,i,a,u);Xi(r,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==i&&6===i.tag?(n(r,i.sibling),(i=o(i,a)).return=r,r=i):(n(r,i),(i=Ll(a,r.mode,u)).return=r,r=i),s(r)):n(r,i)}}var Qi=Yi(!0),Ji=Yi(!1),Zi={},ea=ko(Zi),ta=ko(Zi),na=ko(Zi);function ra(e){if(e===Zi)throw Error(i(174));return e}function oa(e,t){switch(Ro(na,t),Ro(ta,e),Ro(ea,Zi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ue(null,"");break;default:t=ue(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}_o(ea),Ro(ea,t)}function ia(){_o(ea),_o(ta),_o(na)}function aa(e){ra(na.current);var t=ra(ea.current),n=ue(t,e.type);t!==n&&(Ro(ta,e),Ro(ea,n))}function sa(e){ta.current===e&&(_o(ea),_o(ta))}var ua=ko(0);function la(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ca=[];function fa(){for(var e=0;e<ca.length;e++)ca[e]._workInProgressVersionPrimary=null;ca.length=0}var da=x.ReactCurrentDispatcher,pa=x.ReactCurrentBatchConfig,ha=0,va=null,ma=null,ga=null,ya=!1,ba=!1,xa=0,wa=0;function Ca(){throw Error(i(321))}function Ea(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function Sa(e,t,n,r,o,a){if(ha=a,va=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,da.current=null===e||null===e.memoizedState?ss:us,e=n(r,o),ba){a=0;do{if(ba=!1,xa=0,25<=a)throw Error(i(301));a+=1,ga=ma=null,t.updateQueue=null,da.current=ls,e=n(r,o)}while(ba)}if(da.current=as,t=null!==ma&&null!==ma.next,ha=0,ga=ma=va=null,ya=!1,t)throw Error(i(300));return e}function ka(){var e=0!==xa;return xa=0,e}function _a(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ga?va.memoizedState=ga=e:ga=ga.next=e,ga}function Ra(){if(null===ma){var e=va.alternate;e=null!==e?e.memoizedState:null}else e=ma.next;var t=null===ga?va.memoizedState:ga.next;if(null!==t)ga=t,ma=e;else{if(null===e)throw Error(i(310));e={memoizedState:(ma=e).memoizedState,baseState:ma.baseState,baseQueue:ma.baseQueue,queue:ma.queue,next:null},null===ga?va.memoizedState=ga=e:ga=ga.next=e}return ga}function Ia(e,t){return"function"===typeof t?t(e):t}function Ta(e){var t=Ra(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=ma,o=r.baseQueue,a=n.pending;if(null!==a){if(null!==o){var s=o.next;o.next=a.next,a.next=s}r.baseQueue=o=a,n.pending=null}if(null!==o){a=o.next,r=r.baseState;var u=s=null,l=null,c=a;do{var f=c.lane;if((ha&f)===f)null!==l&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var d={lane:f,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===l?(u=l=d,s=r):l=l.next=d,va.lanes|=f,Fu|=f}c=c.next}while(null!==c&&c!==a);null===l?s=r:l.next=u,sr(r,t.memoizedState)||(xs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=l,n.lastRenderedState=r}if(null!==(e=n.interleaved)){o=e;do{a=o.lane,va.lanes|=a,Fu|=a,o=o.next}while(o!==e)}else null===o&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Aa(e){var t=Ra(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,a=t.memoizedState;if(null!==o){n.pending=null;var s=o=o.next;do{a=e(a,s.action),s=s.next}while(s!==o);sr(a,t.memoizedState)||(xs=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function Da(){}function Na(e,t){var n=va,r=Ra(),o=t(),a=!sr(r.memoizedState,o);if(a&&(r.memoizedState=o,xs=!0),r=r.queue,Ha(Oa.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||null!==ga&&1&ga.memoizedState.tag){if(n.flags|=2048,za(9,Ma.bind(null,n,r,o,t),void 0,null),null===Tu)throw Error(i(349));0!==(30&ha)||Pa(n,t,o)}return o}function Pa(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=va.updateQueue)?(t={lastEffect:null,stores:null},va.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ma(e,t,n,r){t.value=n,t.getSnapshot=r,Fa(t)&&La(e)}function Oa(e,t,n){return n((function(){Fa(t)&&La(e)}))}function Fa(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function La(e){var t=Ai(e,1);null!==t&&nl(t,e,1,-1)}function Ba(e){var t=_a();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ia,lastRenderedState:e},t.queue=e,e=e.dispatch=ns.bind(null,va,e),[t.memoizedState,e]}function za(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=va.updateQueue)?(t={lastEffect:null,stores:null},va.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Wa(){return Ra().memoizedState}function Va(e,t,n,r){var o=_a();va.flags|=e,o.memoizedState=za(1|t,n,void 0,void 0===r?null:r)}function Ua(e,t,n,r){var o=Ra();r=void 0===r?null:r;var i=void 0;if(null!==ma){var a=ma.memoizedState;if(i=a.destroy,null!==r&&Ea(r,a.deps))return void(o.memoizedState=za(t,n,i,r))}va.flags|=e,o.memoizedState=za(1|t,n,i,r)}function ja(e,t){return Va(8390656,8,e,t)}function Ha(e,t){return Ua(2048,8,e,t)}function Ga(e,t){return Ua(4,2,e,t)}function qa(e,t){return Ua(4,4,e,t)}function Ka(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Xa(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ua(4,4,Ka.bind(null,t,e),n)}function $a(){}function Ya(e,t){var n=Ra();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Ea(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Qa(e,t){var n=Ra();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Ea(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ja(e,t,n){return 0===(21&ha)?(e.baseState&&(e.baseState=!1,xs=!0),e.memoizedState=n):(sr(n,t)||(n=vt(),va.lanes|=n,Fu|=n,e.baseState=!0),t)}function Za(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=pa.transition;pa.transition={};try{e(!1),t()}finally{bt=n,pa.transition=r}}function es(){return Ra().memoizedState}function ts(e,t,n){var r=tl(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},rs(e))os(t,n);else if(null!==(n=Ti(e,t,n,r))){nl(n,e,r,el()),is(n,t,r)}}function ns(e,t,n){var r=tl(e),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(rs(e))os(t,o);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=i(a,n);if(o.hasEagerState=!0,o.eagerState=s,sr(s,a)){var u=t.interleaved;return null===u?(o.next=o,Ii(t)):(o.next=u.next,u.next=o),void(t.interleaved=o)}}catch(l){}null!==(n=Ti(e,t,o,r))&&(nl(n,e,r,o=el()),is(n,t,r))}}function rs(e){var t=e.alternate;return e===va||null!==t&&t===va}function os(e,t){ba=ya=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function is(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var as={readContext:_i,useCallback:Ca,useContext:Ca,useEffect:Ca,useImperativeHandle:Ca,useInsertionEffect:Ca,useLayoutEffect:Ca,useMemo:Ca,useReducer:Ca,useRef:Ca,useState:Ca,useDebugValue:Ca,useDeferredValue:Ca,useTransition:Ca,useMutableSource:Ca,useSyncExternalStore:Ca,useId:Ca,unstable_isNewReconciler:!1},ss={readContext:_i,useCallback:function(e,t){return _a().memoizedState=[e,void 0===t?null:t],e},useContext:_i,useEffect:ja,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Va(4194308,4,Ka.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Va(4194308,4,e,t)},useInsertionEffect:function(e,t){return Va(4,2,e,t)},useMemo:function(e,t){var n=_a();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=_a();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=ts.bind(null,va,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},_a().memoizedState=e},useState:Ba,useDebugValue:$a,useDeferredValue:function(e){return _a().memoizedState=e},useTransition:function(){var e=Ba(!1),t=e[0];return e=Za.bind(null,e[1]),_a().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=va,o=_a();if(ii){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Tu)throw Error(i(349));0!==(30&ha)||Pa(r,t,n)}o.memoizedState=n;var a={value:n,getSnapshot:t};return o.queue=a,ja(Oa.bind(null,r,a,e),[e]),r.flags|=2048,za(9,Ma.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=_a(),t=Tu.identifierPrefix;if(ii){var n=Jo;t=":"+t+"R"+(n=(Qo&~(1<<32-at(Qo)-1)).toString(32)+n),0<(n=xa++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=wa++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},us={readContext:_i,useCallback:Ya,useContext:_i,useEffect:Ha,useImperativeHandle:Xa,useInsertionEffect:Ga,useLayoutEffect:qa,useMemo:Qa,useReducer:Ta,useRef:Wa,useState:function(){return Ta(Ia)},useDebugValue:$a,useDeferredValue:function(e){return Ja(Ra(),ma.memoizedState,e)},useTransition:function(){return[Ta(Ia)[0],Ra().memoizedState]},useMutableSource:Da,useSyncExternalStore:Na,useId:es,unstable_isNewReconciler:!1},ls={readContext:_i,useCallback:Ya,useContext:_i,useEffect:Ha,useImperativeHandle:Xa,useInsertionEffect:Ga,useLayoutEffect:qa,useMemo:Qa,useReducer:Aa,useRef:Wa,useState:function(){return Aa(Ia)},useDebugValue:$a,useDeferredValue:function(e){var t=Ra();return null===ma?t.memoizedState=e:Ja(t,ma.memoizedState,e)},useTransition:function(){return[Aa(Ia)[0],Ra().memoizedState]},useMutableSource:Da,useSyncExternalStore:Na,useId:es,unstable_isNewReconciler:!1};function cs(e,t){try{var n="",r=t;do{n+=V(r),r=r.return}while(r);var o=n}catch(i){o="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:o,digest:null}}function fs(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ds(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ps="function"===typeof WeakMap?WeakMap:Map;function hs(e,t,n){(n=Mi(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Hu||(Hu=!0,Gu=r),ds(0,t)},n}function vs(e,t,n){(n=Mi(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var o=t.value;n.payload=function(){return r(o)},n.callback=function(){ds(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){ds(0,t),"function"!==typeof r&&(null===qu?qu=new Set([this]):qu.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ms(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ps;var o=new Set;r.set(t,o)}else void 0===(o=r.get(t))&&(o=new Set,r.set(t,o));o.has(n)||(o.add(n),e=kl.bind(null,e,t,n),t.then(e,e))}function gs(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ys(e,t,n,r,o){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Mi(-1,1)).tag=2,Oi(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=o,e)}var bs=x.ReactCurrentOwner,xs=!1;function ws(e,t,n,r){t.child=null===e?Ji(t,null,n,r):Qi(t,e.child,n,r)}function Cs(e,t,n,r,o){n=n.render;var i=t.ref;return ki(t,o),r=Sa(e,t,n,r,i,o),n=ka(),null===e||xs?(ii&&n&&ti(t),t.flags|=1,ws(e,t,r,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Hs(e,t,o))}function Es(e,t,n,r,o){if(null===e){var i=n.type;return"function"!==typeof i||Nl(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Ml(n.type,null,r,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Ss(e,t,i,r,o))}if(i=e.child,0===(e.lanes&o)){var a=i.memoizedProps;if((n=null!==(n=n.compare)?n:ur)(a,r)&&e.ref===t.ref)return Hs(e,t,o)}return t.flags|=1,(e=Pl(i,r)).ref=t.ref,e.return=t,t.child=e}function Ss(e,t,n,r,o){if(null!==e){var i=e.memoizedProps;if(ur(i,r)&&e.ref===t.ref){if(xs=!1,t.pendingProps=r=i,0===(e.lanes&o))return t.lanes=e.lanes,Hs(e,t,o);0!==(131072&e.flags)&&(xs=!0)}}return Rs(e,t,n,r,o)}function ks(e,t,n){var r=t.pendingProps,o=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ro(Pu,Nu),Nu|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ro(Pu,Nu),Nu|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Ro(Pu,Nu),Nu|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Ro(Pu,Nu),Nu|=r;return ws(e,t,o,n),t.child}function _s(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Rs(e,t,n,r,o){var i=Po(n)?Do:To.current;return i=No(t,i),ki(t,o),n=Sa(e,t,n,r,i,o),r=ka(),null===e||xs?(ii&&r&&ti(t),t.flags|=1,ws(e,t,n,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Hs(e,t,o))}function Is(e,t,n,r,o){if(Po(n)){var i=!0;Lo(t)}else i=!1;if(ki(t,o),null===t.stateNode)js(e,t),Hi(t,n,r),qi(t,n,r,o),r=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var u=a.context,l=n.contextType;"object"===typeof l&&null!==l?l=_i(l):l=No(t,l=Po(n)?Do:To.current);var c=n.getDerivedStateFromProps,f="function"===typeof c||"function"===typeof a.getSnapshotBeforeUpdate;f||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==r||u!==l)&&Gi(t,a,r,l),Di=!1;var d=t.memoizedState;a.state=d,Bi(t,r,a,o),u=t.memoizedState,s!==r||d!==u||Ao.current||Di?("function"===typeof c&&(Vi(t,n,c,r),u=t.memoizedState),(s=Di||ji(t,n,s,r,d,u,l))?(f||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),a.props=r,a.state=u,a.context=l,r=s):("function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Pi(e,t),s=t.memoizedProps,l=t.type===t.elementType?s:gi(t.type,s),a.props=l,f=t.pendingProps,d=a.context,"object"===typeof(u=n.contextType)&&null!==u?u=_i(u):u=No(t,u=Po(n)?Do:To.current);var p=n.getDerivedStateFromProps;(c="function"===typeof p||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==f||d!==u)&&Gi(t,a,r,u),Di=!1,d=t.memoizedState,a.state=d,Bi(t,r,a,o);var h=t.memoizedState;s!==f||d!==h||Ao.current||Di?("function"===typeof p&&(Vi(t,n,p,r),h=t.memoizedState),(l=Di||ji(t,n,l,r,d,h,u)||!1)?(c||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,h,u),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,h,u)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=h),a.props=r,a.state=h,a.context=u,r=l):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return Ts(e,t,n,r,i,o)}function Ts(e,t,n,r,o,i){_s(e,t);var a=0!==(128&t.flags);if(!r&&!a)return o&&Bo(t,n,!1),Hs(e,t,i);r=t.stateNode,bs.current=t;var s=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=Qi(t,e.child,null,i),t.child=Qi(t,null,s,i)):ws(e,t,s,i),t.memoizedState=r.state,o&&Bo(t,n,!0),t.child}function As(e){var t=e.stateNode;t.pendingContext?Oo(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Oo(0,t.context,!1),oa(e,t.containerInfo)}function Ds(e,t,n,r,o){return hi(),vi(o),t.flags|=256,ws(e,t,n,r),t.child}var Ns,Ps,Ms,Os={dehydrated:null,treeContext:null,retryLane:0};function Fs(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ls(e,t,n){var r,o=t.pendingProps,a=ua.current,s=!1,u=0!==(128&t.flags);if((r=u)||(r=(null===e||null!==e.memoizedState)&&0!==(2&a)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Ro(ua,1&a),null===e)return ci(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(u=o.children,e=o.fallback,s?(o=t.mode,s=t.child,u={mode:"hidden",children:u},0===(1&o)&&null!==s?(s.childLanes=0,s.pendingProps=u):s=Fl(u,o,0,null),e=Ol(e,o,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Fs(n),t.memoizedState=Os,e):Bs(t,u));if(null!==(a=e.memoizedState)&&null!==(r=a.dehydrated))return function(e,t,n,r,o,a,s){if(n)return 256&t.flags?(t.flags&=-257,zs(e,t,s,r=fs(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=r.fallback,o=t.mode,r=Fl({mode:"visible",children:r.children},o,0,null),(a=Ol(a,o,s,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,0!==(1&t.mode)&&Qi(t,e.child,null,s),t.child.memoizedState=Fs(s),t.memoizedState=Os,a);if(0===(1&t.mode))return zs(e,t,s,null);if("$!"===o.data){if(r=o.nextSibling&&o.nextSibling.dataset)var u=r.dgst;return r=u,zs(e,t,s,r=fs(a=Error(i(419)),r,void 0))}if(u=0!==(s&e.childLanes),xs||u){if(null!==(r=Tu)){switch(s&-s){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}0!==(o=0!==(o&(r.suspendedLanes|s))?0:o)&&o!==a.retryLane&&(a.retryLane=o,Ai(e,o),nl(r,e,o,-1))}return vl(),zs(e,t,s,r=fs(Error(i(421))))}return"$?"===o.data?(t.flags|=128,t.child=e.child,t=Rl.bind(null,e),o._reactRetry=t,null):(e=a.treeContext,oi=lo(o.nextSibling),ri=t,ii=!0,ai=null,null!==e&&(Xo[$o++]=Qo,Xo[$o++]=Jo,Xo[$o++]=Yo,Qo=e.id,Jo=e.overflow,Yo=t),t=Bs(t,r.children),t.flags|=4096,t)}(e,t,u,o,r,a,n);if(s){s=o.fallback,u=t.mode,r=(a=e.child).sibling;var l={mode:"hidden",children:o.children};return 0===(1&u)&&t.child!==a?((o=t.child).childLanes=0,o.pendingProps=l,t.deletions=null):(o=Pl(a,l)).subtreeFlags=14680064&a.subtreeFlags,null!==r?s=Pl(r,s):(s=Ol(s,u,n,null)).flags|=2,s.return=t,o.return=t,o.sibling=s,t.child=o,o=s,s=t.child,u=null===(u=e.child.memoizedState)?Fs(n):{baseLanes:u.baseLanes|n,cachePool:null,transitions:u.transitions},s.memoizedState=u,s.childLanes=e.childLanes&~n,t.memoizedState=Os,o}return e=(s=e.child).sibling,o=Pl(s,{mode:"visible",children:o.children}),0===(1&t.mode)&&(o.lanes=n),o.return=t,o.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=o,t.memoizedState=null,o}function Bs(e,t){return(t=Fl({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function zs(e,t,n,r){return null!==r&&vi(r),Qi(t,e.child,null,n),(e=Bs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ws(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Si(e.return,t,n)}function Vs(e,t,n,r,o){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=o)}function Us(e,t,n){var r=t.pendingProps,o=r.revealOrder,i=r.tail;if(ws(e,t,r.children,n),0!==(2&(r=ua.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ws(e,n,t);else if(19===e.tag)Ws(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ro(ua,r),0===(1&t.mode))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;null!==n;)null!==(e=n.alternate)&&null===la(e)&&(o=n),n=n.sibling;null===(n=o)?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),Vs(t,!1,o,n,i);break;case"backwards":for(n=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===la(e)){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}Vs(t,!0,n,null,i);break;case"together":Vs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function js(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Hs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Fu|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Pl(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Pl(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Gs(e,t){if(!ii)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function qs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=14680064&o.subtreeFlags,r|=14680064&o.flags,o.return=e,o=o.sibling;else for(o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ks(e,t,n){var r=t.pendingProps;switch(ni(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qs(t),null;case 1:case 17:return Po(t.type)&&Mo(),qs(t),null;case 3:return r=t.stateNode,ia(),_o(Ao),_o(To),fa(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(di(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ai&&(al(ai),ai=null))),qs(t),null;case 5:sa(t);var o=ra(na.current);if(n=t.type,null!==e&&null!=t.stateNode)Ps(e,t,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return qs(t),null}if(e=ra(ea.current),di(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[po]=t,r[ho]=a,e=0!==(1&t.mode),n){case"dialog":zr("cancel",r),zr("close",r);break;case"iframe":case"object":case"embed":zr("load",r);break;case"video":case"audio":for(o=0;o<Or.length;o++)zr(Or[o],r);break;case"source":zr("error",r);break;case"img":case"image":case"link":zr("error",r),zr("load",r);break;case"details":zr("toggle",r);break;case"input":Y(r,a),zr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},zr("invalid",r);break;case"textarea":oe(r,a),zr("invalid",r)}for(var u in ye(n,a),o=null,a)if(a.hasOwnProperty(u)){var l=a[u];"children"===u?"string"===typeof l?r.textContent!==l&&(!0!==a.suppressHydrationWarning&&Jr(r.textContent,l,e),o=["children",l]):"number"===typeof l&&r.textContent!==""+l&&(!0!==a.suppressHydrationWarning&&Jr(r.textContent,l,e),o=["children",""+l]):s.hasOwnProperty(u)&&null!=l&&"onScroll"===u&&zr("scroll",r)}switch(n){case"input":q(r),Z(r,a,!0);break;case"textarea":q(r),ae(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=Zr)}r=o,t.updateQueue=r,null!==r&&(t.flags|=4)}else{u=9===o.nodeType?o:o.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=u.createElement(n,{is:r.is}):(e=u.createElement(n),"select"===n&&(u=e,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):e=u.createElementNS(e,n),e[po]=t,e[ho]=r,Ns(e,t),t.stateNode=e;e:{switch(u=be(n,r),n){case"dialog":zr("cancel",e),zr("close",e),o=r;break;case"iframe":case"object":case"embed":zr("load",e),o=r;break;case"video":case"audio":for(o=0;o<Or.length;o++)zr(Or[o],e);o=r;break;case"source":zr("error",e),o=r;break;case"img":case"image":case"link":zr("error",e),zr("load",e),o=r;break;case"details":zr("toggle",e),o=r;break;case"input":Y(e,r),o=$(e,r),zr("invalid",e);break;case"option":default:o=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=L({},r,{value:void 0}),zr("invalid",e);break;case"textarea":oe(e,r),o=re(e,r),zr("invalid",e)}for(a in ye(n,o),l=o)if(l.hasOwnProperty(a)){var c=l[a];"style"===a?me(e,c):"dangerouslySetInnerHTML"===a?null!=(c=c?c.__html:void 0)&&fe(e,c):"children"===a?"string"===typeof c?("textarea"!==n||""!==c)&&de(e,c):"number"===typeof c&&de(e,""+c):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(s.hasOwnProperty(a)?null!=c&&"onScroll"===a&&zr("scroll",e):null!=c&&b(e,a,c,u))}switch(n){case"input":q(e),Z(e,r,!1);break;case"textarea":q(e),ae(e);break;case"option":null!=r.value&&e.setAttribute("value",""+H(r.value));break;case"select":e.multiple=!!r.multiple,null!=(a=r.value)?ne(e,!!r.multiple,a,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof o.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return qs(t),null;case 6:if(e&&null!=t.stateNode)Ms(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=ra(na.current),ra(ea.current),di(t)){if(r=t.stateNode,n=t.memoizedProps,r[po]=t,(a=r.nodeValue!==n)&&null!==(e=ri))switch(e.tag){case 3:Jr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jr(r.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[po]=t,t.stateNode=r}return qs(t),null;case 13:if(_o(ua),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ii&&null!==oi&&0!==(1&t.mode)&&0===(128&t.flags))pi(),hi(),t.flags|=98560,a=!1;else if(a=di(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(i(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(i(317));a[po]=t}else hi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qs(t),a=!1}else null!==ai&&(al(ai),ai=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ua.current)?0===Mu&&(Mu=3):vl())),null!==t.updateQueue&&(t.flags|=4),qs(t),null);case 4:return ia(),null===e&&Ur(t.stateNode.containerInfo),qs(t),null;case 10:return Ei(t.type._context),qs(t),null;case 19:if(_o(ua),null===(a=t.memoizedState))return qs(t),null;if(r=0!==(128&t.flags),null===(u=a.rendering))if(r)Gs(a,!1);else{if(0!==Mu||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(u=la(e))){for(t.flags|=128,Gs(a,!1),null!==(r=u.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(a=n).flags&=14680066,null===(u=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=u.childLanes,a.lanes=u.lanes,a.child=u.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=u.memoizedProps,a.memoizedState=u.memoizedState,a.updateQueue=u.updateQueue,a.type=u.type,e=u.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ro(ua,1&ua.current|2),t.child}e=e.sibling}null!==a.tail&&Qe()>Uu&&(t.flags|=128,r=!0,Gs(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=la(u))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Gs(a,!0),null===a.tail&&"hidden"===a.tailMode&&!u.alternate&&!ii)return qs(t),null}else 2*Qe()-a.renderingStartTime>Uu&&1073741824!==n&&(t.flags|=128,r=!0,Gs(a,!1),t.lanes=4194304);a.isBackwards?(u.sibling=t.child,t.child=u):(null!==(n=a.last)?n.sibling=u:t.child=u,a.last=u)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Qe(),t.sibling=null,n=ua.current,Ro(ua,r?1&n|2:1&n),t):(qs(t),null);case 22:case 23:return fl(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Nu)&&(qs(t),6&t.subtreeFlags&&(t.flags|=8192)):qs(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Xs(e,t){switch(ni(t),t.tag){case 1:return Po(t.type)&&Mo(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ia(),_o(Ao),_o(To),fa(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return sa(t),null;case 13:if(_o(ua),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));hi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return _o(ua),null;case 4:return ia(),null;case 10:return Ei(t.type._context),null;case 22:case 23:return fl(),null;default:return null}}Ns=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ps=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,ra(ea.current);var i,a=null;switch(n){case"input":o=$(e,o),r=$(e,r),a=[];break;case"select":o=L({},o,{value:void 0}),r=L({},r,{value:void 0}),a=[];break;case"textarea":o=re(e,o),r=re(e,r),a=[];break;default:"function"!==typeof o.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(c in ye(n,r),n=null,o)if(!r.hasOwnProperty(c)&&o.hasOwnProperty(c)&&null!=o[c])if("style"===c){var u=o[c];for(i in u)u.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(s.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in r){var l=r[c];if(u=null!=o?o[c]:void 0,r.hasOwnProperty(c)&&l!==u&&(null!=l||null!=u))if("style"===c)if(u){for(i in u)!u.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&u[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(a||(a=[]),a.push(c,n)),n=l;else"dangerouslySetInnerHTML"===c?(l=l?l.__html:void 0,u=u?u.__html:void 0,null!=l&&u!==l&&(a=a||[]).push(c,l)):"children"===c?"string"!==typeof l&&"number"!==typeof l||(a=a||[]).push(c,""+l):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(s.hasOwnProperty(c)?(null!=l&&"onScroll"===c&&zr("scroll",e),a||u===l||(a=[])):(a=a||[]).push(c,l))}n&&(a=a||[]).push("style",n);var c=a;(t.updateQueue=c)&&(t.flags|=4)}},Ms=function(e,t,n,r){n!==r&&(t.flags|=4)};var $s=!1,Ys=!1,Qs="function"===typeof WeakSet?WeakSet:Set,Js=null;function Zs(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Sl(e,t,r)}else n.current=null}function eu(e,t,n){try{n()}catch(r){Sl(e,t,r)}}var tu=!1;function nu(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var o=r=r.next;do{if((o.tag&e)===e){var i=o.destroy;o.destroy=void 0,void 0!==i&&eu(t,n,i)}o=o.next}while(o!==r)}}function ru(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ou(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function iu(e){var t=e.alternate;null!==t&&(e.alternate=null,iu(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[po],delete t[ho],delete t[mo],delete t[go],delete t[yo])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function au(e){return 5===e.tag||3===e.tag||4===e.tag}function su(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||au(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function uu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(uu(e,t,n),e=e.sibling;null!==e;)uu(e,t,n),e=e.sibling}function lu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(lu(e,t,n),e=e.sibling;null!==e;)lu(e,t,n),e=e.sibling}var cu=null,fu=!1;function du(e,t,n){for(n=n.child;null!==n;)pu(e,t,n),n=n.sibling}function pu(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(ot,n)}catch(s){}switch(n.tag){case 5:Ys||Zs(n,t);case 6:var r=cu,o=fu;cu=null,du(e,t,n),fu=o,null!==(cu=r)&&(fu?(e=cu,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):cu.removeChild(n.stateNode));break;case 18:null!==cu&&(fu?(e=cu,n=n.stateNode,8===e.nodeType?uo(e.parentNode,n):1===e.nodeType&&uo(e,n),Ut(e)):uo(cu,n.stateNode));break;case 4:r=cu,o=fu,cu=n.stateNode.containerInfo,fu=!0,du(e,t,n),cu=r,fu=o;break;case 0:case 11:case 14:case 15:if(!Ys&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){o=r=r.next;do{var i=o,a=i.destroy;i=i.tag,void 0!==a&&(0!==(2&i)||0!==(4&i))&&eu(n,t,a),o=o.next}while(o!==r)}du(e,t,n);break;case 1:if(!Ys&&(Zs(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Sl(n,t,s)}du(e,t,n);break;case 21:du(e,t,n);break;case 22:1&n.mode?(Ys=(r=Ys)||null!==n.memoizedState,du(e,t,n),Ys=r):du(e,t,n);break;default:du(e,t,n)}}function hu(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Qs),t.forEach((function(t){var r=Il.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function vu(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var o=n[r];try{var a=e,s=t,u=s;e:for(;null!==u;){switch(u.tag){case 5:cu=u.stateNode,fu=!1;break e;case 3:case 4:cu=u.stateNode.containerInfo,fu=!0;break e}u=u.return}if(null===cu)throw Error(i(160));pu(a,s,o),cu=null,fu=!1;var l=o.alternate;null!==l&&(l.return=null),o.return=null}catch(c){Sl(o,t,c)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)mu(t,e),t=t.sibling}function mu(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(vu(t,e),gu(e),4&r){try{nu(3,e,e.return),ru(3,e)}catch(m){Sl(e,e.return,m)}try{nu(5,e,e.return)}catch(m){Sl(e,e.return,m)}}break;case 1:vu(t,e),gu(e),512&r&&null!==n&&Zs(n,n.return);break;case 5:if(vu(t,e),gu(e),512&r&&null!==n&&Zs(n,n.return),32&e.flags){var o=e.stateNode;try{de(o,"")}catch(m){Sl(e,e.return,m)}}if(4&r&&null!=(o=e.stateNode)){var a=e.memoizedProps,s=null!==n?n.memoizedProps:a,u=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===u&&"radio"===a.type&&null!=a.name&&Q(o,a),be(u,s);var c=be(u,a);for(s=0;s<l.length;s+=2){var f=l[s],d=l[s+1];"style"===f?me(o,d):"dangerouslySetInnerHTML"===f?fe(o,d):"children"===f?de(o,d):b(o,f,d,c)}switch(u){case"input":J(o,a);break;case"textarea":ie(o,a);break;case"select":var p=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!a.multiple;var h=a.value;null!=h?ne(o,!!a.multiple,h,!1):p!==!!a.multiple&&(null!=a.defaultValue?ne(o,!!a.multiple,a.defaultValue,!0):ne(o,!!a.multiple,a.multiple?[]:"",!1))}o[ho]=a}catch(m){Sl(e,e.return,m)}}break;case 6:if(vu(t,e),gu(e),4&r){if(null===e.stateNode)throw Error(i(162));o=e.stateNode,a=e.memoizedProps;try{o.nodeValue=a}catch(m){Sl(e,e.return,m)}}break;case 3:if(vu(t,e),gu(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Ut(t.containerInfo)}catch(m){Sl(e,e.return,m)}break;case 4:default:vu(t,e),gu(e);break;case 13:vu(t,e),gu(e),8192&(o=e.child).flags&&(a=null!==o.memoizedState,o.stateNode.isHidden=a,!a||null!==o.alternate&&null!==o.alternate.memoizedState||(Vu=Qe())),4&r&&hu(e);break;case 22:if(f=null!==n&&null!==n.memoizedState,1&e.mode?(Ys=(c=Ys)||f,vu(t,e),Ys=c):vu(t,e),gu(e),8192&r){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!f&&0!==(1&e.mode))for(Js=e,f=e.child;null!==f;){for(d=Js=f;null!==Js;){switch(h=(p=Js).child,p.tag){case 0:case 11:case 14:case 15:nu(4,p,p.return);break;case 1:Zs(p,p.return);var v=p.stateNode;if("function"===typeof v.componentWillUnmount){r=p,n=p.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(m){Sl(r,n,m)}}break;case 5:Zs(p,p.return);break;case 22:if(null!==p.memoizedState){wu(d);continue}}null!==h?(h.return=p,Js=h):wu(d)}f=f.sibling}e:for(f=null,d=e;;){if(5===d.tag){if(null===f){f=d;try{o=d.stateNode,c?"function"===typeof(a=o.style).setProperty?a.setProperty("display","none","important"):a.display="none":(u=d.stateNode,s=void 0!==(l=d.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null,u.style.display=ve("display",s))}catch(m){Sl(e,e.return,m)}}}else if(6===d.tag){if(null===f)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(m){Sl(e,e.return,m)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:vu(t,e),gu(e),4&r&&hu(e);case 21:}}function gu(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(au(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var o=r.stateNode;32&r.flags&&(de(o,""),r.flags&=-33),lu(e,su(e),o);break;case 3:case 4:var a=r.stateNode.containerInfo;uu(e,su(e),a);break;default:throw Error(i(161))}}catch(s){Sl(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yu(e,t,n){Js=e,bu(e,t,n)}function bu(e,t,n){for(var r=0!==(1&e.mode);null!==Js;){var o=Js,i=o.child;if(22===o.tag&&r){var a=null!==o.memoizedState||$s;if(!a){var s=o.alternate,u=null!==s&&null!==s.memoizedState||Ys;s=$s;var l=Ys;if($s=a,(Ys=u)&&!l)for(Js=o;null!==Js;)u=(a=Js).child,22===a.tag&&null!==a.memoizedState?Cu(o):null!==u?(u.return=a,Js=u):Cu(o);for(;null!==i;)Js=i,bu(i,t,n),i=i.sibling;Js=o,$s=s,Ys=l}xu(e)}else 0!==(8772&o.subtreeFlags)&&null!==i?(i.return=o,Js=i):xu(e)}}function xu(e){for(;null!==Js;){var t=Js;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ys||ru(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Ys)if(null===n)r.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:gi(t.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&zi(t,a,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}zi(t,s,n)}break;case 5:var u=t.stateNode;if(null===n&&4&t.flags){n=u;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var f=c.memoizedState;if(null!==f){var d=f.dehydrated;null!==d&&Ut(d)}}}break;default:throw Error(i(163))}Ys||512&t.flags&&ou(t)}catch(p){Sl(t,t.return,p)}}if(t===e){Js=null;break}if(null!==(n=t.sibling)){n.return=t.return,Js=n;break}Js=t.return}}function wu(e){for(;null!==Js;){var t=Js;if(t===e){Js=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Js=n;break}Js=t.return}}function Cu(e){for(;null!==Js;){var t=Js;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ru(4,t)}catch(u){Sl(t,n,u)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var o=t.return;try{r.componentDidMount()}catch(u){Sl(t,o,u)}}var i=t.return;try{ou(t)}catch(u){Sl(t,i,u)}break;case 5:var a=t.return;try{ou(t)}catch(u){Sl(t,a,u)}}}catch(u){Sl(t,t.return,u)}if(t===e){Js=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Js=s;break}Js=t.return}}var Eu,Su=Math.ceil,ku=x.ReactCurrentDispatcher,_u=x.ReactCurrentOwner,Ru=x.ReactCurrentBatchConfig,Iu=0,Tu=null,Au=null,Du=0,Nu=0,Pu=ko(0),Mu=0,Ou=null,Fu=0,Lu=0,Bu=0,zu=null,Wu=null,Vu=0,Uu=1/0,ju=null,Hu=!1,Gu=null,qu=null,Ku=!1,Xu=null,$u=0,Yu=0,Qu=null,Ju=-1,Zu=0;function el(){return 0!==(6&Iu)?Qe():-1!==Ju?Ju:Ju=Qe()}function tl(e){return 0===(1&e.mode)?1:0!==(2&Iu)&&0!==Du?Du&-Du:null!==mi.transition?(0===Zu&&(Zu=vt()),Zu):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function nl(e,t,n,r){if(50<Yu)throw Yu=0,Qu=null,Error(i(185));gt(e,n,r),0!==(2&Iu)&&e===Tu||(e===Tu&&(0===(2&Iu)&&(Lu|=n),4===Mu&&sl(e,Du)),rl(e,r),1===n&&0===Iu&&0===(1&t.mode)&&(Uu=Qe()+500,Wo&&jo()))}function rl(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-at(i),s=1<<a,u=o[a];-1===u?0!==(s&n)&&0===(s&r)||(o[a]=pt(s,t)):u<=t&&(e.expiredLanes|=s),i&=~s}}(e,t);var r=dt(e,e===Tu?Du:0);if(0===r)null!==n&&Xe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Xe(n),1===t)0===e.tag?function(e){Wo=!0,Uo(e)}(ul.bind(null,e)):Uo(ul.bind(null,e)),ao((function(){0===(6&Iu)&&jo()})),n=null;else{switch(xt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Tl(n,ol.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ol(e,t){if(Ju=-1,Zu=0,0!==(6&Iu))throw Error(i(327));var n=e.callbackNode;if(Cl()&&e.callbackNode!==n)return null;var r=dt(e,e===Tu?Du:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=ml(e,r);else{t=r;var o=Iu;Iu|=2;var a=hl();for(Tu===e&&Du===t||(ju=null,Uu=Qe()+500,dl(e,t));;)try{yl();break}catch(u){pl(e,u)}Ci(),ku.current=a,Iu=o,null!==Au?t=0:(Tu=null,Du=0,t=Mu)}if(0!==t){if(2===t&&(0!==(o=ht(e))&&(r=o,t=il(e,o))),1===t)throw n=Ou,dl(e,0),sl(e,r),rl(e,Qe()),n;if(6===t)sl(e,r);else{if(o=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var o=n[r],i=o.getSnapshot;o=o.value;try{if(!sr(i(),o))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(o)&&(2===(t=ml(e,r))&&(0!==(a=ht(e))&&(r=a,t=il(e,a))),1===t))throw n=Ou,dl(e,0),sl(e,r),rl(e,Qe()),n;switch(e.finishedWork=o,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:wl(e,Wu,ju);break;case 3:if(sl(e,r),(130023424&r)===r&&10<(t=Vu+500-Qe())){if(0!==dt(e,0))break;if(((o=e.suspendedLanes)&r)!==r){el(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=ro(wl.bind(null,e,Wu,ju),t);break}wl(e,Wu,ju);break;case 4:if(sl(e,r),(4194240&r)===r)break;for(t=e.eventTimes,o=-1;0<r;){var s=31-at(r);a=1<<s,(s=t[s])>o&&(o=s),r&=~a}if(r=o,10<(r=(120>(r=Qe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Su(r/1960))-r)){e.timeoutHandle=ro(wl.bind(null,e,Wu,ju),r);break}wl(e,Wu,ju);break;default:throw Error(i(329))}}}return rl(e,Qe()),e.callbackNode===n?ol.bind(null,e):null}function il(e,t){var n=zu;return e.current.memoizedState.isDehydrated&&(dl(e,t).flags|=256),2!==(e=ml(e,t))&&(t=Wu,Wu=n,null!==t&&al(t)),e}function al(e){null===Wu?Wu=e:Wu.push.apply(Wu,e)}function sl(e,t){for(t&=~Bu,t&=~Lu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),r=1<<n;e[n]=-1,t&=~r}}function ul(e){if(0!==(6&Iu))throw Error(i(327));Cl();var t=dt(e,0);if(0===(1&t))return rl(e,Qe()),null;var n=ml(e,t);if(0!==e.tag&&2===n){var r=ht(e);0!==r&&(t=r,n=il(e,r))}if(1===n)throw n=Ou,dl(e,0),sl(e,t),rl(e,Qe()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wl(e,Wu,ju),rl(e,Qe()),null}function ll(e,t){var n=Iu;Iu|=1;try{return e(t)}finally{0===(Iu=n)&&(Uu=Qe()+500,Wo&&jo())}}function cl(e){null!==Xu&&0===Xu.tag&&0===(6&Iu)&&Cl();var t=Iu;Iu|=1;var n=Ru.transition,r=bt;try{if(Ru.transition=null,bt=1,e)return e()}finally{bt=r,Ru.transition=n,0===(6&(Iu=t))&&jo()}}function fl(){Nu=Pu.current,_o(Pu)}function dl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,oo(n)),null!==Au)for(n=Au.return;null!==n;){var r=n;switch(ni(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Mo();break;case 3:ia(),_o(Ao),_o(To),fa();break;case 5:sa(r);break;case 4:ia();break;case 13:case 19:_o(ua);break;case 10:Ei(r.type._context);break;case 22:case 23:fl()}n=n.return}if(Tu=e,Au=e=Pl(e.current,null),Du=Nu=t,Mu=0,Ou=null,Bu=Lu=Fu=0,Wu=zu=null,null!==Ri){for(t=0;t<Ri.length;t++)if(null!==(r=(n=Ri[t]).interleaved)){n.interleaved=null;var o=r.next,i=n.pending;if(null!==i){var a=i.next;i.next=o,r.next=a}n.pending=r}Ri=null}return e}function pl(e,t){for(;;){var n=Au;try{if(Ci(),da.current=as,ya){for(var r=va.memoizedState;null!==r;){var o=r.queue;null!==o&&(o.pending=null),r=r.next}ya=!1}if(ha=0,ga=ma=va=null,ba=!1,xa=0,_u.current=null,null===n||null===n.return){Mu=1,Ou=t,Au=null;break}e:{var a=e,s=n.return,u=n,l=t;if(t=Du,u.flags|=32768,null!==l&&"object"===typeof l&&"function"===typeof l.then){var c=l,f=u,d=f.tag;if(0===(1&f.mode)&&(0===d||11===d||15===d)){var p=f.alternate;p?(f.updateQueue=p.updateQueue,f.memoizedState=p.memoizedState,f.lanes=p.lanes):(f.updateQueue=null,f.memoizedState=null)}var h=gs(s);if(null!==h){h.flags&=-257,ys(h,s,u,0,t),1&h.mode&&ms(a,c,t),l=c;var v=(t=h).updateQueue;if(null===v){var m=new Set;m.add(l),t.updateQueue=m}else v.add(l);break e}if(0===(1&t)){ms(a,c,t),vl();break e}l=Error(i(426))}else if(ii&&1&u.mode){var g=gs(s);if(null!==g){0===(65536&g.flags)&&(g.flags|=256),ys(g,s,u,0,t),vi(cs(l,u));break e}}a=l=cs(l,u),4!==Mu&&(Mu=2),null===zu?zu=[a]:zu.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,Li(a,hs(0,l,t));break e;case 1:u=l;var y=a.type,b=a.stateNode;if(0===(128&a.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===qu||!qu.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t,Li(a,vs(a,u,t));break e}}a=a.return}while(null!==a)}xl(n)}catch(x){t=x,Au===n&&null!==n&&(Au=n=n.return);continue}break}}function hl(){var e=ku.current;return ku.current=as,null===e?as:e}function vl(){0!==Mu&&3!==Mu&&2!==Mu||(Mu=4),null===Tu||0===(268435455&Fu)&&0===(268435455&Lu)||sl(Tu,Du)}function ml(e,t){var n=Iu;Iu|=2;var r=hl();for(Tu===e&&Du===t||(ju=null,dl(e,t));;)try{gl();break}catch(o){pl(e,o)}if(Ci(),Iu=n,ku.current=r,null!==Au)throw Error(i(261));return Tu=null,Du=0,Mu}function gl(){for(;null!==Au;)bl(Au)}function yl(){for(;null!==Au&&!$e();)bl(Au)}function bl(e){var t=Eu(e.alternate,e,Nu);e.memoizedProps=e.pendingProps,null===t?xl(e):Au=t,_u.current=null}function xl(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ks(n,t,Nu)))return void(Au=n)}else{if(null!==(n=Xs(n,t)))return n.flags&=32767,void(Au=n);if(null===e)return Mu=6,void(Au=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Au=t);Au=t=e}while(null!==t);0===Mu&&(Mu=5)}function wl(e,t,n){var r=bt,o=Ru.transition;try{Ru.transition=null,bt=1,function(e,t,n,r){do{Cl()}while(null!==Xu);if(0!==(6&Iu))throw Error(i(327));n=e.finishedWork;var o=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-at(n),i=1<<o;t[o]=0,r[o]=-1,e[o]=-1,n&=~i}}(e,a),e===Tu&&(Au=Tu=null,Du=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Ku||(Ku=!0,Tl(tt,(function(){return Cl(),null}))),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=Ru.transition,Ru.transition=null;var s=bt;bt=1;var u=Iu;Iu|=4,_u.current=null,function(e,t){if(eo=Ht,pr(e=dr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var o=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(w){n=null;break e}var s=0,u=-1,l=-1,c=0,f=0,d=e,p=null;t:for(;;){for(var h;d!==n||0!==o&&3!==d.nodeType||(u=s+o),d!==a||0!==r&&3!==d.nodeType||(l=s+r),3===d.nodeType&&(s+=d.nodeValue.length),null!==(h=d.firstChild);)p=d,d=h;for(;;){if(d===e)break t;if(p===n&&++c===o&&(u=s),p===a&&++f===r&&(l=s),null!==(h=d.nextSibling))break;p=(d=p).parentNode}d=h}n=-1===u||-1===l?null:{start:u,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(to={focusedElem:e,selectionRange:n},Ht=!1,Js=t;null!==Js;)if(e=(t=Js).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Js=e;else for(;null!==Js;){t=Js;try{var v=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==v){var m=v.memoizedProps,g=v.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:gi(t.type,m),g);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(i(163))}}catch(w){Sl(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Js=e;break}Js=t.return}v=tu,tu=!1}(e,n),mu(n,e),hr(to),Ht=!!eo,to=eo=null,e.current=n,yu(n,e,o),Ye(),Iu=u,bt=s,Ru.transition=a}else e.current=n;if(Ku&&(Ku=!1,Xu=e,$u=o),a=e.pendingLanes,0===a&&(qu=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(ot,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rl(e,Qe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)r((o=t[n]).value,{componentStack:o.stack,digest:o.digest});if(Hu)throw Hu=!1,e=Gu,Gu=null,e;0!==(1&$u)&&0!==e.tag&&Cl(),a=e.pendingLanes,0!==(1&a)?e===Qu?Yu++:(Yu=0,Qu=e):Yu=0,jo()}(e,t,n,r)}finally{Ru.transition=o,bt=r}return null}function Cl(){if(null!==Xu){var e=xt($u),t=Ru.transition,n=bt;try{if(Ru.transition=null,bt=16>e?16:e,null===Xu)var r=!1;else{if(e=Xu,Xu=null,$u=0,0!==(6&Iu))throw Error(i(331));var o=Iu;for(Iu|=4,Js=e.current;null!==Js;){var a=Js,s=a.child;if(0!==(16&Js.flags)){var u=a.deletions;if(null!==u){for(var l=0;l<u.length;l++){var c=u[l];for(Js=c;null!==Js;){var f=Js;switch(f.tag){case 0:case 11:case 15:nu(8,f,a)}var d=f.child;if(null!==d)d.return=f,Js=d;else for(;null!==Js;){var p=(f=Js).sibling,h=f.return;if(iu(f),f===c){Js=null;break}if(null!==p){p.return=h,Js=p;break}Js=h}}}var v=a.alternate;if(null!==v){var m=v.child;if(null!==m){v.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(null!==m)}}Js=a}}if(0!==(2064&a.subtreeFlags)&&null!==s)s.return=a,Js=s;else e:for(;null!==Js;){if(0!==(2048&(a=Js).flags))switch(a.tag){case 0:case 11:case 15:nu(9,a,a.return)}var y=a.sibling;if(null!==y){y.return=a.return,Js=y;break e}Js=a.return}}var b=e.current;for(Js=b;null!==Js;){var x=(s=Js).child;if(0!==(2064&s.subtreeFlags)&&null!==x)x.return=s,Js=x;else e:for(s=b;null!==Js;){if(0!==(2048&(u=Js).flags))try{switch(u.tag){case 0:case 11:case 15:ru(9,u)}}catch(C){Sl(u,u.return,C)}if(u===s){Js=null;break e}var w=u.sibling;if(null!==w){w.return=u.return,Js=w;break e}Js=u.return}}if(Iu=o,jo(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(ot,e)}catch(C){}r=!0}return r}finally{bt=n,Ru.transition=t}}return!1}function El(e,t,n){e=Oi(e,t=hs(0,t=cs(n,t),1),1),t=el(),null!==e&&(gt(e,1,t),rl(e,t))}function Sl(e,t,n){if(3===e.tag)El(e,e,n);else for(;null!==t;){if(3===t.tag){El(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===qu||!qu.has(r))){t=Oi(t,e=vs(t,e=cs(n,e),1),1),e=el(),null!==t&&(gt(t,1,e),rl(t,e));break}}t=t.return}}function kl(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=el(),e.pingedLanes|=e.suspendedLanes&n,Tu===e&&(Du&n)===n&&(4===Mu||3===Mu&&(130023424&Du)===Du&&500>Qe()-Vu?dl(e,0):Bu|=n),rl(e,t)}function _l(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ct,0===(130023424&(ct<<=1))&&(ct=4194304)));var n=el();null!==(e=Ai(e,t))&&(gt(e,t,n),rl(e,n))}function Rl(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),_l(e,n)}function Il(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;null!==o&&(n=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),_l(e,n)}function Tl(e,t){return Ke(e,t)}function Al(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dl(e,t,n,r){return new Al(e,t,n,r)}function Nl(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pl(e,t){var n=e.alternate;return null===n?((n=Dl(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ml(e,t,n,r,o,a){var s=2;if(r=e,"function"===typeof e)Nl(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case E:return Ol(n.children,o,a,t);case S:s=8,o|=8;break;case k:return(e=Dl(12,n,t,2|o)).elementType=k,e.lanes=a,e;case T:return(e=Dl(13,n,t,o)).elementType=T,e.lanes=a,e;case A:return(e=Dl(19,n,t,o)).elementType=A,e.lanes=a,e;case P:return Fl(n,o,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case _:s=10;break e;case R:s=9;break e;case I:s=11;break e;case D:s=14;break e;case N:s=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Dl(s,n,t,o)).elementType=e,t.type=r,t.lanes=a,t}function Ol(e,t,n,r){return(e=Dl(7,e,r,t)).lanes=n,e}function Fl(e,t,n,r){return(e=Dl(22,e,r,t)).elementType=P,e.lanes=n,e.stateNode={isHidden:!1},e}function Ll(e,t,n){return(e=Dl(6,e,null,t)).lanes=n,e}function Bl(e,t,n){return(t=Dl(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zl(e,t,n,r,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Wl(e,t,n,r,o,i,a,s,u){return e=new zl(e,t,n,s,u),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Dl(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ni(i),e}function Vl(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:C,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function Ul(e){if(!e)return Io;e:{if(Ue(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Po(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Po(n))return Fo(e,n,t)}return t}function jl(e,t,n,r,o,i,a,s,u){return(e=Wl(n,r,!0,e,0,i,0,s,u)).context=Ul(null),n=e.current,(i=Mi(r=el(),o=tl(n))).callback=void 0!==t&&null!==t?t:null,Oi(n,i,o),e.current.lanes=o,gt(e,o,r),rl(e,r),e}function Hl(e,t,n,r){var o=t.current,i=el(),a=tl(o);return n=Ul(n),null===t.context?t.context=n:t.pendingContext=n,(t=Mi(i,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Oi(o,t,a))&&(nl(e,o,a,i),Fi(e,o,a)),a}function Gl(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function ql(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Kl(e,t){ql(e,t),(e=e.alternate)&&ql(e,t)}Eu=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ao.current)xs=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return xs=!1,function(e,t,n){switch(t.tag){case 3:As(t),hi();break;case 5:aa(t);break;case 1:Po(t.type)&&Lo(t);break;case 4:oa(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,o=t.memoizedProps.value;Ro(yi,r._currentValue),r._currentValue=o;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ro(ua,1&ua.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ls(e,t,n):(Ro(ua,1&ua.current),null!==(e=Hs(e,t,n))?e.sibling:null);Ro(ua,1&ua.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Us(e,t,n);t.flags|=128}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),Ro(ua,ua.current),r)break;return null;case 22:case 23:return t.lanes=0,ks(e,t,n)}return Hs(e,t,n)}(e,t,n);xs=0!==(131072&e.flags)}else xs=!1,ii&&0!==(1048576&t.flags)&&ei(t,Ko,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;js(e,t),e=t.pendingProps;var o=No(t,To.current);ki(t,n),o=Sa(null,t,r,e,o,n);var a=ka();return t.flags|=1,"object"===typeof o&&null!==o&&"function"===typeof o.render&&void 0===o.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Po(r)?(a=!0,Lo(t)):a=!1,t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,Ni(t),o.updater=Ui,t.stateNode=o,o._reactInternals=t,qi(t,r,e,n),t=Ts(null,t,r,!0,a,n)):(t.tag=0,ii&&a&&ti(t),ws(null,t,o,n),t=t.child),t;case 16:r=t.elementType;e:{switch(js(e,t),e=t.pendingProps,r=(o=r._init)(r._payload),t.type=r,o=t.tag=function(e){if("function"===typeof e)return Nl(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===I)return 11;if(e===D)return 14}return 2}(r),e=gi(r,e),o){case 0:t=Rs(null,t,r,e,n);break e;case 1:t=Is(null,t,r,e,n);break e;case 11:t=Cs(null,t,r,e,n);break e;case 14:t=Es(null,t,r,gi(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,o=t.pendingProps,Rs(e,t,r,o=t.elementType===r?o:gi(r,o),n);case 1:return r=t.type,o=t.pendingProps,Is(e,t,r,o=t.elementType===r?o:gi(r,o),n);case 3:e:{if(As(t),null===e)throw Error(i(387));r=t.pendingProps,o=(a=t.memoizedState).element,Pi(e,t),Bi(t,r,null,n);var s=t.memoizedState;if(r=s.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Ds(e,t,r,n,o=cs(Error(i(423)),t));break e}if(r!==o){t=Ds(e,t,r,n,o=cs(Error(i(424)),t));break e}for(oi=lo(t.stateNode.containerInfo.firstChild),ri=t,ii=!0,ai=null,n=Ji(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(hi(),r===o){t=Hs(e,t,n);break e}ws(e,t,r,n)}t=t.child}return t;case 5:return aa(t),null===e&&ci(t),r=t.type,o=t.pendingProps,a=null!==e?e.memoizedProps:null,s=o.children,no(r,o)?s=null:null!==a&&no(r,a)&&(t.flags|=32),_s(e,t),ws(e,t,s,n),t.child;case 6:return null===e&&ci(t),null;case 13:return Ls(e,t,n);case 4:return oa(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Qi(t,null,r,n):ws(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,Cs(e,t,r,o=t.elementType===r?o:gi(r,o),n);case 7:return ws(e,t,t.pendingProps,n),t.child;case 8:case 12:return ws(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,o=t.pendingProps,a=t.memoizedProps,s=o.value,Ro(yi,r._currentValue),r._currentValue=s,null!==a)if(sr(a.value,s)){if(a.children===o.children&&!Ao.current){t=Hs(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var u=a.dependencies;if(null!==u){s=a.child;for(var l=u.firstContext;null!==l;){if(l.context===r){if(1===a.tag){(l=Mi(-1,n&-n)).tag=2;var c=a.updateQueue;if(null!==c){var f=(c=c.shared).pending;null===f?l.next=l:(l.next=f.next,f.next=l),c.pending=l}}a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Si(a.return,n,t),u.lanes|=n;break}l=l.next}}else if(10===a.tag)s=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(s=a.return))throw Error(i(341));s.lanes|=n,null!==(u=s.alternate)&&(u.lanes|=n),Si(s,n,t),s=a.sibling}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===t){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}ws(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=t.pendingProps.children,ki(t,n),r=r(o=_i(o)),t.flags|=1,ws(e,t,r,n),t.child;case 14:return o=gi(r=t.type,t.pendingProps),Es(e,t,r,o=gi(r.type,o),n);case 15:return Ss(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:gi(r,o),js(e,t),t.tag=1,Po(r)?(e=!0,Lo(t)):e=!1,ki(t,n),Hi(t,r,o),qi(t,r,o,n),Ts(null,t,r,!0,e,n);case 19:return Us(e,t,n);case 22:return ks(e,t,n)}throw Error(i(156,t.tag))};var Xl="function"===typeof reportError?reportError:function(e){console.error(e)};function $l(e){this._internalRoot=e}function Yl(e){this._internalRoot=e}function Ql(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zl(){}function ec(e,t,n,r,o){var i=n._reactRootContainer;if(i){var a=i;if("function"===typeof o){var s=o;o=function(){var e=Gl(a);s.call(e)}}Hl(t,a,e,o)}else a=function(e,t,n,r,o){if(o){if("function"===typeof r){var i=r;r=function(){var e=Gl(a);i.call(e)}}var a=jl(t,r,e,0,null,!1,0,"",Zl);return e._reactRootContainer=a,e[vo]=a.current,Ur(8===e.nodeType?e.parentNode:e),cl(),a}for(;o=e.lastChild;)e.removeChild(o);if("function"===typeof r){var s=r;r=function(){var e=Gl(u);s.call(e)}}var u=Wl(e,0,!1,null,0,!1,0,"",Zl);return e._reactRootContainer=u,e[vo]=u.current,Ur(8===e.nodeType?e.parentNode:e),cl((function(){Hl(t,u,n,r)})),u}(n,t,e,o,r);return Gl(a)}Yl.prototype.render=$l.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Hl(e,t,null,null)},Yl.prototype.unmount=$l.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;cl((function(){Hl(null,e,null,null)})),t[vo]=null}},Yl.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Pt.length&&0!==t&&t<Pt[n].priority;n++);Pt.splice(n,0,e),0===n&&Lt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ft(t.pendingLanes);0!==n&&(yt(t,1|n),rl(t,Qe()),0===(6&Iu)&&(Uu=Qe()+500,jo()))}break;case 13:cl((function(){var t=Ai(e,1);if(null!==t){var n=el();nl(t,e,1,n)}})),Kl(e,1)}},Ct=function(e){if(13===e.tag){var t=Ai(e,134217728);if(null!==t)nl(t,e,134217728,el());Kl(e,134217728)}},Et=function(e){if(13===e.tag){var t=tl(e),n=Ai(e,t);if(null!==n)nl(n,e,t,el());Kl(e,t)}},St=function(){return bt},kt=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},Ce=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=Co(r);if(!o)throw Error(i(90));K(r),J(r,o)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ie=ll,Te=cl;var tc={usingClientEntryPoint:!1,Events:[xo,wo,Co,_e,Re,ll]},nc={findFiberByHostInstance:bo,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rc={bundleType:nc.bundleType,version:nc.version,rendererPackageName:nc.rendererPackageName,rendererConfig:nc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:nc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var oc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!oc.isDisabled&&oc.supportsFiber)try{ot=oc.inject(rc),it=oc}catch(ce){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tc,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Ql(t))throw Error(i(200));return Vl(e,t,null,n)},t.createRoot=function(e,t){if(!Ql(e))throw Error(i(299));var n=!1,r="",o=Xl;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(o=t.onRecoverableError)),t=Wl(e,1,!1,null,0,n,0,r,o),e[vo]=t.current,Ur(8===e.nodeType?e.parentNode:e),new $l(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return cl(e)},t.hydrate=function(e,t,n){if(!Jl(t))throw Error(i(200));return ec(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Ql(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,o=!1,a="",s=Xl;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(o=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=jl(t,null,e,1,null!=n?n:null,o,0,a,s),e[vo]=t.current,Ur(e),r)for(e=0;e<r.length;e++)o=(o=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new Yl(t)},t.render=function(e,t,n){if(!Jl(t))throw Error(i(200));return ec(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jl(e))throw Error(i(40));return!!e._reactRootContainer&&(cl((function(){ec(null,null,e,!1,(function(){e._reactRootContainer=null,e[vo]=null}))})),!0)},t.unstable_batchedUpdates=ll,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Jl(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return ec(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},250:function(e,t,n){"use strict";var r=n(164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},164:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(463)},372:function(e,t){"use strict";var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,o=n?Symbol.for("react.portal"):60106,i=n?Symbol.for("react.fragment"):60107,a=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,u=n?Symbol.for("react.provider"):60109,l=n?Symbol.for("react.context"):60110,c=n?Symbol.for("react.async_mode"):60111,f=n?Symbol.for("react.concurrent_mode"):60111,d=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,h=n?Symbol.for("react.suspense_list"):60120,v=n?Symbol.for("react.memo"):60115,m=n?Symbol.for("react.lazy"):60116,g=n?Symbol.for("react.block"):60121,y=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,x=n?Symbol.for("react.scope"):60119;function w(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case c:case f:case i:case s:case a:case p:return e;default:switch(e=e&&e.$$typeof){case l:case d:case m:case v:case u:return e;default:return t}}case o:return t}}}function C(e){return w(e)===f}t.AsyncMode=c,t.ConcurrentMode=f,t.ContextConsumer=l,t.ContextProvider=u,t.Element=r,t.ForwardRef=d,t.Fragment=i,t.Lazy=m,t.Memo=v,t.Portal=o,t.Profiler=s,t.StrictMode=a,t.Suspense=p,t.isAsyncMode=function(e){return C(e)||w(e)===c},t.isConcurrentMode=C,t.isContextConsumer=function(e){return w(e)===l},t.isContextProvider=function(e){return w(e)===u},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return w(e)===d},t.isFragment=function(e){return w(e)===i},t.isLazy=function(e){return w(e)===m},t.isMemo=function(e){return w(e)===v},t.isPortal=function(e){return w(e)===o},t.isProfiler=function(e){return w(e)===s},t.isStrictMode=function(e){return w(e)===a},t.isSuspense=function(e){return w(e)===p},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===i||e===f||e===s||e===a||e===p||e===h||"object"===typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===v||e.$$typeof===u||e.$$typeof===l||e.$$typeof===d||e.$$typeof===y||e.$$typeof===b||e.$$typeof===x||e.$$typeof===g)},t.typeOf=w},441:function(e,t,n){"use strict";e.exports=n(372)},374:function(e,t,n){"use strict";var r=n(791),o=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,i={},l=null,c=null;for(r in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(c=t.ref),t)a.call(t,r)&&!u.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:o,type:e,key:l,ref:c,props:i,_owner:s.current}}t.Fragment=i,t.jsx=l,t.jsxs=l},117:function(e,t){"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,m={};function g(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||h}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||h}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=g.prototype;var x=b.prototype=new y;x.constructor=b,v(x,g.prototype),x.isPureReactComponent=!0;var w=Array.isArray,C=Object.prototype.hasOwnProperty,E={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function k(e,t,r){var o,i={},a=null,s=null;if(null!=t)for(o in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)C.call(t,o)&&!S.hasOwnProperty(o)&&(i[o]=t[o]);var u=arguments.length-2;if(1===u)i.children=r;else if(1<u){for(var l=Array(u),c=0;c<u;c++)l[c]=arguments[c+2];i.children=l}if(e&&e.defaultProps)for(o in u=e.defaultProps)void 0===i[o]&&(i[o]=u[o]);return{$$typeof:n,type:e,key:a,ref:s,props:i,_owner:E.current}}function _(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var R=/\/+/g;function I(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function T(e,t,o,i,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0}}if(u)return a=a(u=e),e=""===i?"."+I(u,0):i,w(a)?(o="",null!=e&&(o=e.replace(R,"$&/")+"/"),T(a,t,o,"",(function(e){return e}))):null!=a&&(_(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,o+(!a.key||u&&u.key===a.key?"":(""+a.key).replace(R,"$&/")+"/")+e)),t.push(a)),1;if(u=0,i=""===i?".":i+":",w(e))for(var l=0;l<e.length;l++){var c=i+I(s=e[l],l);u+=T(s,t,o,c,a)}else if(c=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof c)for(e=c.call(e),l=0;!(s=e.next()).done;)u+=T(s=s.value,t,o,c=i+I(s,l++),a);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function A(e,t,n){if(null==e)return e;var r=[],o=0;return T(e,r,"","",(function(e){return t.call(n,e,o++)})),r}function D(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var N={current:null},P={transition:null},M={ReactCurrentDispatcher:N,ReactCurrentBatchConfig:P,ReactCurrentOwner:E};t.Children={map:A,forEach:function(e,t,n){A(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return A(e,(function(){t++})),t},toArray:function(e){return A(e,(function(e){return e}))||[]},only:function(e){if(!_(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=g,t.Fragment=o,t.Profiler=a,t.PureComponent=b,t.StrictMode=i,t.Suspense=c,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=v({},e.props),i=e.key,a=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,s=E.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(l in t)C.call(t,l)&&!S.hasOwnProperty(l)&&(o[l]=void 0===t[l]&&void 0!==u?u[l]:t[l])}var l=arguments.length-2;if(1===l)o.children=r;else if(1<l){u=Array(l);for(var c=0;c<l;c++)u[c]=arguments[c+2];o.children=u}return{$$typeof:n,type:e.type,key:i,ref:a,props:o,_owner:s}},t.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=k,t.createFactory=function(e){var t=k.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=_,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:D}},t.memo=function(e,t){return{$$typeof:f,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return N.current.useCallback(e,t)},t.useContext=function(e){return N.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return N.current.useDeferredValue(e)},t.useEffect=function(e,t){return N.current.useEffect(e,t)},t.useId=function(){return N.current.useId()},t.useImperativeHandle=function(e,t,n){return N.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return N.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return N.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return N.current.useMemo(e,t)},t.useReducer=function(e,t,n){return N.current.useReducer(e,t,n)},t.useRef=function(e){return N.current.useRef(e)},t.useState=function(e){return N.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return N.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return N.current.useTransition()},t.version="18.2.0"},791:function(e,t,n){"use strict";e.exports=n(117)},184:function(e,t,n){"use strict";e.exports=n(374)},813:function(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,o=e[r];if(!(0<i(o,t)))break e;e[r]=t,e[n]=o,n=r}}function r(e){return 0===e.length?null:e[0]}function o(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,o=e.length,a=o>>>1;r<a;){var s=2*(r+1)-1,u=e[s],l=s+1,c=e[l];if(0>i(u,n))l<o&&0>i(c,u)?(e[r]=c,e[l]=n,r=l):(e[r]=u,e[s]=n,r=s);else{if(!(l<o&&0>i(c,n)))break e;e[r]=c,e[l]=n,r=l}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,u=s.now();t.unstable_now=function(){return s.now()-u}}var l=[],c=[],f=1,d=null,p=3,h=!1,v=!1,m=!1,g="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(c);null!==t;){if(null===t.callback)o(c);else{if(!(t.startTime<=e))break;o(c),t.sortIndex=t.expirationTime,n(l,t)}t=r(c)}}function w(e){if(m=!1,x(e),!v)if(null!==r(l))v=!0,P(C);else{var t=r(c);null!==t&&M(w,t.startTime-e)}}function C(e,n){v=!1,m&&(m=!1,y(_),_=-1),h=!0;var i=p;try{for(x(n),d=r(l);null!==d&&(!(d.expirationTime>n)||e&&!T());){var a=d.callback;if("function"===typeof a){d.callback=null,p=d.priorityLevel;var s=a(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?d.callback=s:d===r(l)&&o(l),x(n)}else o(l);d=r(l)}if(null!==d)var u=!0;else{var f=r(c);null!==f&&M(w,f.startTime-n),u=!1}return u}finally{d=null,p=i,h=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var E,S=!1,k=null,_=-1,R=5,I=-1;function T(){return!(t.unstable_now()-I<R)}function A(){if(null!==k){var e=t.unstable_now();I=e;var n=!0;try{n=k(!0,e)}finally{n?E():(S=!1,k=null)}}else S=!1}if("function"===typeof b)E=function(){b(A)};else if("undefined"!==typeof MessageChannel){var D=new MessageChannel,N=D.port2;D.port1.onmessage=A,E=function(){N.postMessage(null)}}else E=function(){g(A,0)};function P(e){k=e,S||(S=!0,E())}function M(e,n){_=g((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){v||h||(v=!0,P(C))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,o,i){var a=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?a+i:a:i=a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:f++,callback:o,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>a?(e.sortIndex=i,n(c,e),null===r(l)&&e===r(c)&&(m?(y(_),_=-1):m=!0,M(w,i-a))):(e.sortIndex=s,n(l,e),v||h||(v=!0,P(C))),e},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},296:function(e,t,n){"use strict";e.exports=n(813)},902:function(){},522:function(){},753:function(){}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};n.t=function(r,o){if(1&o&&(r=this(r)),8&o)return r;if("object"===typeof r&&r){if(4&o&&r.__esModule)return r;if(16&o&&"function"===typeof r.then)return r}var i=Object.create(null);n.r(i);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&o&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((function(e){a[e]=function(){return r[e]}}));return a.default=function(){return r},n.d(i,a),i}}(),n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,r){return n.f[r](e,t),t}),[]))},n.u=function(e){return"static/js/"+e+".1044f42c.chunk.js"},n.miniCssF=function(e){},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="classroom:";n.l=function(r,o,i,a){if(e[r])e[r].push(o);else{var s,u;if(void 0!==i)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var f=l[c];if(f.getAttribute("src")==r||f.getAttribute("data-webpack")==t+i){s=f;break}}s||(u=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+i),s.src=r),e[r]=[o];var d=function(t,n){s.onerror=s.onload=null,clearTimeout(p);var o=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),o&&o.forEach((function(e){return e(n)})),t)return t(n)},p=setTimeout(d.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=d.bind(null,s.onerror),s.onload=d.bind(null,s.onload),u&&document.head.appendChild(s)}}}(),n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="./",function(){var e={179:0};n.f.j=function(t,r){var o=n.o(e,t)?e[t]:void 0;if(0!==o)if(o)r.push(o[2]);else{var i=new Promise((function(n,r){o=e[t]=[n,r]}));r.push(o[2]=i);var a=n.p+n.u(t),s=new Error;n.l(a,(function(r){if(n.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var i=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+a+")",s.name="ChunkLoadError",s.type=i,s.request=a,o[1](s)}}),"chunk-"+t,t)}};var t=function(t,r){var o,i,a=r[0],s=r[1],u=r[2],l=0;if(a.some((function(t){return 0!==e[t]}))){for(o in s)n.o(s,o)&&(n.m[o]=s[o]);if(u)u(n)}for(t&&t(r);l<a.length;l++)i=a[l],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0},r=self.webpackChunkclassroom=self.webpackChunkclassroom||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}(),function(){"use strict";var e=n(791),t=n.t(e,2),r=n(250);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e){var t=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===o(t)?t:String(t)}function a(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l=function(){function e(e){var t=this;this._insertTag=function(e){var n;n=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,n),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{n.insertRule(e,n.cssRules.length)}catch(nn){0}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){return e.parentNode&&e.parentNode.removeChild(e)})),this.tags=[],this.ctr=0},e}(),c=Math.abs,f=String.fromCharCode,d=Object.assign;function p(e){return e.trim()}function h(e,t,n){return e.replace(t,n)}function v(e,t){return e.indexOf(t)}function m(e,t){return 0|e.charCodeAt(t)}function g(e,t,n){return e.slice(t,n)}function y(e){return e.length}function b(e){return e.length}function x(e,t){return t.push(e),e}var w=1,C=1,E=0,S=0,k=0,_="";function R(e,t,n,r,o,i,a){return{value:e,root:t,parent:n,type:r,props:o,children:i,line:w,column:C,length:a,return:""}}function I(e,t){return d(R("",null,null,"",null,null,0),e,{length:-e.length},t)}function T(){return k=S>0?m(_,--S):0,C--,10===k&&(C=1,w--),k}function A(){return k=S<E?m(_,S++):0,C++,10===k&&(C=1,w++),k}function D(){return m(_,S)}function N(){return S}function P(e,t){return g(_,e,t)}function M(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function O(e){return w=C=1,E=y(_=e),S=0,[]}function F(e){return _="",e}function L(e){return p(P(S-1,W(91===e?e+2:40===e?e+1:e)))}function B(e){for(;(k=D())&&k<33;)A();return M(e)>2||M(k)>3?"":" "}function z(e,t){for(;--t&&A()&&!(k<48||k>102||k>57&&k<65||k>70&&k<97););return P(e,N()+(t<6&&32==D()&&32==A()))}function W(e){for(;A();)switch(k){case e:return S;case 34:case 39:34!==e&&39!==e&&W(k);break;case 40:41===e&&W(e);break;case 92:A()}return S}function V(e,t){for(;A()&&e+k!==57&&(e+k!==84||47!==D()););return"/*"+P(t,S-1)+"*"+f(47===e?e:A())}function U(e){for(;!M(D());)A();return P(e,S)}var j="-ms-",H="-moz-",G="-webkit-",q="comm",K="rule",X="decl",$="@keyframes";function Y(e,t){for(var n="",r=b(e),o=0;o<r;o++)n+=t(e[o],o,e,t)||"";return n}function Q(e,t,n,r){switch(e.type){case"@import":case X:return e.return=e.return||e.value;case q:return"";case $:return e.return=e.value+"{"+Y(e.children,r)+"}";case K:e.value=e.props.join(",")}return y(n=Y(e.children,r))?e.return=e.value+"{"+n+"}":""}function J(e){return F(Z("",null,null,null,[""],e=O(e),0,[0],e))}function Z(e,t,n,r,o,i,a,s,u){for(var l=0,c=0,d=a,p=0,g=0,b=0,w=1,C=1,E=1,S=0,k="",_=o,R=i,I=r,P=k;C;)switch(b=S,S=A()){case 40:if(108!=b&&58==m(P,d-1)){-1!=v(P+=h(L(S),"&","&\f"),"&\f")&&(E=-1);break}case 34:case 39:case 91:P+=L(S);break;case 9:case 10:case 13:case 32:P+=B(b);break;case 92:P+=z(N()-1,7);continue;case 47:switch(D()){case 42:case 47:x(te(V(A(),N()),t,n),u);break;default:P+="/"}break;case 123*w:s[l++]=y(P)*E;case 125*w:case 59:case 0:switch(S){case 0:case 125:C=0;case 59+c:g>0&&y(P)-d&&x(g>32?ne(P+";",r,n,d-1):ne(h(P," ","")+";",r,n,d-2),u);break;case 59:P+=";";default:if(x(I=ee(P,t,n,l,c,o,s,k,_=[],R=[],d),i),123===S)if(0===c)Z(P,t,I,I,_,i,d,s,R);else switch(99===p&&110===m(P,3)?100:p){case 100:case 109:case 115:Z(e,I,I,r&&x(ee(e,I,I,0,0,o,s,k,o,_=[],d),R),o,R,d,s,r?_:R);break;default:Z(P,I,I,I,[""],R,0,s,R)}}l=c=g=0,w=E=1,k=P="",d=a;break;case 58:d=1+y(P),g=b;default:if(w<1)if(123==S)--w;else if(125==S&&0==w++&&125==T())continue;switch(P+=f(S),S*w){case 38:E=c>0?1:(P+="\f",-1);break;case 44:s[l++]=(y(P)-1)*E,E=1;break;case 64:45===D()&&(P+=L(A())),p=D(),c=d=y(k=P+=U(N())),S++;break;case 45:45===b&&2==y(P)&&(w=0)}}return i}function ee(e,t,n,r,o,i,a,s,u,l,f){for(var d=o-1,v=0===o?i:[""],m=b(v),y=0,x=0,w=0;y<r;++y)for(var C=0,E=g(e,d+1,d=c(x=a[y])),S=e;C<m;++C)(S=p(x>0?v[C]+" "+E:h(E,/&\f/g,v[C])))&&(u[w++]=S);return R(e,t,n,0===o?K:s,u,l,f)}function te(e,t,n){return R(e,t,n,q,f(k),g(e,2,-2),0)}function ne(e,t,n,r){return R(e,t,n,X,g(e,0,r),g(e,r+1,-1),r)}var re=function(e,t,n){for(var r=0,o=0;r=o,o=D(),38===r&&12===o&&(t[n]=1),!M(o);)A();return P(e,S)},oe=function(e,t){return F(function(e,t){var n=-1,r=44;do{switch(M(r)){case 0:38===r&&12===D()&&(t[n]=1),e[n]+=re(S-1,t,n);break;case 2:e[n]+=L(r);break;case 4:if(44===r){e[++n]=58===D()?"&\f":"",t[n]=e[n].length;break}default:e[n]+=f(r)}}while(r=A());return e}(O(e),t))},ie=new WeakMap,ae=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,n=e.parent,r=e.column===n.column&&e.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||ie.get(n))&&!r){ie.set(e,!0);for(var o=[],i=oe(t,o),a=n.props,s=0,u=0;s<i.length;s++)for(var l=0;l<a.length;l++,u++)e.props[u]=o[s]?i[s].replace(/&\f/g,a[l]):a[l]+" "+i[s]}}},se=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function ue(e,t){switch(function(e,t){return 45^m(e,0)?(((t<<2^m(e,0))<<2^m(e,1))<<2^m(e,2))<<2^m(e,3):0}(e,t)){case 5103:return G+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return G+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return G+e+H+e+j+e+e;case 6828:case 4268:return G+e+j+e+e;case 6165:return G+e+j+"flex-"+e+e;case 5187:return G+e+h(e,/(\w+).+(:[^]+)/,G+"box-$1$2"+j+"flex-$1$2")+e;case 5443:return G+e+j+"flex-item-"+h(e,/flex-|-self/,"")+e;case 4675:return G+e+j+"flex-line-pack"+h(e,/align-content|flex-|-self/,"")+e;case 5548:return G+e+j+h(e,"shrink","negative")+e;case 5292:return G+e+j+h(e,"basis","preferred-size")+e;case 6060:return G+"box-"+h(e,"-grow","")+G+e+j+h(e,"grow","positive")+e;case 4554:return G+h(e,/([^-])(transform)/g,"$1"+G+"$2")+e;case 6187:return h(h(h(e,/(zoom-|grab)/,G+"$1"),/(image-set)/,G+"$1"),e,"")+e;case 5495:case 3959:return h(e,/(image-set\([^]*)/,G+"$1$`$1");case 4968:return h(h(e,/(.+:)(flex-)?(.*)/,G+"box-pack:$3"+j+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+G+e+e;case 4095:case 3583:case 4068:case 2532:return h(e,/(.+)-inline(.+)/,G+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(y(e)-1-t>6)switch(m(e,t+1)){case 109:if(45!==m(e,t+4))break;case 102:return h(e,/(.+:)(.+)-([^]+)/,"$1"+G+"$2-$3$1"+H+(108==m(e,t+3)?"$3":"$2-$3"))+e;case 115:return~v(e,"stretch")?ue(h(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==m(e,t+1))break;case 6444:switch(m(e,y(e)-3-(~v(e,"!important")&&10))){case 107:return h(e,":",":"+G)+e;case 101:return h(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+G+(45===m(e,14)?"inline-":"")+"box$3$1"+G+"$2$3$1"+j+"$2box$3")+e}break;case 5936:switch(m(e,t+11)){case 114:return G+e+j+h(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return G+e+j+h(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return G+e+j+h(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return G+e+j+e+e}return e}var le=[function(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case X:e.return=ue(e.value,e.length);break;case $:return Y([I(e,{value:h(e.value,"@","@"+G)})],r);case K:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Y([I(e,{props:[h(t,/:(read-\w+)/,":-moz-$1")]})],r);case"::placeholder":return Y([I(e,{props:[h(t,/:(plac\w+)/,":"+G+"input-$1")]}),I(e,{props:[h(t,/:(plac\w+)/,":-moz-$1")]}),I(e,{props:[h(t,/:(plac\w+)/,j+"input-$1")]})],r)}return""}))}}],ce=function(e){var t=e.key;if("css"===t){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var r=e.stylisPlugins||le;var o,i,a={},s=[];o=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),n=1;n<t.length;n++)a[t[n]]=!0;s.push(e)}));var u,c,f=[Q,(c=function(e){u.insert(e)},function(e){e.root||(e=e.return)&&c(e)})],d=function(e){var t=b(e);return function(n,r,o,i){for(var a="",s=0;s<t;s++)a+=e[s](n,r,o,i)||"";return a}}([ae,se].concat(r,f));i=function(e,t,n,r){u=n,Y(J(e?e+"{"+t.styles+"}":t.styles),d),r&&(p.inserted[t.name]=!0)};var p={key:t,sheet:new l({key:t,container:o,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:a,registered:{},insert:i};return p.sheet.hydrate(s),p};function fe(e,t,n){var r="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):r+=n+" "})),r}var de=function(e,t,n){var r=e.key+"-"+t.name;!1===n&&void 0===e.registered[r]&&(e.registered[r]=t.styles)},pe=function(e,t,n){de(e,t,n);var r=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var o=t;do{e.insert(t===o?"."+r:"",o,e.sheet,!0);o=o.next}while(void 0!==o)}};var he=function(e){for(var t,n=0,r=0,o=e.length;o>=4;++r,o-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(o){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)},ve={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};var me=function(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}},ge=/[A-Z]|^ms/g,ye=/_EMO_([^_]+?)_([^]*?)_EMO_/g,be=function(e){return 45===e.charCodeAt(1)},xe=function(e){return null!=e&&"boolean"!==typeof e},we=me((function(e){return be(e)?e:e.replace(ge,"-$&").toLowerCase()})),Ce=function(e,t){switch(e){case"animation":case"animationName":if("string"===typeof t)return t.replace(ye,(function(e,t,n){return Se={name:t,styles:n,next:Se},t}))}return 1===ve[e]||be(e)||"number"!==typeof t||0===t?t:t+"px"};function Ee(e,t,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return Se={name:n.name,styles:n.styles,next:Se},n.name;if(void 0!==n.styles){var r=n.next;if(void 0!==r)for(;void 0!==r;)Se={name:r.name,styles:r.styles,next:Se},r=r.next;return n.styles+";"}return function(e,t,n){var r="";if(Array.isArray(n))for(var o=0;o<n.length;o++)r+=Ee(e,t,n[o])+";";else for(var i in n){var a=n[i];if("object"!==typeof a)null!=t&&void 0!==t[a]?r+=i+"{"+t[a]+"}":xe(a)&&(r+=we(i)+":"+Ce(i,a)+";");else if(!Array.isArray(a)||"string"!==typeof a[0]||null!=t&&void 0!==t[a[0]]){var s=Ee(e,t,a);switch(i){case"animation":case"animationName":r+=we(i)+":"+s+";";break;default:r+=i+"{"+s+"}"}}else for(var u=0;u<a.length;u++)xe(a[u])&&(r+=we(i)+":"+Ce(i,a[u])+";")}return r}(e,t,n);case"function":if(void 0!==e){var o=Se,i=n(e);return Se=o,Ee(e,t,i)}}if(null==t)return n;var a=t[n];return void 0!==a?a:n}var Se,ke=/label:\s*([^\s;\n{]+)\s*(;|$)/g;var _e=function(e,t,n){if(1===e.length&&"object"===typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var r=!0,o="";Se=void 0;var i=e[0];null==i||void 0===i.raw?(r=!1,o+=Ee(n,t,i)):o+=i[0];for(var a=1;a<e.length;a++)o+=Ee(n,t,e[a]),r&&(o+=i[a]);ke.lastIndex=0;for(var s,u="";null!==(s=ke.exec(o));)u+="-"+s[1];return{name:he(o)+u,styles:o,next:Se}},Re=!!t.useInsertionEffect&&t.useInsertionEffect,Ie=Re||function(e){return e()},Te=Re||e.useLayoutEffect,Ae={}.hasOwnProperty,De=(0,e.createContext)("undefined"!==typeof HTMLElement?ce({key:"css"}):null);De.Provider;var Ne=function(t){return(0,e.forwardRef)((function(n,r){var o=(0,e.useContext)(De);return t(n,o,r)}))},Pe=(0,e.createContext)({});var Me="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",Oe=function(e,t){var n={};for(var r in t)Ae.call(t,r)&&(n[r]=t[r]);return n[Me]=e,n},Fe=function(e){var t=e.cache,n=e.serialized,r=e.isStringTag;de(t,n,r);Ie((function(){return pe(t,n,r)}));return null},Le=Ne((function(t,n,r){var o=t.css;"string"===typeof o&&void 0!==n.registered[o]&&(o=n.registered[o]);var i=t[Me],a=[o],s="";"string"===typeof t.className?s=fe(n.registered,a,t.className):null!=t.className&&(s=t.className+" ");var u=_e(a,void 0,(0,e.useContext)(Pe));s+=n.key+"-"+u.name;var l={};for(var c in t)Ae.call(t,c)&&"css"!==c&&c!==Me&&(l[c]=t[c]);return l.ref=r,l.className=s,(0,e.createElement)(e.Fragment,null,(0,e.createElement)(Fe,{cache:n,serialized:u,isStringTag:"string"===typeof i}),(0,e.createElement)(i,l))}));n(110);var Be=function(t,n){var r=arguments;if(null==n||!Ae.call(n,"css"))return e.createElement.apply(void 0,r);var o=r.length,i=new Array(o);i[0]=Le,i[1]=Oe(t,n);for(var a=2;a<o;a++)i[a]=r[a];return e.createElement.apply(null,i)},ze=Ne((function(t,n){var r=t.styles,o=_e([r],void 0,(0,e.useContext)(Pe)),i=(0,e.useRef)();return Te((function(){var e=n.key+"-global",t=new n.sheet.constructor({key:e,nonce:n.sheet.nonce,container:n.sheet.container,speedy:n.sheet.isSpeedy}),r=!1,a=document.querySelector('style[data-emotion="'+e+" "+o.name+'"]');return n.sheet.tags.length&&(t.before=n.sheet.tags[0]),null!==a&&(r=!0,a.setAttribute("data-emotion",e),t.hydrate([a])),i.current=[t,r],function(){t.flush()}}),[n]),Te((function(){var e=i.current,t=e[0];if(e[1])e[1]=!1;else{if(void 0!==o.next&&pe(n,o.next,!0),t.tags.length){var r=t.tags[t.tags.length-1].nextElementSibling;t.before=r,t.flush()}n.insert("",o,t,!1)}}),[n,o.name]),null}));function We(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return _e(t)}var Ve=n(948),Ue=n.n(Ve);function je(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function He(e,t){if(e){if("string"===typeof e)return je(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?je(e,t):void 0}}function Ge(e){return function(e){if(Array.isArray(e))return je(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||He(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var qe="__default",Ke=function(e){return"object"===typeof e&&null!==e&&qe in e};function Xe(e,t,n,r,o){var i=t&&"string"===typeof t?t.split("."):[t];for(r=0;r<i.length;r++)e=e?e[i[r]]:o;return e===o?n:Ke(e)?e[qe]:e}var $e=function e(t,n){if(t&&t.variant){var r={};for(var o in t){var i=t[o];if("variant"===o){var a=e(Xe(n,"function"===typeof i?i(n):i),n);r=u(u({},r),a)}else r[o]=i}return r}return t},Ye=[40,52,64].map((function(e){return e+"em"})),Qe={space:[0,4,8,16,32,64,128,256,512],fontSizes:[12,14,16,20,24,32,48,64,72]},Je={bg:"backgroundColor",m:"margin",mt:"marginTop",mr:"marginRight",mb:"marginBottom",ml:"marginLeft",mx:"marginX",my:"marginY",p:"padding",pt:"paddingTop",pr:"paddingRight",pb:"paddingBottom",pl:"paddingLeft",px:"paddingX",py:"paddingY"},Ze={marginX:["marginLeft","marginRight"],marginY:["marginTop","marginBottom"],paddingX:["paddingLeft","paddingRight"],paddingY:["paddingTop","paddingBottom"],scrollMarginX:["scrollMarginLeft","scrollMarginRight"],scrollMarginY:["scrollMarginTop","scrollMarginBottom"],scrollPaddingX:["scrollPaddingLeft","scrollPaddingRight"],scrollPaddingY:["scrollPaddingTop","scrollPaddingBottom"],size:["width","height"]},et={color:"colors",background:"colors",backgroundColor:"colors",borderColor:"colors",caretColor:"colors",columnRuleColor:"colors",outlineColor:"colors",textDecorationColor:"colors",opacity:"opacities",transition:"transitions",margin:"space",marginTop:"space",marginRight:"space",marginBottom:"space",marginLeft:"space",marginX:"space",marginY:"space",marginBlock:"space",marginBlockEnd:"space",marginBlockStart:"space",marginInline:"space",marginInlineEnd:"space",marginInlineStart:"space",padding:"space",paddingTop:"space",paddingRight:"space",paddingBottom:"space",paddingLeft:"space",paddingX:"space",paddingY:"space",paddingBlock:"space",paddingBlockEnd:"space",paddingBlockStart:"space",paddingInline:"space",paddingInlineEnd:"space",paddingInlineStart:"space",scrollMargin:"space",scrollMarginTop:"space",scrollMarginRight:"space",scrollMarginBottom:"space",scrollMarginLeft:"space",scrollMarginX:"space",scrollMarginY:"space",scrollPadding:"space",scrollPaddingTop:"space",scrollPaddingRight:"space",scrollPaddingBottom:"space",scrollPaddingLeft:"space",scrollPaddingX:"space",scrollPaddingY:"space",inset:"space",insetBlock:"space",insetBlockEnd:"space",insetBlockStart:"space",insetInline:"space",insetInlineEnd:"space",insetInlineStart:"space",top:"space",right:"space",bottom:"space",left:"space",gridGap:"space",gridColumnGap:"space",gridRowGap:"space",gap:"space",columnGap:"space",rowGap:"space",fontFamily:"fonts",fontSize:"fontSizes",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",border:"borders",borderTop:"borders",borderRight:"borders",borderBottom:"borders",borderLeft:"borders",borderWidth:"borderWidths",borderStyle:"borderStyles",borderRadius:"radii",borderTopRightRadius:"radii",borderTopLeftRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",borderTopWidth:"borderWidths",borderTopColor:"colors",borderTopStyle:"borderStyles",borderBottomWidth:"borderWidths",borderBottomColor:"colors",borderBottomStyle:"borderStyles",borderLeftWidth:"borderWidths",borderLeftColor:"colors",borderLeftStyle:"borderStyles",borderRightWidth:"borderWidths",borderRightColor:"colors",borderRightStyle:"borderStyles",borderBlock:"borders",borderBlockColor:"colors",borderBlockEnd:"borders",borderBlockEndColor:"colors",borderBlockEndStyle:"borderStyles",borderBlockEndWidth:"borderWidths",borderBlockStart:"borders",borderBlockStartColor:"colors",borderBlockStartStyle:"borderStyles",borderBlockStartWidth:"borderWidths",borderBlockStyle:"borderStyles",borderBlockWidth:"borderWidths",borderEndEndRadius:"radii",borderEndStartRadius:"radii",borderInline:"borders",borderInlineColor:"colors",borderInlineEnd:"borders",borderInlineEndColor:"colors",borderInlineEndStyle:"borderStyles",borderInlineEndWidth:"borderWidths",borderInlineStart:"borders",borderInlineStartColor:"colors",borderInlineStartStyle:"borderStyles",borderInlineStartWidth:"borderWidths",borderInlineStyle:"borderStyles",borderInlineWidth:"borderWidths",borderStartEndRadius:"radii",borderStartStartRadius:"radii",columnRuleWidth:"borderWidths",boxShadow:"shadows",textShadow:"shadows",zIndex:"zIndices",width:"sizes",minWidth:"sizes",maxWidth:"sizes",height:"sizes",minHeight:"sizes",maxHeight:"sizes",flexBasis:"sizes",size:"sizes",blockSize:"sizes",inlineSize:"sizes",maxBlockSize:"sizes",maxInlineSize:"sizes",minBlockSize:"sizes",minInlineSize:"sizes",columnWidth:"sizes",fill:"colors",stroke:"colors"},tt=function(e,t){if("number"!==typeof t||t>=0){if("string"===typeof t&&t.startsWith("-")){var n=t.substring(1),r=Xe(e,n,n);return"number"===typeof r?-1*r:"-".concat(r)}return Xe(e,t,t)}var o=Math.abs(t),i=Xe(e,o,o);return"string"===typeof i?"-"+i:-1*Number(i)},nt=["margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginBlock","marginBlockEnd","marginBlockStart","marginInline","marginInlineEnd","marginInlineStart","top","bottom","left","right"].reduce((function(e,t){return u(u({},e),{},a({},t,tt))}),{}),rt=function(e){return function(t){var n={},r=t&&t.breakpoints||Ye,o=[null].concat(Ge(r.map((function(e){return e.includes("@media")?e:"@media screen and (min-width: ".concat(e,")")}))));for(var i in e){var a=i,s=e[a];if("function"===typeof s&&(s=s(t||{})),!1!==s&&null!=s)if(Array.isArray(s))for(var u=0;u<s.slice(0,o.length).length;u++){var l=o[u];l?(n[l]=n[l]||{},null!=s[u]&&(n[l][a]=s[u])):n[a]=s[u]}else n[a]=s}return n}},ot=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=u(u({},Qe),"theme"in n?n.theme:n),o=$e("function"===typeof t?t(r):t,r),i=rt(o)(r),a={};for(var s in i){var l=i[s],c="function"===typeof l?l(r):l;if(c&&"object"===typeof c){if(Ke(c)){a[s]=c[qe];continue}a[s]=e(c)(r)}else{var f=s in Je?Je[s]:s,d=f in et?et[f]:void 0,p=d?null==r?void 0:r[d]:Xe(r,f,{}),h=Xe(nt,f,Xe),v=h(p,c,c);if(f in Ze)for(var m=Ze[f],g=0;g<m.length;g++)a[m[g]]=v;else a[f]=v}}return a}},it=function(e){if(!e||!e.sx&&!e.css)return e;var t={};for(var n in e)"sx"!==n&&(t[n]=e[n]);return t.css=function(e){return function(t){return[ot(e.sx)(t),"function"===typeof e.css?e.css(t):e.css]}}(e),t},at=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return Be.apply(void 0,[e,it(t)].concat(r))},st={__EMOTION_VERSION__:"11.10.5",theme:{}},ut=(0,e.createContext)(st),lt=function(){return(0,e.useContext)(ut)},ct="function"===typeof Symbol&&Symbol.for,ft=ct?Symbol.for("react.element"):60103,dt=ct?Symbol.for("react.forward_ref"):60103,pt={isMergeableObject:function(e){return!!e&&"object"===typeof e&&e.$$typeof!==ft&&e.$$typeof!==dt},arrayMerge:function(e,t){return t}},ht=function(e,t){return Ue()(e,t,pt)};ht.all=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Ue().all(t,pt)};var vt=function(e){var t=e.context,n=e.children;return at(Pe.Provider,{value:t.theme},at(ut.Provider,{value:t,children:n}))};function mt(e){var t=e.theme,n=e.children,r=lt();var o="function"===typeof t?u(u({},r),{},{theme:t(r.theme)}):ht.all({},r,{theme:t});return at(vt,{context:o,children:n})}function gt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(c){l=!0,o=c}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||He(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var yt=function(e){return"--theme-ui-".concat(e.replace("-__default",""))},bt=function(e){return"var(".concat(yt(e),")")},xt=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(Boolean).join("-")},wt=new Set(["useCustomProperties","initialColorModeName","printColorModeName","initialColorMode","useLocalStorage","config"]),Ct=function e(t,n){var r=Array.isArray(t)?[]:{};for(var o in t){var i=t[o],a=xt(n,o);i&&"object"===typeof i?r[o]=e(i,a):wt.has(o)?r[o]=i:r[o]=bt(a)}return r},Et=function e(t,n){var r={};for(var o in n)if("modes"!==o){var i=xt(t,o),a=n[o];a&&"object"===typeof a?r=u(u({},r),e(i,a)):r[yt(i)]=a}return r},St=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.config||e||{},n=t.useCustomProperties,r=t.initialColorModeName,o=t.printColorModeName,i=t.useRootStyles,a=e.rawColors||e.colors;if(!a||!1===i)return{};if(!1===n)return ot({color:"text",bg:"background"})(e);var s=a.modes||{},l=kt(a,s);if(o){var c=s[o];c||o!==r||(c=a),c?l["@media print"]=Et("colors",c):console.error("Theme UI `printColorModeName` was not found in colors scale",{colors:a,printColorModeName:o})}var f=function(e){return bt("colors-".concat(e))};return ot(u(u({},l),{},{color:f("text"),bg:f("background")}))(e)};function kt(e,t){var n=Et("colors",e);return Object.keys(t).forEach((function(e){var r=".theme-ui-".concat(e),o="&".concat(r,", ").concat(r," &");n[o]=Et("colors",t[e])})),n}var _t="theme-ui-color-mode",Rt="(prefers-color-scheme: dark)",It=function(){try{return window.localStorage.getItem(_t)}catch(e){console.warn("localStorage is disabled and color mode might not work as expected.","Please check your Site Settings.",e)}},Tt=function(e){try{window.localStorage.setItem(_t,e)}catch(t){console.warn("localStorage is disabled and color mode might not work as expected.","Please check your Site Settings.",t)}},At=function(){if("undefined"!==typeof window&&window.matchMedia){if(window.matchMedia(Rt).matches)return"dark";if(window.matchMedia("(prefers-color-scheme: light)").matches)return"light"}return null},Dt="undefined"===typeof window?function(){}:e.useLayoutEffect,Nt=function(t){var n=t.outerCtx,r=t.children,o=n.theme||{},i=o.config||o,a=i.initialColorModeName,s=i.useColorSchemeMediaQuery,l=i.useLocalStorage,c=gt((0,e.useState)((function(){return!1!==s&&At()||a})),2),f=c[0],d=c[1];Dt((function(){var e=!1!==l&&It();"undefined"!==typeof document&&document.documentElement.classList.remove("theme-ui-"+e),"system"!==s&&e&&e!==f&&(f=e,d(e))}),[]),(0,e.useEffect)((function(){f&&!1!==l&&Tt(f)}),[f,l]);var p=(0,e.useCallback)((function(){var e=At();d(e||a)}),[a]);(0,e.useEffect)((function(){if("system"===s&&window.matchMedia){var e=window.matchMedia(Rt);"function"===typeof e.addEventListener?e.addEventListener("change",p):"function"===typeof e.addListener&&e.addListener(p)}return function(){if("system"===s&&window.matchMedia){var e=window.matchMedia(Rt);"function"===typeof e.removeEventListener?e.removeEventListener("change",p):"function"===typeof e.removeListener&&e.removeListener(p)}}}),[s,p]);var h=Ot({colorMode:f,outerTheme:o}),v=u(u({},n),{},{theme:h,colorMode:f,setColorMode:d});return e.createElement(vt,{context:v},e.createElement(Ft,{theme:h}),r)};var Pt=function(e){var t=u({},e);return delete t.modes,t};function Mt(e,t){for(var n=0,r=Object.entries(e);n<r.length;n++){var o=gt(r[n],2),i=o[0],a=o[1];if("string"!==typeof a||a.startsWith("var(")){if("object"===typeof a){var s=u({},t[i]);Mt(a,s),t[i]=s}}else t[i]=a}}function Ot(t){var n=t.outerTheme,r=t.colorMode;return(0,e.useMemo)((function(){var e=u({},n),t=Xe(e,"colors.modes",{}),o=Xe(t,r,{});r&&(e.colors=u(u({},e.colors),o));var i=n.config||n,s=i.useCustomProperties,l=i.initialColorModeName,c=void 0===l?"__default":l,f=n.rawColors||n.colors||{};if(!1!==s){var d=null!=e.rawColors,p=e.colors||{};if(d)Mt(p,f=u({},f)),f.modes&&(f.modes[c]=Pt(f)),e.rawColors=f;else if("modes"in f){var h=u(a({},c,Pt(f)),f.modes);e.rawColors=u(u({},p),{},{modes:h})}else e.rawColors=p;e.colors=Ct(Pt(f),"colors")}return e}),[r,n])}function Ft(e){var t=e.theme;return at(ze,{styles:function(){return{html:St(t)}}})}function Lt(t){var n,r=t.outerCtx,o=t.children,i=Ot({outerTheme:r.theme,colorMode:r.colorMode}),a=gt((0,e.useState)((function(){var e;return!1!==(null==(e=i.config)?void 0:e.useLocalStorage)})),2),s=a[0],l=a[1];Dt((function(){l(!1)}),[]);var c=i.rawColors||i.colors,f=null==(n=i.config)?void 0:n.useCustomProperties,d=(0,e.useMemo)((function(){if(!1===f)return{};var e=c||{};return ot(kt(e,e.modes||{}))(i)}),[i,c,f]);return e.createElement(vt,{context:u(u({},r),{},{theme:i})},at("div",{"data-themeui-nested-provider":!0,key:Number(s),suppressHydrationWarning:!0,css:d,children:o}))}var Bt=function(t){var n=t.children,r=lt();return"function"!==typeof r.setColorMode?e.createElement(Nt,{outerCtx:r},n):e.createElement(Lt,{outerCtx:r},n)},zt=e.createContext({});function Wt(t){var n=e.useContext(zt);return e.useMemo((function(){return"function"===typeof t?t(n):u(u({},n),t)}),[n,t])}var Vt={};function Ut(t){var n=t.components,r=t.children,o=t.disableParentContext,i=Wt(n);return o&&(i=n||Vt),e.createElement(zt.Provider,{value:i},r)}var jt={inlineCode:"code",thematicBreak:"hr",root:"div"},Ht=function(e){return function(e){return e in jt}(e)?jt[e]:e},Gt=function(e){return function(t){return ot(Xe(t,"styles.".concat(e)))(t)}},qt=function(e,t){var n=Gt(t),r=function(t){var r={};if("th"===e||"td"===e){var o=t.align;"char"!==o&&(r.textAlign=o)}t.css;return at(e,u(u({},t),{},{css:[t.css,n,r].filter(Boolean)}))};return r.displayName="Themed(".concat(e,")"),r},Kt=qt("div","div"),Xt={},$t=Kt;["p","b","i","a","h1","h2","h3","h4","h5","h6","img","pre","code","ol","ul","li","blockquote","hr","em","table","tr","th","td","em","strong","del","inlineCode","thematicBreak","div","root"].forEach((function(e){var t=qt(Ht(e),e);Xt[e]=t,$t[e]=t}));var Yt=function(e){var t=Object.keys(e),n=u({},Xt);return t.forEach((function(t){var r=e[t];if(r){var o=function(e){return at(r,u(u({},e),{},{css:Gt(t)}))};o.displayName="MdxComponents('"+t+"')",n[t]=o}})),n},Qt=function(t){var n=t.components,r=t.children,o=Wt(),i=(0,e.useMemo)((function(){return Yt(u(u({},o),n))}),[n,o]);return at(Ut,{components:i,children:r})},Jt=function(){return at(ze,{styles:function(e){var t,n=e;if(!1===(n.config||n).useRootStyles||n.styles&&!n.styles.root)return null;var r=!1===(null==(t=n.config)?void 0:t.useBorderBox)?void 0:"border-box";return ot({"*":{boxSizing:r},html:{variant:"styles.root"},body:{margin:0}})(n)}})},Zt=function(t){var n=t.theme,r=t.components,o=t.children,i=lt()===st;return e.createElement(mt,{theme:n},e.createElement(Bt,null,i&&e.createElement(Jt,null),e.createElement(Qt,{components:r},o)))};function en(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var tn=function(e,t){return(tn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function nn(e,t){function n(){this.constructor=e}tn(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function rn(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function on(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var an=function(){function e(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(e,t){null!=this.platform&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+t+"."),this.platformName=e,this.platform=t},e.prototype.registerFlag=function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){var r=this.urlFlags[e];console.warn("Setting feature override from URL "+e+": "+r+"."),this.set(e,r)}},e.prototype.get=function(e){return e in this.flags||(this.flags[e]=this.evaluateFlag(e)),this.flags[e]},e.prototype.getNumber=function(e){return this.get(e)},e.prototype.getBool=function(e){return this.get(e)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag "+e+" as it has not been registered.");this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)},e.prototype.evaluateFlag=function(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '"+e+"': no evaluation function found.");return this.flagRegistry[e].evaluationFn()},e.prototype.setFlags=function(e){this.flags=Object.assign({},e)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var e=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var t,n,r=(t=this.global.location.search,n={},t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return sn(n,t[0],t[1]),t.join("=")})),n);"tfjsflags"in r&&r.tfjsflags.split(",").forEach((function(t){var n=t.split(":"),r=n[0],o=n[1];e.urlFlags[r]=function(e,t){if("true"===(t=t.toLowerCase())||"false"===t)return"true"===t;if(""+ +t===t)return+t;throw new Error("Could not parse value flag value "+t+" for flag "+e+".")}(r,o)}))}},e}();function sn(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function un(){return ln}var ln=null,cn=new Map,fn=new Map;function dn(e,t){var n=mn(e,t);return cn.get(n)}function pn(e){for(var t=cn.entries(),n=[];;){var r=t.next(),o=r.done,i=r.value;if(o)break;var a=i[0],s=i[1];a.split("_")[0]===e&&n.push(s)}return n}function hn(e){var t=e.kernelName,n=e.backendName,r=mn(t,n);if(cn.has(r))throw new Error("The kernel '"+t+"' for backend '"+n+"' is already registered");cn.set(r,e)}function vn(e){var t=e.kernelName;fn.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),fn.set(t,e)}function mn(e,t){return t+"_"+e}function gn(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function yn(e,t,n){return Math.max(e,Math.min(t,n))}function bn(e){return e%2==0?e:e+1}function xn(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function wn(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function Cn(e,t,n){void 0===n&&(n=""),wn(_n(e,t),(function(){return n+" Shapes "+e+" and "+t+" must match"}))}function En(e){wn(null!=e,(function(){return"The input to the tensor constructor must be a non-null value."}))}function Sn(e,t,n){if(void 0===t&&(t=[]),void 0===n&&(n=!1),null==t&&(t=[]),Array.isArray(e)||Wn(e)&&!n)for(var r=0;r<e.length;++r)Sn(e[r],t,n);else t.push(e);return t}function kn(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function _n(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Rn(e){return e%1==0}function In(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function Tn(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function An(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function Dn(e,t,n){return void 0===t&&(t=function(e){return 0}),new Promise((function(r,o){var i=0;!function a(){if(e())r();else{i++;var s=t(i);null!=n&&i>=n?o():setTimeout(a,s)}}()}))}function Nn(e,t){for(var n=1,r=-1,o=0;o<e.length;++o)if(e[o]>=0)n*=e[o];else if(-1===e[o]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+o);r=o}else if(e[o]<0)throw Error("Shapes can not be < 0. Found "+e[o]+" at dim "+o);if(-1===r){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(0===n)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var i=e.slice();return i[r]=t/n,i}function Pn(e,t){var n=t.length;return wn((e=null==e?t.map((function(e,t){return t})):[].concat(e)).every((function(e){return e>=-n&&e<n})),(function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e})),wn(e.every((function(e){return Rn(e)})),(function(){return"All values in axis param must be integers but got axis "+e})),e.map((function(e){return e<0?n+e:e}))}function Mn(e,t){for(var n=[],r=[],o=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||o?null:Pn(t,e).sort(),a=0,s=0;s<e.length;++s){if(null!=i){if(i[a]===s&&1!==e[s])throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(null==i[a]||i[a]>s)&&1===e[s]&&(n.push(e[s]),r.push(s)),i[a]<=s&&a++}1!==e[s]&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function On(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function Fn(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type "+e);n=new Array(t)}return n}function Ln(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function Bn(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function zn(e,t){return"complex64"!==t&&("float32"!==t||"complex64"===e)&&("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)}function Wn(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function Vn(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype "+e)}function Un(e){if(null==e)return 0;var t=0;return e.forEach((function(e){return t+=e.length})),t}function jn(e){return"string"==typeof e||e instanceof String}function Hn(e){return"boolean"==typeof e}function Gn(e){return"number"==typeof e}function qn(e){return Array.isArray(e)?qn(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":Gn(e)?"float32":jn(e)?"string":Hn(e)?"bool":"float32"}function Kn(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Xn(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function $n(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function Yn(e,t,n){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Sn(e)),n&&Ln(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){for(var r=new Uint8Array(e.length),o=0;o<r.length;++o)0!==Math.round(e[o])&&(r[o]=1);return r}throw new Error("Unknown data type "+t)}function Qn(e,t){if(0===e.length)return t[0];var n=e.reduce((function(e,t){return e*t}));if(0===n)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function e(t,n,r){var o=new Array;if(1===n.length)for(var i=n[0],a=0;a<i;a++)o[a]=r[t+a];else{i=n[0];var s=n.slice(1),u=s.reduce((function(e,t){return e*t}));for(a=0;a<i;a++)o[a]=e(t+a*u,s,r)}return o}(0,e,t)}function Jn(e,t){for(var n=Zn(e,t),r=0;r<n.length;r++)n[r]=1;return n}function Zn(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type "+t)}function er(){return un().platform.now()}function tr(e){e.forEach((function(t){wn(Number.isInteger(t)&&t>=0,(function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."}))}))}function nr(e,t){return void 0===t&&(t="utf-8"),t=t||"utf-8",un().platform.encode(e,t)}function rr(e,t){return void 0===t&&(t="utf-8"),t=t||"utf-8",un().platform.decode(e,t)}function or(e,t,n){if(0===t)return 0;if(1===t)return e[0];for(var r=e[e.length-1],o=0;o<e.length-1;++o)r+=n[o]*e[o];return r}function ir(e,t,n){if(0===t)return[];if(1===t)return[e];for(var r=new Array(t),o=0;o<r.length-1;++o)r[o]=Math.floor(e/n[o]),e-=r[o]*n[o];return r[r.length-1]=e,r}Object.freeze({shuffle:gn,clamp:yn,nearestLargerEven:bn,sum:xn,randUniform:function(e,t){var n=Math.random();return t*n+(1-n)*e},distSquared:function(e,t){for(var n=0,r=0;r<e.length;r++){var o=Number(e[r])-Number(t[r]);n+=o*o}return n},assert:wn,assertShapesMatch:Cn,assertNonNull:En,flatten:Sn,sizeFromShape:kn,isScalarShape:function(e){return 0===e.length},arraysEqual:_n,isInt:Rn,tanh:In,sizeToSquarishShape:Tn,createShuffledIndices:function(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return gn(t),t},rightPad:An,repeatedTry:Dn,inferFromImplicitShape:Nn,parseAxisParam:Pn,squeezeShape:Mn,getTypedArrayFromDType:On,getArrayFromDType:Fn,checkConversionForErrors:Ln,isValidDtype:Bn,hasEncodingLoss:zn,isTypedArray:Wn,bytesPerElement:Vn,bytesFromStringArray:Un,isString:jn,isBoolean:Hn,isNumber:Gn,inferDtype:qn,isFunction:Kn,nearestDivisor:Xn,computeStrides:$n,toTypedArray:Yn,toNestedArray:Qn,makeOnesTypedArray:Jn,makeZerosTypedArray:Zn,now:er,assertNonNegativeIntegerDimensions:tr,fetch:function(e,t){return un().platform.fetch(e,t)},encodeString:nr,decodeString:rr,locToIndex:or,indexToLoc:ir});var ar=function(){function e(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new sr)}return e.prototype.profileKernel=function(e,t,n){var r,o=this,i=this.backendTimer.time((function(){r=n()}));return r.forEach((function(n){n.data().then((function(r){!function(e,t,n){if("float32"!==t)return!1;for(var r=0;r<e.length;r++){var o=e[r];if(isNaN(o)||!isFinite(o))return console.warn("Found "+o+" in the result of '"+n+"'"),!0}}(r,n.dtype,e),i.then((function(i){var a="";null!=i.getExtraProfileInfo&&(a=i.getExtraProfileInfo()),o.logger.logKernelProfile(e,n,r,i.kernelMs,t,a)}))}))})),r},e}(),sr=function(){function e(){}return e.prototype.logKernelProfile=function(e,t,n,r,o,i){var a="number"==typeof r?An(r+"ms",9):r.error,s=An(e,25),u=t.rank,l=t.size,c=An(t.shape.toString(),14),f="";for(var d in o){var p=o[d].shape||t.shape,h=p.length;f+=d+": "+h+"D "+(h>0?p:"")+" "}console.log("%c"+s+"\t%c"+a+"\t%c"+u+"D "+c+"\t%c"+l+"\t%c"+f+"\t%c"+i,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}();function ur(e,t,n){return An(Array.isArray(e)?parseFloat(e[0].toFixed(7))+" + "+parseFloat(e[1].toFixed(7))+"j":jn(e)?"'"+e+"'":"bool"===n?lr(e):parseFloat(e.toFixed(7)).toString(),t)}function lr(e){return 0===e?"false":"true"}function cr(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var fr=function(){function e(e,t,n){var r=this;if(this.dtype=t,this.shape=e.slice(),this.size=kn(e),null!=n){var o=n.length;wn(o===this.size,(function(){return"Length of values '"+o+"' does not match the size inferred by the shape '"+r.size+"'."}))}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||Fn(t,this.size),this.strides=$n(e)}return e.prototype.set=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),wn(n.length===this.rank,(function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+t.rank+")"}));var o=this.locToIndex(n);this.values[o]=e},e.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];0===e.length&&(e=[0]);for(var n=0,r=0,o=e;r<o.length;r++){var i=o[r];if(i<0||i>=this.shape[n]){var a="Requested out of range element at "+e+".   Buffer shape="+this.shape;throw new Error(a)}n++}for(var s=e[e.length-1],u=0;u<e.length-1;++u)s+=this.strides[u]*e[u];return this.values[s]},e.prototype.locToIndex=function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t},e.prototype.indexToLoc=function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return dr().makeTensor(this.values,this.shape,this.dtype)},e}(),dr=null,pr=null,hr=null,vr=function(){function e(e,t,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=kn(e),this.strides=$n(e),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),wn(1===this.size,(function(){return"The array must have only 1 element."})),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(e,t){return this.throwIfDisposed(),this.reshape([e,t])},e.prototype.as3D=function(e,t,n){return this.throwIfDisposed(),this.reshape([e,t,n])},e.prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),this.reshape([e,t,n,r])},e.prototype.as5D=function(e,t,n,r,o){return this.throwIfDisposed(),this.reshape([e,t,n,r,o])},e.prototype.asType=function(e){return this.throwIfDisposed(),pr.cast(this,e)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return rn(this,void 0,void 0,(function(){var e;return on(this,(function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,pr.buffer(this.shape,this.dtype,e)]}}))}))},e.prototype.bufferSync=function(){return pr.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return rn(this,void 0,void 0,(function(){var e;return on(this,(function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,Qn(this.shape,e)]}}))}))},e.prototype.arraySync=function(){return Qn(this.shape,this.dataSync())},e.prototype.data=function(){return rn(this,void 0,void 0,(function(){var e,t;return on(this,(function(n){switch(n.label){case 0:return this.throwIfDisposed(),e=dr().read(this.dataId),"string"!==this.dtype?[3,2]:[4,e];case 1:t=n.sent();try{return[2,t.map((function(e){return rr(e)}))]}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,e]}}))}))},e.prototype.dataSync=function(){this.throwIfDisposed();var e=dr().readSync(this.dataId);if("string"===this.dtype)try{return e.map((function(e){return rr(e)}))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e},e.prototype.bytes=function(){return rn(this,void 0,void 0,(function(){var e;return on(this,(function(t){switch(t.label){case 0:return this.throwIfDisposed(),[4,dr().read(this.dataId)];case 1:return e=t.sent(),"string"===this.dtype?[2,e]:[2,new Uint8Array(e.buffer)]}}))}))},e.prototype.dispose=function(){this.isDisposed||(dr().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(e){return void 0===e&&(e=!1),pr.print(this,e)},e.prototype.reshape=function(e){return this.throwIfDisposed(),pr.reshape(this,e)},e.prototype.reshapeAs=function(e){return this.throwIfDisposed(),this.reshape(e.shape)},e.prototype.expandDims=function(e){return void 0===e&&(e=0),pr.expandDims(this,e)},e.prototype.cumsum=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=!1),void 0===n&&(n=!1),pr.cumsum(this,e,t,n)},e.prototype.squeeze=function(e){return this.throwIfDisposed(),pr.squeeze(this,e)},e.prototype.clone=function(){return this.throwIfDisposed(),pr.clone(this)},e.prototype.oneHot=function(e,t,n){return this.throwIfDisposed(),pr.oneHot(this,e,t,n)},e.prototype.toString=function(e){return void 0===e&&(e=!1),function(e,t,n,r){var o=$n(t),i=function(e,t,n,r){var o=kn(t),i=r[r.length-1],a=new Array(i).fill(0),s=t.length,u="complex64"===n?cr(e):e;if(s>1)for(var l=0;l<o/i;l++)for(var c=l*i,f=0;f<i;f++)a[f]=Math.max(a[f],ur(u[c+f],0,n).length);return a}(e,t,n,o),a=t.length,s=function e(t,n,r,o,i,a){void 0===a&&(a=!0);var s="complex64"===r?2:1,u=n[0],l=n.length;if(0===l)return"complex64"===r?[ur(cr(t)[0],0,r)]:"bool"===r?[lr(t[0])]:[t[0].toString()];if(1===l){if(u>20){var c=3*s,f=Array.from(t.slice(0,c)),d=Array.from(t.slice((u-3)*s,u*s));return"complex64"===r&&(f=cr(f),d=cr(d)),["["+f.map((function(e,t){return ur(e,i[t],r)})).join(", ")+", ..., "+d.map((function(e,t){return ur(e,i[u-3+t],r)})).join(", ")+"]"]}return["["+("complex64"===r?cr(t):Array.from(t)).map((function(e,t){return ur(e,i[t],r)})).join(", ")+"]"]}var p=n.slice(1),h=o.slice(1),v=o[0]*s,m=[];if(u>20){for(var g=0;g<3;g++){var y=(b=g*v)+v;m.push.apply(m,e(t.slice(b,y),p,r,h,i,!1))}for(m.push("..."),g=u-3;g<u;g++)y=(b=g*v)+v,m.push.apply(m,e(t.slice(b,y),p,r,h,i,g===u-1))}else for(g=0;g<u;g++){var b;y=(b=g*v)+v,m.push.apply(m,e(t.slice(b,y),p,r,h,i,g===u-1))}var x=2===l?",":"";for(m[0]="["+m[0]+x,g=1;g<m.length-1;g++)m[g]=" "+m[g]+x;var w=",\n";for(g=2;g<l;g++)w+="\n";return m[m.length-1]=" "+m[m.length-1]+"]"+(a?"":w),m}(e,t,n,o,i),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+a),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(s.map((function(e){return"    "+e})).join("\n")),u.join("\n")}(this.dataSync(),this.shape,this.dtype,e)},e.prototype.tile=function(e){return this.throwIfDisposed(),pr.tile(this,e)},e.prototype.gather=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),pr.gather(this,e,t)},e.prototype.matMul=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),this.throwIfDisposed(),pr.matMul(this,e,t,n)},e.prototype.dot=function(e){return this.throwIfDisposed(),pr.dot(this,e)},e.prototype.norm=function(e,t,n){return void 0===e&&(e="euclidean"),void 0===t&&(t=null),void 0===n&&(n=!1),this.throwIfDisposed(),pr.norm(this,e,t,n)},e.prototype.slice=function(e,t){return this.throwIfDisposed(),pr.slice(this,e,t)},e.prototype.reverse=function(e){return this.throwIfDisposed(),pr.reverse(this,e)},e.prototype.concat=function(t,n){return void 0===n&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),pr.concat([this].concat(t),n)},e.prototype.split=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),pr.split(this,e,t)},e.prototype.stack=function(e,t){return void 0===t&&(t=0),pr.stack([this,e],t)},e.prototype.unstack=function(e){return void 0===e&&(e=0),pr.unstack(this,e)},e.prototype.pad=function(e,t){return void 0===t&&(t=0),pr.pad(this,e,t)},e.prototype.batchNormalization=function(e,t,n,r,o){return void 0===n&&(n=.001),hr("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(e,t,o,r,n)},e.prototype.batchNorm=function(e,t,n,r,o){return void 0===o&&(o=.001),this.throwIfDisposed(),pr.batchNorm(this,e,t,n,r,o)},e.prototype.all=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),pr.all(this,e,t)},e.prototype.any=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),pr.any(this,e,t)},e.prototype.logSumExp=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),pr.logSumExp(this,e,t)},e.prototype.sum=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),pr.sum(this,e,t)},e.prototype.prod=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),pr.prod(this,e,t)},e.prototype.mean=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),pr.mean(this,e,t)},e.prototype.min=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),pr.min(this,e,t)},e.prototype.max=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),pr.max(this,e,t)},e.prototype.argMin=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),pr.argMin(this,e)},e.prototype.argMax=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),pr.argMax(this,e)},e.prototype.cast=function(e){return this.throwIfDisposed(),pr.cast(this,e)},e.prototype.add=function(e){return this.throwIfDisposed(),pr.add(this,e)},e.prototype.addStrict=function(e){return this.throwIfDisposed(),pr.addStrict(this,e)},e.prototype.atan2=function(e){return this.throwIfDisposed(),pr.atan2(this,e)},e.prototype.sub=function(e){return this.throwIfDisposed(),pr.sub(this,e)},e.prototype.subStrict=function(e){return this.throwIfDisposed(),pr.subStrict(this,e)},e.prototype.pow=function(e){return this.throwIfDisposed(),pr.pow(this,e)},e.prototype.powStrict=function(e){return this.throwIfDisposed(),pr.powStrict(this,e)},e.prototype.mul=function(e){return this.throwIfDisposed(),pr.mul(this,e)},e.prototype.mulStrict=function(e){return this.throwIfDisposed(),pr.mulStrict(this,e)},e.prototype.div=function(e){return this.throwIfDisposed(),pr.div(this,e)},e.prototype.divNoNan=function(e){return this.throwIfDisposed(),pr.divNoNan(this,e)},e.prototype.floorDiv=function(e){return this.throwIfDisposed(),pr.floorDiv(this,e)},e.prototype.divStrict=function(e){return this.throwIfDisposed(),pr.divStrict(this,e)},e.prototype.minimum=function(e){return this.throwIfDisposed(),pr.minimum(this,e)},e.prototype.minimumStrict=function(e){return this.throwIfDisposed(),pr.minimumStrict(this,e)},e.prototype.maximum=function(e){return this.throwIfDisposed(),pr.maximum(this,e)},e.prototype.maximumStrict=function(e){return this.throwIfDisposed(),pr.maximumStrict(this,e)},e.prototype.mod=function(e){return this.throwIfDisposed(),pr.mod(this,e)},e.prototype.modStrict=function(e){return this.throwIfDisposed(),pr.modStrict(this,e)},e.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),pr.squaredDifferenceStrict(this,e)},e.prototype.transpose=function(e){return this.throwIfDisposed(),pr.transpose(this,e)},e.prototype.notEqual=function(e){return this.throwIfDisposed(),pr.notEqual(this,e)},e.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),pr.notEqualStrict(this,e)},e.prototype.less=function(e){return this.throwIfDisposed(),pr.less(this,e)},e.prototype.lessStrict=function(e){return this.throwIfDisposed(),pr.lessStrict(this,e)},e.prototype.equal=function(e){return this.throwIfDisposed(),pr.equal(this,e)},e.prototype.equalStrict=function(e){return this.throwIfDisposed(),pr.equalStrict(this,e)},e.prototype.lessEqual=function(e){return this.throwIfDisposed(),pr.lessEqual(this,e)},e.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),pr.lessEqualStrict(this,e)},e.prototype.greater=function(e){return this.throwIfDisposed(),pr.greater(this,e)},e.prototype.greaterStrict=function(e){return this.throwIfDisposed(),pr.greaterStrict(this,e)},e.prototype.greaterEqual=function(e){return this.throwIfDisposed(),pr.greaterEqual(this,e)},e.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),pr.greaterEqualStrict(this,e)},e.prototype.logicalAnd=function(e){return this.throwIfDisposed(),pr.logicalAnd(this,e)},e.prototype.logicalOr=function(e){return this.throwIfDisposed(),pr.logicalOr(this,e)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),pr.logicalNot(this)},e.prototype.logicalXor=function(e){return this.throwIfDisposed(),pr.logicalXor(this,e)},e.prototype.where=function(e,t){return this.throwIfDisposed(),pr.where(e,this,t)},e.prototype.neg=function(){return this.throwIfDisposed(),pr.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),pr.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),pr.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),pr.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),pr.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),pr.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),pr.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),pr.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),pr.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),pr.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),pr.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),pr.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),pr.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),pr.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),pr.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),pr.abs(this)},e.prototype.clipByValue=function(e,t){return this.throwIfDisposed(),pr.clipByValue(this,e,t)},e.prototype.relu=function(){return this.throwIfDisposed(),pr.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),pr.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),pr.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),pr.selu(this)},e.prototype.leakyRelu=function(e){return void 0===e&&(e=.2),this.throwIfDisposed(),pr.leakyRelu(this,e)},e.prototype.prelu=function(e){return this.throwIfDisposed(),pr.prelu(this,e)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),pr.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),pr.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),pr.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),pr.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),pr.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),pr.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),pr.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),pr.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),pr.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),pr.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),pr.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),pr.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),pr.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),pr.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),pr.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),pr.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),pr.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),pr.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),pr.round(this)},e.prototype.step=function(e){return void 0===e&&(e=0),this.throwIfDisposed(),pr.step(this,e)},e.prototype.softmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),pr.softmax(this,e)},e.prototype.logSoftmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),pr.logSoftmax(this,e)},e.prototype.resizeBilinear=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),pr.image.resizeBilinear(this,e,t)},e.prototype.resizeNearestNeighbor=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),pr.image.resizeNearestNeighbor(this,e,t)},e.prototype.conv1d=function(e,t,n,r,o,i){return void 0===r&&(r="NWC"),void 0===o&&(o=1),this.throwIfDisposed(),pr.conv1d(this,e,t,n,r,o,i)},e.prototype.conv2d=function(e,t,n,r,o,i){return void 0===r&&(r="NHWC"),void 0===o&&(o=[1,1]),this.throwIfDisposed(),pr.conv2d(this,e,t,n,r,o,i)},e.prototype.conv2dTranspose=function(e,t,n,r,o){return this.throwIfDisposed(),pr.conv2dTranspose(this,e,t,n,r,o)},e.prototype.depthwiseConv2D=function(e,t,n,r,o,i){return void 0===r&&(r="NHWC"),void 0===o&&(o=[1,1]),this.throwIfDisposed(),pr.depthwiseConv2d(this,e,t,n,r,o,i)},e.prototype.separableConv2d=function(e,t,n,r,o,i){return void 0===o&&(o=[1,1]),void 0===i&&(i="NHWC"),this.throwIfDisposed(),pr.separableConv2d(this,e,t,n,r,o,i)},e.prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),pr.avgPool(this,e,t,n,r)},e.prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),pr.maxPool(this,e,t,n,r)},e.prototype.localResponseNormalization=function(e,t,n,r){return void 0===e&&(e=5),void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=.5),pr.localResponseNormalization(this,e,t,n,r)},e.prototype.pool=function(e,t,n,r,o){return this.throwIfDisposed(),pr.pool(this,e,t,n,r,o)},e.prototype.variable=function(e,t,n){return void 0===e&&(e=!0),this.throwIfDisposed(),dr().makeVariable(this,e,t,n)},e.prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),pr.unsortedSegmentSum(this,e,t)},e.prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),pr.batchToSpaceND(this,e,t)},e.prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),pr.spaceToBatchND(this,e,t)},e.prototype.topk=function(e,t){return void 0===e&&(e=1),void 0===t&&(t=!0),this.throwIfDisposed(),pr.topk(this,e,t)},e.prototype.stridedSlice=function(e,t,n,r,o,i,a,s){return void 0===r&&(r=0),void 0===o&&(o=0),void 0===i&&(i=0),void 0===a&&(a=0),void 0===s&&(s=0),this.throwIfDisposed(),pr.stridedSlice(this,e,t,n,r,o,i,a,s)},e.prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),pr.depthToSpace(this,e,t)},e.prototype.fft=function(){return this.throwIfDisposed(),pr.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),pr.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),pr.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),pr.spectral.irfft(this)},e}();Object.defineProperty(vr,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.dataId&&null!=e.shape&&null!=e.dtype}});var mr,gr,yr,br,xr,wr,Cr=function(e){function t(t,n,r,o){var i=e.call(this,t.shape,t.dtype,t.dataId,o)||this;return i.trainable=n,i.name=r,i}return nn(t,e),t.prototype.assign=function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value ("+e.dtype+") and previous value ("+this.dtype+") must match");if(!_n(e.shape,this.shape))throw new Error("shape of the new value ("+e.shape+") and previous value ("+this.shape+") must match");dr().disposeTensor(this),this.dataId=e.dataId,dr().incRef(this,null)},t.prototype.dispose=function(){dr().disposeVariable(this),this.isDisposedInternal=!0},t}(vr);Object.defineProperty(Cr,Symbol.hasInstance,{value:function(e){return e instanceof vr&&null!=e.assign&&e.assign instanceof Function}}),(wr=mr||(mr={})).R0="R0",wr.R1="R1",wr.R2="R2",wr.R3="R3",wr.R4="R4",wr.R5="R5",wr.R6="R6",function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(gr||(gr={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(yr||(yr={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(br||(br={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(xr||(xr={}));var Er={float32:br,int32:gr,bool:yr,complex64:xr};function Sr(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast "+e+" with "+t)}return Er[e][t]}function kr(e){return Sr(e,"int32")}function _r(e,t){if(e.dtype===t.dtype)return[e,t];var n=Sr(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function Rr(e,t){wn(e.dtype===t.dtype,(function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"}))}function Ir(e){var t=[];return function e(t,n,r){if(null!=t)if(t instanceof vr)n.push(t);else if(o=t,Array.isArray(o)||"object"==typeof o){var o,i=t;for(var a in i){var s=i[a];r.has(s)||(r.add(s),e(s,n,r))}}}(e,t,new Set),t}Object.freeze({makeTypesMatch:_r,assertTypesMatch:Rr,isTensorInList:function(e,t){return t.some((function(t){return t.id===e.id}))},getTensorsInContainer:Ir});var Tr,Ar=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()},e}(),Dr=function(){function e(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Ar}return e.prototype.ready=function(){return rn(this,void 0,void 0,(function(){var e,t,n;return on(this,(function(r){switch(r.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then((function(){}))];if(null!=this.backendInstance)return[2];e=this.getSortedBackends(),t=0,r.label=1;case 1:return t<e.length?(n=e[t],[4,this.initializeBackend(n).success]):[3,5];case 2:return r.sent()?[4,this.setBackend(n)]:[3,4];case 3:return r.sent(),[2];case 4:return t++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}}))}))},Object.defineProperty(e.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '"+t+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;if(this.initializeBackend(e).asyncInit)return null}return this.registry[e]},e.prototype.findBackendFactory=function(e){return e in this.registryFactory?this.registryFactory[e].factory:null},e.prototype.registerBackend=function(e,t,n){return void 0===n&&(n=1),e in this.registryFactory?(console.warn(e+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)},e.prototype.setBackend=function(e){return rn(this,void 0,void 0,(function(){var t,n,r;return on(this,(function(o){switch(o.label){case 0:if(null==this.registryFactory[e])throw new Error("Backend name '"+e+"' not found in registry");return this.backendName=e,null!=this.registry[e]?[3,4]:(this.backendInstance=null,t=this.initializeBackend(e),n=t.success,t.asyncInit?[4,n]:[3,2]);case 1:return r=o.sent(),[3,3];case 2:r=n,o.label=3;case 3:if(!r)return[2,!1];o.label=4;case 4:return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new ar(this.backendInstance),[2,!0]}}))}))},e.prototype.setupRegisteredKernels=function(){var e=this;pn(this.backendName).forEach((function(t){null!=t.setupFunc&&t.setupFunc(e.backendInstance)}))},e.prototype.disposeRegisteredKernels=function(e){var t=this;pn(e).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(t.registry[e])}))},e.prototype.initializeBackend=function(e){var t=this,n=this.registryFactory[e];if(null==n)throw new Error("Cannot initialize backend "+e+", no registration found.");try{var r=n.factory();if(Promise.resolve(r)===r){var o=++this.pendingBackendInitId,i=r.then((function(n){return!(o<t.pendingBackendInitId)&&(t.registry[e]=n,t.pendingBackendInit=null,!0)})).catch((function(n){return!(o<t.pendingBackendInitId)&&(t.pendingBackendInit=null,console.warn("Initialization of backend "+e+" failed"),console.warn(n.stack||n.message),!1)}));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(t){return console.warn("Initialization of backend "+e+" failed"),console.warn(t.stack||t.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(e){if(!(e in this.registryFactory))throw new Error(e+" backend not found in registry");this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var e=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority}))},e.prototype.initializeBackendsAndReturnBest=function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],r=this.initializeBackend(n),o=r.success,i=r.asyncInit;if(i||o)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(e,t){var n=this.state.tensorInfo.get(t),r=n.backend,o=this.readSync(t);r.disposeData(t),n.backend=e,e.move(t,o,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(e,t){var n,r=this,o=null;if(null==t){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");o=e}return this.scopedRun((function(){return r.startScope(o)}),(function(){return r.endScope(n)}),(function(){return(n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))},e.prototype.scopedRun=function(e,t,n){e();try{var r=n();return t(),r}catch(e){throw t(),e}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(e){var t=this.makeTensorFromDataId(e.dataId,e.shape,e.dtype),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],(function(e){return{x:function(){return e.toFloat()}}}),[]),t},e.prototype.runKernel=function(e,t,n,r,o){return this.runKernelFunc(null,t,null,e,n,r,o)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(e,t,n){var r=this.backend.numDataIds(),o=0;n.forEach((function(e){o+="complex64"===e.dtype?3:1}));var i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=r-t-o-i;if(a>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+a+" data ids) after running '"+e+"'")},e.prototype.runKernelFunc=function(e,t,n,r,o,i,a){var s,u=this;void 0===i&&(i=[]),void 0===a&&(a=[]);var l=[],c=this.isTapeOn();null==r&&(r=null!=this.state.activeScope?this.state.activeScope.name:"");var f,d=function(e){c&&(l=e.map((function(e){return u.keep(u.clone(e))})))},p=this.state.numBytes,h=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var v,m=dn(r,this.backendName);return f=null!=m?function(){var e=u.backend.numDataIds();v=m.kernelFunc({inputs:t,attrs:o,backend:u.backend});var n=Array.isArray(v)?v:[v];u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(r,e,n);var s=n.map((function(e){var t=e.dataId,n=e.shape,r=e.dtype;return u.makeTensorFromDataId(t,n,r)})),l=s.filter((function(e,t){return a[t]}));return d((i||[]).slice().concat(l)),s}:function(){var t=u.backend.numDataIds();v=u.tidy((function(){return e(u.backend,d)}));var n=Array.isArray(v)?v:[v];return u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(r,t,n),n},this.scopedRun((function(){return u.state.kernelDepth++}),(function(){return u.state.kernelDepth--}),(function(){s=u.ENV.getBool("DEBUG")?u.profiler.profileKernel(r,t,(function(){return f()})):f()})),c&&this.addTapeNode(r,t,s,n,l),this.state.profiling&&this.state.activeProfile.kernels.push({name:r,bytesAdded:this.state.numBytes-p,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-h,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(t).map((function(e){return t[e].shape})),outputShapes:s.map((function(e){return e.shape}))}),Array.isArray(v)?s:s[0]},e.prototype.makeTensor=function(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var o=e;"string"===n&&jn(e[0])&&(o=e.map((function(e){return nr(e)})));var i=r.write(o,t,n),a=new vr(t,n,i,this.nextTensorId());if(this.incRef(a,r),"string"===n){var s=this.state.tensorInfo.get(i),u=Un(o);this.state.numBytes+=u-s.bytes,s.bytes=u}return a},e.prototype.makeTensorFromDataId=function(e,t,n,r){var o=new vr(t,n=n||"float32",e,this.nextTensorId());return this.incRef(o,r),o},e.prototype.makeVariable=function(e,t,n,r){void 0===t&&(t=!0),n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.asType(r));var o=new Cr(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[o.name])throw new Error("Variable with name "+o.name+" was already registered");return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o},e.prototype.incRef=function(e,t){var n=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(r=e.size*Vn(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:r,refCount:0}),this.state.numBytes+=r}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof Cr||this.track(e)},e.prototype.disposeTensor=function(e){if(this.state.tensorInfo.has(e.dataId)){this.state.numTensors--,"string"===e.dtype&&this.state.numStringTensors--;var t=this.state.tensorInfo.get(e.dataId);t.refCount<=1?("complex64"!==e.dtype&&(this.state.numBytes-=t.bytes),this.state.numDataBuffers--,t.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):this.state.tensorInfo.get(e.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}},e.prototype.disposeVariable=function(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]},e.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e},e.prototype.profile=function(e){return rn(this,void 0,void 0,(function(){var t,n;return on(this,(function(r){return this.state.profiling=!0,t=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map((function(e){return e.totalBytesSnapshot}))),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]}))}))},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},e.prototype.addTapeNode=function(e,t,n,r,o){var i=this,a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:o},s=function(e){return fn.get(e)}(e);null!=s&&(r=s.gradFunc),null!=r&&(a.gradient=function(e){return e=e.map((function(e,t){if(null==e){var r=n[t],o=Zn(r.size,r.dtype);return i.makeTensor(o,r.shape,r.dtype)}return e})),r(e.length>1?e:e[0],o)}),this.state.activeTape.push(a)},e.prototype.keep=function(e){return e.kept=!0,e},e.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t},e.prototype.endScope=function(e){for(var t=this,n=Ir(e),r=new Set(n.map((function(e){return e.id}))),o=0;o<this.state.activeScope.track.length;o++){var i=this.state.activeScope.track[o];i.kept||r.has(i.id)||i.dispose()}var a=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(e){e.kept||e.scopeId!==a.id||t.track(e)}))},e.prototype.gradients=function(e,t,n,r){var o=this;if(void 0===r&&(r=!1),wn(t.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var i=this.scopedRun((function(){return o.startTape()}),(function(){return o.endTape()}),(function(){return o.tidy("forward",e)}));wn(i instanceof vr,(function(){return"The result y returned by f() must be a tensor."}));var a=function(e,t,n){for(var r={},o={},i=0;i<t.length;i++)r[t[i].id]=!0;for(i=0;i<e.length;i++){var a=(h=e[i]).inputs;for(var s in a){for(var u=a[s],l=!1,c=0;c<t.length;c++)if(r[u.id]){h.outputs.forEach((function(e){return r[e.id]=!0})),l=!0,o[h.id]=!0;break}if(l)break}}var f={};f[n.id]=!0;var d={};for(i=e.length-1;i>=0;i--)for(a=(h=e[i]).inputs,c=0;c<h.outputs.length;c++)if(f[h.outputs[c].id]){for(var s in a)f[a[s].id]=!0,d[h.id]=!0;break}var p=[];for(i=0;i<e.length;i++){var h;if(o[(h=e[i]).id]&&d[h.id]){var v={};for(var s in h.inputs){var m=h.inputs[s];r[m.id]&&(v[s]=m)}var g=Object.assign({},h);g.inputs=v,g.outputs=h.outputs,p.push(g)}}return p}(this.state.activeTape,t,i);if(!r&&0===a.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var e,r,s={};s[i.id]=null==n?(r=Jn(kn(e=i.shape),"float32"),Nr.makeTensor(r,e,"float32")):n,function(e,t,n){for(var r=function(r){var o=t[r],i=[];if(o.outputs.forEach((function(t){var n=e[t.id];null!=n?i.push(n):i.push(null)})),null==o.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+o.kernelName+".");var a=o.gradient(i),s=function(t){if(!(t in a))throw new Error("Cannot backprop through input "+t+". Available gradients found: "+Object.keys(a)+".");var r=n((function(){return a[t]()}));if("float32"!==r.dtype)throw new Error("Error in gradient for op "+o.kernelName+". The gradient of input "+t+" must have 'float32' dtype, but has '"+r.dtype+"'");var i=o.inputs[t];if(!_n(r.shape,i.shape))throw new Error("Error in gradient for op "+o.kernelName+". The gradient of input '"+t+"' has shape '"+r.shape+"', which does not match the shape of the input '"+i.shape+"'");if(null==e[i.id])e[i.id]=r;else{var s=e[i.id];e[i.id]=s.add(r),s.dispose()}};for(var u in o.inputs)s(u)},o=t.length-1;o>=0;o--)r(o)}(s,a,(function(e){return o.tidy(e)}));var u=t.map((function(e){return s[e.id]}));return 0===o.state.gradientDepth&&(o.state.activeTape.forEach((function(e){for(var t=0,n=e.saved;t<n.length;t++)n[t].dispose()})),o.state.activeTape=null),{value:i,grads:u}}))},e.prototype.customGrad=function(e){var t=this;return wn(Kn(e),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];wn(r.every((function(e){return e instanceof vr})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var i={};return r.forEach((function(e,t){i[t]=e})),t.runKernelFunc((function(t,o){return wn((n=e.apply(void 0,r.concat([o]))).value instanceof vr,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),wn(Kn(n.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),n.value}),i,(function(e,t){var o=n.gradFunc(e,t),i=Array.isArray(o)?o:[o];wn(i.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),wn(i.every((function(e){return e instanceof vr})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var a={};return i.forEach((function(e,t){a[t]=function(){return e}})),a}))}},e.prototype.readSync=function(e){return this.state.tensorInfo.get(e).backend.readSync(e)},e.prototype.read=function(e){return this.state.tensorInfo.get(e).backend.read(e)},e.prototype.time=function(e){return rn(this,void 0,void 0,(function(){var t,n;return on(this,(function(r){switch(r.label){case 0:return t=er(),[4,this.backend.time(e)];case 1:return(n=r.sent()).wallMs=er()-t,[2,n]}}))}))},e.prototype.track=function(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Ar,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),Nr=function(){var e=function(){if(null==Tr){var e=void 0;if("undefined"!=typeof window)e=window;else if("undefined"!=typeof n.g)e=n.g;else if("undefined"!=typeof process)e=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");e=self}Tr=e}return Tr}();if(null==e._tfengine){var t=new an(e);e._tfengine=new Dr(t)}return function(e){ln=e}(e._tfengine.ENV),dr=function(){return e._tfengine},e._tfengine}();function Pr(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}var Mr=un();Mr.registerFlag("DEBUG",(function(){return!1}),(function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),Mr.registerFlag("IS_BROWSER",(function(){return Pr()})),Mr.registerFlag("IS_NODE",(function(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node})),Mr.registerFlag("IS_CHROME",(function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),Mr.registerFlag("PROD",(function(){return!1})),Mr.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return Mr.getBool("DEBUG")})),Mr.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),Mr.registerFlag("IS_TEST",(function(){return!1}));var Or,Fr,Lr,Br={},zr={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Wr(e,t){Br[e]=t}function Vr(e){e in Br||(Br[e]=function(e){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var t=function(e){if("undefined"!=typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e);return t.addEventListener("webglcontextlost",(function(t){t.preventDefault(),delete Br[e]}),!1),1===e?t.getContext("webgl",zr)||t.getContext("experimental-webgl",zr):t.getContext("webgl2",zr)}(e));var t=Br[e];return t.isContextLost()?(delete Br[e],Vr(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Br[e])}function Ur(e,t){return[t,e]}function jr(e){var t=kn(e);return Tn(Math.ceil(t/4))}function Hr(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function Gr(e,t){var n,r,o,i,a,s,u,l,c,f=e;return 2===un().getNumber("WEBGL_VERSION")?(n=f.R32F,r=f.R16F,o=f.RGBA16F,i=f.RGBA32F,a=f.RED,s=4,u=1,l=f.HALF_FLOAT,c=f.FLOAT):(n=e.RGBA,r=e.RGBA,o=e.RGBA,i=f.RGBA,a=e.RGBA,s=4,u=4,l=null!=t?t.HALF_FLOAT_OES:null,c=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:l,textureTypeFloat:c}}function qr(e,t,n){var r=n();return t&&function(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+Xr(e,t))}(e),r}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(Or||(Or={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(Fr||(Fr={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Lr||(Lr={}));function Kr(e){return!!(un().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function Xr(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function $r(e,t,n){return bo(e,t,(function(){return e.getExtension(n)}),'Extension "'+n+'" not supported on this browser.')}function Yr(e,t,n){var r=bo(e,t,(function(){return e.createShader(e.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(qr(e,t,(function(){return e.shaderSource(r,n)})),qr(e,t,(function(){return e.compileShader(r)})),!1===e.getShaderParameter(r,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function Qr(e,t,n){var r=bo(e,t,(function(){return e.createShader(e.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(qr(e,t,(function(){return e.shaderSource(r,n)})),qr(e,t,(function(){return e.compileShader(r)})),!1===e.getShaderParameter(r,e.COMPILE_STATUS))throw function(e,t){var n=eo.exec(t);if(null==n)return console.log("Couldn't parse line number in error: "+t),void console.log(e);for(var r=+n[1],o=e.split("\n"),i=o.length.toString().length+2,a=o.map((function(e,t){return An((t+1).toString(),i)+e})),s=0,u=0;u<a.length;u++)s=Math.max(a[u].length,s);var l=a.slice(0,r-1),c=a.slice(r-1,r),f=a.slice(r);console.log(l.join("\n")),console.log(t.split("\n")[0]),console.log("%c "+An(c[0],s),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(f.join("\n"))}(n,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var Jr,Zr,eo=/ERROR: [0-9]+:([0-9]+):/g;function to(e,t){return bo(e,t,(function(){return e.createProgram()}),"Unable to create WebGLProgram.")}function no(e,t,n){if(qr(e,t,(function(){return e.linkProgram(n)})),!1===e.getProgramParameter(n,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function ro(e,t,n){if(qr(e,t,(function(){return e.validateProgram(n)})),!1===e.getProgramParameter(n,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function oo(e,t,n){var r=bo(e,t,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return qr(e,t,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),qr(e,t,(function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)})),r}function io(e,t,n){var r=bo(e,t,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return qr(e,t,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)})),qr(e,t,(function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)})),r}function ao(e,t){return bo(e,t,(function(){return e.createTexture()}),"Unable to create WebGLTexture.")}function so(e,t){var n=un().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="["+e+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n)throw r="["+e+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU ["+n+"x"+n+"].")}function uo(e,t){return bo(e,t,(function(){return e.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}function lo(e,t,n,r,o,i,a,s){var u=e.getAttribLocation(n,r);return-1!==u&&(qr(e,t,(function(){return e.bindBuffer(e.ARRAY_BUFFER,o)})),qr(e,t,(function(){return e.vertexAttribPointer(u,i,e.FLOAT,!1,a,s)})),qr(e,t,(function(){return e.enableVertexAttribArray(u)})),!0)}function co(e,t,n,r){xo(e,r),qr(e,t,(function(){return e.activeTexture(e.TEXTURE0+r)})),qr(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,n)}))}function fo(e,t,n,r){return bo(e,t,(function(){return e.getUniformLocation(n,r)}),'uniform "'+r+'" not present in program.')}function po(e,t,n){return e.getUniformLocation(t,n)}function ho(e,t,n,r,o,i){qr(e,t,(function(){return co(e,t,r,i)})),qr(e,t,(function(){return e.uniform1i(o,i)}))}function vo(e,t,n,r){qr(e,t,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)})),qr(e,t,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)}))}function mo(e,t,n){qr(e,t,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)})),qr(e,t,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}))}function go(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+yo(e,t))}function yo(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function bo(e,t,n,r){var o=qr(e,t,(function(){return n()}));if(null==o)throw new Error(r);return o}function xo(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+n+"].")}function wo(e,t){return void 0===t&&(t=2),kn(e.slice(0,e.length-t))}function Co(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function Eo(e){var t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[wo(e)].concat(Co(e))),t}function So(e,t){var n;void 0===t&&(t=!1);var r=un().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,1===(e=e.map((function(t,n){return n>=e.length-2?bn(e[n]):e[n]}))).length&&(e=[2,e[0]])),2!==e.length){var o=Mn(e);e=o.newShape}var i=kn(e);if(e.length<=1&&i<=r)return[1,i];if(2===e.length&&e[0]<=r&&e[1]<=r)return e;if(3===e.length&&e[0]*e[1]<=r&&e[2]<=r)return[e[0]*e[1],e[2]];if(3===e.length&&e[0]<=r&&e[1]*e[2]<=r)return[e[0],e[1]*e[2]];if(4===e.length&&e[0]*e[1]*e[2]<=r&&e[3]<=r)return[e[0]*e[1]*e[2],e[3]];if(4===e.length&&e[0]<=r&&e[1]*e[2]*e[3]<=r)return[e[0],e[1]*e[2]*e[3]];if(t){var a=wo(e),s=2,u=2;return e.length&&(s=(n=Co(e))[0],u=n[1]),Tn(i=a*(s/2)*(u/2)).map((function(e){return 2*e}))}return Tn(i)}function ko(e){return e%2==0}function _o(e,t){if(_n(e=e.slice(-2),t=t.slice(-2)))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r)return!0;if(ko(n)&&ko(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&ko(e[0])&&ko(t[0])}function Ro(e){if(null==Jr){var t=Vr(e);Jr=t.getParameter(t.MAX_TEXTURE_SIZE)}return Jr}function Io(e){if(null==Zr){var t=Vr(e);Zr=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Zr)}function To(e){if(0===e)return 0;var t=Vr(e);return Ao(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:Ao(t,"EXT_disjoint_timer_query")?1:0}function Ao(e,t){return null!=e.getExtension(t)}function Do(e){try{if(null!=Vr(e))return!0}catch(e){return!1}return!1}function No(e){if(0===e)return!1;var t=Vr(e);if(1===e){if(!Ao(t,"OES_texture_float"))return!1}else if(!Ao(t,"EXT_color_buffer_float"))return!1;return Mo(t)}function Po(e){if(0===e)return!1;var t=Vr(e);if(1!==e){if(Ao(t,"EXT_color_buffer_float"))return Mo(t);if(Ao(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(e,t){var n=Gr(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(o),i}(t,n)}return!1}return!!Ao(t,"OES_texture_float")&&!!Ao(t,"WEBGL_color_buffer_float")&&Mo(t)}function Mo(e){var t=Gr(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),o}function Oo(e){return 2===e&&null!=Vr(e).fenceSync}var Fo=Object.freeze({callAndCheck:qr,canBeRepresented:Kr,getWebGLErrorMessage:Xr,getExtensionOrThrow:$r,createVertexShader:Yr,createFragmentShader:Qr,createProgram:to,linkProgram:no,validateProgram:ro,createStaticVertexBuffer:oo,createStaticIndexBuffer:io,getNumChannels:function(){return 2===un().getNumber("WEBGL_VERSION")?1:4},createTexture:ao,validateTextureSize:so,createFramebuffer:uo,bindVertexBufferToProgramAttribute:lo,bindTextureUnit:co,unbindTextureUnit:function(e,t,n){xo(e,n),qr(e,t,(function(){return e.activeTexture(e.TEXTURE0+n)})),qr(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))},getProgramUniformLocationOrThrow:fo,getProgramUniformLocation:po,bindTextureToProgramUniformSampler:ho,bindCanvasToFramebuffer:function(e,t){qr(e,t,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)})),qr(e,t,(function(){return e.viewport(0,0,e.canvas.width,e.canvas.height)})),qr(e,t,(function(){return e.scissor(0,0,e.canvas.width,e.canvas.height)}))},bindColorTextureToFramebuffer:vo,unbindColorTextureFromFramebuffer:mo,validateFramebuffer:go,getFramebufferErrorMessage:yo,getBatchDim:wo,getRowsCols:Co,getShapeAs3D:Eo,getTextureShapeFromLogicalShape:So,isReshapeFree:_o,getWebGLMaxTextureSize:Ro,resetMaxTextureSize:function(){Jr=null},resetMaxTexturesInShader:function(){Zr=null},getMaxTexturesInShader:Io,getWebGLDisjointQueryTimerVersion:To,hasExtension:Ao,isWebGLVersionEnabled:Do,isCapableOfRenderingToFloatTexture:No,isDownloadFloatTextureEnabled:Po,isWebGLFenceEnabled:Oo}),Lo=un();function Bo(e){un().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function zo(e,t){return Nr.tidy(e,t)}function Wo(e){Ir(e).forEach((function(e){return e.dispose()}))}function Vo(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];un().getBool("IS_TEST")||console.warn.apply(console,e)}function Uo(e,t){var n=e;if(Wn(e))return"string"===t?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||Wn(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&un().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function e(t,n,r){if(r=r||[],Array.isArray(t)||Wn(t)){wn(n.length>0,(function(){return"Element arr["+r.join("][")+"] should be a primitive, but is an array of "+t.length+" elements"})),wn(t.length===n[0],(function(){return"Element arr["+r.join("][")+"] should have "+n[0]+" elements, but has "+t.length+" elements"}));for(var o=n.slice(1),i=0;i<t.length;++i)e(t[i],o,r.concat(i))}else wn(0===n.length,(function(){return"Element arr["+r.join("][")+"] is a primitive, but should be an array/TypedArray of "+n[0]+" elements"}))}(e,r,[]),r}function jo(e,t,n,r){if(null!=e&&("numeric"!==e&&e!==t||"numeric"===e&&"string"===t))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+e+" tensor, but got "+t+" tensor")}function Ho(e,t,n,r){if(void 0===r&&(r="numeric"),e instanceof vr)return jo(r,e.dtype,t,n),e;var o=qn(e);if("string"!==o&&["bool","int32","float32"].indexOf(r)>=0&&(o=r),jo(r,o,t,n),null==e||!Wn(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e){var i=null==e?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+i+"'")}var a=Uo(e,o);Wn(e)||Array.isArray(e)||(e=[e]);var s="string"!==o?Yn(e,o,un().getBool("DEBUG")):Sn(e,[],!0);return Nr.makeTensor(s,a,o)}function Go(e,t,n,r){if(void 0===r&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map((function(e,r){return Ho(e,t+"["+r+"]",n)}),r)}function qo(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function Ko(e,t,n){for(var r=e.length+t.length,o=[],i=0,a=0,s=0;s<r;s++)-1===n.indexOf(s)?o.push(e[i++]):o.push(t[a++]);return o}function Xo(e,t){for(var n=[],r=e.length,o=0;o<r;o++)-1===t.indexOf(o)&&n.push(e[o]);return[n,t.map((function(t){return e[t]}))]}function $o(e,t){return Ko(e,t.map((function(e){return 1})),t)}function Yo(e,t,n){wn(qo(t,n),(function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."}))}function Qo(e,t){if(qo(e,t))return null;for(var n=[],r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((function(e){return n.push(e)})),n}function Jo(e){return e.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]}))}function Zo(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}function ei(e,t){var n=e[0].length;e.forEach((function(e,t){wn(e.length===n,(function(){return"Error in concat"+n+"D: rank of tensors["+t+"] must be the same as the rank of the rest ("+n+")"}))})),wn(t>=0&&t<n,(function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."}));var r=e[0];e.forEach((function(e,o){for(var i=0;i<n;i++)wn(i===t||e[i]===r[i],(function(){return"Error in concat"+n+"D: Shape of tensors["+o+"] ("+e+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+o+"."}))}))}function ti(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function ni(e){var t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var o=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Nr.startScope(n);try{var o=r.apply(void 0,e);return o instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),Nr.endScope(o),o}catch(e){throw Nr.endScope(null),e}};return Object.defineProperty(o,"name",{value:n,configurable:!0}),o}Lo.registerFlag("HAS_WEBGL",(function(){return Lo.getNumber("WEBGL_VERSION")>0})),Lo.registerFlag("WEBGL_VERSION",(function(){return Do(2)?2:Do(1)?1:0})),Lo.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===Lo.get("WEBGL_VERSION")})),Lo.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),Lo.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),Lo.registerFlag("WEBGL_PACK",(function(){return Lo.getBool("HAS_WEBGL")})),Lo.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return Lo.getBool("WEBGL_PACK")})),Lo.registerFlag("WEBGL_PACK_CLIP",(function(){return Lo.getBool("WEBGL_PACK")})),Lo.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),Lo.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return Lo.getBool("WEBGL_PACK")})),Lo.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return Lo.getBool("WEBGL_PACK")})),Lo.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return Lo.getBool("WEBGL_PACK")})),Lo.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return Lo.getBool("WEBGL_PACK")})),Lo.registerFlag("WEBGL_PACK_REDUCE",(function(){return Lo.getBool("WEBGL_PACK")})),Lo.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return Lo.getBool("WEBGL_PACK")})),Lo.registerFlag("WEBGL_CONV_IM2COL",(function(){return Lo.getBool("WEBGL_PACK")})),Lo.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return Ro(Lo.getNumber("WEBGL_VERSION"))})),Lo.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return Io(Lo.getNumber("WEBGL_VERSION"))})),Lo.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var e=Lo.getNumber("WEBGL_VERSION");return 0===e?0:To(e)})),Lo.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return Lo.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e})),Lo.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return No(Lo.getNumber("WEBGL_VERSION"))})),Lo.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!Lo.getBool("WEBGL_FORCE_F16_TEXTURES")&&Lo.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),Lo.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return Po(Lo.getNumber("WEBGL_VERSION"))})),Lo.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return Oo(Lo.getNumber("WEBGL_VERSION"))})),Lo.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return Lo.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),hr=Bo;var ri=ni({complex_:function(e,t){var n=Ho(e,"real","complex"),r=Ho(t,"imag","complex");return Cn(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),Nr.runKernelFunc((function(e){return e.complex(n,r)}),{$real:n,$imag:r})}}),oi=ni({real_:function(e){var t=Ho(e,"input","real");return Nr.runKernelFunc((function(e){return e.real(t)}),{$input:t})}}),ii=ni({imag_:function(e){var t=Ho(e,"input","imag");return Nr.runKernelFunc((function(e){return e.imag(t)}),{$input:t})}});function ai(e,t,n){return si(e,t,Uo(e,n),n)}function si(e,t,n,r){if(null==r&&(r=qn(e)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Wn(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){tr(t);var o=kn(t),i=kn(n);wn(o===i,(function(){return"Based on the provided shape, ["+t+"], the tensor should have "+o+" values but has "+i}));for(var a=0;a<n.length;++a){var s=n[a],u=a!==n.length-1||s!==kn(t.slice(a));wn(n[a]===t[a]||!u,(function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "}))}}return Wn(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==r?Yn(e,r,un().getBool("DEBUG")):Sn(e,[],!0),Nr.makeTensor(e,t,r)}function ui(e,t){if((Wn(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&Wn(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return si(e,[],[],t)}function li(e,t){En(e);var n=Uo(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return si(e,null,n,t)}function ci(e,t,n){if(En(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var r=Uo(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return si(e,t,r,n)}function fi(e,t,n){if(En(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");var r=Uo(e,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return si(e,t,r,n)}function di(e,t,n){if(En(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");var r=Uo(e,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return si(e,t,r,n)}function pi(e,t){if(void 0===t&&(t="float32"),"complex64"===t){var n=pi(e,"float32"),r=hi(e,"float32");return ri(n,r)}var o=Jn(kn(e),t);return Nr.makeTensor(o,e,t)}function hi(e,t){if(void 0===t&&(t="float32"),"complex64"===t){var n=hi(e,"float32"),r=hi(e,"float32");return ri(n,r)}var o=Zn(kn(e),t);return Nr.makeTensor(o,e,t)}function vi(e,t,n){return Nr.runKernelFunc((function(r){return r.fill(e,t,n)}),{})}function mi(e,t,n,r){if(void 0===n&&(n=1),void 0===r&&(r="float32"),0===n)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return hi([0],r);var o=Zn(Math.abs(Math.ceil((t-e)/n)),r);t<e&&1===n&&(n=-1),o[0]=e;for(var i=1;i<o.length;i++)o[i]=o[i-1]+n;return li(o,r)}var gi=ni({onesLike_:function(e){var t=Ho(e,"x","onesLike");if("complex64"===t.dtype){var n=gi(oi(t)),r=yi(ii(t));return ri(n,r)}return Nr.runKernelFunc((function(e){return e.onesLike(t)}),{$x:t},(function(e,t){return{$x:function(){return yi(e)}}}))}}),yi=ni({zerosLike_:function(e){var t=Ho(e,"x","zerosLike");return Nr.runKernelFunc((function(e){return e.zerosLike(t)}),{$x:t},(function(e,t){return{$x:function(){return yi(e)}}}))}}),bi=ni({concat_:function(e,t){void 0===t&&(t=0),wn(e.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=Go(e,"tensors","concat");"complex64"===n[0].dtype&&n.forEach((function(e){if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype "+e.dtype+". ")})),t=Pn(t,n[0].shape)[0];var r=ti(n.map((function(e){return e.shape})),t);if(0===kn(r))return ai([],r);if(1===(n=n.filter((function(e){return e.size>0}))).length)return n[0];var o=n.map((function(e){return e.shape}));ei(o,t);var i=n,a={axis:t};return Nr.runKernelFunc((function(e){return e.concat(n,t)}),i,(function(e){var n=o.map((function(e){return e[t]}));return Si(e,n,t).map((function(e){return function(){return e}}))}),"Concat",a)}}),xi=ni({concat1d_:function(e){return bi(e,0)}}),wi=ni({concat2d_:function(e,t){return bi(e,t)}}),Ci=ni({concat3d_:function(e,t){return bi(e,t)}}),Ei=ni({concat4d_:function(e,t){return bi(e,t)}}),Si=ni({split_:function(e,t,n){void 0===n&&(n=0);var r,o=Ho(e,"x","split");return n=Pn(n,o.shape)[0],"number"==typeof t?(wn(o.shape[n]%t==0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(t).fill(o.shape[n]/t)):(wn(o.shape[n]===t.reduce((function(e,t){return e+t})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=t),Nr.runKernelFunc((function(e){return e.split(o,r,n)}),{$x:o},(function(e){return{$x:function(){return bi(e,n)}}}))}});function ki(e,t){return e(t={exports:{}},t.exports),t.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof n.g?n.g:"undefined"!=typeof self&&self;var _i=ki((function(e){!function(e,t,n){function r(e){var t,n=this,r=(t=4022871197,function(e){e=e.toString();for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)});n.next=function(){var e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1),r=null}function o(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function i(e,t){var n=new r(e),i=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,i&&("object"==typeof i&&o(i,n),a.state=function(){return o(n,{})}),a}t&&t.exports?t.exports=i:this.alea=i}(0,e)})),Ri=ki((function(e){!function(e,t,n){function r(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function i(e,t){var n=new r(e),i=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,i&&("object"==typeof i&&o(i,n),a.state=function(){return o(n,{})}),a}t&&t.exports?t.exports=i:this.xor128=i}(0,e)})),Ii=ki((function(e){!function(e,t,n){function r(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function i(e,t){var n=new r(e),i=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,i&&("object"==typeof i&&o(i,n),a.state=function(){return o(n,{})}),a}t&&t.exports?t.exports=i:this.xorwow=i}(0,e)})),Ti=ki((function(e){!function(e,t,n){function r(e){var t=this;t.next=function(){var e,n,r=t.x,o=t.i;return e=r[o],n=(e^=e>>>7)^e<<24,n^=(e=r[o+1&7])^e>>>10,n^=(e=r[o+3&7])^e>>>3,n^=(e=r[o+4&7])^e<<7,e=r[o+7&7],n^=(e^=e<<13)^e<<9,r[o]=n,t.i=o+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function o(e,t){return t.x=e.x.slice(),t.i=e.i,t}function i(e,t){null==e&&(e=+new Date);var n=new r(e),i=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,i&&(i.x&&o(i,n),a.state=function(){return o(n,{})}),a}t&&t.exports?t.exports=i:this.xorshift7=i}(0,e)})),Ai=ki((function(e){!function(e,t,n){function r(e){var t=this;t.next=function(){var e,n,r=t.w,o=t.X,i=t.i;return t.w=r=r+1640531527|0,n=o[i+34&127],e=o[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=o[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,o,i,a,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),o=0,i=-32;i<u;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(a=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(a=a+1640531527|0,o=0==(n=s[127&i]^=r+a)?o+1:0);for(o>=128&&(s[127&(t&&t.length||0)]=-1),o=127,i=512;i>0;--i)r=s[o+34&127],n=s[o=o+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[o]=r^n;e.w=a,e.X=s,e.i=o}(t,e)}function o(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function i(e,t){null==e&&(e=+new Date);var n=new r(e),i=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,i&&(i.X&&o(i,n),a.state=function(){return o(n,{})}),a}t&&t.exports?t.exports=i:this.xor4096=i}(0,e)})),Di=ki((function(e){!function(e,t,n){function r(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,o=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^o,o=o-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^o,t.a=o-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function o(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function i(e,t){var n=new r(e),i=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,i&&("object"==typeof i&&o(i,n),a.state=function(){return o(n,{})}),a}t&&t.exports?t.exports=i:this.tychei=i}(0,e)})),Ni=ki((function(e){!function(t,r){var o,i=this,a=256,s="random",u=r.pow(a,6),l=r.pow(2,52),c=2*l,f=255;function d(e,n,f){var d=[],g=v(function e(t,n){var r,o=[],i=typeof t;if(n&&"object"==i)for(r in t)try{o.push(e(t[r],n-1))}catch(e){}return o.length?o:"string"==i?t:t+"\0"}((n=1==n?{entropy:!0}:n||{}).entropy?[e,m(t)]:null==e?function(){try{var e;return o&&(e=o.randomBytes)?e=e(a):(e=new Uint8Array(a),(i.crypto||i.msCrypto).getRandomValues(e)),m(e)}catch(e){var n=i.navigator,r=n&&n.plugins;return[+new Date,i,r,i.screen,m(t)]}}():e,3),d),y=new p(d),b=function(){for(var e=y.g(6),t=u,n=0;e<l;)e=(e+n)*a,t*=a,n=y.g(1);for(;e>=c;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|y.g(4)},b.quick=function(){return y.g(4)/4294967296},b.double=b,v(m(y.S),t),(n.pass||f||function(e,t,n,o){return o&&(o.S&&h(o,y),e.state=function(){return h(y,{})}),n?(r[s]=e,t):e})(b,g,"global"in n?n.global:this==r,n.state)}function p(e){var t,n=e.length,r=this,o=0,i=r.i=r.j=0,s=r.S=[];for(n||(e=[n++]);o<a;)s[o]=o++;for(o=0;o<a;o++)s[o]=s[i=f&i+e[o%n]+(t=s[o])],s[i]=t;(r.g=function(e){for(var t,n=0,o=r.i,i=r.j,s=r.S;e--;)t=s[o=f&o+1],n=n*a+s[f&(s[o]=s[i=f&i+t])+(s[i]=t)];return r.i=o,r.j=i,n})(a)}function h(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function v(e,t){for(var n,r=e+"",o=0;o<r.length;)t[f&o]=f&(n^=19*t[f&o])+r.charCodeAt(o++);return m(t)}function m(e){return String.fromCharCode.apply(0,e)}if(r["seed"+s]=d,v(r.random(),t),e.exports){e.exports=d;try{o=n(902)}catch(e){}}}([],Math)}));Ni.alea=_i,Ni.xor128=Ri,Ni.xorwow=Ii,Ni.xorshift7=Ti,Ni.xor4096=Ai,Ni.tychei=Di;var Pi=Ni.alea,Mi=function(){function e(e,t,n,r,o){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var i=o||Math.random();this.random=Pi(i.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var o=void 0,i=void 0,a=void 0;do{a=(o=2*this.random()-1)*o+(i=2*this.random()-1)*i}while(a>=1||0===a);var s=Math.sqrt(-2*Math.log(a)/a);t=this.mean+this.stdDev*o*s,n=this.mean+this.stdDev*i*s,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)},e.prototype.convertValue=function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)},e.prototype.isValidTruncated=function(e){return e<=this.upper&&e>=this.lower},e}(),Oi=function(){function e(e,t,n,r){this.alpha=e,this.beta=1/t,this.dtype=n;var o=r||Math.random();this.randu=Pi(o.toString()),this.randn=new Mi(0,1,n,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var e,t,n,r,o,i;;){do{r=this.randn.nextValue(),i=1+this.c*r}while(i<=0);if(i*=i*i,t=1-.331*(e=r*r)*e,n=.5*e+this.d*(1-i+Math.log(i)),(o=this.randu())<t||Math.log(o)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)},e.prototype.convertValue=function(e){return"float32"===this.dtype?e:Math.round(e)},e}(),Fi=function(){function e(e,t,n,r){var o=this;if(void 0===e&&(e=0),void 0===t&&(t=1),this.canReturnFloat=function(){return null==o.dtype||"float32"===o.dtype},this.min=e,this.range=t-e,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+e+" - "+t+" <= 1 and dtype is not float");this.random=Pi(r)}return e.prototype.convertValue=function(e){return this.canReturnFloat()?e:Math.round(e)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}();function Li(e,t,n){return void 0===t&&(t="float32"),t=t||"float32",tr(e),new fr(e,t,n)}var Bi=ni({batchToSpaceND_:function(e,t,n){var r=Ho(e,"x","batchToSpaceND"),o=t.reduce((function(e,t){return e*t}));return wn(r.rank>=1+t.length,(function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length})),wn(n.length===t.length,(function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length})),wn(r.shape[0]%o==0,(function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+o})),Nr.runKernelFunc((function(e){return e.batchToSpaceND(r,t,n)}),{$x:r},(function(e){return{$x:function(){return e.spaceToBatchND(t,n)}}}))}}),zi=ni({broadcastTo_:function(e,t){var n=Ho(e,"broadcastTo","x"),r=n.shape;if(t.some((function(e){return!(e>0)||e%1!=0})))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var o=n.shape.slice();o.length<t.length;)o.unshift(1);n=n.reshape(o)}for(var i=Array.from(t),a=t.length-1;a>=0;a--)if(n.shape[a]===t[a])i[a]=1;else if(1!==n.shape[a])throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var s=i.map((function(e,t){return e>1?t:-1})).filter((function(e){return e>=0}));return 0===s.length?n.clone():Nr.runKernelFunc((function(e){return e.tile(n,i)}),{input:n},(function(e){return{input:function(){return e.sum(s,!0)}}}))}}),Wi=ni({cast_:function(e,t){var n=Ho(e,"x","cast");if(!Bn(t))throw new Error("Failed to cast to unknown dtype "+t);if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var r={dtype:t};return Nr.runKernelFunc((function(e){return e.cast(n,t)}),{x:n},(function(e){return{x:function(){return e.clone()}}}),"Cast",r)}}),Vi=ni({clone_:function(e){var t=Ho(e,"x","clone",null);return Nr.runKernelFunc((function(){return Nr.makeTensorFromDataId(t.dataId,t.shape,t.dtype)}),{$x:t},(function(e){return{$x:function(){return e.toFloat()}}}))}}),Ui=ni({cumsum_:function(e,t,n,r){void 0===t&&(t=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var o=Ho(e,"x","cumsum"),i=Qo([t|=0],o.rank),a=o;null!=i&&(a=o.transpose(i));var s=Zo(1,o.rank)[0],u=Nr.runKernelFunc((function(e){return e.cumsum(a,s,n,r)}),{permutedX:a},(function(e){return{permutedX:function(){return e.cumsum(t,n,!r)}}}));return null!=i&&(u=u.transpose(i)),u}}),ji=ni({depthToSpace_:function(e,t,n){void 0===n&&(n="NHWC");var r=Ho(e,"x","depthToSpace"),o="NHWC"===n?r.shape[1]:r.shape[2],i="NHWC"===n?r.shape[2]:r.shape[3],a="NHWC"===n?r.shape[3]:r.shape[1];return wn(o*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+o+" and "+t+"  for depthToSpace with input shape\n      "+r.shape})),wn(i*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+i+" and "+t+" for depthToSpace with input shape\n          "+r.shape})),wn(a%(t*t)==0,(function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+a+" for depthToSpace with input shape "+r.shape})),Nr.runKernelFunc((function(e){return e.depthToSpace(r,t,n)}),{$x:r})}}),Hi=ni({expandDims_:function(e,t){void 0===t&&(t=0);var n=Ho(e,"x","expandDims",null);wn(t<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n.shape.slice();return t<0&&(wn(-(n.rank+1)<=t,(function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"})),t=n.rank+t+1),r.splice(t,0,1),ra(n,r)}}),Gi=ni({eye_:function(e,t,n,r){void 0===r&&(r="float32"),null==t&&(t=e);for(var o=Li([e,t],r),i=e<=t?e:t,a=0;a<i;++a)o.set(1,a,a);var s=o.toTensor().as2D(e,t);if(null==n)return s;if(1===n.length)return sa(Hi(s,0),[n[0],1,1]);if(2===n.length)return sa(Hi(Hi(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return sa(Hi(Hi(Hi(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),qi=ni({multinomial_:function(e,t,n,r){void 0===r&&(r=!1);var o=Ho(e,"logits","multinomial"),i=o.size,a=o.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(a>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+a);n=n||Math.random();var s=1===a?o.as2D(1,-1):o,u=Nr.runKernelFunc((function(e){return e.multinomial(s,r,t,n)}),{logits2D:s});return 1===a?u.as1D():u}}),Ki=ni({oneHot_:function(e,t,n,r){if(void 0===n&&(n=1),void 0===r&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var o=Ho(e,"indices","oneHot","int32"),i=o.shape.concat([t]);return o=o.flatten(),Nr.runKernelFunc((function(e){return e.oneHot(o,t,n,r)}),{$indices:o},(function(e){return{$indices:function(){return hi(o.shape,"float32")}}})).reshape(i)}}),Xi=ni({pad_:function(e,t,n){void 0===n&&(n=0);var r=Ho(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var o={paddings:t,constantValue:n};return Nr.runKernelFunc((function(e){return e.pad(r,t,n)}),{x:r},(function(e){var n=t.map((function(e){return e[0]}));return{x:function(){return e.slice(n,r.shape)}}}),"PadV2",o)}}),$i=ni({pad1d_:function(e,t,n){return void 0===n&&(n=0),wn(2===t.length,(function(){return"Invalid number of paddings. Must be length of 2."})),Xi(e,[t],n)}}),Yi=ni({pad2d_:function(e,t,n){return void 0===n&&(n=0),wn(2===t.length&&2===t[0].length&&2===t[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Xi(e,t,n)}}),Qi=ni({pad3d_:function(e,t,n){return void 0===n&&(n=0),wn(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Xi(e,t,n)}}),Ji=ni({pad4d_:function(e,t,n){return void 0===n&&(n=0),wn(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Xi(e,t,n)}}),Zi=ni({rand_:function(e,t,n){var r=kn(e),o=null;if(null==n||"float32"===n)o=new Float32Array(r);else if("int32"===n)o=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);o=new Uint8Array(r)}for(var i=0;i<r;i++)o[i]=t();return Nr.makeTensor(o,e,n)}}),ea=ni({randomNormal_:function(e,t,n,r,o){if(void 0===t&&(t=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var i=new Mi(t,n,r,!1,o),a=Li(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),ta=ni({randomGamma_:function(e,t,n,r,o){if(void 0===n&&(n=1),void 0===r&&(r="float32"),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type "+r);for(var i=new Oi(t,n,r,o),a=Li(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),na=ni({randomUniform_:function(e,t,n,r,o){void 0===t&&(t=0),void 0===n&&(n=1),void 0===r&&(r="float32");for(var i=Li(e,r),a=new Fi(t,n,null,o),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}}),ra=ni({reshape_:function(e,t){var n=Ho(e,"x","reshape",null);t=Nn(t,n.size),wn(n.size===kn(t),(function(){return"new shape and old shape must have the same number of elements."}));var r={shape:t};return Nr.runKernelFunc((function(e){return e.reshape(n,t)}),{x:n},(function(e){return{x:function(){return e.reshape(n.shape)}}}),"Reshape",r)}}),oa=ni({spaceToBatchND_:function(e,t,n){var r=Ho(e,"x","spaceToBatchND");return wn(r.rank>=1+t.length,(function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length})),wn(n.length===t.length,(function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length})),wn(r.shape.reduce((function(e,r,o){return o>0&&o<=t.length?e&&(r+n[o-1][0]+n[o-1][1])%t[o-1]==0:e}),!0),(function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()})),Nr.runKernelFunc((function(e){return e.spaceToBatchND(r,t,n)}),{$x:r},(function(e){return{$x:function(){return e.batchToSpaceND(t,n)}}}))}}),ia=ni({squeeze_:function(e,t){var n=Ho(e,"x","squeeze");return ra(n,Mn(n.shape,t).newShape)}}),aa=ni({stack_:function(e,t){void 0===t&&(t=0);var n=Go(e,"tensors","stack");if(wn(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),1===n.length)return n[0].expandDims(t);var r=n[0].rank,o=n[0].shape,i=n[0].dtype;wn(t<=r,(function(){return"Axis must be <= rank of the tensor"})),n.forEach((function(e){Cn(o,e.shape,"All tensors passed to stack must have matching shapes")})),n.forEach((function(e){wn(i===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var a=n.map((function(e){return e.expandDims(t)}));return bi(a,t)}}),sa=ni({tile_:function(e,t){var n=Ho(e,"x","tile",null);wn(n.rank===t.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."}));var r=[n],o={reps:t};return Nr.runKernelFunc((function(e,r){var o=e.tile(n,t);return r([n]),o}),{x:n},(function(e,n){var r=n[0];return{x:function(){var n=yi(r);if(1===r.rank)for(var o=0;o<t[0];++o)n=n.add(e.slice([o*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(o=0;o<t[0];++o)for(var i=0;i<t[1];++i)n=n.add(e.slice([o*r.shape[0],i*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(o=0;o<t[0];++o)for(i=0;i<t[1];++i)for(var a=0;a<t[2];++a)n=n.add(e.slice([o*r.shape[0],i*r.shape[1],a*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(o=0;o<t[0];++o)for(i=0;i<t[1];++i)for(a=0;a<t[2];++a)for(var s=0;s<t[3];++s)n=n.add(e.slice([o*r.shape[0],i*r.shape[1],a*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return n}}}),"Tile",o,r)}}),ua=ni({truncatedNormal_:function(e,t,n,r,o){if(void 0===t&&(t=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var i=new Mi(t,n,r,!0,o),a=Li(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),la=ni({unstack_:function(e,t){void 0===t&&(t=0),t=t||0;var n=Ho(e,"x","unstack");wn(t>=-n.shape.length&&t<n.shape.length,(function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"})),t<0&&(t+=n.shape.length);var r={axis:t};return Nr.runKernelFunc((function(e){return e.unstack(n,t)}),{x:n},(function(e){return{x:function(){return aa(e,t)}}}),"Unpack",r)}});function ca(e,t,n,r){void 0===r&&(r=!0);var o=[];if(r)(o=o.concat(t.slice(0))).push(e[0]/n),o=o.concat(e.slice(1));else{o=o.concat(e[0]);for(var i=t.length,a=0;a<i;++a)o=o.concat([e[a+1]/t[a],t[a]]);o=o.concat(e.slice(i+1))}return o}function fa(e,t,n){void 0===n&&(n=!0);var r=[];if(n){r.push(t);for(var o=t+1;o<e;++o)o<=2*t?(r.push(o),r.push(o-(t+1))):r.push(o)}else{var i=[],a=[];for(o=1;o<e;++o)o>=2*t+1||o%2==1?a.push(o):i.push(o);r.push.apply(r,i),r.push(0),r.push.apply(r,a)}return r}function da(e,t,n,r){void 0===r&&(r=!0);var o=[];r?o.push(e[0]/n):o.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?r?o.push(t[i-1]*e[i]):o.push(e[i]/t[i-1]):o.push(e[i]);return o}function pa(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function ha(e,t,n){for(var r=e.slice(0,1),o=0;o<n;++o)r.push(e[o+1]-t[o][0]-t[o][1]);return r}function va(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(0===e.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,r=n[n.length-1],o=1,i=0;i<n.length-1;++i)o*=n[i];var a=e.shape,s=n.slice();s.pop();var u=1;for(i=r;i<e.rank;++i)u*=a[i],s.push(a[i]);var l=$n(e.shape).map((function(e){return e/u})).concat([1]).slice(0,r);return[s,o,u,l]}Object.freeze({prepareAndValidate:va});function ma(e){return e<=30?e:Xn(e,Math.floor(Math.sqrt(e)))}function ga(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,o=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+r+", and batchDim: "+o+".";if(n.rank<o)throw new Error(i+" update.rank < "+o+". ");if(e.length<r+(n.rank-o))throw new Error(i+" Output shape length < "+(r+(n.rank-o)));if(n.rank!==o+e.length-r)throw new Error(i+" update.rank != "+(o+e.length-r));for(var a=0;a<o;++a)if(n.shape[a]!==t.shape[a])throw new Error(i+" updates.shape["+a+"] ("+n.shape[a]+") != indices.shape["+a+"] ("+t.shape[a]+").");for(a=0;a<n.rank-o;++a)if(n.shape[a+o]!==e[a+r])throw new Error(i+" updates.shape["+(a+o)+"] ("+n.shape[a+o]+") != shape["+(a+o)+"] ("+e[a+o]+")")}function ya(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(0===e.size)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}ga(n,t,e)}function ba(e,t,n){for(var r=t.shape.length,o=r>1?t.shape[r-1]:1,i=n.length,a=1,s=o;s<i;++s)a*=n[s];var u=o<1?1:o;return{sliceRank:o,numUpdates:kn(t.shape)/u,sliceSize:a,strides:$n(n.slice(0,o)).concat([1]),outputSize:kn(n)}}Object.freeze({validateUpdateShape:ga,validateInput:ya,calculateShapes:ba});function xa(e,t,n){wn(e.rank===t.length,(function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."})),wn(e.rank===n.length,(function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."}));for(var r=function(r){wn(t[r]+n[r]<=e.shape[r],(function(){return"Error in slice"+e.rank+"D: begin["+r+"] + size["+r+"] ("+(t[r]+n[r])+") would overflow input.shape["+r+"] ("+e.shape[r]+")"}))},o=0;o<e.rank;++o)r(o)}function wa(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function Ca(e,t,n){for(var r=[],o=0;o<e.length;o++)r[o]=Math.ceil((t[o]-e[o])/n[o]);return r}function Ea(e,t,n,r,o){var i=t[o],a=n[o]||1;(e&1<<o||null==i)&&(i=a>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),yn(0,i,s-1)}function Sa(e,t,n,r,o){var i=t[o],a=n[o]||1;(e&1<<o||null==i)&&(i=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),a>0?yn(0,i,s):yn(-1,i,s-1)}function ka(e,t,n){for(var r=n.length,o=0;o<n.length;o++)if(n[o]>1){r=o;break}for(o=r+1;o<n.length;o++)if(t[o]>0||n[o]!==e[o])return!1;return!0}function _a(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}Object.freeze({assertParamsValid:xa,maskToAxes:wa,computeOutShape:Ca,startForAxis:Ea,stopForAxis:Sa,isSliceContinous:ka,computeFlatOffset:_a});function Ra(e){return Nr.customGrad(e)}var Ia=ni({softmax_:function(e,t){void 0===t&&(t=-1);var n=Ho(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return Nr.runKernelFunc((function(e,r){var o=e.softmax(n,t);return r([o]),o}),{logits:n},(function(e,n){var r=n[0],o=e.mul(r);return{logits:function(){return o.sub(o.sum([t],!0).mul(r))}}}),"Softmax",{dim:t},[],[!0])}}),Ta=ni({logSoftmax_:function(e,t){void 0===t&&(t=-1);var n=Ho(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return Ra((function(e,n){var r=e.max(t,!0),o=e.sub(r),i=o.toFloat().sub(o.exp().sum(t,!0).log());return n([i]),{value:i,gradFunc:function(e,n){var r=n[0].exp();return e.sub(e.sum(t,!0).mul(r))}}}))(n)}}),Aa=function(){function e(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)},e.prototype.set=function(e,t){this.dataIdsCount++,this.data.set(e,t)},e.prototype.has=function(e){return this.data.has(e)},e.prototype.delete=function(e){return this.dataIdsCount--,this.data.delete(e)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),Da=function(){function e(){}return e.prototype.time=function(e){return Na("time")},e.prototype.read=function(e){return Na("read")},e.prototype.readSync=function(e){return Na("readSync")},e.prototype.numDataIds=function(){return Na("numDataIds")},e.prototype.disposeData=function(e){return Na("disposeData")},e.prototype.write=function(e,t,n){return Na("write")},e.prototype.move=function(e,t,n,r){return Na("move")},e.prototype.memory=function(){return Na("memory")},e.prototype.floatPrecision=function(){return Na("floatPrecision")},e.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},e.prototype.batchMatMul=function(e,t,n,r){return Na("batchMatMul")},e.prototype.fusedBatchMatMul=function(e){return e.a,e.b,e.transposeA,e.transposeB,e.bias,e.activation,e.preluActivationWeights,Na("fusedBatchMatMul")},e.prototype.slice=function(e,t,n){return Na("slice")},e.prototype.stridedSlice=function(e,t,n,r){return Na("stridedSlice")},e.prototype.unstack=function(e,t){return Na("unstack")},e.prototype.reverse=function(e,t){return Na("reverse")},e.prototype.concat=function(e,t){return Na("concat")},e.prototype.neg=function(e){return Na("neg")},e.prototype.add=function(e,t){return Na("add")},e.prototype.addN=function(e){return Na("addN")},e.prototype.subtract=function(e,t){return Na("subtract")},e.prototype.multiply=function(e,t){return Na("multiply")},e.prototype.realDivide=function(e,t){return Na("realDivide")},e.prototype.floorDiv=function(e,t){return Na("floorDiv")},e.prototype.sum=function(e,t){return Na("sum")},e.prototype.prod=function(e,t){return Na("prod")},e.prototype.unsortedSegmentSum=function(e,t,n){return Na("unsortedSegmentSum")},e.prototype.argMin=function(e,t){return Na("argMin")},e.prototype.argMax=function(e,t){return Na("argMax")},e.prototype.equal=function(e,t){return Na("equal")},e.prototype.notEqual=function(e,t){return Na("notEqual")},e.prototype.less=function(e,t){return Na("less")},e.prototype.lessEqual=function(e,t){return Na("lessEqual")},e.prototype.greater=function(e,t){return Na("greater")},e.prototype.greaterEqual=function(e,t){return Na("greaterEqual")},e.prototype.logicalNot=function(e){return Na("logicalNot")},e.prototype.logicalAnd=function(e,t){return Na("logicalAnd")},e.prototype.logicalOr=function(e,t){return Na("logicalOr")},e.prototype.where=function(e){return Na("where")},e.prototype.select=function(e,t,n){return Na("select")},e.prototype.topk=function(e,t,n){return Na("topk")},e.prototype.min=function(e,t){return Na("min")},e.prototype.minimum=function(e,t){return Na("minimum")},e.prototype.mod=function(e,t){return Na("mod")},e.prototype.max=function(e,t){return Na("max")},e.prototype.maximum=function(e,t){return Na("maximum")},e.prototype.all=function(e,t){return Na("all")},e.prototype.any=function(e,t){return Na("any")},e.prototype.squaredDifference=function(e,t){return Na("squaredDifference")},e.prototype.ceil=function(e){return Na("ceil")},e.prototype.floor=function(e){return Na("floor")},e.prototype.round=function(e){return Na("round")},e.prototype.sign=function(e){return Na("sign")},e.prototype.isNaN=function(e){return Na("isNaN")},e.prototype.isInf=function(e){return Na("isInf")},e.prototype.isFinite=function(e){return Na("isFinite")},e.prototype.pow=function(e,t){return Na("pow")},e.prototype.exp=function(e){return Na("exp")},e.prototype.expm1=function(e){return Na("expm1")},e.prototype.softmax=function(e,t){return Na("softmax")},e.prototype.log=function(e){return Na("log")},e.prototype.log1p=function(e){return Na("log1p")},e.prototype.sqrt=function(e){return Na("sqrt")},e.prototype.rsqrt=function(e){return Na("rsqrt")},e.prototype.square=function(e){return Na("square")},e.prototype.reciprocal=function(e){return Na("reciprocal")},e.prototype.relu=function(e){return Na("relu")},e.prototype.relu6=function(e){return Na("relu6")},e.prototype.prelu=function(e,t){return Na("prelu")},e.prototype.elu=function(e){return Na("elu")},e.prototype.eluDer=function(e,t){return Na("eluDer")},e.prototype.selu=function(e){return Na("selu")},e.prototype.int=function(e){return Na("int")},e.prototype.clip=function(e,t,n){return Na("clip")},e.prototype.abs=function(e){return Na("abs")},e.prototype.complexAbs=function(e){return Na("complexAbs")},e.prototype.sigmoid=function(e){return Na("sigmoid")},e.prototype.softplus=function(e){return Na("softplus")},e.prototype.sin=function(e){return Na("sin")},e.prototype.cos=function(e){return Na("cos")},e.prototype.tan=function(e){return Na("tan")},e.prototype.asin=function(e){return Na("asin")},e.prototype.acos=function(e){return Na("acos")},e.prototype.atan=function(e){return Na("atan")},e.prototype.atan2=function(e,t){return Na("atan2")},e.prototype.sinh=function(e){return Na("sinh")},e.prototype.cosh=function(e){return Na("cosh")},e.prototype.tanh=function(e){return Na("tanh")},e.prototype.asinh=function(e){return Na("asinh")},e.prototype.acosh=function(e){return Na("acosh")},e.prototype.atanh=function(e){return Na("atanh")},e.prototype.erf=function(e){return Na("erf")},e.prototype.step=function(e,t){return Na("step")},e.prototype.fusedConv2d=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,Na("fusedConv2d")},e.prototype.conv2d=function(e,t,n){return Na("conv2d")},e.prototype.conv2dDerInput=function(e,t,n){return Na("conv2dDerInput")},e.prototype.conv2dDerFilter=function(e,t,n){return Na("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,Na("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(e,t,n){return Na("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(e,t,n){return Na("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(e,t,n){return Na("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(e,t,n){return Na("conv3d")},e.prototype.conv3dDerInput=function(e,t,n){return Na("conv3dDerInput")},e.prototype.conv3dDerFilter=function(e,t,n){return Na("conv3dDerFilter")},e.prototype.maxPool=function(e,t){return Na("maxPool")},e.prototype.maxPoolBackprop=function(e,t,n,r){return Na("maxPoolBackprop")},e.prototype.avgPool=function(e,t){return Na("avgPool")},e.prototype.avgPoolBackprop=function(e,t,n){return Na("avgPoolBackprop")},e.prototype.avgPool3d=function(e,t){return Na("avgPool3d")},e.prototype.avgPool3dBackprop=function(e,t,n){return Na("avgPool3dBackprop")},e.prototype.maxPool3d=function(e,t){return Na("maxPool3d")},e.prototype.maxPool3dBackprop=function(e,t,n,r){return Na("maxPool3dBackprop")},e.prototype.reshape=function(e,t){return Na("reshape")},e.prototype.cast=function(e,t){return Na("cast")},e.prototype.tile=function(e,t){return Na("tile")},e.prototype.pad=function(e,t,n){return Na("pad")},e.prototype.transpose=function(e,t){return Na("transpose")},e.prototype.gather=function(e,t,n){return Na("gather")},e.prototype.gatherND=function(e,t){return Na("gatherND")},e.prototype.scatterND=function(e,t,n){return Na("scatterND")},e.prototype.batchToSpaceND=function(e,t,n){return Na("batchToSpaceND")},e.prototype.spaceToBatchND=function(e,t,n){return Na("spaceToBatchND")},e.prototype.resizeBilinear=function(e,t,n,r){return Na("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(e,t,n){return Na("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(e,t,n,r){return Na("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(e,t,n){return Na("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(e,t,n,r,o,i){return Na("batchNormalization")},e.prototype.localResponseNormalization4D=function(e,t,n,r,o){return Na("localResponseNormalization4D")},e.prototype.LRNGrad=function(e,t,n,r,o,i,a){return Na("LRNGrad")},e.prototype.multinomial=function(e,t,n,r){return Na("multinomial")},e.prototype.oneHot=function(e,t,n,r){return Na("oneHot")},e.prototype.cumsum=function(e,t,n,r){return Na("cumsum")},e.prototype.nonMaxSuppression=function(e,t,n,r,o){return Na("nonMaxSuppression")},e.prototype.fft=function(e){return Na("fft")},e.prototype.ifft=function(e){return Na("ifft")},e.prototype.complex=function(e,t){return Na("complex")},e.prototype.real=function(e){return Na("real")},e.prototype.imag=function(e){return Na("imag")},e.prototype.cropAndResize=function(e,t,n,r,o,i){return Na("cropAndResize")},e.prototype.depthToSpace=function(e,t,n){return Na("depthToSpace")},e.prototype.split=function(e,t,n){return Na("split")},e.prototype.sparseToDense=function(e,t,n,r){return Na("sparseToDense")},e.prototype.diag=function(e){return Na("diag")},e.prototype.fill=function(e,t,n){return Na("fill")},e.prototype.onesLike=function(e){return Na("onesLike")},e.prototype.zerosLike=function(e){return Na("zerosLike")},e.prototype.linspace=function(e,t,n){return Na("linspace")},e.prototype.dispose=function(){return Na("dispose")},e}();function Na(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function Pa(e,t){for(var n=e.length,r=[],o=0;o<n;o++){var i=n-1-o,a=e[i]||1;(t[t.length-1-o]||1)>1&&1===a&&r.unshift(i)}return r}function Ma(e,t){for(var n=[],r=0;r<t.length;r++){var o=e[e.length-r-1],i=t.length-r-1,a=t[i];(null==o||1===o&&a>1)&&n.unshift(i)}return n}function Oa(e,t){for(var n=[],r=Math.max(e.length,t.length),o=0;o<r;o++){var i=e[e.length-o-1];null==i&&(i=1);var a=t[t.length-o-1];if(null==a&&(a=1),1===i)n.unshift(a);else if(1===a)n.unshift(i);else{if(i!==a)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(i)}}return n}function Fa(e,t,n,r,o,i,a){void 0===a&&(a="channelsLast");var s,u=Va(t),l=u[0],c=u[1];if("channelsLast"===a)s=[l,c,e[3],e[3]];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);s=[l,c,e[1],e[1]]}return Ba(e,s,n,r,o,i,!1,a)}function La(e,t,n,r,o,i,a){void 0===a&&(a="NDHWC");var s,u,l=Ua(t),c=l[0],f=l[1],d=l[2];if("NDHWC"===a)u="channelsLast",s=[c,f,d,e[4],e[4]];else{if("NCDHW"!==a)throw new Error("Unknown dataFormat "+a);u="channelsFirst",s=[c,f,d,e[1],e[1]]}return za(e,s,n,r,o,!1,u,i)}function Ba(e,t,n,r,o,i,a,s){void 0===a&&(a=!1),void 0===s&&(s="channelsLast");var u=[-1,-1,-1,-1],l=u[0],c=u[1],f=u[2],d=u[3];if("channelsLast"===s)l=e[0],c=e[1],f=e[2],d=e[3];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);l=e[0],d=e[1],c=e[2],f=e[3]}var p,h=t[0],v=t[1],m=t[3],g=Va(n),y=g[0],b=g[1],x=Va(r),w=x[0],C=x[1],E=ja(h,w),S=ja(v,C),k=function(e,t,n,r,o,i,a,s){var u,l,c;if("number"==typeof e){u={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};var f=function(e,t,n,r,o){null==r&&(r=Wa(e,t,n));var i=e[1],a=Ha((e[0]-t+2*r)/n+1,o);wn(Rn(a),(function(){return"The output # of rows ("+a+") must be an integer. Change the stride and/or zero pad parameters"}));var s=Ha((i-t+2*r)/n+1,o);return wn(Rn(s),(function(){return"The output # of columns ("+s+") must be an integer. Change the stride and/or zero pad parameters"})),[a,s]}([t,n],i,r,e,s);l=f[0],c=f[1]}else if("same"===e){l=Math.ceil(t/r),c=Math.ceil(n/o);var d=Math.max(0,(l-1)*r+i-t),p=Math.max(0,(c-1)*o+a-n),h=Math.floor(d/2),v=d-h,m=Math.floor(p/2);u={top:h,bottom:v,left:m,right:p-m,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: "+e);u={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((t-i+1)/r),c=Math.ceil((n-a+1)/o)}return{padInfo:u,outHeight:l,outWidth:c}}(o,c,f,y,b,E,S,i),_=k.padInfo,R=k.outHeight,I=k.outWidth,T=a?m*d:m;return"channelsFirst"===s?p=[l,T,R,I]:"channelsLast"===s&&(p=[l,R,I,T]),{batchSize:l,dataFormat:s,inHeight:c,inWidth:f,inChannels:d,outHeight:R,outWidth:I,outChannels:T,padInfo:_,strideHeight:y,strideWidth:b,filterHeight:h,filterWidth:v,effectiveFilterHeight:E,effectiveFilterWidth:S,dilationHeight:w,dilationWidth:C,inShape:e,outShape:p,filterShape:t}}function za(e,t,n,r,o,i,a,s){void 0===i&&(i=!1),void 0===a&&(a="channelsLast");var u=[-1,-1,-1,-1,-1],l=u[0],c=u[1],f=u[2],d=u[3],p=u[4];if("channelsLast"===a)l=e[0],c=e[1],f=e[2],d=e[3],p=e[4];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);l=e[0],p=e[1],c=e[2],f=e[3],d=e[4]}var h,v=t[0],m=t[1],g=t[2],y=t[4],b=Ua(n),x=b[0],w=b[1],C=b[2],E=Ua(r),S=E[0],k=E[1],_=E[2],R=ja(v,S),I=ja(m,k),T=ja(g,_),A=function(e,t,n,r,o,i,a,s,u,l,c){var f,d,p,h;if("number"==typeof e){f={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};var v=function(e,t,n,r,o,i){null==o&&(o=Wa(e,t,r));var a=e[1],s=e[2],u=Ha((e[0]-t+2*o)/r+1,i);wn(Rn(u),(function(){return"The output # of depths ("+u+") must be an integer. Change the stride and/or zero pad parameters"}));var l=Ha((a-t+2*o)/r+1,i);wn(Rn(l),(function(){return"The output # of rows ("+l+") must be an integer. Change the stride and/or zero pad parameters"}));var c=Ha((s-t+2*o)/r+1,i);return wn(Rn(c),(function(){return"The output # of columns ("+c+") must be an integer. Change the stride and/or zero pad parameters"})),[u,l,c,1]}([t,n,r,1],s,0,o,e,c);d=v[0],p=v[1],h=v[2]}else if("same"===e){var m=((d=Math.ceil(t/o))-1)*o+s-t,g=((p=Math.ceil(n/i))-1)*i+u-n,y=((h=Math.ceil(r/a))-1)*a+l-r,b=Math.floor(m/2),x=m-b,w=Math.floor(g/2),C=g-w,E=Math.floor(y/2);f={top:w,bottom:C,left:E,right:y-E,front:b,back:x,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: "+e);f={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},d=Math.ceil((t-s+1)/o),p=Math.ceil((n-u+1)/i),h=Math.ceil((r-l+1)/a)}return{padInfo:f,outDepth:d,outHeight:p,outWidth:h}}(o,c,f,d,x,w,C,R,I,T,s),D=A.padInfo,N=A.outDepth,P=A.outHeight,M=A.outWidth,O=i?y*p:y;return"channelsFirst"===a?h=[l,O,N,P,M]:"channelsLast"===a&&(h=[l,N,P,M,O]),{batchSize:l,dataFormat:a,inDepth:c,inHeight:f,inWidth:d,inChannels:p,outDepth:N,outHeight:P,outWidth:M,outChannels:O,padInfo:D,strideDepth:x,strideHeight:w,strideWidth:C,filterDepth:v,filterHeight:m,filterWidth:g,effectiveFilterDepth:R,effectiveFilterHeight:I,effectiveFilterWidth:T,dilationDepth:S,dilationHeight:k,dilationWidth:_,inShape:e,outShape:h,filterShape:t}}function Wa(e,t,n,r){void 0===r&&(r=1);var o=ja(t,r);return Math.floor((e[0]*(n-1)-n+o)/2)}function Va(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function Ua(e){return"number"==typeof e?[e,e,e]:e}function ja(e,t){return t<=1?e:e+(e-1)*(t-1)}function Ha(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function Ga(e){var t=Va(e),n=t[0],r=t[1],o=t[2];return 1===n&&1===r&&1===o}function qa(e,t){return Ga(e)||Ga(t)}function Ka(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function Xa(e,t,n){if("complex64"===t){if("complex64"===e.dtype)return e.clone();var r=hi(e.shape),o=e.toFloat(),i=n.complex(o,r);return r.dispose(),o.dispose(),i}if(!zn(e.dtype,t))return Nr.makeTensorFromDataId(e.dataId,e.shape,t);if("complex64"===e.dtype){var a=n.real(e);return i=a.cast(t),a.dispose(),i}if("int32"===t)return n.int(e);if("bool"===t){var s=ui(0,e.dtype);return i=n.notEqual(e,s),s.dispose(),i}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function $a(e,t){return Nr.makeTensorFromDataId(e.dataId,t,e.dtype)}function Ya(e,t,n){var r=(t-e)/(n-1),o=Zn(n,"float32");o[0]=e;for(var i=1;i<o.length;i++)o[i]=o[i-1]+r;return li(o,"float32")}Object.freeze({castTensor:Xa,reshapeTensor:$a,linspaceImpl:Ya,upcastType:Sr,axesAreInnerMostDims:qo,combineLocations:Ko,computeOutAndReduceShapes:Xo,expandShapeToKeepDim:$o,assertAxesAreInnerMostDims:Yo,getAxesPermutation:Qo,getUndoAxesPermutation:Jo,getInnerMostAxes:Zo,getBroadcastDims:Pa,getReductionAxes:Ma,assertAndGetBroadcastShape:Oa,assertParamsConsistent:ei,computeOutShape:ti,computePool2DInfo:Fa,computePool3DInfo:La,computeConv2DInfo:Ba,computeConv3DInfo:za,computeDefaultPad:Wa,tupleValuesAreOne:Ga,eitherStridesOrDilationsAreOne:qa,convertConv2DDataFormat:Ka,PARALLELIZE_THRESHOLD:30,computeOptimalWindowSize:ma});function Qa(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function Ja(e,t){return{real:e[2*t],imag:e[2*t+1]}}function Za(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function es(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function ts(e,t,n){var r=function(e,t,n){return function(e,t,n){for(var r=0,o=e.length,i=0,a=!1;r<o;){var s=n(t,e[i=r+(o-r>>>1)]);s>0?r=i+1:(o=i,a=!s)}return a?r:-r-1}(e,t,n||ns)}(e,t,n),o=r<0?-(r+1):r;e.splice(o,0,t)}function ns(e,t){return e>t?1:e<t?-1:0}function rs(e,t,n,r,o){return is(e,t,n,r,o,0).selectedIndices}function os(e,t,n,r,o,i){var a=is(e,t,n,r,o,i,!0);return a.numValidOutputs.dispose(),{selectedIndices:a.selectedIndices,selectedScores:a.selectedScores}}function is(e,t,n,r,o,i,a,s){void 0===a&&(a=!1),void 0===s&&(s=!1);for(var u=Array.from(t).map((function(e,t){return{score:e,boxIndex:t,suppressBeginIndex:0}})).filter((function(e){return e.score>o})).sort(us),l=i>0?-.5/i:0,c=[],f=[];c.length<n&&u.length>0;){var d=u.pop(),p=d.score,h=d.boxIndex,v=d.suppressBeginIndex;if(p<o)break;for(var m=!1,g=c.length-1;g>=v;--g){var y=as(e,h,c[g]);if(y>=r){m=!0;break}if(d.score=d.score*ss(r,l,y),d.score<=o)break}d.suppressBeginIndex=c.length,m||(d.score===p?(c.push(h),f.push(d.score)):d.score>o&&ts(u,d,us))}var b=c.length;return s&&(c.fill(0,b),f.fill(0,b)),{selectedIndices:li(c,"int32"),selectedScores:li(f,"float32"),numValidOutputs:ui(b,"int32")}}function as(e,t,n){var r=e.subarray(4*t,4*t+4),o=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(o[0],o[2]),c=Math.min(o[1],o[3]),f=Math.max(o[0],o[2]),d=Math.max(o[1],o[3]),p=(s-i)*(u-a),h=(f-l)*(d-c);if(p<=0||h<=0)return 0;var v=Math.max(i,l),m=Math.max(a,c),g=Math.min(s,f),y=Math.min(u,d),b=Math.max(g-v,0)*Math.max(y-m,0);return b/(p+h-b)}function ss(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function us(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function ls(e,t,n){var r=new Array(e.rank).fill(0),o=e.shape.slice();return t.map((function(t){o[n]=t;var i=e.slice(r,o);return r[n]+=t,i}))}function cs(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];var o=Li(n,e.dtype);for(r=0;r<o.values.length;++r){for(var i=o.indexToLoc(r),a=new Array(e.rank),s=0;s<a.length;s++)a[s]=i[s]%e.shape[s];var u=e.locToIndex(a);o.values[r]=e.values[u]}return o.toTensor()}function fs(e,t,n,r,o){for(var i=t[t.length-1],a=[e.length/i,i],s=a[0],u=a[1],l=On(n,s*r),c=On("int32",s*r),f=0;f<s;f++){for(var d=f*u,p=e.subarray(d,d+u),h=[],v=0;v<p.length;v++)h.push({value:p[v],index:v});h.sort((function(e,t){return t.value-e.value}));var m=f*r,g=l.subarray(m,m+r),y=c.subarray(m,m+r);for(v=0;v<r;v++)g[v]=h[v].value,y[v]=h[v].index}var b=t.slice();return b[b.length-1]=r,[ai(l,b,n),ai(c,b,"int32")]}function ds(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);var o=Li(e,"int32"),i=Li([n.length,e.length],"int32");for(r=0;r<n.length;r++){var a=o.indexToLoc(n[r]),s=r*e.length;i.values.set(a,s)}return i.toTensor()}var ps=function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((function(e,t){return"T"+t}));var n=[];this.variableNames.forEach((function(e){n.push("float v"+e+" = get"+e+"AtOutCoords();")}));var r=this.variableNames.map((function(e){return"v"+e})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        float result = "+r+";\n        setOutput(result);\n      }\n    "},hs=function(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((function(e,t){return"T"+t}));var n=[];this.variableNames.forEach((function(e){n.push("vec4 v"+e+" = get"+e+"AtOutCoords();")}));var r=this.variableNames.map((function(e){return"v"+e})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        vec4 result = "+r+";\n        setOutput(result);\n      }\n    "},vs=function(e,t,n){this.variableNames=["A"];var r=e.windowSize,o=e.batchSize,i=e.inSize,a=Math.ceil(i/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[o,a];var s="max"===t?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+u+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+s+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "};function ms(e,t){return["x","y","z","w","u","v"].slice(0,t).map((function(t){return e+"."+t}))}function gs(e,t){return 1===t?[e]:ms(e,t)}function ys(){var e,t,n,r,o,i,a,s,u,l;return 2===un().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",o="texture",i="outputColor",a="out vec4 outputColor;",s="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",u="",l="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",o="texture2D",i="gl_FragColor",a="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",l="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:o,output:i,defineOutput:a,defineSpecialNaN:s,defineSpecialInf:u,defineRound:l}}function bs(e,t,n){void 0===n&&(n="index");var r=$n(t);return r.map((function(t,o){return"int "+e[o]+" = "+n+" / "+t+"; "+(o===r.length-1?"int "+e[o+1]+" = "+n+" - "+e[o]+" * "+t:"index -= "+e[o]+" * "+t)+";"})).join("")}function xs(e){var t=$n(e).map((function(e){return e.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * "+t[0]+" + coords.y * "+t[1]+" + coords.z;\n  }\n"}var ws="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";function Cs(e,t,n,r){var o=[];e.forEach((function(e){var t=kn(e.shapeInfo.logicalShape);e.shapeInfo.isUniform?o.push("uniform float "+e.name+(t>1?"["+t+"]":"")+";"):(o.push("uniform sampler2D "+e.name+";"),o.push("uniform int offset"+e.name+";"))}));var i,a,s=o.join("\n"),u=e.map((function(e){return function(e,t,n){void 0===n&&(n=!1);var r="";r+=n?Ss(e):Es(e);var o=e.shapeInfo.logicalShape,i=t.logicalShape;return o.length<=i.length&&(r+=n?function(e,t){var n,r=e.name,o=r.charAt(0).toUpperCase()+r.slice(1),i="get"+o+"AtOutCoords",a=e.shapeInfo.logicalShape.length,s=t.logicalShape.length,u=Pa(e.shapeInfo.logicalShape,t.logicalShape),l=Ds(s),c=s-a,f=["x","y","z","w","u","v"];n=0===a?"":s<2&&u.length>=1?"coords = 0;":u.map((function(e){return"coords."+f[e+c]+" = 0;"})).join("\n");var d;d=s<2&&a>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords."+f[t+c]})).join(", ");var p="return outputValue;",h=1===kn(e.shapeInfo.logicalShape),v=1===kn(t.logicalShape);if(1!==a||h||v){if(h&&!v)p=1===s?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(u.length){var m=a-2,g=a-1;u.indexOf(m)>-1&&u.indexOf(g)>-1?p="return vec4(outputValue.x);":u.indexOf(m)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":u.indexOf(g)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 "+i+"() {\n      "+l+" coords = getOutputCoords();\n      "+n+"\n      vec4 outputValue = get"+o+"("+d+");\n      "+p+"\n    }\n  "}(e,t):function(e,t){var n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),o="get"+r+"AtOutCoords",i=t.texShape,a=e.shapeInfo.texShape,s=e.shapeInfo.logicalShape.length,u=t.logicalShape.length;if(!e.shapeInfo.isUniform&&s===u&&null==e.shapeInfo.flatOffset&&_n(a,i))return"\n      float "+o+"() {\n        return sampleTexture("+n+", resultUV);\n      }\n    ";var l,c=Ds(u),f=Pa(e.shapeInfo.logicalShape,t.logicalShape),d=u-s,p=["x","y","z","w","u","v"];l=0===s?"":u<2&&f.length>=1?"coords = 0;":f.map((function(e){return"coords."+p[e+d]+" = 0;"})).join("\n");var h;return h=u<2&&s>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords."+p[t+d]})).join(", "),"\n    float "+o+"() {\n      "+c+" coords = getOutputCoords();\n      "+l+"\n      return get"+r+"("+h+");\n    }\n  "}(e,t)),r}(e,t,r)})).join("\n"),l=t.texShape,c=ys(),f=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return "+e.texture2D+"(textureSampler, uv).r;\n    }\n  "}(c),d=function(e){return e.version+"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    "+e.varyingFs+" vec2 resultUV;\n    "+e.defineOutput+"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    "+e.defineSpecialNaN+"\n    "+e.defineSpecialInf+"\n    "+e.defineRound+"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    "+ks+"\n    "+_s+"\n    "+Rs+"\n  "}(c);return t.isPacked?(i=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return 1===n[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * "+n[1]+".0);\n      }\n    ":1===n[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * "+n[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      return 2 * (resTexRC.x * "+n[1]+" + resTexRC.y);\n    }\n  "}(0,t);case 2:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(_n(e,t))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2("+n[0]+", "+n[1]+"));\n      }\n    ";var r=Math.ceil(e[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec2(r, c);\n    }\n  "}(e,t);case 3:return n=e,r=t,o=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],a=(i=Math.ceil(n[2]/2))*Math.ceil(n[1]/2),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+o[0]+", "+o[1]+"));\n      int index = resTexRC.x * "+o[1]+" + resTexRC.y;\n\n      int b = index / "+a+";\n      index -= b * "+a+";\n\n      int r = 2 * (index / "+i+");\n      int c = imod(index, "+i+") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";default:return function(e,t){for(var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[e.length-1]/2),o=r*Math.ceil(e[e.length-2]/2),i=o,a="",s="b, r, c",u=2;u<e.length-1;u++)a="\n      int b"+u+" = index / "+(i*=e[e.length-u-1])+";\n      index -= b"+u+" * "+i+";\n    "+a,s="b"+u+", "+s;return"\n    ivec"+e.length+" getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n\n      "+a+"\n\n      int b = index / "+o+";\n      index -= b * "+o+";\n\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec"+e.length+"("+s+");\n    }\n  "}(e,t)}var n,r,o,i,a}(t.logicalShape,l),a=function(e){return"\n    void setOutput(vec4 val) {\n      "+e.output+" = val;\n    }\n  "}(c)):(i=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){return 1===t[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+t[1]+".0);\n      }\n    ":1===t[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+t[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+t[0]+", "+t[1]+"));\n      return resTexRC.x * "+t[1]+" + resTexRC.y;\n    }\n  "}(0,t);case 2:return function(e,t){return _n(e,t)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+t[0]+", "+t[1]+"));\n      }\n    ":1===e[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+t[0]+", "+t[1]+"));\n        int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===e[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+t[0]+", "+t[1]+"));\n        int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n      int r = index / "+e[1]+";\n      int c = index - r * "+e[1]+";\n      return ivec2(r, c);\n    }\n  "}(e,t);case 3:return n=t,r=bs(["r","c","d"],e),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      "+r+"\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(e,t){var n=bs(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n      "+n+"\n      return ivec4(r, c, d, d2);\n    }\n  "}(e,t);case 5:return function(e,t){var n=bs(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+t[0]+",\n                             "+t[1]+"));\n\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  "}(e,t);case 6:return function(e,t){var n=bs(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  "}(e,t);default:throw new Error(e.length+"-D output sampling is not yet supported")}var n,r}(t.logicalShape,l),a=function(e){return"\n    void setOutput(float val) {\n      "+e.output+" = vec4(val, 0, 0, 0);\n    }\n  "}(c)),r&&(d+=Is),[d,f,a,s,i,u,n].join("\n")}function Es(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"float "+n+"() {return "+t+";}";var r=e.shapeInfo.texShape,o=r[0],i=r[1];if(1===o&&1===i)return"\n      float "+n+"() {\n        return sampleTexture("+t+", halfCR);\n      }\n    ";var a=e.shapeInfo.texShape;return"\n    float "+n+"() {\n      vec2 uv = uvFromFlat("+a[0]+", "+a[1]+", "+Ts(t)+");\n      return sampleTexture("+t+", uv);\n    }\n  "}(e);case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"\n      float "+n+"(int index) {\n        "+As(e)+"\n      }\n    ";var r=e.shapeInfo.texShape,o=r[0],i=r[1];if(1===i&&1===o)return"\n      float "+n+"(int index) {\n        return sampleTexture("+t+", halfCR);\n      }\n    ";var a=Ts(t);return 1===i?"\n      float "+n+"(int index) {\n        vec2 uv = vec2(0.5, (float(index + "+a+") + 0.5) / "+o+".0);\n        return sampleTexture("+t+", uv);\n      }\n    ":1===o?"\n      float "+n+"(int index) {\n        vec2 uv = vec2((float(index + "+a+") + 0.5) / "+i+".0, 0.5);\n        return sampleTexture("+t+", uv);\n      }\n    ":"\n    float "+n+"(int index) {\n      vec2 uv = uvFromFlat("+o+", "+i+", index + "+a+");\n      return sampleTexture("+t+", uv);\n    }\n  "}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=e.shapeInfo.texShape;if(null!=o&&_n(t,o)){var i=o[0];return"\n    float "+r+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+o[1]+".0, "+i+".0);\n      return sampleTexture("+n+", uv);\n    }\n  "}var a=Mn(t),s=a.newShape,u=a.keptDims,l=s;if(l.length<t.length)return"\n      "+Es(Ns(e,l))+"\n      float "+r+"(int row, int col) {\n        return "+r+"("+Ps(["row","col"],u)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2("+t[1]+", 1)));\n        "+As(e)+"\n      }\n    ";var c=o[0],f=o[1],d=Ts(n);return 1===f?"\n    float "+r+"(int row, int col) {\n      float index = dot(vec3(row, col, "+d+"), vec3("+t[1]+", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / "+c+".0);\n      return sampleTexture("+n+", uv);\n    }\n  ":1===c?"\n    float "+r+"(int row, int col) {\n      float index = dot(vec3(row, col, "+d+"), vec3("+t[1]+", 1, 1));\n      vec2 uv = vec2((index + 0.5) / "+f+".0, 0.5);\n      return sampleTexture("+n+", uv);\n    }\n  ":"\n  float "+r+"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * "+t[1]+" + col + "+d+";\n    vec2 uv = uvFromFlat("+c+", "+f+", index);\n    return sampleTexture("+n+", uv);\n  }\n"}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=t[1]*t[2],i=t[2],a=Mn(t),s=a.newShape,u=a.keptDims,l=s;if(l.length<t.length)return"\n        "+Es(Ns(e,l))+"\n        float "+r+"(int row, int col, int depth) {\n          return "+r+"("+Ps(["row","col","depth"],u)+");\n        }\n      ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3("+o+", "+i+", 1)));\n        "+As(e)+"\n      }\n    ";var c=e.shapeInfo.texShape,f=c[0],d=c[1],p=e.shapeInfo.flatOffset;return d===o&&null==p?"\n        float "+r+"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2("+i+", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+d+".0, "+f+".0);\n          return sampleTexture("+n+", uv);\n        }\n      ":d===i&&null==p?"\n    float "+r+"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2("+t[1]+", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+d+".0, "+f+".0);\n      return sampleTexture("+n+", uv);\n    }\n  ":"\n      float "+r+"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * "+o+" + col * "+i+" + depth + "+Ts(n)+";\n        vec2 uv = uvFromFlat("+f+", "+d+", index);\n        return sampleTexture("+n+", uv);\n      }\n  "}(e);case 4:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=t[3],i=t[2]*o,a=t[1]*i,s=Mn(t),u=s.newShape,l=s.keptDims;if(u.length<t.length)return"\n      "+Es(Ns(e,u))+"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        return "+r+"("+Ps(["row","col","depth","depth2"],l)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4("+a+", "+i+", "+o+", 1)));\n        "+As(e)+"\n      }\n    ";var c=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,d=f[0],p=f[1];return p===a&&null==c?"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3("+i+", "+o+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+p+".0, "+d+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":p===o&&null==c?"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3("+t[1]*t[2]+", "+t[2]+", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+p+".0, "+d+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":"\n    float "+r+"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+a+" + col * "+i+" +\n          depth * "+o+" + depth2;\n      vec2 uv = uvFromFlat("+d+", "+p+", index + "+Ts(n)+");\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);case 5:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=t[4],i=t[3]*o,a=t[2]*i,s=t[1]*a,u=Mn(t),l=u.newShape,c=u.keptDims;if(l.length<t.length)return"\n      "+Es(Ns(e,l))+"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+r+"("+Ps(["row","col","depth","depth2","depth3"],c)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+s+", "+a+", "+i+", "+o+")) +\n          depth3;\n        "+As(e)+"\n      }\n    ";var f=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,p=d[0],h=d[1];return h===s&&null==f?"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4("+a+", "+i+", "+o+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+h+".0, "+p+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":h===o&&null==f?"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+t[1]*t[2]*t[3]+",\n               "+t[2]*t[3]+", "+t[3]+", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+h+".0, "+p+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":"\n    float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+s+" + col * "+a+" + depth * "+i+" +\n          depth2 * "+o+" + depth3 + "+Ts(n)+";\n      vec2 uv = uvFromFlat("+p+", "+h+", index);\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);case 6:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=Mn(t),i=o.newShape,a=o.keptDims;if(i.length<t.length)return"\n      "+Es(Ns(e,i))+"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return "+r+"("+Ps(["row","col","depth","depth2","depth3","depth4"],a)+");\n      }\n    ";var s=t[5],u=t[4]*s,l=t[3]*u,c=t[2]*l,f=t[1]*c;if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4("+f+", "+c+", "+l+", "+u+")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2("+s+", 1)));\n        "+As(e)+"\n      }\n    ";var d=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,h=p[0],v=p[1];return v===f&&null==d?"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4("+c+", "+l+", "+u+", "+s+")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+v+".0, "+h+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":v===s&&null==d?"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4("+t[1]*t[2]*t[3]*t[4]+",\n               "+t[2]*t[3]*t[4]+",\n               "+t[3]*t[4]+",\n               "+t[4]+")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+v+".0, "+h+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":"\n    float "+r+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+f+" + col * "+c+" + depth * "+l+" +\n          depth2 * "+u+" + depth3 * "+s+" + depth4 + "+Ts(n)+";\n      vec2 uv = uvFromFlat("+h+", "+v+", index);\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function Ss(e){var t;switch(e.shapeInfo.logicalShape.length){case 0:return"\n    vec4 "+("get"+(t=e.name).charAt(0).toUpperCase()+t.slice(1))+"() {\n      return "+ys().texture2D+"("+t+", halfCR);\n    }\n  ";case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=e.shapeInfo.texShape,o=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],i=ys();return"\n    vec4 "+n+"(int index) {\n      vec2 uv = packedUVfrom1D(\n        "+o[0]+", "+o[1]+", index);\n      return "+i.texture2D+"("+t+", uv);\n    }\n  "}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=e.shapeInfo.texShape,i=o[0],a=o[1],s=ys();if(null!=o&&_n(t,o))return"\n      vec4 "+r+"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2("+a+".0, "+i+".0);\n\n        return "+s.texture2D+"("+n+", uv);\n      }\n    ";var u=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];return"\n    vec4 "+r+"(int row, int col) {\n      vec2 uv = packedUVfrom2D("+Math.ceil(t[1]/2)+", "+u[0]+", "+u[1]+", row, col);\n      return "+s.texture2D+"("+n+", uv);\n    }\n  "}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=e.shapeInfo.texShape,i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(1===t[0])return"\n        "+Ss(Ns(e,t.slice(1)))+"\n        vec4 "+r+"(int b, int row, int col) {\n          return "+r+"("+Ps(["b","row","col"],[1,2])+");\n        }\n      ";var a=i[0],s=i[1],u=Math.ceil(t[2]/2);return"\n    vec4 "+r+"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        "+a+", "+s+", "+u*Math.ceil(t[1]/2)+", "+u+", b, row, col);\n      return "+ys().texture2D+"("+n+", uv);\n    }\n  "}(e);default:return function(e){for(var t=e.shapeInfo.logicalShape,n=t.length,r=e.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,a=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],s=a[0],u=a[1],l=Math.ceil(t[n-1]/2),c=l*Math.ceil(t[n-2]/2),f="int b, int row, int col",d="b * "+c+" + (row / 2) * "+l+" + (col / 2)",p=2;p<n-1;p++)f="int b"+p+", "+f,d="b"+p+" * "+(c*=t[n-p-1])+" + "+d;return"\n    vec4 "+o+"("+f+") {\n      int index = "+d+";\n      int texR = index / "+u+";\n      int texC = index - texR * "+u+";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+u+", "+s+");\n      return "+ys().texture2D+"("+r+", uv);\n    }\n  "}(e)}}var ks="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",_s="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Rs="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Is="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function Ts(e){return"offset"+e}function As(e){var t=e.name,n=kn(e.shapeInfo.logicalShape);return n<2?"return "+t+";":"\n    for (int i = 0; i < "+n+"; i++) {\n      if (i == index) {\n        return "+t+"[i];\n      }\n    }\n  "}function Ds(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function Ns(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function Ps(e,t){return t.map((function(t){return e[t]})).join(", ")}var Ms=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,wn(e.length>2,(function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."}));var o=e[e.length-1],i=Math.ceil(o/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var a,s,u=this.outputShape,l=u.length,c=Ds(l),f=gs("coords",l);if(1===i){var d=Ds(s=l+1);a="\n        "+d+" sourceLocR = "+d+"("+f.join()+", 0);\n        ++"+f[l-1]+";\n        "+d+" sourceLocG = "+d+"("+f.join()+", 0);\n        ++"+f[l-2]+";\n        "+d+" sourceLocA = "+d+"("+f.join()+", 0);\n        --"+f[l-1]+";\n        "+d+" sourceLocB = "+d+"("+f.join()+", 0);\n        --"+f[l-2]+";"}else s=l,a="\n        "+c+" sourceLocR = coords;\n        ++"+f[l-1]+";\n        "+c+" sourceLocG = coords;\n        ++"+f[l-2]+";\n        "+c+" sourceLocA = coords;\n        --"+f[l-1]+";\n        "+c+" sourceLocB = coords;\n        --"+f[l-2]+";";var p=["x","y","z","w","u","v"].slice(0,s),h="."+p[s-1],v=p.map((function(e){return"int "+e})),m=gs("sourceLocR",s-1).concat("inIdx.r"),g=gs("sourceLocG",s-1).concat("inIdx.g"),y=gs("sourceLocB",s-1).concat("inIdx.b"),b=gs("sourceLocA",s-1).concat("inIdx.a"),x="max"===n?"greaterThan":"lessThan",w=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel("+m.join()+"),\n                             getBestIndicesAChannel("+g.join()+"),\n                             getBestIndicesAChannel("+y.join()+"),\n                             getBestIndicesAChannel("+b.join()+")));",C="vec4(\n            getAChannel("+m.join()+"),\n            hasNextCol ? getAChannel("+g.join()+") : 0.,\n            hasNextRow ? getAChannel("+y.join()+") : 0.,\n            hasNextRow && hasNextCol ? getAChannel("+b.join()+") : 0.)",E=r?"":"\n      float getBestIndicesAChannel("+v.join()+") {\n        return getChannel(getBestIndicesA("+p.join()+"),\n                                          vec2("+p.slice(-2).join()+"));\n      }";this.userCode="\n      float getAChannel("+v.join()+") {\n        return getChannel(getA("+p.join()+"),\n                               vec2("+p.slice(-2).join()+"));\n      }\n      "+E+"\n      void main() {\n        "+c+" coords = getOutputCoords();\n        bool hasNextCol = "+f[l-1]+" < "+(u[l-1]-1)+";\n        bool hasNextRow = "+f[l-2]+" < "+(u[l-2]-1)+";\n        "+a+"\n        ivec4 srcIdx = ivec4(sourceLocR"+h+", sourceLocG"+h+",\n          sourceLocB"+h+", sourceLocA"+h+") * "+t+";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = "+C+";\n\n        for (int i = 0; i < "+t+"; i++) {\n          inIdx = srcIdx;\n          "+w+"\n          vec4 candidate = "+C+";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4("+x+"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    "},Os=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,l=s-1-e.padInfo.top,c=u-1-e.padInfo.left,f=1/(t*n);this.userCode="\n      const ivec2 pads = ivec2("+l+", "+c+");\n      const float avgMultiplier = float("+f+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+s+";\n            wR += "+i+") {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+u+";\n            wC+= "+a+") {\n            float dyC = float(dyCCorner + wC) / "+o+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Fs=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,f=e.effectiveFilterHeight,d=e.effectiveFilterWidth,p=c-1-e.padInfo.front,h=f-1-e.padInfo.top,v=d-1-e.padInfo.left,m=1/(t*n*r);this.userCode="\n      const ivec3 pads = ivec3("+p+", "+h+", "+v+");\n      const float avgMultiplier = float("+m+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+c+";\n            wD += "+s+") {\n          float dyD = float(dyDCorner + wD) / "+o+".0;\n\n          if (dyD < 0.0 || dyD >= "+e.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+f+";\n              wR += "+u+") {\n            float dyR = float(dyRCorner + wR) / "+i+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+d+";\n                wC += "+l+") {\n              float dyC = float(dyCCorner + wC) / "+a+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Ls=function(e,t,n,r,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Oa(e,t),Oa(e,n);var a="0.0";null!=r&&(Oa(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="1.0";null!=o&&(Oa(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+a+";\n        float scale = "+s+";\n        float inv = scale * inversesqrt(variance + float("+i+"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    "},Bs=function(e,t,n,r,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Oa(e,t),Oa(e,n);var a="vec4(0.0)";null!=r&&(Oa(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="vec4(1.0)";null!=o&&(Oa(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        vec4 offset = "+a+";\n        vec4 scale = "+s+";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4("+i+"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    "},zs=function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Oa(t,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        "+e+"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    "},Ws="return a + b;",Vs="return a - b;",Us="return a * b;",js="return (a < 0.) ? b * a : a;",Hs=function(e,t,n){this.variableNames=["A","B"],this.outputShape=Oa(t,n),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+e+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "},Gs="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",qs=function(e,t,n,r){void 0===r&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Oa(t,n);var o=this.outputShape.length,i="";if(r)if(0===o||1===kn(this.outputShape))i="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(i="\n          "+Ds(o)+" coords = getOutputCoords();\n        ",1===o)i+="\n            result.y = (coords + 1) >= "+this.outputShape[0]+" ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ";else{var a=gs("coords",o);i+="\n            bool nextRowOutOfBounds =\n              ("+a[o-2]+" + 1) >= "+this.outputShape[o-2]+";\n            bool nextColOutOfBounds =\n              ("+a[o-1]+" + 1) >= "+this.outputShape[o-1]+";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        "+e+"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        "+i+"\n\n        setOutput(result);\n      }\n    "},Ks=function(){function e(e){this.variableNames=["A"],this.outputShape=e,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e,t){var n=this;return function(r,o){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(o,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(o,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}},e}(),Xs=function(){function e(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e,t){var n=this;return function(r,o){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(o,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(o,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}},e}(),$s=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "},Ys=function(e){this.outputShape=[],this.outputShape=ti(e,1),this.variableNames=e.map((function(e,t){return"T"+t}));var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++){var o=t[n-1];r.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+o+"));")}var i=t.length,a=t[t.length-1];r.push("else setOutput(getT"+i+"(yR, yC-"+a+"));"),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        "+r.join("\n        ")+"\n      }\n    "},Qs=function(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=ti(e,t);var n=this.outputShape,r=n.length,o=Ds(r),i=gs("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((function(e,t){return"T"+t}));var s=new Array(e.length-1);s[0]=e[0][t];for(var u=1;u<s.length;u++)s[u]=s[u-1]+e[u][t];var l=a[t],c=a.slice(-2),f=a.join(),d="if ("+l+" < "+s[0]+") {\n        return getChannel(\n            getT0("+f+"), vec2("+c.join()+"));\n        }";for(u=1;u<s.length;u++){var p=s[u-1];d+="\n        if ("+l+" < "+s[u]+"  && "+l+" >= "+s[u-1]+") {\n          return getChannel(\n            getT"+u+"("+Js(a,l,p)+"),\n            vec2("+Js(c,l,p)+"));\n        }"}var h=s.length,v=s[s.length-1];d+="\n        return getChannel(\n          getT"+h+"("+Js(a,l,v)+"),\n          vec2("+Js(c,l,v)+"));",this.userCode="\n      float getValue("+a.map((function(e){return"int "+e}))+") {\n        "+d+"\n      }\n\n      void main() {\n        "+o+" coords = getOutputCoords();\n        vec4 result = vec4(getValue("+i+"), 0., 0., 0.);\n\n        "+i[r-1]+" = "+i[r-1]+" + 1;\n        if ("+i[r-1]+" < "+n[r-1]+") {\n          result.g = getValue("+i+");\n        }\n\n        "+i[r-2]+" = "+i[r-2]+" + 1;\n        if ("+i[r-2]+" < "+n[r-2]+") {\n          result.a = getValue("+i+");\n        }\n\n        "+i[r-1]+" = "+i[r-1]+" - 1;\n        if ("+i[r-2]+" < "+n[r-2]+" &&\n            "+i[r-1]+" < "+n[r-1]+") {\n          result.b = getValue("+i+");\n        }\n        setOutput(result);\n      }\n    "};function Js(e,t,n){var r=e.indexOf(t);return e.map((function(e,t){return t===r?e+" - "+n:e})).join()}var Zs=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i="channelsLast"===e.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n            int xR = wR + yR * "+t+" - "+r+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+o+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              if ("+i+") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},eu=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i="channelsLast"===e.dataFormat,a=t-1-e.padInfo.top,s=n-1-e.padInfo.left,u=i?1:2,l=i?2:3,c=i?3:1;this.userCode="\n      const ivec2 pads = ivec2("+a+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords["+c+"];\n\n        ivec2 dyCorner = ivec2(coords["+u+"], coords["+l+"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+o+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+e.outChannels+"; d2++) {\n\n              if ("+i+") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},tu=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,o=e.padInfo.front,i=e.padInfo.top,a=e.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yF = 0; yF < "+e.outDepth+"; yF++) {\n            int xF = wF + yF * "+t+" - "+o+";\n\n            if (xF < 0 || xF >= "+e.inDepth+") {\n              continue;\n            }\n\n            for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n              int xR = wR + yR * "+n+" - "+i+";\n\n              if (xR < 0 || xR >= "+e.inHeight+") {\n                continue;\n              }\n\n              for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n                int xC = wC + yC * "+r+" - "+a+";\n\n                if (xC < 0 || xC >= "+e.inWidth+") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},nu=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=t-1-e.padInfo.front,u=n-1-e.padInfo.top,l=r-1-e.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3("+s+", "+u+", "+l+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+t+"; wF++) {\n          float dyF = float(dyFCorner + wF) / "+o+".0;\n\n          if (dyF < 0.0 || dyF >= "+e.outDepth+".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = "+t+" - 1 - wF;\n\n          for (int wR = 0; wR < "+n+"; wR++) {\n            float dyR = float(dyRCorner + wR) / "+i+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = "+n+" - 1 - wR;\n\n            for (int wC = 0; wC < "+r+"; wC++) {\n              float dyC = float(dyCCorner + wC) / "+a+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = "+r+" - 1 - wC;\n\n              for (int d2 = 0; d2 < "+e.outChannels+"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},ru=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+i+" + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n            int xR = wR + yR * "+t+" - "+r+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+o+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},ou=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=t-1-e.padInfo.top,a=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+i+", "+a+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+o+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+s+"; dm++) {\n              int d2 = d1 * "+s+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},iu=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var o=e.padInfo.top,i=e.padInfo.left,a=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterHeight,f=e.filterWidth,d=4*Math.floor(e.inChannels/4),p=e.inChannels%4,h="channelsLast"===e.dataFormat,v=h?1:2,m=h?2:3,g=h?3:1,y="",b="";n&&(y=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",b="result = activation(result);");var x=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+y+"\n\n      const ivec2 strides = ivec2("+a+", "+s+");\n      const ivec2 pads = ivec2("+o+", "+i+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords["+g+"];\n\n        ivec2 xRCCorner =\n            ivec2(coords["+v+"], coords["+m+"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+c+"; wR++) {\n          int xR = xRCorner + wR * "+u+";\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+f+"; wC++) {\n            int xC = xCCorner + wC * "+l+";\n\n            if (xC < 0 || xC >= "+e.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+d+"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if ("+h+") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if ("+(1===p)+") {\n\n              if ("+h+") {\n                dotProd +=\n                    getX(batch, xR, xC, "+d+") *\n                    getW(wR, wC, "+d+", d2);\n              } else {\n                dotProd +=\n                    getX(batch, "+d+", xR, xC) *\n                    getW(wR, wC, "+d+", d2);\n              }\n\n            } else if ("+(2===p)+") {\n              vec2 wValues = vec2(\n                getW(wR, wC, "+d+", d2),\n                getW(wR, wC, "+d+" + 1, d2)\n              );\n\n              if ("+h+") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, "+d+"),\n                  getX(batch, xR, xC, "+d+" + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, "+d+", xR, xC),\n                  getX(batch, "+d+" + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if ("+(3===p)+") {\n              vec3 wValues = vec3(\n                getW(wR, wC, "+d+", d2),\n                getW(wR, wC, "+d+" + 1, d2),\n                getW(wR, wC, "+d+" + 2, d2)\n              );\n\n              if ("+h+") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, "+d+"),\n                  getX(batch, xR, xC, "+d+" + 1),\n                  getX(batch, xR, xC, "+d+" + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, "+d+", xR, xC),\n                  getX(batch, "+d+" + 1, xR, xC),\n                  getX(batch, "+d+" + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        "+x+"\n        "+b+"\n        setOutput(result);\n      }\n    "},au=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterDepth,f=e.filterHeight,d=e.filterWidth,p=4*Math.floor(e.inChannels/4),h=e.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3("+o+", "+i+", "+a+");\n      const ivec3 pads = ivec3("+t+", "+n+", "+r+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+c+"; wF++) {\n          int xF = xFCorner + wF * "+s+";\n\n          if (xF < 0 || xF >= "+e.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+f+"; wR++) {\n            int xR = xRCorner + wR * "+u+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+d+"; wC++) {\n              int xC = xCCorner + wC * "+l+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < "+p+"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if ("+(1===h)+") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, "+p+") *\n                  getW(wF, wR, wC, "+p+", d2);\n              } else if ("+(2===h)+") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, "+p+"),\n                  getX(batch, xF, xR, xC, "+p+" + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, "+p+", d2),\n                  getW(wF, wR, wC, "+p+" + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if ("+(3===h)+") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, "+p+"),\n                  getX(batch, xF, xR, xC, "+p+" + 1),\n                  getX(batch, xF, xR, xC, "+p+" + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, "+p+", d2),\n                  getW(wF, wR, wC, "+p+" + 1, d2),\n                  getW(wF, wR, wC, "+p+" + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},su=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var o=e.inHeight,i=e.inWidth,a=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,f=e.dilationWidth,d=e.filterHeight,p=e.filterWidth,h=e.outChannels/e.inChannels,v="",m="";n&&(v=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",m="result = activation(result);");var g=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+v+"\n\n      const ivec2 strides = ivec2("+u+", "+l+");\n      const ivec2 pads = ivec2("+a+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+h+";\n        int q = d2 - d1 * "+h+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+d+"; wR++) {\n          int xR = xRCorner + wR * "+c+";\n\n          if (xR < 0 || xR >= "+o+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+p+"; wC++) {\n            int xC = xCCorner + wC * "+f+";\n\n            if (xC < 0 || xC >= "+i+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        "+g+"\n        "+m+"\n        setOutput(result);\n      }\n    "},uu=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var o=e.inHeight,i=e.inWidth,a=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,f=e.dilationWidth,d=e.filterHeight,p=e.filterWidth,h=p,v="int xR; int xC; int xCOffset;",m=0;m<d;m++)for(var g=0;g<p;g++)v+="\n          vec4 xTexelR"+m+"C"+2*g+" = vec4(0.);\n          vec4 wR"+m+"C"+g+" = vec4(0.);\n          vec4 xR"+m+"C"+g+" = vec4(0.);";for(m=0;m<d;m++)for(var y=0;y<h;y++){if(v+="\n          xR = xRCorner + "+m*c+";\n          xC = xCCorner + "+(g=2*y)*f+";\n        ",1===l){if(g<p&&(v+=s%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < "+o+" && xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+m+"C"+g+" = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+i+") {\n                    xTexelR"+m+"C"+g+".zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR"+m+"C"+g+" = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < "+o+" && xCOffset >= 0 && xCOffset < "+i+") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+i+") {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR"+m+"C"+g+" = vec4(previous.zw, xTexelR"+m+"C"+g+".xy);\n                } else {\n                  xR"+m+"C"+g+" = vec4(0, 0, xTexelR"+m+"C"+g+".xy);\n                }\n              ":"\n                if(xR >= 0 && xR < "+o+" && xC >= 0 && xC < "+i+") {\n                  xTexelR"+m+"C"+g+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+m+"C"+g+" = vec4(0.);\n                }\n\n                xR"+m+"C"+g+" = xTexelR"+m+"C"+g+";\n              ",g+1<p)){var b=s%2==0?bn(f):f;f%2==0&&s%2==1||f%2!=0&&s%2!=1?(v+="\n                  xCOffset = xC + "+s%2+" + "+b+";\n\n                  if(xR >= 0 && xR < "+o+" &&\n                    xCOffset >= 0 && xCOffset < "+i+") {\n                    xTexelR"+m+"C"+(g+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n                ",f>1&&(v+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < "+o+" &&\n                      xCOffset >= 0 && xCOffset < "+i+") {\n                      xTexelR"+m+"C"+g+" = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR"+m+"C"+g+" = vec4(0.);\n                    }\n                  "),v+="\n                  xR"+m+"C"+(g+1)+" = vec4(\n                    xTexelR"+m+"C"+g+".zw, xTexelR"+m+"C"+(g+2)+".xy);\n                "):v+="\n                  xCOffset = xC + "+b+";\n\n                  if(xR >= 0 && xR < "+o+" &&\n                    xCOffset >= 0 && xCOffset < "+i+") {\n                    xTexelR"+m+"C"+(g+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR"+m+"C"+(g+1)+" = xTexelR"+m+"C"+(g+2)+";\n                "}}else g<p&&(v+="\n              if(xR >= 0 && xR < "+o+") {\n            ",s%2==1?(v+="\n                xCOffset = xC + 1 - "+l+";\n                if(xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+m+"C"+g+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+m+"C"+g+" = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < "+i+") {\n                  xTexelR"+m+"C"+(g+2)+" = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR"+m+"C"+(g+2)+" = vec4(0.);\n                }\n\n                xR"+m+"C"+g+" = vec4(\n                  xTexelR"+m+"C"+g+".zw, xTexelR"+m+"C"+(g+2)+".zw);\n              ",g+1<p&&(v+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + "+l+";\n                  if(xCOffset >= 0 && xCOffset < "+i+") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR"+m+"C"+(g+1)+" = vec4(xTexelR"+m+"C"+(g+2)+".xy, final.xy);\n                ")):(v+="\n                if(xC >= 0 && xC < "+i+") {\n                  xTexelR"+m+"C"+g+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+m+"C"+g+" = vec4(0.);\n                }\n\n                xCOffset = xC + "+l+";\n                if(xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+m+"C"+(g+2)+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+m+"C"+(g+2)+" = vec4(0.);\n                }\n\n                xR"+m+"C"+g+" = vec4(\n                  xTexelR"+m+"C"+g+".xy, xTexelR"+m+"C"+(g+2)+".xy);\n              ",g+1<p&&(v+="\n                  xR"+m+"C"+(g+1)+" = vec4(\n                    xTexelR"+m+"C"+g+".zw, xTexelR"+m+"C"+(g+2)+".zw);\n                ")),v+="}");g<p&&(v+="\n            vec4 wTexelR"+m+"C"+g+" = getW("+m+", "+g+", d1, q);\n            wR"+m+"C"+g+" = vec4(wTexelR"+m+"C"+g+".xz, wTexelR"+m+"C"+g+".xz);\n          ",g+1<p&&(v+="\n              vec4 wTexelR"+m+"C"+(g+1)+" = getW("+m+", "+(g+1)+", d1, q);\n              wR"+m+"C"+(g+1)+" =\n                vec4(wTexelR"+m+"C"+(g+1)+".xz, wTexelR"+m+"C"+(g+1)+".xz);"))}for(m=0;m<d;m++)for(g=0;g<p;g++)v+="dotProd += xR"+m+"C"+g+" * wR"+m+"C"+g+";";var x="",w="";n&&(x=r?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"vec4 activation(vec4 x) {\n          "+n+"\n        }",w="result = activation(result);");var C=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+x+"\n\n      const ivec2 strides = ivec2("+u+", "+l+");\n      const ivec2 pads = ivec2("+a+", "+s+");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        "+v+"\n\n        vec4 result = dotProd;\n        "+C+"\n        "+w+"\n        setOutput(result);\n      }\n    "},lu=function(e,t,n,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=e[0],a=e[1],s=e[2],u=e[3],l=t[0],c=n[0],f=n[1];this.outputShape=[l,c,f,u];var d="bilinear"===r?1:0,p=[a-1+".0",s-1+".0"],h=p[0],v=p[1],m=c>1?[""+(a-1)/(c-1),"(y2-y1) * height_ratio","y1*"+h+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+h],g=m[0],y=m[1],b=m[2],x=f>1?[""+(s-1)/(f-1),"(x2-x1) * width_ratio","x1*"+v+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+v],w=x[0],C=x[1],E=x[2];this.userCode="\n      const float height_ratio = float("+g+");\n      const float width_ratio = float("+w+");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= "+i+") {\n          return;\n        }\n\n        float height_scale = "+y+";\n        float width_scale = "+C+";\n\n        float in_y = "+b+";\n        if( in_y < 0.0 || in_y > "+h+" ) {\n          setOutput(float("+o+"));\n          return;\n        }\n        float in_x = "+E+";\n        if( in_x < 0.0 || in_x > "+v+" ) {\n          setOutput(float("+o+"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if("+d+" == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    "},cu=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var r=e.length,o=e[e.length-1],i=n?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(n?"return "+o+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+Ds(r)+" coords = getOutputCoords();\n        int end = "+fu(r,"coords")+";\n        float val = 0.0;\n        for (int i = "+o+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+i+" end) {\n            continue;\n          }\n          if (idx == end && "+t+") {\n            continue;\n          }\n          "+fu(r,"coords")+" = idx;\n          val += getX("+function(e,t){if(1===e)return""+t;if(2===e)return t+".x, "+t+".y";if(3===e)return t+".x, "+t+".y, "+t+".z";if(4===e)return t+".x, "+t+".y, "+t+".z, "+t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}(r,"coords")+");\n        }\n        setOutput(val);\n      }\n    "};function fu(e,t){if(1===e)return""+t;if(2===e)return t+".y";if(3===e)return t+".z";if(4===e)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var du=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Or.DENSE;var t=jr(e),n=ys();this.outputShape=e,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+bs(["r","c","d"],e)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+t[0]+", "+t[1]+"));\n        int index = 4 * (resTexRC.x * "+t[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        "+n.output+" = result;\n      }\n    "},pu=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Or.DENSE;var t=jr(e),n=ys();this.outputShape=e,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+bs(["r","c","d"],e)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+t[0]+", "+t[1]+"));\n        int index = 4 * (resTexRC.x * "+t[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        "+n.output+" = result;\n      }\n    "},hu=function(){function e(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = "+this.getHeightCoordString()+";\n      int w = "+this.getWidthCoordString()+";\n      int d = "+this.getDepthCoordString()+";\n\n      int in_h = h / "+t+";\n      int offset_h = imod(h, "+t+");\n      int in_w = w / "+t+";\n      int offset_w = imod(w, "+t+");\n      int offset_d = (offset_h * "+t+" + offset_w) *\n        "+this.getOutputDepthSize()+";\n      int in_d = d + offset_d;\n\n      float result = "+this.getInputSamplingString()+";\n      setOutput(result);\n    }\n  "}return e.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),vu=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "},mu=function(e){this.variableNames=["A"],this.outTexUsage=Fr.DOWNLOAD;var t=ys();this.outputShape=e,this.userCode="\n      "+ws+"\n\n      void main() {\n        float x = getAAtOutCoords();\n        "+t.output+" = encode_float(x);\n      }\n    "},gu=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Fr.DOWNLOAD;var t=ys();this.outputShape=e,this.userCode="\n      "+ws+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        "+t.output+" = encode_float(x);\n      }\n    "},yu=function(e,t,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=ys(),o=t[0],i=t[1];this.outputShape=e;var a="result";n&&(a="floor(result * 255. + 0.5)"),this.userCode="\n      "+xs(e)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / "+i+";\n        int c = imod(flatIndex, "+i+");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2("+i+".0, "+o+".0);\n        vec4 values = "+r.texture2D+"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        "+r.output+" = vec4("+a+", 0., 0., 0.);\n      }\n    "},bu=function(e,t,n){void 0===n&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=ys(),o=t[0],i=t[1];this.outputShape=e;var a="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var l=0;l<=1;l++){var c=2*u+l;a+="\n          localCoords = coords;\n          if(localCoords[2] + "+l+" < "+e[2]+") {\n            localCoords[2] += "+l+";\n            if(localCoords[1] + "+u+" < "+e[1]+") {\n              localCoords[1] += "+u+";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / "+i+";\n              c = imod(flatIndex, "+i+");\n              uv = (vec2(c, r) + halfCR) / vec2("+i+".0, "+o+".0);\n              values = "+r.texture2D+"(A, uv);\n\n              if(offset == 0) {\n                result["+c+"] = values[0];\n              } else if(offset == 1) {\n                result["+c+"] = values[1];\n              } else if(offset == 2) {\n                result["+c+"] = values[2];\n              } else {\n                result["+c+"] = values[3];\n              }\n            }\n          }\n        "}this.userCode="\n      "+xs(e)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        "+a+"\n\n        "+r.output+" = "+s+";\n      }\n    "},xu=function(e,t,n){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var o=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=n?r+".0":"1.0";this.userCode="\n      const float exponentMultiplier = "+o+";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        "+e+"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float("+r+");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < "+r+"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / "+i+";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    "},wu=function(){function e(e,t){this.outputShape=[],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;return function(n,r){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(t.valueLoc,e)}},e}(),Cu=function(e,t,n){this.variableNames=["A","indices"];var r=e.slice();r[n]=t,this.outputShape=r,this.rank=r.length;var o=Ds(this.rank),i=function(e,t){var n=e.length;if(n>4)throw Error("Gather for rank "+n+" is not yet supported");if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],i=0;i<e.length;i++)i===t?o.push("int(getIndices("+r[i]+"))"):o.push(""+r[i]);return o.join()}(e,n);this.userCode="\n      void main() {\n        "+o+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},Eu=function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var r=Ds(t.length),o=Ds(n.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode="\n        "+r+" strides = "+r+"("+this.strides+");\n         void main() {\n          "+o+" coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < "+this.sliceDim+"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * "+i+";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      "};function Su(e,t){var n=ys();return Yr(e,t,n.version+"\n    precision highp float;\n    "+n.attribute+" vec3 clipSpacePos;\n    "+n.attribute+" vec2 uv;\n    "+n.varyingVs+" vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function ku(e,t){return oo(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function _u(e,t){return io(e,t,new Uint16Array([0,1,2,2,1,3]))}function Ru(e,t,n,r,o,i,a){so(n,r);var s=ao(e,t),u=e.TEXTURE_2D;return qr(e,t,(function(){return e.bindTexture(u,s)})),qr(e,t,(function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)})),qr(e,t,(function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)})),qr(e,t,(function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)})),qr(e,t,(function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)})),qr(e,t,(function(){return e.texImage2D(u,0,o,n,r,0,i,a,null)})),qr(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)})),s}function Iu(e,t,n,r,o){var i=Ur(n,r);return Ru(e,t,i[0],i[1],o.internalFormatFloat,o.textureFormatFloat,e.FLOAT)}function Tu(e,t,n,r,o){var i=Ur(n,r);return Ru(e,t,i[0],i[1],o.internalFormatHalfFloat,o.textureFormatFloat,o.textureTypeHalfFloat)}function Au(e,t,n,r,o){var i=Ur(n,r);return Ru(e,t,i[0],i[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function Du(e,t,n,r,o){var i=Hr(n,r);return Ru(e,t,i[0],i[1],o.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function Nu(e,t,n,r,o){var i=Hr(n,r);return Ru(e,t,i[0],i[1],o.internalFormatPackedHalfFloat,e.RGBA,o.textureTypeHalfFloat)}function Pu(e,t,n,r){return qr(e,t,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),lo(e,t,n,"clipSpacePos",r,3,20,0)&&lo(e,t,n,"uv",r,2,20,12)}function Mu(e,t,n,r,o,i,a){var s,u,l;qr(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,n)})),i instanceof Uint8Array?(s=new Uint8Array(r*o*4),u=e.UNSIGNED_BYTE,l=e.RGBA):(s=new Float32Array(r*o*4),u=e.FLOAT,l=a.internalFormatPackedFloat),s.set(i),qr(e,t,(function(){return e.texImage2D(e.TEXTURE_2D,0,l,r,o,0,e.RGBA,u,s)})),qr(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}function Ou(e,t,n,r){qr(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,n)})),r.data instanceof Uint8Array?qr(e,t,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)})):qr(e,t,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)})),qr(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}function Fu(e,t,n,r,o){var i=e.createBuffer();qr(e,t,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,i)}));var a=16*n*r;return qr(e,t,(function(){return e.bufferData(e.PIXEL_PACK_BUFFER,a,e.STREAM_READ)})),qr(e,t,(function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,0)})),qr(e,t,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)})),i}function Lu(e,t,n){var r=e,o=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,o),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),o}function Bu(e,t,n,r,o){var i=Ur(n,r),a=i[0],s=i[1],u=new Uint8Array(n*r*4);return qr(e,t,(function(){return e.readPixels(0,0,a,s,o.downloadTextureFormat,e.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}function zu(e,t,n,r,o,i,a,s){var u=e,l=new Float32Array(function(e,t){var n=Hr(e,t);return n[0]*n[1]*4}(i,a));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function Wu(e,t,n,r){var o=new Float32Array(n*r*4);return qr(e,t,(function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,o)})),o}var Vu=Object.freeze({createVertexShader:Su,createVertexBuffer:ku,createIndexBuffer:_u,createFloat32MatrixTexture:Iu,createFloat16MatrixTexture:Tu,createUnsignedBytesMatrixTexture:Au,createPackedMatrixTexture:Du,createFloat16PackedMatrixTexture:Nu,bindVertexProgramAttributeStreams:Pu,uploadDenseMatrixToTexture:Mu,uploadPixelDataToTexture:Ou,createBufferFromOutputTexture:Fu,downloadFloat32MatrixFromBuffer:Lu,downloadByteEncodedFloatMatrixFromOutputTexture:Bu,downloadPackedMatrixFromBuffer:zu,downloadMatrixFromPackedOutputTexture:Wu}),Uu=function(){function e(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var t=un().getNumber("WEBGL_VERSION");null!=e?(this.gl=e,Wr(t,e)):this.gl=Vr(t);var n="WEBGL_color_buffer_float";if(1===un().getNumber("WEBGL_VERSION")){if(this.textureFloatExtension=$r(this.gl,this.debug,"OES_texture_float"),Ao(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=$r(this.gl,this.debug,"OES_texture_half_float");else if(un().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),Ao(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=$r(this.gl,this.debug,"EXT_color_buffer_half_float");else if(un().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",Ao(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!Ao(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=ku(this.gl,this.debug),this.indexBuffer=_u(this.gl,this.debug),this.framebuffer=uo(this.gl,this.debug),this.textureConfig=Gr(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return un().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;qr(t,this.debug,(function(){return t.finish()})),qr(t,this.debug,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),qr(t,this.debug,(function(){return t.deleteFramebuffer(e.framebuffer)})),qr(t,this.debug,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),qr(t,this.debug,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),qr(t,this.debug,(function(){return t.deleteBuffer(e.indexBuffer)})),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(e,t){return this.throwIfDisposed(),Iu(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(e,t){return this.throwIfDisposed(),Tu(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(e,t){return this.throwIfDisposed(),Au(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(e,t){this.throwIfDisposed(),Ou(this.gl,this.debug,e,t)},e.prototype.uploadDenseMatrixToTexture=function(e,t,n,r){this.throwIfDisposed(),Mu(this.gl,this.debug,e,t,n,r,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(e,t){return this.throwIfDisposed(),Nu(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(e,t){return this.throwIfDisposed(),Du(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.deleteMatrixTexture=function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(mo(this.gl,this.debug,this.framebuffer),this.outputTexture=null),qr(this.gl,this.debug,(function(){return t.gl.deleteTexture(e)}))},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return Bu(r.gl,r.debug,t,n,r.textureConfig)}))},e.prototype.downloadPackedMatrixFromBuffer=function(e,t,n,r,o,i){return zu(this.gl,e,0,0,0,o,i,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(e,t){return Lu(this.gl,e,t)},e.prototype.createBufferFromTexture=function(e,t,n){this.bindTextureToFrameBuffer(e);var r=Fu(this.gl,this.debug,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r},e.prototype.createAndWaitForFence=function(){var e=this.createFence(this.gl);return this.pollFence(e)},e.prototype.createFence=function(e){var t,n,r=this;if(un().getBool("WEBGL_FENCE_API_ENABLED")){var o=e,i=o.fenceSync(o.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var e=o.clientWaitSync(i,0,0);return e===o.ALREADY_SIGNALED||e===o.CONDITION_SATISFIED},t=i}else un().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(t,un().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:t,isFencePassed:n}},e.prototype.downloadMatrixFromPackedTexture=function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return Wu(r.gl,r.debug,t,n)}))},e.prototype.createProgram=function(e){this.throwIfDisposed();var t=this.gl,n=Qr(t,this.debug,e),r=Su(t,this.debug),o=to(t,this.debug);return qr(t,this.debug,(function(){return t.attachShader(o,r)})),qr(t,this.debug,(function(){return t.attachShader(o,n)})),no(t,this.debug,o),this.debug&&ro(t,this.debug,o),this.vertexAttrsAreBound||(this.setProgram(o),this.vertexAttrsAreBound=Pu(t,this.debug,this.program,this.vertexBuffer)),o},e.prototype.deleteProgram=function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&qr(this.gl,this.debug,(function(){return t.gl.deleteProgram(e)}))},e.prototype.setProgram=function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&ro(this.gl,this.debug,this.program),qr(this.gl,this.debug,(function(){return t.gl.useProgram(e)}))},e.prototype.getUniformLocation=function(e,t,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?fo(this.gl,this.debug,e,t):po(this.gl,e,t)},e.prototype.getAttributeLocation=function(e,t){var n=this;return this.throwIfDisposed(),qr(this.gl,this.debug,(function(){return n.gl.getAttribLocation(e,t)}))},e.prototype.getUniformLocationNoThrow=function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)},e.prototype.setInputMatrixTexture=function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),ho(this.gl,this.debug,this.program,e,t,n)},e.prototype.setOutputMatrixTexture=function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)},e.prototype.setOutputPackedMatrixTexture=function(e,t,n){this.throwIfDisposed();var r=Hr(t,n),o=r[0],i=r[1];this.setOutputMatrixTextureDriver(e,o,i)},e.prototype.setOutputMatrixWriteRegion=function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)},e.prototype.setOutputPackedMatrixWriteRegion=function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){null!=this.program&&ro(this.gl,this.debug,this.program),go(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),qr(e,this.debug,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))},e.prototype.blockUntilAllProgramsCompleted=function(){var e=this;this.throwIfDisposed(),qr(this.gl,this.debug,(function(){return e.gl.finish()}))},e.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=$r(this.gl,this.debug,2===un().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(2===un().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),o=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,o),o},e.prototype.endQuery=function(){if(2!==un().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(e){return rn(this,void 0,void 0,(function(){var t=this;return on(this,(function(n){switch(n.label){case 0:return[4,Dn((function(){return t.disposed||t.isQueryAvailable(e,un().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}))];case 1:return n.sent(),[2,this.getQueryTime(e,un().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}}))}))},e.prototype.getQueryTime=function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),o=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),o&&!this.disjoint}return o=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),o&&!this.disjoint},e.prototype.pollFence=function(e){var t=this;return new Promise((function(n){t.addItemToPoll((function(){return e.isFencePassed()}),(function(){return n()}))}))},e.prototype.pollItems=function(){for(var e=function(e){for(var t=0;t<e.length&&e[t]();++t);return t-1}(this.itemsToPoll.map((function(e){return e.isDoneFn}))),t=0;t<=e;++t)(0,this.itemsToPoll[t].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(e+1)},e.prototype.addItemToPoll=function(e,t){var n=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||Dn((function(){return n.pollItems(),0===n.itemsToPoll.length}))},e.prototype.bindTextureToFrameBuffer=function(e){this.throwIfDisposed(),vo(this.gl,this.debug,e,this.framebuffer),this.debug&&go(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(vo(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&go(this.gl)):mo(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n},e.prototype.setOutputMatrixTextureDriver=function(e,t,n){this.throwIfDisposed();var r=this.gl;vo(r,this.debug,e,this.framebuffer),this.debug&&go(r),this.outputTexture=e,qr(r,this.debug,(function(){return r.viewport(0,0,t,n)})),qr(r,this.debug,(function(){return r.scissor(0,0,t,n)}))},e.prototype.setOutputMatrixWriteRegionDriver=function(e,t,n,r){var o=this;this.throwIfDisposed(),qr(this.gl,this.debug,(function(){return o.gl.scissor(e,t,n,r)}))},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},e}();function ju(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach((function(e,n){var r=e.logicalShape,o=t[n],i=o.shape;if(!_n(r,i))throw Error("Binary was compiled with different shapes than the current args. Shapes "+r+" and "+i+" must match");if(!e.isUniform||!o.isUniform){var a=e.texShape,s=o.isUniform?null:o.texData.texShape;if(!_n(a,s))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+a+" and "+s+" must match")}}))}var Hu=function(e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var r=n.filterWidth,o=n.inChannels,i=n.strideWidth,a=n.strideHeight,s=n.padInfo,u=n.outWidth,l=n.dilationWidth,c=n.dilationHeight,f=n.dataFormat,d=s.left,p=s.top,h=o*r,v=ys(),m="channelsLast"===f,g=m?0:1,y=m?1:2,b="",x=0;x<=1;x++)for(var w=0;w<=1;w++)b+="\n          blockIndex = rc.y + "+w+";\n          pos = rc.x + "+x+";\n\n          if(blockIndex < "+e[1]+" && pos < "+e[0]+") {\n            offsetY = int(blockIndex / ("+u+")) * "+a+" - "+p+";\n            d0 = offsetY + "+c+" * (pos / "+h+");\n\n            if(d0 < "+t[g]+" && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), "+u+".) * "+i+". - "+d+".);\n              d1 = offsetX + "+l+" * (int(mod(float(pos), "+h+".) / "+o+".));\n\n              if(d1 < "+t[y]+" && d1 >= 0) {\n\n                ch = int(mod(float(pos), "+o+".));\n\n                if ("+m+") {\n                  innerDims = vec2(d1, ch);\n                  result["+(2*x+w)+"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result["+(2*x+w)+"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ";this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        "+b+"\n\n        "+v.output+" = result;\n      }\n    "},Gu=function(e,t,n,r,o){this.variableNames=["x"],this.outputShape=[];var i,a=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";i=.5===o?"inversesqrt("+u+")":1===o?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+a+"; j <= "+a+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+s+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+i+";\n        setOutput(val);\n      }\n    "},qu=function(e,t,n,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=o,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < "+this.depth+"; ++d) {\n          int depthBegin = int(max(0.0, float(d - "+t+")));\n          int depthEnd = int(min(float("+this.depth+"),\n              float(d + "+t+" + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = "+this.depth+";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float("+r+") * norm + float("+n+");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float("+r+")\n                * float("+o+")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * "+o+");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    "},Ku=function(e,t,n,r,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,a=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";i=.5===o?"inversesqrt("+u+")":1===o?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < "+this.outputShape[3]+";\n        bool hasNextRow = c < "+this.outputShape[2]+";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - "+a+";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - "+a+"; j <= "+a+"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2("+s+"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * "+i+";\n        setOutput(result);\n      }\n    "},Xu=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,o=e.effectiveFilterHeight,i=e.effectiveFilterWidth,a=o-1-e.padInfo.top,s=i-1-e.padInfo.left,u=o*i-1;this.userCode="\n      const ivec2 pads = ivec2("+a+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+o+";\n          wR += "+r+") {\n          float dyR = float(dyRCorner + wR) / "+t+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+i+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+n+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+u+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+i+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},$u=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,o=e.dilationDepth,i=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterDepth,u=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=s-1-e.padInfo.front,f=u-1-e.padInfo.top,d=l-1-e.padInfo.left,p=s*u*l-1;this.userCode="\n      const ivec3 pads = ivec3("+c+", "+f+", "+d+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+s+";\n           wD += "+o+") {\n          float dyD = float(dyDCorner + wD) / "+t+".0;\n\n          if (dyD < 0.0 || dyD >= "+e.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+i+") {\n            float dyR = float(dyRCorner + wR) / "+n+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+l+";\n                wC += "+a+") {\n              float dyC = float(dyCCorner + wC) / "+r+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = "+p+" -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * "+u+" * "+l+" +\n                  wR * "+l+" + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Yu=function(e,t,n,r,o,i,a){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===i&&(i=null),void 0===a&&(a=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var s=n?e[1]:e[2],u=Math.ceil(s/2),l=n?"i * 2, rc.y":"rc.y, i * 2",c=r?"rc.z, i * 2":"i * 2, rc.z",f=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],d=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],p="",h="";i&&(p=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+i+"\n        }":"vec4 activation(vec4 x) {\n          "+i+"\n        }",h="result = activation(result);");var v=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+p+"\n\n      const float sharedDimension = "+u+".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < "+u+"; i++) {\n          vec4 a = getMatrixA(rc.x, "+l+");\n          vec4 b = getMatrixB(rc.x, "+c+");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += ("+f[0]+" * "+d[0]+");\n          result += ("+f[1]+" * "+d[1]+");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        "+v+"\n\n        "+h+"\n\n        setOutput(result);\n      }\n    "},Qu=function(){function e(e,t,n){this.variableNames=["probs"],this.outputShape=[e,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(t-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(t-1)+"));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;return function(n,r){null==t.seedLoc&&(t.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(t.seedLoc,e)}},e}(),Ju=function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+n+"),\n                      float(index == coords.y)));\n      }\n    "},Zu=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var t=e.length;if(0===t)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var n=gs("rc",t),r=Ds(t),o=function(e,t,n){if(1===e)return"rc > "+t[0];for(var r="",o=e-2;o<e;o++)r+=n[o]+" >= "+t[o],o<e-1&&(r+="||");return r}(t,e,n),i=function(e,t,n,r){if(1===e)return"";var o=r.slice(-2);return"\n    int r = "+o[0]+";\n    int c = "+o[1]+";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= "+t+";\n    bool rEdge = rp1 >= "+n+";\n  "}(t,e[e.length-1],e[e.length-2],n),a=function(e,t){var n=e.length,r=function(e,t){for(var n=[],r=0;r<=1;r++)for(var o=0;o<=1;o++){for(var i=(0===r?"r":"rp1")+", "+(0===o?"c":"cp1"),a=2;a<e;a++)i=t[t.length-1-a]+","+i;n.push(i)}return n}(n,t);return 1===n?"getA(rc),\n            rc + 1 >= "+e[0]+" ? 0. : getA(rc + 1),\n            0, 0":"getA("+r[0]+"),\n          cEdge ? 0. : getA("+r[1]+"),\n          rEdge ? 0. : getA("+r[2]+"),\n          rEdge || cEdge ? 0. : getA("+r[3]+")"}(e,n);this.userCode="\n        void main() {\n          "+r+" rc = getOutputCoords();\n\n          if("+o+") {\n            setOutput(vec4(0));\n          } else {\n            "+i+"\n\n            setOutput(vec4("+a+"));\n          }\n        }\n      "}},el=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map((function(t,n){return t[0]+e[n]+t[1]}));var r=e.length,o=Ds(r),i=t.map((function(e){return e[0]})).join(","),a=t.map((function(t,n){return t[0]+e[n]})).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      "+o+" start = "+o+"("+i+");\n      "+o+" end = "+o+"("+a+");\n\n      void main() {\n        "+o+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+n+"));\n        } else {\n          "+o+" coords = outC - start;\n          setOutput(getX("+s+"));\n        }\n      }\n    ":"\n        int start = "+i+";\n        int end = "+a+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+n+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "},tl=function(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((function(t,n){return t[0]+e[n]+t[1]}));for(var r=e.length,o=Ds(r),i=t.map((function(e){return e[0]})).join(","),a=t.map((function(t,n){return t[0]+e[n]})).join(","),s=gs("rc",r),u=gs("source",r),l=s[r-1]+" < "+this.outputShape[r-1],c=1===r?"source":"vec2("+u.slice(-2).join()+")",f=[o+" rc = outputLoc;",s[r-1]+" += 1;\n       if("+l+") {\n      ",1===r?"":"}\n       rc = outputLoc;\n       "+s[r-2]+" += 1;\n       if("+s[r-2]+" < "+this.outputShape[r-2]+") {",1===r?"":"  "+s[r-1]+" += 1;\n         if("+l+") {"],d=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",p="",h=0,v=1===r?2:4;h<v;h++)p+="\n        "+f[h]+"\n        if ("+d+") {\n          result["+h+"] = float("+n+");\n        } else {\n          "+o+" source = rc - start;\n          result["+h+"] = getChannel(getX("+u.join()+"), "+c+");\n        }\n      ";p+=1===r?"} ":"}}",this.userCode="\n      const "+o+" start = "+o+"("+i+");\n      const "+o+" end = "+o+"("+a+");\n\n      void main() {\n        "+o+" outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        "+p+"\n        setOutput(result);\n      }\n    "},nl=function(e,t,n){if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,o=e.strideHeight,i=e.strideWidth,a=e.dilationHeight,s=e.dilationWidth,u=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=e.padInfo.top,f=e.padInfo.left;this.outputShape=e.outShape;var d="avg"===t,p="0.0";if(d||(p="-1.0 / 1e-20"),n)this.userCode="\n        const ivec2 strides = ivec2("+o+", "+i+");\n        const ivec2 pads = ivec2("+c+", "+f+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+a+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+l+";\n                wC += "+s+") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+l+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var h=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(h="avgValue / count");var v=4*Math.floor(r/4),m=r%4,g="\n      if ("+d+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+o+", "+i+");\n      const ivec2 pads = ivec2("+c+", "+f+");\n      const float initializationValue = "+p+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+e.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+p+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+u+";\n            wR += "+a+") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+v+"; wC += 4) {\n            int xC = xCCorner + wC * "+s+";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              getValue(batch, xR, xC + 3 * "+s+", d)\n            );\n\n            "+g+"\n          }\n\n          int xC = xCCorner + "+v+";\n          if ("+(1===m)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+g+"\n          } else if ("+(2===m)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+g+"\n          } else if ("+(3===m)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              initializationValue\n            );\n\n            "+g+"\n          }\n        }\n        setOutput("+h+");\n      }\n    "}},rl=function(e,t,n){if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,f=e.effectiveFilterHeight,d=e.effectiveFilterWidth,p=e.padInfo.front,h=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;var m="avg"===t,g="0.0";if(m||(g="-1.0 / 1e-20"),n)this.userCode="\n        const ivec3 strides =\n            ivec3("+o+", "+i+", "+a+");\n        const ivec3 pads = ivec3("+p+", "+h+", "+v+");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < "+c+";\n              wD += "+s+") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= "+e.inDepth+") {\n              continue;\n            }\n\n            for (int wR = 0; wR < "+f+";\n                wR += "+u+") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= "+e.inHeight+") {\n                continue;\n              }\n\n              for (int wC = 0; wC < "+d+";\n                  wC += "+l+") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= "+e.inWidth+") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition =\n                      wD * "+f+" * "+d+" +\n                      wR * "+d+" + wC;;\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var y=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(y="avgValue / count");var b=4*Math.floor(r/4),x=r%4,w="\n      if ("+m+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec3 strides =\n        ivec3("+o+", "+i+", "+a+");\n      const ivec3 pads = ivec3("+p+", "+h+", "+v+");\n      const float initializationValue = "+g+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= "+e.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+g+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < "+c+";\n            wD += "+s+") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= "+e.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+f+";\n            wR += "+u+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+b+"; wC += 4) {\n              int xC = xCCorner + wC * "+l+";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+l+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+l+", ch),\n                getValue(batch, xD, xR, xC + 3 * "+l+", ch)\n              );\n\n              "+w+"\n            }\n\n            int xC = xCCorner + "+b+";\n            if ("+(1===x)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              "+w+"\n            } else if ("+(2===x)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+l+", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              "+w+"\n            } else if ("+(3===x)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+l+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+l+", ch),\n                initializationValue\n              );\n\n              "+w+"\n            }\n          }\n          setOutput("+y+");\n        }\n      }\n    "}},ol=function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,o=e.inSize,i=Math.ceil(o/n);this.outputShape=[r,i];var a="0.0",s="";"prod"===t?a="1.0":"min"===t?(a="1.0 / 1e-20",s="min"):"max"===t&&(a="-1.0 / 1e-20",s="max");var u=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===t?u="sumValue":"prod"===t?u="prodValue":"all"===t?u="allValue":"any"===t&&(u="anyValue");var l=4*Math.floor(n/4),c=n%4,f="\n      if ("+("sum"===t)+") {\n        sumValue += dot(values, ones);\n      } else if ("+("prod"===t)+") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = "+s+"(values, minMaxValue);\n      }\n    ",d="vec4";"all"===t?(a="1.0",f="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===t&&(a="0.0",f="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");var p="";o%n>0&&(p="\n        if (inIdx < 0 || inIdx >= "+o+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+a+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+p+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+n+";\n\n        vec4 minMaxValue = vec4("+a+");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < "+l+"; i += 4) {\n          int inIdx = inOffset + i;\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+f+"\n        }\n\n        int inIdx = inOffset + "+l+";\n        if ("+(1===c)+") {\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          "+f+"\n        } else if ("+(2===c)+") {\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          "+f+"\n        } else if ("+(3===c)+") {\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          "+f+"\n        }\n        setOutput("+u+");\n      }\n    "},il=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n="",r=0;r<4;r++){var o="thisRC = rc;";r%2==1&&(o+="thisRC.z += 1;"),r>1&&(o+="thisRC.y += 1;"),n+="\n        "+o+"\n        "+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+"\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result["+r+"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        "+(r>0?"}":"")+"\n      "}this.userCode="\n      \n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      "+bs(["r","c","d"],t)+"\n      return ivec3(r, c, d);\n    }\n  \n      "+xs(e)+"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = "+e[1]+";\n        int cols = "+e[2]+";\n\n        "+n+"\n\n        setOutput(result);\n      }\n    "},al=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,o=r[1],i=r[2],a=e.shape,s=a[1],u=a[2],l=[n&&s>1?o-1:o,n&&u>1?i-1:i],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],f=l[0]/c[0],d=l[1]/c[1],p=1/f,h=1/d,v=2*Math.ceil(p)+2,m=2*Math.ceil(h)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+f+");\n        const float widthScale = float("+d+");\n\n        const float invHeightScale = float("+p+");\n        const float invWidthScale = float("+h+");\n\n        const int winHeight = int("+v+");\n        const int winWidth = int("+m+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(o-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(i-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},sl=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?a-1:a],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/l[0]+",\n          "+u[1]/l[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+a+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "},ul=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?a-1:a],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          "+u[0]/l[0]+",\n          "+u[1]/l[1]+",\n          "+u[1]/l[1]+");\n      const vec3 inputShapeRC = vec3("+i+".0, "+a+".0,\n                                     "+a+".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < "+(s-1)+";\n        bool hasNextRow = coords.z < "+(n-1)+";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    "},ll=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,o=r[1],i=r[2],a=e.shape,s=a[1],u=a[2],l=[n&&s>1?o-1:o,n&&u>1?i-1:i],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],f=l[0]/c[0],d=l[1]/c[1],p=1/f,h=1/d,v=2*Math.ceil(p)+2,m=2*Math.ceil(h)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+f+");\n        const float widthScale = float("+d+");\n\n        const float invHeightScale = float("+p+");\n        const float invWidthScale = float("+h+");\n\n        const int winHeight = int("+v+");\n        const int winWidth = int("+m+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float("+l[0]+") *\n                (float(dyR) / float("+c[0]+"));\n\n            float sourceFracCol =\n                float("+l[1]+") *\n                  (float(dyC) / float("+c[1]+"));\n\n            int sourceNearestRow = int(min(\n                float(int("+o+") - 1),\n                "+n+" ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int("+i+") - 1),\n                "+n+" ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},cl=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?a-1:a],l=[r&&t>1?t-1:t,r&&n>1?n-1:n],c=r?"0.5":"0.0";this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/l[0]+",\n          "+u[1]/l[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+a+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+c+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "},fl=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,1!==n){var r=e.map((function(n,r){return function(n){return-1!==t.indexOf(n)&&1!==e[n]?e[n]+" - coords["+n+"] - 1":"coords["+n+"]"}(r)})).join(","),o=Ds(n);this.userCode="\n      void main() {\n        "+o+" coords = getOutputCoords();\n        setOutput(getX("+r+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+e[0]+" - coord - 1));\n        }\n      "},dl=function(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var r=gs("rc",n),o=r[n-1]+" + 1 < "+this.outputShape[n-1],i=r[n-2]+" + 1 < "+this.outputShape[n-2],a=Ds(n);function s(n){var r=e.map((function(r,o){return function(n,r){return-1!==t.indexOf(n)&&1!==e[n]?e[n]+" - "+r[n]+" - 1":""+r[n]}(o,n)}));return"getChannel(getX("+r.join(",")+"), vec2("+r.slice(-2).join(",")+"))"}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX("+e[0]+" - rc - 1),\n            "+e[0]+" - rc - 1);\n          if("+o+"){\n              result.g = getChannel(getX("+e[0]+" - (rc  + 1) - 1),\n                "+e[0]+" - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      ":"\n        void main() {\n          "+a+" rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = "+function(e){return s(e)}(r.slice())+";\n          if("+o+"){\n            result.g = "+function(e){return e[n-1]="("+e[n-1]+" + 1)",s(e)}(r.slice())+";\n          }\n          if("+i+") {\n            result.b = "+function(e){return e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice())+";\n            if("+o+") {\n              result.a = "+function(e){return e[n-1]="("+e[n-1]+" + 1)",e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice())+";\n            }\n          }\n          setOutput(result);\n        }\n    "},pl=function(e,t,n,r,o,i,a){void 0===a&&(a=!0),this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var s=Ds(o.length),u=Ds(i.length),l="";1===n?l="i":2===n&&(l="i, j");var c="getIndices("+l+")",f="";1===r?f="i":2===r&&(f="i, coords[1]");var d="getUpdates("+f+")",p=t>1?"strides[j]":"strides";this.userCode="\n        "+s+" strides = "+s+"("+o+");\n\n        void main() {\n          "+u+" coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < "+e+"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < "+t+"; j++) {\n              int index = round("+c+");\n              flattenedIndex += index * "+p+";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += "+d+";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      "},hl=function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,r=e.batchSize,o=e.inSize,i=e.numSegments,a=i*Math.ceil(o/n);this.outputShape=[r,a];var s=4*Math.floor(n/4),u=n%4,l="\n        sumValue += dot(values, segFilter);\n    ",c="";o%n>0&&(c="\n        if (inIdx < 0 || inIdx >= "+o+") {\n          return initializationValue;\n        }\n      ");var f="";o%n>0&&(f="\n        if (inIdx < 0 || inIdx >= "+o+") {\n          return -1.0;\n        }\n      "),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        "+c+"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        "+f+"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          "+i+")) * float("+n+"));\n        int currentSeg = int(mod(float(outIdx), float("+i+")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+s+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          "+l+"\n        }\n\n        int inIdx = inOffset + "+s+";\n        if ("+(1===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          "+l+"\n        } else if ("+(2===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          "+l+"\n        } else if ("+(3===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          "+l+"\n        }\n        setOutput(sumValue);\n      }\n    "},vl=function(e,t,n){var r,o;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(1===n)o="resRC",r="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],s=[],u=0;u<t.length;u++)s.push(""+i[u]),u<e&&a.push(""+i[u]);r=a.join(),o=s.join()}var l=Ds(n);this.userCode="\n      void main() {\n        "+l+" resRC = getOutputCoords();\n        float cVal = getC("+r+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+o+"));\n        } else {\n          setOutput(getB("+o+"));\n        }\n      }\n    "},ml=function(){function e(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;var t,n=Ds(this.rank),r="uniform int start["+this.rank+"];",o=function(e){if(1===e)return"sourceLoc";if(e<=6)return gl.slice(0,e).map((function(e){return"sourceLoc."+e})).join(",");throw Error("Slicing for rank "+e+" is not yet supported")}(this.rank);t="\n        "+n+" sourceLoc;\n        "+n+" coords = getOutputCoords();\n        "+e.map((function(e,t){return"sourceLoc."+gl[t]+" = start["+t+"] + coords."+gl[t]+";"})).join("\n")+"\n      ",this.userCode="\n      "+r+"\n      void main() {\n        "+t+"\n        setOutput(getSource("+o+"));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}},e}(),gl=["x","y","z","w","u","v"],yl=function(){function e(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length;var t=Ds(this.rank),n=gs("coords",this.rank),r=gs("sourceLoc",this.rank),o=1===this.rank?"sourceLoc":"vec2("+r.slice(-2).join()+")",i="getChannel(getSource("+r.join()+"), "+o+")",a="\n      result.x = "+i+";\n      if (++"+n[this.rank-1]+" < "+e[this.rank-1]+") {\n        ++"+r[this.rank-1]+";\n        result.y = "+i+";\n        --"+r[this.rank-1]+";\n      }\n    ",s=1===this.rank?"":"\n      --"+n[this.rank-1]+";\n      if (++"+n[this.rank-2]+" < "+e[this.rank-2]+") {\n        ++"+r[this.rank-2]+";\n        result.z = "+i+";\n        if (++"+n[this.rank-1]+" < "+e[this.rank-1]+") {\n          ++"+r[this.rank-1]+";\n          result.w = "+i+";\n        }\n      }\n    ",u=this.rank<=4?"sourceLoc = coords +\n            "+t+"("+e.map((function(e,t){return"start["+t+"]"})).join()+");":e.map((function(e,t){return r[t]+" = "+n[t]+" + start["+t+"];"})).join("\n");this.userCode="\n      uniform int start["+this.rank+"];\n      void main() {\n        "+t+" coords = getOutputCoords();\n        "+t+" sourceLoc;\n        "+u+"\n        vec4 result = vec4(0.);\n        "+a+"\n        "+s+"\n        setOutput(result);\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}},e}(),bl=function(e,t,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,o=Ds(n.length),i=Ds(n.length),a="";if(1===r)a="coords * strides + begin";else{var s=0;a=n.map((function(e,t){return s++,1===n.length?"coords * strides["+t+"] + begin["+t+"]":"coords["+(s-1)+"] * strides["+t+"] + begin["+t+"]"})).join(",")}this.userCode="\n      "+o+" begin = "+o+"("+e+");\n      "+o+" strides = "+o+"("+t+");\n\n      void main() {\n        "+i+" coords = getOutputCoords();\n        setOutput(getX("+a+"));\n      }\n    "},xl=function(){function e(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(e,t,n){var r,o=wl(t,n),i=Cl(e,o,n);if(i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]),this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var a=this.freeTextures[i].shift();return this.usedTextures[i].push(a),a}return this.numUsedTextures++,this.log(),o===Lr.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):o===Lr.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):o===Lr.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):o===Lr.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):o===Lr.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(r),r},e.prototype.releaseTexture=function(e,t,n,r){if(null!=this.freeTextures){var o=Cl(t,wl(n,r),r);o in this.freeTextures||(this.freeTextures[o]=[]),this.freeTextures[o].push(e),this.numFreeTextures++,this.numUsedTextures--;var i=this.usedTextures[o],a=i.indexOf(e);if(a<0)throw new Error("Cannot release a texture that was never provided by this texture manager");i.splice(a,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+e+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));for(var t in this.usedTextures)this.usedTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function wl(e,t){if(e===Fr.UPLOAD)return Lr.PACKED_2X2_FLOAT32;if(e===Fr.RENDER||null==e)return function(e){return un().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?Lr.PACKED_2X2_FLOAT32:Lr.UNPACKED_FLOAT32:e?Lr.PACKED_2X2_FLOAT16:Lr.UNPACKED_FLOAT16}(t);if(e===Fr.DOWNLOAD||e===Fr.PIXELS)return Lr.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function Cl(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var El=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;var o=Ds(this.rank),i=function(e){var t=e.length;if(t>5)throw Error("Tile for rank "+t+" is not yet supported");if(1===t)return"imod(resRC, "+e[0]+")";for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],o=0;o<e.length;o++)r.push("imod("+n[o]+", "+e[o]+")");return r.join()}(e);this.userCode="\n      void main() {\n        "+o+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},Sl=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;var o=Ds(this.rank),i=function(e){var t=e.length;if(t>6)throw Error("Transpose for rank "+t+" is not yet supported");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t),o=0;o<e.length;o++)r[e[o]]=n[o];return r.join()}(t);this.userCode="\n    void main() {\n      "+o+" resRC = getOutputCoords();\n      setOutput(getA("+i+"));\n    }\n    "},kl=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var o=Ds(this.rank),i=ms("rc",this.rank),a=new Array(this.rank);for(r=0;r<t.length;r++)a[t[r]]=i[r];var s="vec2("+a.slice(-2).join()+")",u="++"+i[this.rank-1]+" < "+n[this.rank-1],l="getChannel(getA("+a.join()+"), "+s+")";this.userCode="\n    void main() {\n      "+o+" rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = "+l+";\n      if("+u+") {\n        result[1] = "+l+";\n      }\n      --"+i[this.rank-1]+";\n      if(++"+i[this.rank-2]+" < "+n[this.rank-2]+") {\n        result[2] = "+l+";\n        if("+u+") {\n          result[3] = "+l+";\n        }\n      }\n      setOutput(result);\n    }\n    "},_l=1.7580993408473768,Rl=1.0507009873554805,Il=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode="\n      float unaryOperation(float x) {\n        "+t+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},Tl="if (isnan(x)) return x;",Al="return abs(x);",Dl=Tl+"\n  return (x < 0.0) ? 0.0 : x;\n",Nl=Tl+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",Pl="return (x >= 0.0) ? x : (exp(x) - 1.0);",Ml="\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = "+_l+";\n  float scale = "+Rl+";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n",Ol="return -x;",Fl="return ceil(x);",Ll="return floor(x);",Bl="return exp(x);",zl="return exp(x) - 1.0;",Wl=Tl+"\n  return sin(x);\n",Vl=Tl+"\n  return cos(x);\n",Ul=Tl+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n",jl=Tl+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n",Hl=Tl+"\n  return atan(x);\n",Gl=Tl+"return log(x + sqrt(x * x + 1.0));",ql=Tl+"\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));",Kl=Tl+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;",Xl="return x;",$l="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Yl="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Ql="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",Jl=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        "+t+"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},Zl=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var t=e.length,n=gs("rc",t),r=Ds(t),o=function(e,t){if(1===e)return"rc";for(var n="",r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(t,n),i=n.slice(-2),a=t<=1?"rc":"vec2("+i.join(",")+")";this.userCode="\n      void main() {\n        "+r+" rc = getOutputCoords();\n        vec4 packedInput = getA("+o+");\n\n        setOutput(getChannel(packedInput, "+a+"));\n      }\n    "},ec={};function tc(e,t){if(void 0===t&&(t=!1),"linear"===e)return"return x;";if("relu"===e)return t?$l:Dl;if("elu"===e)return t?Ql:Pl;if("relu6"===e)return t?Yl:Nl;if("prelu"===e)return t?Gs:js;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var nc=function(e){function t(t){var n,r=e.call(this)||this;if(r.pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.warnedAboutMemory=!1,r.pendingDeletes=0,r.disposed=!1,!un().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==t){var o=Vr(un().getNumber("WEBGL_VERSION"));r.binaryCache=((n=un().getNumber("WEBGL_VERSION"))in ec||(ec[n]={}),ec[n]),r.gpgpu=new Uu(o),r.canvas=o.canvas,r.gpgpuCreatedLocally=!0}else r.gpgpu=t,r.binaryCache={},r.gpgpuCreatedLocally=!1,r.canvas=t.gl.canvas;return r.textureManager=new xl(r.gpgpu),r.numMBBeforeWarning=null==un().global.screen?1024:un().global.screen.height*un().global.screen.width*window.devicePixelRatio*600/1024/1024,r.texData=new Aa(r,Nr),r}return nn(t,e),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(e,t,n){if(un().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:Fr.UPLOAD}),r},t.prototype.move=function(e,t,n,r){if(un().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:Fr.UPLOAD})},t.prototype.readSync=function(e){var t=this.texData.get(e),n=t.values,r=t.dtype,o=t.complexTensors,i=t.slice,a=t.shape,s=t.isPacked;if(null!=i){var u;u=s?new Jl(a,Xl):new Il(a,Xl);var l=this.runWebGLProgram(u,[{dataId:e,shape:a,dtype:r}],r),c=this.readSync(l.dataId);return this.disposeData(l.dataId),c}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;var f,d,p=null!=this.activeTimers;return p&&(f=er()),d="complex64"===r?Qa(o.real.dataSync(),o.imag.dataSync()):this.getValuesFromTexture(e),p&&(this.downloadWaitMs+=er()-f),this.convertAndCacheOnCPU(e,d)},t.prototype.read=function(e){return rn(this,void 0,void 0,(function(){var t,n,r,o,i,a,s,u,l,c,f,d,p,h,v,m,g,y,b,x,w,C;return on(this,(function(E){switch(E.label){case 0:if(this.pendingRead.has(e))return t=this.pendingRead.get(e),[2,new Promise((function(e){return t.push(e)}))];if(n=this.texData.get(e),r=n.values,o=n.shape,i=n.slice,a=n.dtype,s=n.complexTensors,u=n.isPacked,null!=i)return void 0,l=u?new Jl(o,Xl):new Il(o,Xl),c=this.runWebGLProgram(l,[{dataId:e,shape:o,dtype:a}],a),f=this.read(c.dataId),this.disposeData(c.dataId),[2,f];if(null!=r)return[2,this.convertAndCacheOnCPU(e)];if(!un().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===un().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return d=null,"complex64"!==a&&un().get("WEBGL_BUFFER_SUPPORTED")&&(p=this.decode(e),h=this.texData.get(p.dataId),d=(C=this.gpgpu).createBufferFromTexture.apply(C,[h.texture].concat(jr(o)))),this.pendingRead.set(e,[]),"complex64"===a?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:E.sent(),E.label=2;case 2:return"complex64"!==a?[3,4]:[4,Promise.all([s.real.data(),s.imag.data()])];case 3:return m=E.sent(),g=m[0],y=m[1],v=Qa(g,y),[3,5];case 4:null==d?v=this.getValuesFromTexture(e):(b=kn(o),v=this.gpgpu.downloadFloat32MatrixFromBuffer(d,b)),E.label=5;case 5:return null!=p&&this.disposeData(p.dataId),x=this.convertAndCacheOnCPU(e,v),w=this.pendingRead.get(e),this.pendingRead.delete(e),w.forEach((function(e){return e(x)})),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e),this.pendingDeletes--),[2,x]}}))}))},t.prototype.checkNumericalProblems=function(e){if(null!=e)for(var t=0;t<e.length;t++){var n=e[t];if(!Kr(n)){if(un().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value "+n+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value "+n+" cannot be represented on this device.")}}},t.prototype.getValuesFromTexture=function(e){var t,n=this.texData.get(e),r=n.shape,o=n.dtype,i=n.isPacked,a=kn(r);if(un().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var s=this.decode(e),u=this.texData.get(s.dataId),l=(t=this.gpgpu).downloadMatrixFromPackedTexture.apply(t,[u.texture].concat(jr(r))).subarray(0,a);return this.disposeData(s.dataId),l}var c=un().getBool("WEBGL_PACK")&&!0===i,f=c?Eo(r):r,d=c?new gu(f):new mu(f),p=this.runWebGLProgram(d,[{shape:f,dtype:o,dataId:e}],"float32"),h=this.texData.get(p.dataId),v=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(h.texture,h.texShape[0],h.texShape[1]).subarray(0,a);return this.disposeData(p.dataId),v},t.prototype.time=function(e){return rn(this,void 0,void 0,(function(){var t,n,r,o,i,a,s;return on(this,(function(u){switch(u.label){case 0:return t=this.activeTimers,n=[],r=!1,null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,e(),o=Sn(this.activeTimers.map((function(e){return e.query}))).filter((function(e){return null!=e})),i=Sn(this.activeTimers.map((function(e){return e.name}))).filter((function(e){return null!=e})),this.activeTimers=t,r&&(this.programTimersStack=null),a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},un().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(o)]:[3,2];case 1:return s=u.sent(),a.kernelMs=xn(s),a.getExtraProfileInfo=function(){return s.map((function(e,t){return{name:i[t],ms:e}})).map((function(e){return e.name+": "+e.ms})).join(", ")},[3,3];case 2:a.kernelMs={error:"WebGL query timers are not supported in this environment."},u.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,a]}}))}))},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return un().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:er(),endMs:null}},t.prototype.endTimer=function(e){return un().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=er(),e)},t.prototype.getQueryTime=function(e){return rn(this,void 0,void 0,(function(){var t;return on(this,(function(n){return un().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(e)]:[2,(t=e).endMs-t.startMs]}))}))},t.prototype.disposeData=function(e){if(!this.pendingDisposal.has(e)){if(this.pendingRead.has(e))return this.pendingDisposal.add(e),void this.pendingDeletes++;if(this.texData.has(e)){this.releaseGPUData(e);var t=this.texData.get(e).complexTensors;null!=t&&(t.real.dispose(),t.imag.dispose()),this.texData.delete(e)}}},t.prototype.releaseGPUData=function(e){var t=this.texData.get(e),n=t.texture,r=t.dtype,o=t.texShape,i=t.usage,a=t.isPacked,s=t.slice,u=s&&s.origDataId||e,l=this.dataRefCount.get(u);l>1?this.dataRefCount.set(u,l-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(o,r),this.textureManager.releaseTexture(n,o,i,a)));var c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null},t.prototype.getTexture=function(e){return this.uploadToGPU(e),this.texData.get(e).texture},t.prototype.getDataInfo=function(e){return this.texData.get(e)},t.prototype.getCPUBackend=function(){return un().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=Nr.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(e,t){var n=this;return void 0===t&&(t=128),null!=this.getCPUBackend()&&e.every((function(e){return null==n.texData.get(e.dataId).texture&&e.size<t}))},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(e,t){var n=this.makeOutput(e.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:Nr.keep(e.clone()),imag:Nr.keep(t.clone())},n},t.prototype.real=function(e){return this.texData.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.texData.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,t,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.slice(e,t,n);if(0===kn(n))return ai([],n,e.dtype);var r=this.texData.get(e.dataId).isPacked,o=ka(e.shape,t,n);if(r||!o){var i=un().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new yl(n):new ml(n),a=i.getCustomSetupFunc(t);return this.compileAndRun(i,[e],null,a)}return this.uploadToGPU(e.dataId),this.shallowSlice(e,t,n)},t.prototype.shallowSlice=function(e,t,n){var r=this.texData.get(e.dataId),o=this.makeOutput(n,e.dtype),i=this.texData.get(o.dataId);Object.assign(i,r),i.shape=n,i.dtype=e.dtype;var a=_a(t,e.strides);r.slice&&(a+=r.slice.flatOffset),i.slice={flatOffset:a,origDataId:r.slice&&r.slice.origDataId||e.dataId};var s=this.dataRefCount.get(i.slice.origDataId)||1;return this.dataRefCount.set(i.slice.origDataId,s+1),o},t.prototype.stridedSlice=function(e,t,n,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.stridedSlice(e,t,n,r);var o=Ca(t,n,r);if(o.some((function(e){return 0===e})))return ai([],o);var i=new bl(t,r,o);return this.compileAndRun(i,[e])},t.prototype.reverse=function(e,t){var n=un().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new dl(e.shape,t):new fl(e.shape,t);return this.compileAndRun(n,[e])},t.prototype.concat=function(e,t){if("complex64"===e[0].dtype){var n=e.map((function(e){return oi(e)})),r=e.map((function(e){return ii(e)}));return ri(this.concat(n,t),this.concat(r,t))}if(this.shouldExecuteOnCPU(e))return this.cpuBackend.concat(e,t);if(1===e.length)return e[0];if(e.length>un().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var o=Math.floor(e.length/2),i=this.concat(e.slice(0,o),t),a=this.concat(e.slice(o),t);return this.concat([i,a],t)}if(un().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].rank>1){var s=new Qs(e.map((function(e){return e.shape})),t);return this.compileAndRun(s,e)}var u=ti(e.map((function(e){return e.shape})),t),l=e.map((function(e){return e.as2D(-1,kn(e.shape.slice(t)))})),c=new Ys(l.map((function(e){return e.shape})));return this.compileAndRun(c,l).reshape(u)},t.prototype.neg=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.neg(e);if(un().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Ol,e.dtype);var t=new Il(e.shape,Ol);return this.compileAndRun(t,[e])},t.prototype.batchMatMul=function(e,t,n,r){var o=n?e.shape[2]:e.shape[1],i=r?t.shape[1]:t.shape[2],a=n?e.shape[1]:e.shape[2],s=e.shape[0];if((1===o||1===i)&&a>1e3){n&&(e=e.transpose([0,2,1])),r&&(t=t.transpose([0,2,1]));var u=1===i?e:e.as3D(s,a,1),l=1===i?2:1,c=1===i?t.as3D(s,1,a):t;return this.multiply(u,c).sum(l,!0)}var f=Sr(e.dtype,t.dtype),d=new Yu(e.shape,[s,o,i],n,r);return this.compileAndRun(d,[e,t],f)},t.prototype.fusedBatchMatMul=function(e){var t=e.a,n=e.b,r=e.transposeA,o=e.transposeB,i=e.bias,a=e.activation,s=e.preluActivationWeights,u=r?t.shape[2]:t.shape[1],l=o?n.shape[1]:n.shape[2],c=t.shape[0],f=Sr(t.dtype,n.dtype),d=null!=i,p=null!=s,h=a?tc(a,!0):null,v=new Yu(t.shape,[c,u,l],r,o,d,h,p),m=[t,n];return i&&m.push(i),s&&m.push(s),this.compileAndRun(v,m,f)},t.prototype.multiply=function(e,t){if("complex64"===e.dtype){var n=this.texData.get(e.dataId),r=this.texData.get(t.dataId),o=new zs("return areal * breal - aimag * bimag;",e.shape,t.shape),i=new zs("return areal * bimag + aimag * breal;",e.shape,t.shape),a=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag),this.makeComplexComponentTensorInfo(t,r.complexTensors.real),this.makeComplexComponentTensorInfo(t,r.complexTensors.imag)],s=this.compileAndRun(o,a),u=this.compileAndRun(i,a),l=this.complex(s,u);return s.dispose(),u.dispose(),l}if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.multiply(e,t);if(un().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,Us,e.dtype);var c=new Hs(Us,e.shape,t.shape);return this.compileAndRun(c,[e,t],e.dtype)},t.prototype.batchNormalization=function(e,t,n,r,o,i){var a=[e,t,n],s=null;null!=i&&(s=i.shape,a.push(i));var u=null;if(null!=o&&(u=o.shape,a.push(o)),un().getBool("WEBGL_PACK_NORMALIZATION")){var l=new Bs(e.shape,t.shape,n.shape,s,u,r);return this.compileAndRun(l,a)}var c=new Ls(e.shape,t.shape,n.shape,s,u,r);return this.compileAndRun(c,a)},t.prototype.localResponseNormalization4D=function(e,t,n,r,o){var i=un().getBool("WEBGL_PACK_NORMALIZATION")?new Ku(e.shape,t,n,r,o):new Gu(e.shape,t,n,r,o);return this.compileAndRun(i,[e])},t.prototype.LRNGrad=function(e,t,n,r,o,i,a){var s=new qu(t.shape,r,o,i,a);return this.compileAndRun(s,[t,n,e])},t.prototype.tile=function(e,t){if("string"===e.dtype){var n=this.readSync(e.dataId).map((function(e){return rr(e)}));return cs(Li(e.shape,e.dtype,n),t)}var r=new El(e.shape,t);return this.compileAndRun(r,[e])},t.prototype.pad=function(e,t,n){var r=un().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new tl(e.shape,t,n):new el(e.shape,t,n);return this.compileAndRun(r,[e])},t.prototype.transpose=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.transpose(e,t);var n=un().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new kl(e.shape,t):new Sl(e.shape,t);return this.compileAndRun(n,[e])},t.prototype.gather=function(e,t,n){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.gather(e,t,n);var r=new Cu(e.shape,t.size,n);return this.compileAndRun(r,[e,t])},t.prototype.batchToSpaceND=function(e,t,n){wn(e.rank<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var r=t.reduce((function(e,t){return e*t})),o=ca(e.shape,t,r),i=fa(o.length,t.length),a=da(e.shape,t,r),s=pa(n,t.length),u=ha(a,n,t.length);return e.reshape(o).transpose(i).reshape(a).slice(s,u)},t.prototype.spaceToBatchND=function(e,t,n){wn(e.rank<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var r=t.reduce((function(e,t){return e*t})),o=[[0,0]];o.push.apply(o,n);for(var i=1+t.length;i<e.shape.length;++i)o.push([0,0]);var a=e.pad(o),s=ca(a.shape,t,r,!1),u=fa(s.length,t.length,!1),l=da(a.shape,t,r,!1);return a.reshape(s).transpose(u).reshape(l)},t.prototype.reduce=function(e,t,n){var r=e.shape[0],o=e.shape[1],i=ma(o),a=new ol({windowSize:i,inSize:o,batchSize:r},t),s=this.compileAndRun(a,[e],n);return 1===s.shape[1]?s:this.reduce(s,t,n)},t.prototype.argReduce=function(e,t,n){void 0===n&&(n=null);var r=e.shape[0],o=e.shape[1];null!=n&&(r=n.shape[0],o=n.shape[1]);var i=ma(o),a=new vs({windowSize:i,inSize:o,batchSize:r},t,null==n),s=[e];null!=n&&s.push(n);var u=this.compileAndRun(a,s,"int32");return 1===u.shape[1]?u:this.argReduce(e,t,u)},t.prototype.argReducePacked=function(e,t,n){void 0===n&&(n=null);var r=null!=n?n.shape:e.shape,o=ma(r[r.length-1]),i=new Ms(r,o,t,null==n),a=null==n?[e]:[e,n],s=this.compileAndRun(i,a,"int32");return s.rank===e.rank?this.argReducePacked(e,t,s):s},t.prototype.sum=function(e,t){Yo("sum",t,e.rank);var n=Xo(e.shape,t),r=n[0],o=kn(n[1]),i=e.as2D(-1,o),a=kr(e.dtype);return this.reduce(i,"sum",a).reshape(r)},t.prototype.prod=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.prod(e,t);var n=Xo(e.shape,t),r=n[0],o=kn(n[1]),i=e.as2D(-1,o),a=kr(e.dtype);return this.reduce(i,"prod",a).reshape(r)},t.prototype.unsortedSegmentSum=function(e,t,n){var r=0,o=Qo([r],e.rank),i=e;null!=o&&(i=e.transpose(o),r=Zo(1,e.rank)[0]);var a=function(e,t,n){for(var r=[],o=e.length,i=0;i<o;i++)i!==t?r.push(e[i]):r.push(n);return r}(i.shape,r,n),s=kn([i.shape[r]]),u=i.as2D(-1,s),l=kr(e.dtype),c=this.segOpCompute(u,"unsortedSegmentSum",t,l,n).reshape(a);return null!=o&&(c=c.transpose(Jo(o))),c},t.prototype.segOpCompute=function(e,t,n,r,o){var i=e.shape[0],a=e.shape[1],s=function(e,t){var n,r=!1;for(e<=30?(n=e,r=!0):n=Xn(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=Xn(e,n+1);return n}(a,o),u=new hl({windowSize:s,inSize:a,batchSize:i,numSegments:o},t),l=this.compileAndRun(u,[e,n],r);return l.shape[1]===o?l:(n=mi(0,o).tile([a/s]),this.segOpCompute(l,t,n,r,o))},t.prototype.argMinMaxReduce=function(e,t,n){var r=[t];if(Yo("arg"+n.charAt(0).toUpperCase()+n.slice(1),r,e.rank),!un().getBool("WEBGL_PACK_REDUCE")||e.rank<=2){var o=Xo(e.shape,r),i=o[0],a=kn(o[1]),s=e.as2D(-1,a);return this.argReduce(s,n).reshape(i)}return this.argReducePacked(e,n)},t.prototype.argMin=function(e,t){return this.argMinMaxReduce(e,t,"min")},t.prototype.argMax=function(e,t){return this.argMinMaxReduce(e,t,"max")},t.prototype.cumsum=function(e,t,n,r){if(t!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(e.rank-1)+" but got axis="+t);var o=new cu(e.shape,n,r);return this.compileAndRun(o,[e])},t.prototype.equal=function(e,t){if(un().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(equal(a, b));\n","bool");var n=new Hs("return float(a == b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.notEqual=function(e,t){if(un().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(notEqual(a, b));\n","bool");var n=new Hs("return float(a != b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.less=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.less(e,t);if(un().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(lessThan(a, b));\n","bool");var n=new Hs("return float(a < b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.lessEqual=function(e,t){if(un().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(lessThanEqual(a, b));\n","bool");var n=new Hs("return float(a <= b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.greater=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.greater(e,t);if(un().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(greaterThan(a, b));\n","bool");var n=new Hs("return float(a > b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.greaterEqual=function(e,t){if(un().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var n=new Hs("return float(a >= b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.logicalNot=function(e){var t=new Il(e.shape,"return float(!(x >= 1.0));");return this.compileAndRun(t,[e])},t.prototype.logicalAnd=function(e,t){if(un().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var n=new Hs("return float(a >= 1.0 && b >= 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.logicalOr=function(e,t){if(un().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var n=new Hs("return float(a >= 1.0 || b >= 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.select=function(e,t,n){var r=new vl(e.rank,t.shape,t.rank);return this.compileAndRun(r,[e,t,n],Sr(t.dtype,n.dtype))},t.prototype.where=function(e){Vo("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var t=e.dataSync();return ds(e.shape,t)},t.prototype.topk=function(e,t,n){return fs(e.dataSync(),e.shape,e.dtype,t)},t.prototype.min=function(e,t){Yo("min",t,e.rank);var n=Xo(e.shape,t),r=n[0],o=kn(n[1]),i=e.as2D(-1,o);return this.reduce(i,"min",i.dtype).reshape(r)},t.prototype.minimum=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.minimum(e,t);var n=un().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qs("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new Hs("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.mod=function(e,t){var n=un().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qs("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new Hs("if (b == 0.0) return NAN;\n  return mod(a, b);",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.max=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.max(e,t);Yo("max",t,e.rank);var n=Xo(e.shape,t),r=n[0],o=kn(n[1]),i=e.as2D(-1,o);return this.reduce(i,"max",i.dtype).reshape(r)},t.prototype.maximum=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.maximum(e,t);var n=un().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qs("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new Hs("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.all=function(e,t){Yo("all",t,e.rank);var n=Xo(e.shape,t),r=n[0],o=kn(n[1]),i=e.as2D(-1,o);return this.reduce(i,"all",i.dtype).reshape(r)},t.prototype.any=function(e,t){Yo("any",t,e.rank);var n=Xo(e.shape,t),r=n[0],o=kn(n[1]),i=e.as2D(-1,o);return this.reduce(i,"any",i.dtype).reshape(r)},t.prototype.realDivide=function(e,t){if(un().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n","float32",!0);var n=new Hs("\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",e.shape,t.shape);return this.compileAndRun(n,[e,t],"float32")},t.prototype.floorDiv=function(e,t){if(un().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var n=new Hs("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",e.shape,t.shape);return this.compileAndRun(n,[e,t],"int32")},t.prototype.add=function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,Ws);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.add(e,t);var n=Sr(e.dtype,t.dtype);if(un().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,Ws,n);var r=new Hs(Ws,e.shape,t.shape);return this.compileAndRun(r,[e,t],n)},t.prototype.packedUnaryOp=function(e,t,n){var r=new Jl(e.shape,t);return this.compileAndRun(r,[e],n)},t.prototype.packedBinaryOp=function(e,t,n,r,o){void 0===o&&(o=!1);var i=new qs(n,e.shape,t.shape,o);return this.compileAndRun(i,[e,t],r)},t.prototype.complexSeparableBinaryOp=function(e,t,n){var r=this,o=this.texData.get(e.dataId),i=this.texData.get(t.dataId),a=[[o.complexTensors.real,i.complexTensors.real],[o.complexTensors.imag,i.complexTensors.imag]].map((function(o){var i=o[0],a=o[1],s=r.makeComplexComponentTensorInfo(e,i),u=r.makeComplexComponentTensorInfo(t,a),l=new Hs(n,e.shape,t.shape);return r.compileAndRun(l,[s,u],Sr(i.dtype,a.dtype))})),s=a[0],u=a[1],l=this.complex(s,u);return s.dispose(),u.dispose(),l},t.prototype.makeComplexComponentTensorInfo=function(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}},t.prototype.addN=function(e){if(1===e.length)return e[0];if(e.length>un().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var t=Math.floor(e.length/2),n=this.addN(e.slice(0,t)),r=this.addN(e.slice(t));return this.addN([n,r])}var o=e.map((function(e){return e.dtype})).reduce((function(e,t){return Sr(e,t)})),i=e.map((function(e){return e.shape})),a=un().getBool("WEBGL_PACK")?new hs(e[0].shape,i):new ps(e[0].shape,i);return this.compileAndRun(a,e,o)},t.prototype.subtract=function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,Vs);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.subtract(e,t);var n=Sr(e.dtype,t.dtype);if(un().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,Vs,e.dtype);var r=new Hs(Vs,e.shape,t.shape);return this.compileAndRun(r,[e,t],n)},t.prototype.pow=function(e,t){var n=un().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qs("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new Hs("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",e.shape,t.shape),r=Sr(e.dtype,t.dtype);return this.compileAndRun(n,[e,t],r)},t.prototype.ceil=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.ceil(e);if(un().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Fl,e.dtype);var t=new Il(e.shape,Fl);return this.compileAndRun(t,[e])},t.prototype.floor=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.floor(e);if(un().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Ll,e.dtype);var t=new Il(e.shape,Ll);return this.compileAndRun(t,[e])},t.prototype.sign=function(e){var t=new Il(e.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(t,[e])},t.prototype.isNaN=function(e){var t=new Il(e.shape,"return float(isnan(x));");return this.compileAndRun(t,[e],"bool")},t.prototype.isInf=function(e){var t=new Il(e.shape,"return float(isinf(x));");return this.compileAndRun(t,[e],"bool")},t.prototype.isFinite=function(e){var t=new Il(e.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(t,[e],"bool")},t.prototype.round=function(e){var t=new Il(e.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(t,[e])},t.prototype.exp=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.exp(e);if(un().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Bl,e.dtype);var t=new Il(e.shape,Bl);return this.compileAndRun(t,[e])},t.prototype.expm1=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.expm1(e);if(un().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,zl,e.dtype);var t=new Il(e.shape,zl);return this.compileAndRun(t,[e])},t.prototype.softmax=function(e,t){var n=Pn([t],e.shape),r=this.max(e,n),o=$o(r.shape,n),i=this.subtract(e,r.reshape(o)),a=this.exp(i),s=this.sum(a,n).reshape(o);return this.realDivide(a,s)},t.prototype.log=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.log(e);if(un().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",e.dtype);var t=new Il(e.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(t,[e])},t.prototype.log1p=function(e){var t=new Il(e.shape,"return log(1.0 + x);");return this.compileAndRun(t,[e])},t.prototype.sqrt=function(e){var t=new Il(e.shape,"return sqrt(x);");return this.compileAndRun(t,[e])},t.prototype.rsqrt=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.rsqrt(e);var t=new Il(e.shape,"return inversesqrt(x);");return this.compileAndRun(t,[e])},t.prototype.reciprocal=function(e){var t=new Il(e.shape,"return 1.0 / x;");return this.compileAndRun(t,[e])},t.prototype.relu=function(e){var t;return t=un().getBool("WEBGL_PACK")?new Jl(e.shape,$l):new Il(e.shape,Dl),this.compileAndRun(t,[e])},t.prototype.relu6=function(e){var t;return t=un().getBool("WEBGL_PACK")?new Jl(e.shape,Yl):new Il(e.shape,Nl),this.compileAndRun(t,[e])},t.prototype.prelu=function(e,t){var n=un().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qs(Gs,e.shape,t.shape):new Hs(js,e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.elu=function(e){if(un().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Ql,e.dtype);var t=new Il(e.shape,Pl);return this.compileAndRun(t,[e])},t.prototype.eluDer=function(e,t){var n=un().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qs("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",e.shape,t.shape):new Hs("return (b >= 1.0) ? a : a * (b + 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.selu=function(e){var t=new Il(e.shape,Ml);return this.compileAndRun(t,[e])},t.prototype.int=function(e){var t=new Il(e.shape,"return float(int(x));");return this.compileAndRun(t,[e],"int32")},t.prototype.clip=function(e,t,n){var r,o=(r=un().getBool("WEBGL_PACK_CLIP")?new Xs(e.shape):new Ks(e.shape)).getCustomSetupFunc(t,n);return this.compileAndRun(r,[e],null,o)},t.prototype.abs=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.abs(e);if(un().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Al,e.dtype);var t=new Il(e.shape,Al);return this.compileAndRun(t,[e])},t.prototype.complexAbs=function(e){var t=this.texData.get(e.dataId),n=new $s(e.shape),r=[this.makeComplexComponentTensorInfo(e,t.complexTensors.real),this.makeComplexComponentTensorInfo(e,t.complexTensors.imag)];return this.compileAndRun(n,r)},t.prototype.sigmoid=function(e){var t=new Il(e.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(t,[e])},t.prototype.softplus=function(e){var t=new Il(e.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(t,[e])},t.prototype.sin=function(e){var t=new Il(e.shape,Wl);return this.compileAndRun(t,[e])},t.prototype.cos=function(e){var t=new Il(e.shape,Vl);return this.compileAndRun(t,[e])},t.prototype.tan=function(e){var t=new Il(e.shape,"return tan(x);");return this.compileAndRun(t,[e])},t.prototype.asin=function(e){var t=new Il(e.shape,Ul);return this.compileAndRun(t,[e])},t.prototype.acos=function(e){var t=new Il(e.shape,jl);return this.compileAndRun(t,[e])},t.prototype.atan=function(e){var t=new Il(e.shape,Hl);return this.compileAndRun(t,[e])},t.prototype.atan2=function(e,t){var n=un().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qs("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new Hs("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.sinh=function(e){var t=new Il(e.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])},t.prototype.cosh=function(e){var t=new Il(e.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])},t.prototype.tanh=function(e){var t=new Il(e.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(t,[e])},t.prototype.asinh=function(e){var t=new Il(e.shape,Gl);return this.compileAndRun(t,[e])},t.prototype.acosh=function(e){var t=new Il(e.shape,ql);return this.compileAndRun(t,[e])},t.prototype.atanh=function(e){var t=new Il(e.shape,Kl);return this.compileAndRun(t,[e])},t.prototype.erf=function(e){var t=new Il(e.shape,'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = 0.3275911;\n  float a1 = 0.254829592;\n  float a2 = -0.284496736;\n  float a3 = 1.421413741;\n  float a4 = -1.453152027;\n  float a5 = 1.061405429;\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n');return this.compileAndRun(t,[e])},t.prototype.step=function(e,t){var n=new Il(e.shape,function(e){return void 0===e&&(e=0),Tl+"\n    return x > 0.0 ? 1.0 : float("+e+");\n  "}(t));return this.compileAndRun(n,[e])},t.prototype.conv2dByMatMul=function(e,t,n,r,o,i){var a=e.shape,s=this.texData.get(e.dataId),u=n.inChannels,l=a[0]*a[1]*a[2],c=n.outChannels,f="channelsLast"===n.dataFormat,d=(1===l||1===c)&&u>1e3,p=a[2]%2!=0&&!!s.isPacked;if(d||!un().getBool("WEBGL_LAZILY_UNPACK")||!un().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!p){var h=f?a[0]*a[1]*a[2]:a[0]*a[2]*a[3],v=this.reshape(e,[1,h,n.inChannels]),m=this.reshape(t,[1,n.inChannels,n.outChannels]);return this.reshape(this.fusedBatchMatMul({a:v,b:m,transposeA:!1,transposeB:!1,bias:r,activation:o,preluActivationWeights:i}),n.outShape)}var g=f?a[0]*a[1]*(a[2]+1):a[0]*a[2]*(a[3]+1),y={dataId:e.dataId,shape:[1,g,n.inChannels],dtype:e.dtype},b=s.shape;s.shape=s.shape.slice(),s.shape[s.shape.length-2]++,wn(_o(s.shape,y.shape),(function(){return"packed reshape "+s.shape+" to "+y.shape+" isn't free"}));var x=this.reshape(t,[1,n.inChannels,n.outChannels]),w=this.fusedBatchMatMul({a:y,b:x,transposeA:!1,transposeB:!1,bias:r,activation:o,preluActivationWeights:i}),C=this.texData.get(w.dataId);return wn(C.isPacked,(function(){return"batchMatMul result is expected to be packed"})),s.shape=b,C.shape=n.outShape,Nr.makeTensorFromDataId(w.dataId,n.outShape,w.dtype)},t.prototype.conv2dWithIm2Row=function(e,t,n,r,o,i){var a=n.filterWidth,s=n.filterHeight,u=n.inChannels,l=n.outWidth,c=n.outHeight,f="channelsLast"===n.dataFormat,d=a*s*u,p=c*l,h=[d,p],v=e.squeeze([0]),m=t.reshape([1,d,-1]),g=new Hu(h,v.shape,n),y=this.compileAndRun(g,[v]).reshape([1,h[0],h[1]]),b=null!=r,x=null!=i,w=o?tc(o,!0):null,C=new Yu(y.shape,[1,p,n.outChannels],!0,!1,b,w,x),E=[y,m];r&&E.push(r),x&&E.push(i);var S=this.compileAndRun(C,E);return f?S.reshape([1,c,l,n.outChannels]):S.reshape([1,n.outChannels,c,l])},t.prototype.fusedConv2d=function(e){var t=e.input,n=e.filter,r=e.convInfo,o=e.bias,i=e.activation,a=e.preluActivationWeights;if(1===r.filterHeight&&1===r.filterWidth&&1===r.dilationHeight&&1===r.dilationWidth&&1===r.strideHeight&&1===r.strideWidth&&("SAME"===r.padInfo.type||"VALID"===r.padInfo.type))return this.conv2dByMatMul(t,n,r,o,i,a);if(un().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,n,r,o,i,a);var s=null!=o,u=null!=a,l=i?tc(i,!1):null,c=new iu(r,s,l,u),f=[t,n];return o&&f.push(o),a&&f.push(a),this.compileAndRun(c,f)},t.prototype.conv2d=function(e,t,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(e,t,n);if(un().getBool("WEBGL_CONV_IM2COL")&&1===e.shape[0])return this.conv2dWithIm2Row(e,t,n);var r=new iu(n);return this.compileAndRun(r,[e,t])},t.prototype.conv2dDerInput=function(e,t,n){var r=new eu(n);return this.compileAndRun(r,[e,t])},t.prototype.conv2dDerFilter=function(e,t,n){var r=new Zs(n);return this.compileAndRun(r,[e,t])},t.prototype.fusedDepthwiseConv2D=function(e){var t,n=e.input,r=e.filter,o=e.convInfo,i=e.bias,a=e.activation,s=e.preluActivationWeights,u=un().getBool("WEBGL_PACK_DEPTHWISECONV")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1,l=a?tc(a,u):null,c=[n,r],f=null!=i,d=null!=s;return f&&c.push(i),d&&c.push(s),u?(t=new uu(o,f,l,d),this.compileAndRun(t,c)):(t=new su(o,f,l,d),this.compileAndRun(t,c))},t.prototype.depthwiseConv2D=function(e,t,n){var r;return un().getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(r=new uu(n),this.compileAndRun(r,[e,t])):(r=new su(n),this.compileAndRun(r,[e,t]))},t.prototype.depthwiseConv2DDerInput=function(e,t,n){var r=new ou(n);return this.compileAndRun(r,[e,t])},t.prototype.depthwiseConv2DDerFilter=function(e,t,n){var r=new ru(n);return this.compileAndRun(r,[e,t])},t.prototype.conv3d=function(e,t,n){var r=new au(n);return this.compileAndRun(r,[e,t])},t.prototype.conv3dDerInput=function(e,t,n){var r=new nu(n);return this.compileAndRun(r,[e,t])},t.prototype.conv3dDerFilter=function(e,t,n){var r=new tu(n);return this.compileAndRun(r,[e,t])},t.prototype.maxPool=function(e,t){var n=new nl(t,"max",!1);return this.compileAndRun(n,[e])},t.prototype.avgPool=function(e,t){var n=new nl(t,"avg",!1);return this.compileAndRun(n,[e],"float32")},t.prototype.maxPoolBackprop=function(e,t,n,r){var o=new nl(r,"max",!0),i=this.compileAndRun(o,[t]),a=new Xu(r),s=this.compileAndRun(a,[e,i],t.dtype);return i.dispose(),s},t.prototype.avgPoolBackprop=function(e,t,n){var r=new Os(n);return this.compileAndRun(r,[e],t.dtype)},t.prototype.cast=function(e,t){return Xa(e,t,this)},t.prototype.unstack=function(e,t){for(var n=e.shape[t],r=new Array(e.rank-1),o=0,i=0;i<e.rank;i++)i!==t&&(r[o++]=e.shape[i]);var a=new Array(e.rank).fill(0),s=e.shape.slice();s[t]=1;var u=new Array(n);for(i=0;i<u.length;i++)a[t]=i,u[i]=this.slice(e,a,s).reshape(r);return u},t.prototype.avgPool3d=function(e,t){var n=new rl(t,"avg",!1);return this.compileAndRun(n,[e],"float32")},t.prototype.avgPool3dBackprop=function(e,t,n){var r=new Fs(n);return this.compileAndRun(r,[e],t.dtype)},t.prototype.maxPool3d=function(e,t){var n=new rl(t,"max",!1);return this.compileAndRun(n,[e],"float32")},t.prototype.maxPool3dBackprop=function(e,t,n,r){var o=new rl(r,"max",!0),i=this.compileAndRun(o,[t]),a=new $u(r),s=this.compileAndRun(a,[e,i],t.dtype);return i.dispose(),s},t.prototype.reshape=function(e,t){var n=this.texData.get(e.dataId);if(n.isPacked&&!_o(e.shape,t)&&(null===n.texture||!_o(n.shape,t))){var r=this.packedReshape(e,t);return Nr.makeTensorFromDataId(r.dataId,r.shape,r.dtype)}return $a(e,t)},t.prototype.resizeBilinear=function(e,t,n,r){var o=un().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new ul(e.shape,t,n,r):new sl(e.shape,t,n,r);return this.compileAndRun(o,[e],"float32")},t.prototype.resizeBilinearBackprop=function(e,t,n){var r=new al(e,t,n);return this.compileAndRun(r,[e])},t.prototype.resizeNearestNeighbor=function(e,t,n,r){var o=new cl(e.shape,t,n,r);return this.compileAndRun(o,[e])},t.prototype.resizeNearestNeighborBackprop=function(e,t,n){var r=new ll(e,t,n);return this.compileAndRun(r,[e])},t.prototype.multinomial=function(e,t,n,r){var o=t?e:Ia(e),i=o.shape[0],a=o.shape[1],s=new Qu(i,a,n),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[o],"int32",u)},t.prototype.oneHot=function(e,t,n,r){var o=new Ju(e.size,t,n,r);return this.compileAndRun(o,[e])},t.prototype.diag=function(e){var t=new vu(e.size);return this.compileAndRun(t,[e])},t.prototype.nonMaxSuppression=function(e,t,n,r,o){return Vo("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),rs(e.dataSync(),t.dataSync(),n,r,o)},t.prototype.cropAndResize=function(e,t,n,r,o,i){var a=new lu(e.shape,t.shape,r,o,i);return this.compileAndRun(a,[e,t,n],"float32")},t.prototype.depthToSpace=function(e,t,n){wn(t>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+t}));var r=e.shape[0],o="NHWC"===n?e.shape[1]:e.shape[2],i="NHWC"===n?e.shape[2]:e.shape[3],a="NHWC"===n?e.shape[3]:e.shape[1],s=o*t,u=i*t,l=a/(t*t),c=new hu("NHWC"===n?[r,s,u,l]:[r,l,s,u],t,n);return this.compileAndRun(c,[e])},t.prototype.split=function(e,t,n){return ls(e,t,n)},t.prototype.scatterND=function(e,t,n){var r=ba(0,e,n),o=r.sliceRank,i=r.numUpdates,a=r.sliceSize,s=r.strides,u=r.outputSize,l=[u/a,a],c=e.reshape([i,o]),f=t.reshape([i,a]);if(0===u)return $a(ai([]),n);var d=ui(0),p=new pl(i,o,c.rank,f.rank,s,l);return this.compileAndRun(p,[f,c,d]).reshape(n)},t.prototype.sparseToDense=function(e,t,n,r){var o=ba(0,e,n),i=o.sliceRank,a=o.numUpdates,s=o.strides,u=o.outputSize,l=new pl(a,i,e.rank,t.rank,s,[u,1],!1);return this.compileAndRun(l,[t,e,r]).reshape(n)},t.prototype.fft=function(e){return this.fftImpl(e,!1)},t.prototype.ifft=function(e){return this.fftImpl(e,!0)},t.prototype.fftImpl=function(e,t){var n=this.texData.get(e.dataId),r=new xu("return real * expR - imag * expI;",e.shape,t),o=new xu("return real * expI + imag * expR;",e.shape,t),i=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag)],a=this.compileAndRun(r,i),s=this.compileAndRun(o,i),u=this.complex(a,s).as2D(e.shape[0],e.shape[1]);return a.dispose(),s.dispose(),u},t.prototype.gatherND=function(e,t){var n=t.shape,r=n[n.length-1],o=va(e,t),i=o[0],a=o[1],s=o[2],u=o[3],l=t.reshape([a,r]),c=e.reshape([e.size/s,s]),f=new Eu(r,u,[a,s]);return this.compileAndRun(f,[c,l]).reshape(i)},t.prototype.fill=function(e,t,n){if("string"===(n=n||qn(t))){var r=Fn(n,kn(e));return r.fill(t),Nr.makeTensor(r,e,n,this)}var o=new wu(e,t),i=o.getCustomSetupFunc(t);return this.compileAndRun(o,[],n,i)},t.prototype.onesLike=function(e){if("string"===e.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){return this.fill(e.shape,"string"===e.dtype?"":0,e.dtype)},t.prototype.linspace=function(e,t,n){return Ya(e,t,n)},t.prototype.makeTensorInfo=function(e,t){var n=this.write(null,e,t);return this.texData.get(n).usage=null,{dataId:n,shape:e,dtype:t}},t.prototype.makeOutput=function(e,t){var n=this.makeTensorInfo(e,t).dataId;return Nr.makeTensorFromDataId(n,e,t,this)},t.prototype.unpackTensor=function(e){var t=new Zl(e.shape);return this.runWebGLProgram(t,[e],e.dtype)},t.prototype.packTensor=function(e){var t=new Zu(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)},t.prototype.packedReshape=function(e,t){var n=[wo(e.shape)].concat(Co(e.shape)),r={dtype:e.dtype,shape:n,dataId:e.dataId},o=[wo(t)].concat(Co(t)),i=new il(o,n),a=this.runWebGLProgram(i,[r],e.dtype,null,!0);return{dataId:a.dataId,shape:t,dtype:a.dtype}},t.prototype.decode=function(e){var t,n=this.texData.get(e),r=n.isPacked,o=n.shape,i=n.dtype,a=Eo(o);return t=r?new pu(a):new du(a),{dtype:i,shape:o,dataId:this.runWebGLProgram(t,[{shape:a,dtype:i,dataId:e}],i,null,!0).dataId}},t.prototype.runWebGLProgram=function(e,t,n,r,o){var i=this;void 0===o&&(o=!1);var a=this.makeTensorInfo(e.outputShape,n),s=this.texData.get(a.dataId);if(e.packedOutput&&(s.isPacked=!0),e.outPackingScheme===Or.DENSE){var u=jr(e.outputShape);s.texShape=u.map((function(e){return 2*e}))}if(null!=e.outTexUsage&&(s.usage=e.outTexUsage),0===kn(a.shape))return s.values=On(a.dtype,0),a;var l=[],c=t.map((function(t){if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=i.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&kn(t.shape)<=un().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}else if(!!n.isPacked!=!!e.packedInputs)t=n.isPacked?i.unpackTensor(t):i.packTensor(t),l.push(t),n=i.texData.get(t.dataId);else if(n.isPacked&&!_o(n.shape,t.shape)){var r=t,o=t.shape;t.shape=n.shape,t=i.packedReshape(t,o),l.push(t),n=i.texData.get(t.dataId),r.shape=o}return i.uploadToGPU(t.dataId),{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(a.dataId);var f,d={shape:a.shape,texData:s,isUniform:!1},p=function(e,t,n){var r="";t.concat(n).forEach((function(e){var t=null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0,n=e.isUniform?"uniform":e.texData.texShape;r+=e.shape+"_"+n+"_"+t}));var o=e.userCode;return e.constructor.name+"_"+r+"_"+o}(e,c,d),h=this.getAndSaveBinary(p,(function(){return function(e,t,n,r){var o=t.userCode,i=n.map((function(e,n){var r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),a=i.map((function(e){return e.shapeInfo})),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},u=Cs(i,s,o,t.packedInputs),l=e.createProgram(u),c=null,f=e.getUniformLocation(l,"NAN",!1);1===un().getNumber("WEBGL_VERSION")&&(c=e.getUniformLocation(l,"INFINITY",!1));for(var d={},p=0;p<t.variableNames.length;p++){var h=t.variableNames[p];d[h]=e.getUniformLocation(l,h,!1),d["offset"+h]=e.getUniformLocation(l,"offset"+h,!1)}return{program:t,source:u,webGLProgram:l,uniformLocations:d,inShapeInfos:a,outShapeInfo:s,infLoc:c,nanLoc:f}}(i.gpgpu,e,c,d)})),v=null!=this.activeTimers;if(v&&(f=this.startTimer()),function(e,t,n,r,o){ju(t.inShapeInfos,n),ju([t.outShapeInfo],[r]);var i=r.texData.texture,a=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(i,a[0],a[1]):e.setOutputMatrixTexture(i,a[0],a[1]),e.setProgram(t.webGLProgram),1===un().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN),n.forEach((function(n,r){var o=t.program.variableNames[r],i=t.uniformLocations[o],a=t.uniformLocations["offset"+o];if(null!=i)if(n.isUniform)if(kn(n.shape)<2)e.gl.uniform1f(i,n.uniformValues[0]);else{var s=n.uniformValues;s instanceof Float32Array||(s=new Float32Array(s)),e.gl.uniform1fv(i,s)}else null!=n.texData.slice&&null!=a&&e.gl.uniform1i(a,n.texData.slice.flatOffset),e.setInputMatrixTexture(n.texData.texture,i,r)})),null!=o&&o(e,t.webGLProgram),e.executeProgram()}(this.gpgpu,h,c,d,r),l.forEach((function(e){return i.disposeData(e.dataId)})),v&&(f=this.endTimer(f),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(f)})),!un().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&!1===o){var m=this.unpackTensor(a);return this.disposeData(a.dataId),m}return a},t.prototype.compileAndRun=function(e,t,n,r,o){void 0===o&&(o=!1),n=n||t[0].dtype;var i=this.runWebGLProgram(e,t,n,r,o);return Nr.makeTensorFromDataId(i.dataId,i.shape,i.dtype)},t.prototype.getAndSaveBinary=function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var e=this;this.disposed||(un().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach((function(t){e.gpgpu.deleteProgram(e.binaryCache[t].webGLProgram),delete e.binaryCache[t]})),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=zo((function(){if(!un().get("WEBGL_RENDER_FLOAT32_ENABLED")){var t=un().getBool("DEBUG");un().set("DEBUG",!1);var n=e.abs(ui(1e-8)).dataSync()[0];if(un().set("DEBUG",t),n>0)return 32}return 16}))),this.floatPrecisionValue},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.uploadToGPU=function(e){var t,n=this.texData.get(e),r=n.shape,o=n.dtype,i=n.values,a=n.texture,s=n.usage,u=n.isPacked;if(null==a){var l,c=null!=this.activeTimers;c&&(l=er());var f=n.texShape;if(null==f&&(f=So(r,u),n.texShape=f),null!=i){var d=Eo(r),p=void 0,h=f[1],v=f[0],m=i instanceof Uint8Array;u?(h=(t=Hr(f[0],f[1]))[0],v=t[1],p=new bu(d,[v,h],m)):p=new yu(d,[v,h],m);var g=this.makeTensorInfo([v,h],o);this.texData.get(g.dataId).usage=m?Fr.PIXELS:Fr.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(g.dataId),h,v,i);var y=this.runWebGLProgram(p,[g],o,null,!0),b=this.texData.get(y.dataId);n.texture=b.texture,n.texShape=b.texShape,n.isPacked=b.isPacked,n.usage=b.usage,this.disposeData(g.dataId),this.texData.delete(y.dataId),n.values=null,c&&(this.uploadWaitMs+=er()-l)}else{var x=this.acquireTexture(f,s,o,u);n.texture=x}}},t.prototype.convertAndCacheOnCPU=function(e,t){var n=this.texData.get(e),r=n.dtype;return this.releaseGPUData(e),null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){for(var n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length),r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}throw new Error("Unknown dtype "+t)}(t,r)),n.values},t.prototype.acquireTexture=function(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+o+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)},t.prototype.computeBytes=function(e,t){return e[0]*e[1]*Vn(t)},t}(Da);Pr()&&Nr.registerBackend("webgl",(function(){return new nc}),2);var rc=ni({square_:function(e){var t=Ho(e,"x","square"),n=[t];return Nr.runKernelFunc((function(e,n){return n([t]),e.square(t)}),{x:t},null,"Square",{},n,[])}}),oc="SquaredDifference",ic=ni({squaredDifference_:function(e,t){var n,r=Ho(e,"a","squaredDifference"),o=Ho(t,"b","squaredDifference");n=_r(r,o),r=n[0],o=n[1],Oa(r.shape,o.shape);var i={a:r,b:o},a=[r,o];return Nr.runKernelFunc((function(e,t){var n=e.squaredDifference(r,o);return t([r,o]),n}),i,(function(e,t){var n=t[0],r=t[1],o=ui(2);return{a:function(){return e.mul(n.sub(r).mul(o))},b:function(){return e.mul(r.sub(n).mul(o))}}}),oc,{},a,[])}}),ac=ni({abs_:function(e){var t=Ho(e,"x","abs");return"complex64"===t.dtype?Nr.runKernelFunc((function(e){return e.complexAbs(t)}),{$x:t}):Nr.runKernelFunc((function(e,n){var r=e.abs(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().step(-1))}}}),"Abs")}}),sc=ni({acos_:function(e){var t=Ho(e,"x","acos");return Nr.runKernelFunc((function(e,n){var r=e.acos(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.divStrict(ui(1).sub(n.toFloat().square()).sqrt()).neg()}}}))}}),uc=ni({acosh_:function(e){var t=Ho(e,"x","acosh");return Nr.runKernelFunc((function(e,n){var r=e.acosh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.divStrict(n.toFloat().square().sub(1).sqrt())}}}))}}),lc=ni({asin_:function(e){var t=Ho(e,"x","asin");return Nr.runKernelFunc((function(e,n){var r=e.asin(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.divStrict(ui(1).sub(n.toFloat().square()).sqrt())}}}))}}),cc=ni({asinh_:function(e){var t=Ho(e,"x","asinh");return Nr.runKernelFunc((function(e,n){var r=e.asinh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.divStrict(ui(1).add(n.toFloat().square()).sqrt())}}}))}}),fc=ni({atan_:function(e){var t=Ho(e,"x","atan");return Nr.runKernelFunc((function(e,n){var r=e.atan(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.toFloat().square().add(1))}}}))}}),dc=ni({atanh_:function(e){var t=Ho(e,"x","atanh");return Nr.runKernelFunc((function(e,n){var r=e.atanh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(ui(1).sub(n.toFloat().square()))}}}))}}),pc=ni({ceil_:function(e){var t=Ho(e,"x","ceil");return Nr.runKernelFunc((function(e){return e.ceil(t)}),{$x:t},(function(e){return{$x:function(){return yi(e)}}}))}}),hc=ni({clipByValue_:function(e,t,n){var r=Ho(e,"x","clipByValue");wn(t<=n,(function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."}));var o=[r],i={min:t,max:n};return Nr.runKernelFunc((function(e,o){var i=e.clip(r,t,n);return o([r]),i}),{x:r},(function(e,r){var o=r[0];return{x:function(){return e.where(o.greaterEqual(t).logicalAnd(o.lessEqual(n)),yi(e))}}}),"ClipByValue",i,o)}}),vc=ni({cos_:function(e){var t=Ho(e,"x","cos"),n=[t];return Nr.runKernelFunc((function(e,n){var r=e.cos(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return n.toFloat().sin().neg().mul(e)}}}),"Cos",{},n)}}),mc=ni({cosh_:function(e){var t=Ho(e,"x","cosh");return Nr.runKernelFunc((function(e,n){var r=e.cosh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return n.toFloat().sinh().mulStrict(e)}}}))}}),gc=ni({erf_:function(e){var t=Ho(e,"x","erf");return wn("int32"===t.dtype||"float32"===t.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===t.dtype&&(t=t.toFloat()),Nr.runKernelFunc((function(e,n){var r=e.erf(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}}))}}),yc=ni({exp_:function(e){var t=Ho(e,"x","exp");return Nr.runKernelFunc((function(e,n){var r=e.exp(t);return n([r]),r}),{x:t},(function(e,t){return{x:function(){return e.mulStrict(t[0])}}}),"Exp",{},[],[!0])}}),bc=ni({expm1_:function(e){var t=Ho(e,"x","expm1");return Nr.runKernelFunc((function(e,n){var r=e.expm1(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.exp())}}}))}}),xc=ni({floor_:function(e){var t=Ho(e,"x","floor");return Nr.runKernelFunc((function(e){return e.floor(t)}),{$x:t},(function(e){return{$x:function(){return yi(e)}}}))}}),wc=ni({log_:function(e){var t=Ho(e,"x","log"),n=[t];return Nr.runKernelFunc((function(e,n){var r=e.log(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return e.div(n.toFloat())}}}),"Log",{},n)}}),Cc=ni({log1p_:function(e){var t=Ho(e,"x","log1p");return Nr.runKernelFunc((function(e,n){var r=e.log1p(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.add(1))}}}))}}),Ec=ni({logSigmoid_:function(e){var t=Ho(e,"x","logSigmoid");return Nr.runKernelFunc((function(e,n){var r=e.softplus(t.neg()).neg();return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.neg().sigmoid())}}}))}}),Sc=ni({neg_:function(e){var t=Ho(e,"x","neg"),n=[t];return Nr.runKernelFunc((function(e){return e.neg(t)}),{x:t},(function(e){return{x:function(){return e.neg()}}}),"Neg",{},n)}}),kc=ni({reciprocal_:function(e){var t=Ho(e,"x","reciprocal");return Nr.runKernelFunc((function(e,n){var r=e.reciprocal(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.square().neg())}}}))}}),_c=ni({round_:function(e){var t=Ho(e,"x","round");return Nr.runKernelFunc((function(e){return e.round(t)}),{$x:t},(function(e){return{$x:function(){return yi(e)}}}))}}),Rc=ni({rsqrt_:function(e){var t=Ho(e,"x","rsqrt"),n=[t];return Nr.runKernelFunc((function(e,n){var r=e.rsqrt(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return e.div(n.pow(1.5).mul(2)).neg()}}}),"Rsqrt",{},n)}}),Ic=ni({sigmoid_:function(e){var t=Ho(e,"x","sigmoid");return Nr.runKernelFunc((function(e,n){var r=e.sigmoid(t);return n([r]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return e.mul(n.mul(ui(1).sub(n)))}}}),"Sigmoid")}}),Tc=ni({sign_:function(e){var t=Ho(e,"x","sign");return Nr.runKernelFunc((function(e){return e.sign(t)}),{$x:t},(function(e){return{$x:function(){return yi(e)}}}))}}),Ac=ni({isNaN_:function(e){var t=Ho(e,"x","isNaN");return Nr.runKernelFunc((function(e){return e.isNaN(t)}),{$x:t},(function(e){return{$x:function(){return yi(e)}}}))}}),Dc=ni({isInf_:function(e){var t=Ho(e,"x","isInf");return Nr.runKernelFunc((function(e){return e.isInf(t)}),{$x:t},(function(e){return{$x:function(){return yi(e)}}}))}}),Nc=ni({isFinite_:function(e){var t=Ho(e,"x","isFinite");return Nr.runKernelFunc((function(e){return e.isFinite(t)}),{$x:t},(function(e){return{$x:function(){return yi(e)}}}))}}),Pc=ni({sin_:function(e){var t=Ho(e,"x","sin"),n=[t];return Nr.runKernelFunc((function(e,n){var r=e.sin(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return n.toFloat().cos().mul(e)}}}),"Sin",{},n)}}),Mc=ni({sinh_:function(e){var t=Ho(e,"x","sinh");return Nr.runKernelFunc((function(e,n){var r=e.sinh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return n.toFloat().cosh().mulStrict(e)}}}))}}),Oc=ni({softplus_:function(e){var t=Ho(e,"x","softplus");return Nr.runKernelFunc((function(e,n){var r=e.softplus(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.sigmoid())}}}))}}),Fc=ni({sqrt_:function(e){var t=Ho(e,"x","sqrt");return Nr.runKernelFunc((function(e,n){var r=e.sqrt(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.toFloat().sqrt().mul(2))}}}))}}),Lc=ni({step_:function(e,t){void 0===t&&(t=0);var n=Ho(e,"x","step");return Nr.runKernelFunc((function(e){return e.step(n,t)}),{$x:n},(function(e){return{$x:function(){return yi(e)}}}))}}),Bc=ni({tan_:function(e){var t=Ho(e,"x","tan");return Nr.runKernelFunc((function(e,n){var r=e.tan(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.cos().square())}}}))}}),zc=ni({tanh_:function(e){var t=Ho(e,"x","tanh");return Nr.runKernelFunc((function(e,n){var r=e.tanh(t);return n([r]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return ui(1).sub(n.square()).mulStrict(e)}}}),"Tanh",{},null,[!0])}});function Wc(e,t,n,r,o,i){var a,s,u=Ho(e,"x","batchNorm"),l=Ho(t,"mean","batchNorm"),c=Ho(n,"variance","batchNorm");return null!=o&&(a=Ho(o,"scale","batchNorm")),null!=r&&(s=Ho(r,"offset","batchNorm")),wn(2===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),wn(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+l.rank+"."})),wn(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+c.rank+"."})),null!=a&&wn(2===a.rank||1===a.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+a.rank+"."})),null!=s&&wn(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."})),jc(u,l,c,s,a,i)}function Vc(e,t,n,r,o,i){var a,s,u=Ho(e,"x","batchNorm"),l=Ho(t,"mean","batchNorm"),c=Ho(n,"variance","batchNorm");return null!=o&&(a=Ho(o,"scale","batchNorm")),null!=r&&(s=Ho(r,"offset","batchNorm")),wn(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),wn(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+l.rank+"."})),wn(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+c.rank+"."})),null!=a&&wn(3===a.rank||1===a.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+a.rank+"."})),null!=s&&wn(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."})),jc(u,l,c,s,a,i)}function Uc(e,t,n,r,o,i){var a,s,u=Ho(e,"x","batchNorm"),l=Ho(t,"mean","batchNorm"),c=Ho(n,"variance","batchNorm");return null!=o&&(a=Ho(o,"scale","batchNorm")),null!=r&&(s=Ho(r,"offset","batchNorm")),wn(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."})),wn(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+l.rank+"."})),wn(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+c.rank+"."})),null!=a&&wn(4===a.rank||1===a.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+a.rank+"."})),null!=s&&wn(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."})),jc(u,l,c,s,a,i)}function jc(e,t,n,r,o,i){null==i&&(i=.001);var a,s,u,l=Ho(e,"x","batchNorm"),c=Ho(t,"mean","batchNorm"),f=Ho(n,"variance","batchNorm");null!=o&&(a=Ho(o,"scale","batchNorm")),null!=r&&(s=Ho(r,"offset","batchNorm")),wn(c.rank===f.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),wn(null==s||c.rank===s.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),wn(null==a||c.rank===a.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),u=0===l.rank||1===l.rank?l.as4D(1,1,1,l.size):2===l.rank?l.as4D(1,1,l.shape[0],l.shape[1]):3===l.rank?l.as4D(1,l.shape[0],l.shape[1],l.shape[2]):l;var d=[l,c,f,a];return Nr.runKernelFunc((function(e,t){var n=e.batchNormalization(u,Hc(c),Hc(f),i,Hc(a),Hc(s));return t([l,c,f,a]),n}),{x:l,mean:c,variance:f,scale:a,offset:s},(function(e,t){var n=t,r=n[0],o=n[1],a=n[2],s=n[3],l=null==s?ui(1):s,c=Ma(o.shape,u.shape),f=[];if(1===o.rank){for(var d=0;d<u.shape.length-1;++d)f.push(u.shape[d]);f.push(1)}var p=r.sub(o),h=e.mul(l),v=Rc(a.add(ui(i))),m=v.mul(v).mul(v).mul(ui(-.5));return{x:function(){return 1===o.rank?e.mul(sa(v.as4D(1,1,1,o.shape[0]),f)).mul(l).reshape(r.shape):e.mul(v).mul(l).reshape(r.shape)},mean:function(){var e=v.mul(ui(-1)).mul(h);return 1===o.rank&&(e=e.sum(c)),e.reshape(o.shape)},variance:function(){var e=m.mul(p).mul(h);return 1===o.rank&&(e=e.sum(c)),e.reshape(o.shape)},scale:function(){var t=p.mul(v),n=e.mul(t);return 1===o.rank&&(n=n.sum(c)),n.reshape(o.shape)},offset:function(){var t=e;return 1===o.rank&&(t=t.sum(c)),t.reshape(o.shape)}}}),"BatchNormalization",{varianceEpsilon:i},d).reshape(l.shape)}function Hc(e){return null==e?null:0===e.rank?e.as1D():1===e.rank?e:2===e.rank?e.as4D(1,1,e.shape[0],e.shape[1]):3===e.rank?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function Gc(){Bo("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var qc=ni({batchNormalization2d_:function(e,t,n,r,o,i){return void 0===r&&(r=.001),Gc(),Wc(e,t,n,i,o,r)}}),Kc=ni({batchNormalization3d_:function(e,t,n,r,o,i){return void 0===r&&(r=.001),Gc(),Vc(e,t,n,i,o,r)}}),Xc=ni({batchNormalization4d_:function(e,t,n,r,o,i){return void 0===r&&(r=.001),Gc(),Uc(e,t,n,i,o,r)}}),$c=ni({batchNormalization_:function(e,t,n,r,o,i){return void 0===r&&(r=.001),Gc(),jc(e,t,n,i,o,r)}}),Yc=ni({batchNorm_:jc}),Qc=ni({batchNorm2d_:Wc}),Jc=ni({batchNorm3d_:Vc}),Zc=ni({batchNorm4d_:Uc}),ef=ni({logicalAnd_:function(e,t){var n=Ho(e,"a","logicalAnd","bool"),r=Ho(t,"b","logicalAnd","bool");return Oa(n.shape,r.shape),Nr.runKernelFunc((function(e){return e.logicalAnd(n,r)}),{a:n,b:r},null,"LogicalAnd")}}),tf=ni({logicalNot_:function(e){var t=Ho(e,"x","logicalNot","bool");return Nr.runKernelFunc((function(e){return e.logicalNot(t)}),{$x:t})}}),nf=ni({logicalOr_:function(e,t){var n=Ho(e,"a","logicalOr","bool"),r=Ho(t,"b","logicalOr","bool");return Oa(n.shape,r.shape),Nr.runKernelFunc((function(e){return e.logicalOr(n,r)}),{$a:n,$b:r})}}),rf=ni({logicalXor_:function(e,t){var n=Ho(e,"a","logicalXor","bool"),r=Ho(t,"b","logicalXor","bool");return Oa(n.shape,r.shape),nf(e,t).logicalAnd(ef(e,t).logicalNot())}}),of=ni({where_:function(e,t,n){var r=Ho(t,"a","where"),o=Ho(n,"b","where"),i=Ho(e,"condition","where","bool");return Cn(r.shape,o.shape,"Error in where: "),1===i.rank?wn(i.shape[0]===r.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})):Cn(i.shape,o.shape,"Error in where: "),Nr.runKernelFunc((function(e,t){var n=e.select(i,r,o);return t([i]),n}),{$condition:i,$a:r,$b:o},(function(e,t){var n=t[0];return{$condition:function(){return yi(n).toFloat()},$a:function(){return e.mul(n.cast(e.dtype))},$b:function(){return e.mul(n.logicalNot().cast(e.dtype))}}}))}}),af=function(e){return rn(this,void 0,void 0,(function(){var t,n,r;return on(this,(function(o){switch(o.label){case 0:return[4,(t=Ho(e,"condition","whereAsync","bool")).data()];case 1:return n=o.sent(),r=ds(t.shape,n),e!==t&&t.dispose(),[2,r]}}))}))},sf=ni({add_:function(e,t){var n,r=Ho(e,"a","add"),o=Ho(t,"b","add");n=_r(r,o),r=n[0],o=n[1];var i=Oa(r.shape,o.shape);return Nr.runKernelFunc((function(e){return e.add(r,o)}),{a:r,b:o},(function(e){return{a:function(){var t=e,n=Ma(r.shape,i);return n.length>0&&(t=t.sum(n)),t.reshape(r.shape)},b:function(){var t=e,n=Ma(o.shape,i);return n.length>0&&(t=t.sum(n)),t.reshape(o.shape)}}}),"Add")}}),uf=ni({addN_:function(e){wn(Array.isArray(e),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),wn(e.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length}));var t=e.map((function(e,t){return Ho(e,"tensors"+t,"addN")})),n=t[0];t.forEach((function(e){if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((function(e){if(!_n(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var r=t;return Nr.runKernelFunc((function(e){return e.addN(t)}),r,(function(e){var n={};return t.forEach((function(t,r){n[r]=function(){return e.clone()}})),n}),"AddN")}}),lf=ni({addStrict_:function(e,t){var n=Ho(e,"a","addStrict"),r=Ho(t,"b","addStrict");return Cn(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),cf=ni({atan2_:function(e,t){var n,r=Ho(e,"a","atan2"),o=Ho(t,"b","atan2");n=_r(r,o),r=n[0],o=n[1];var i=Oa(r.shape,o.shape);return Nr.runKernelFunc((function(e,t){var n=e.atan2(r,o);return t([r,o]),n}),{$a:r,$b:o},(function(e,t){var n=t[0],r=t[1];return{$a:function(){var t=sf(n.square(),r.square()),o=e.mul(r.div(t)),a=Ma(n.shape,i);return a.length>0&&(o=o.sum(a)),o.reshape(n.shape)},$b:function(){var t=sf(n.square(),r.square()),o=Sc(e.mul(n.div(t))),a=Ma(r.shape,i);return a.length>0&&(o=o.sum(a)),o.reshape(r.shape)}}}))}}),ff=ni({div_:function(e,t){var n,r=Ho(e,"a","div"),o=Ho(t,"b","div");if(n=_r(r,o),r=n[0],o=n[1],"int32"===r.dtype&&"int32"===o.dtype)return hf(r,o);var i=Oa(r.shape,o.shape);return Nr.runKernelFunc((function(e,t){var n=e.realDivide(r,o);return t([r,o]),n}),{a:r,b:o},(function(e,t){var n=t[0],r=t[1];return{a:function(){var t=e.div(r.toFloat()),o=Ma(n.shape,i);return o.length>0?t.sum(o).reshape(n.shape):t},b:function(){var t=e.mul(n.toFloat()),o=Ma(r.shape,i);o.length>0&&(t=t.sum(o).reshape(r.shape));var a=r.square();return t.div(a.toFloat()).neg()}}}),"Div")}}),df=ni({divNoNan_:function(e,t){var n,r=Ho(e,"a","div"),o=Ho(t,"b","div");r=(n=_r(r,o))[0],o=n[1];var i=ff(r,o),a=yi(i),s=o.equal(a);return of(s,a,i)}}),pf=ni({divStrict_:function(e,t){var n=Ho(e,"a","div"),r=Ho(t,"b","div");return Cn(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),hf=ni({floorDiv_:function(e,t){var n,r=Ho(e,"a","floorDiv"),o=Ho(t,"b","floorDiv");n=_r(r,o),r=n[0],o=n[1];var i=Oa(r.shape,o.shape);return Nr.runKernelFunc((function(e,t){var n=e.floorDiv(r,o);return t([r,o]),n}),{a:r,b:o},(function(e,t){var n=t[0],r=t[1];return{a:function(){var t=e.div(r.toFloat()),o=Ma(n.shape,i);return o.length>0?t.sum(o).reshape(n.shape):t},b:function(){var t=e.mul(n.toFloat()),o=Ma(r.shape,i);o.length>0&&(t=t.sum(o).reshape(r.shape));var a=r.square();return t.div(a.toFloat()).neg()}}}),"FloorDiv")}}),vf=ni({maximum_:function(e,t){var n,r=Ho(e,"a","maximum"),o=Ho(t,"b","maximum");return n=_r(r,o),r=n[0],o=n[1],"bool"===r.dtype&&(r=r.toInt(),o=o.toInt()),Oa(r.shape,o.shape),Nr.runKernelFunc((function(e,t){var n=e.maximum(r,o);return t([r,o]),n}),{a:r,b:o},(function(e,t){var n=t[0],r=t[1];return{a:function(){return e.mul(n.greaterEqual(r).toFloat())},b:function(){return e.mul(n.less(r).toFloat())}}}),"Maximum")}}),mf=ni({maximumStrict_:function(e,t){var n=Ho(e,"a","maximumStrict"),r=Ho(t,"b","maximumStrict");return Cn(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),gf=ni({minimum_:function(e,t){var n,r=Ho(e,"a","minimum"),o=Ho(t,"b","minimum");return n=_r(r,o),r=n[0],o=n[1],"bool"===r.dtype&&(r=r.toInt(),o=o.toInt()),Oa(r.shape,o.shape),Nr.runKernelFunc((function(e,t){var n=e.minimum(r,o);return t([r,o]),n}),{a:r,b:o},(function(e,t){var n=t[0],r=t[1];return{a:function(){return e.mul(n.lessEqual(r).toFloat())},b:function(){return e.mul(n.greater(r).toFloat())}}}),"Minimum")}}),yf=ni({minimumStrict_:function(e,t){var n=Ho(e,"a","minimumStrict"),r=Ho(t,"b","minimumStrict");return Cn(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),bf=ni({mod_:function(e,t){var n,r=Ho(e,"a","mod"),o=Ho(t,"b","mod");n=_r(r,o),r=n[0],o=n[1];var i=Oa(r.shape,o.shape);return Nr.runKernelFunc((function(e,t){var n=e.mod(r,o);return t([r,o]),n}),{$a:r,$b:o},(function(e,t){var n=t[0],r=t[1];return{$a:function(){var t=Ma(n.shape,i);return t.length>0?e.sum(t).reshape(n.shape):e},$b:function(){var t=e.mul(n.div(r).floor().neg()),o=Ma(r.shape,i);return o.length>0?t.sum(o).reshape(r.shape):t}}}))}}),xf=ni({modStrict_:function(e,t){var n=Ho(e,"a","modStrict"),r=Ho(t,"b","modStrict");return Cn(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),wf=ni({mul_:function(e,t){var n,r=Ho(e,"a","mul"),o=Ho(t,"b","mul");n=_r(r,o),r=n[0],o=n[1];var i=Oa(r.shape,o.shape);return Nr.runKernelFunc((function(e,t){var n=e.multiply(r,o);return t([r,o]),n}),{a:r,b:o},(function(e,t){var n=t[0],r=t[1];return{a:function(){var t=e.mul(r.toFloat()),o=Ma(n.shape,i);return o.length>0?t.sum(o).reshape(n.shape):t},b:function(){var t=e.mul(n.toFloat()),o=Ma(r.shape,i);return o.length>0?t.sum(o).reshape(r.shape):t}}}),"Mul")}}),Cf=ni({mulStrict_:function(e,t){var n=Ho(e,"a","mul"),r=Ho(t,"b","mul");return Cn(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),Ef=ni({pow_:function(e,t){var n,r=Ho(e,"base","pow"),o=Ho(t,"exp","pow");n=_r(r,o),r=n[0],o=n[1];var i=Oa(r.shape,o.shape),a=[r,o];return Nr.runKernelFunc((function(e,t){var n=e.pow(r,o);return t([r,o,n]),n}),{a:r,b:o},(function(e,t){var n=t[0],r=t[1],o=t[2];return{a:function(){var t=r.toFloat(),o=e.mul(t.mul(n.pow(t.sub(ui(1))))),a=Ma(n.shape,i);return a.length>0&&(o=o.sum(a)),o.reshape(n.shape)},b:function(){var t=n.greater(0),a=n.log().where(t,yi(n)),s=e.mul(o.mul(a)),u=Ma(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)}}}),"Pow",{},a,[!0])}}),Sf=ni({powStrict_:function(e,t){return Cn(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),kf=ni({squaredDifferenceStrict_:function(e,t){var n=Ho(e,"a","squaredDifferenceStrict"),r=Ho(t,"b","squaredDifferenceStrict");return Cn(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),_f=ni({sub_:function(e,t){var n,r=Ho(e,"a","sub"),o=Ho(t,"b","sub");n=_r(r,o),r=n[0],o=n[1];var i=Oa(r.shape,o.shape);return Nr.runKernelFunc((function(e){return e.subtract(r,o)}),{a:r,b:o},(function(e){return{a:function(){var t=e,n=Ma(r.shape,i);return n.length>0&&(t=t.sum(n)),t.reshape(r.shape)},b:function(){var t=e,n=Ma(o.shape,i);return n.length>0&&(t=t.sum(n)),t.neg().reshape(o.shape)}}}),"Sub")}}),Rf=ni({subStrict_:function(e,t){var n=Ho(e,"a","subStrict"),r=Ho(t,"b","subStrict");return Cn(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),If=ni({equal_:function(e,t){var n,r=Ho(e,"a","equal"),o=Ho(t,"b","equal");return n=_r(r,o),r=n[0],o=n[1],Oa(r.shape,o.shape),Nr.runKernelFunc((function(e){return e.equal(r,o)}),{$a:r,$b:o})}}),Tf=ni({equalStrict_:function(e,t){var n=Ho(e,"a","equalStrict"),r=Ho(t,"b","equalStrict");return Cn(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),Af=ni({greater_:function(e,t){var n,r=Ho(e,"a","greater"),o=Ho(t,"b","greater");return n=_r(r,o),r=n[0],o=n[1],Oa(r.shape,o.shape),Nr.runKernelFunc((function(e){return e.greater(r,o)}),{a:r,b:o},null,"Greater")}}),Df=ni({greaterEqual_:function(e,t){var n,r=Ho(e,"a","greaterEqual"),o=Ho(t,"b","greaterEqual");return n=_r(r,o),r=n[0],o=n[1],Oa(r.shape,o.shape),Nr.runKernelFunc((function(e,t){var n=e.greaterEqual(r,o);return t([r,o]),n}),{a:r,b:o},(function(e,t){var n=t[0],r=t[1];return{a:function(){return yi(n)},b:function(){return yi(r)}}}),"GreaterEqual")}}),Nf=ni({greaterEqualStrict_:function(e,t){var n=Ho(e,"a","greaterEqualStrict"),r=Ho(t,"b","greaterEqualStrict");return Cn(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),Pf=ni({greaterStrict_:function(e,t){var n=Ho(e,"a","greaterStrict"),r=Ho(t,"b","greaterStrict");return Cn(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),Mf=ni({less_:function(e,t){var n,r=Ho(e,"a","less"),o=Ho(t,"b","less");return n=_r(r,o),r=n[0],o=n[1],Oa(r.shape,o.shape),Nr.runKernelFunc((function(e){return e.less(r,o)}),{a:r,b:o},null,"Less")}}),Of=ni({lessEqual_:function(e,t){var n,r=Ho(e,"a","lessEqual"),o=Ho(t,"b","lessEqual");return n=_r(r,o),r=n[0],o=n[1],Oa(r.shape,o.shape),Nr.runKernelFunc((function(e,t){var n=e.lessEqual(r,o);return t([r,o]),n}),{a:r,b:o},null,"LessEqual")}}),Ff=ni({lessEqualStrict_:function(e,t){var n=Ho(e,"a","lessEqualStrict"),r=Ho(t,"b","lessEqualStrict");return Cn(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),Lf=ni({lessStrict_:function(e,t){var n=Ho(e,"a","lessStrict"),r=Ho(t,"b","lessStrict");return Cn(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),Bf=ni({notEqual_:function(e,t){var n,r=Ho(e,"a","notEqual"),o=Ho(t,"b","notEqual");return n=_r(r,o),r=n[0],o=n[1],Oa(r.shape,o.shape),Nr.runKernelFunc((function(e){return e.notEqual(r,o)}),{a:r,b:o},null,"NotEqual")}}),zf=ni({notEqualStrict_:function(e,t){var n=Ho(e,"a","notEqualStrict"),r=Ho(t,"b","notEqualStrict");return Cn(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function Wf(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function Vf(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var Uf=ni({gather_:function(e,t,n){void 0===n&&(n=0);var r=Ho(e,"x","gather"),o=Ho(t,"indices","gather","int32");n=Pn(n,r.shape)[0];var i=function(e,t,n){for(var r=e.shape[n],o=[],i=1,a=1,s=0;s<n;s++)o.push(e.shape[s]),i*=e.shape[s];for(s=0;s<t.rank;s++)o.push(t.shape[s]);for(s=n+1;s<e.rank;s++)o.push(e.shape[s]),a*=e.shape[s];return{batchSize:i,sliceSize:a,dimSize:r,outputShape:o}}(r,o,n);return Nr.runKernelFunc((function(e,t){var i=e.gather(r,o.flatten(),n);return t([o]),i}),{x:r,indices:o},(function(e,t){var o=t[0];return{x:function(){var t=r.shape,i=o.size,a=t.slice(0,n),s=a.length,u=t.slice(n,t.length).slice(1),l=u.length,c=Wf(0,s),f=Wf(s+1,s+1+l),d=Vf([a,[i],u]),p=e.reshape(d),h=o.reshape([i]),v=Vf([[s],c,f]),m=p.transpose(v),g=jf(m,h,r.shape[n]),y=Jo(v);return g.transpose(y)},indices:function(){return o}}}),"Gather",{axis:n}).reshape(i.outputShape)}}),jf=ni({unsortedSegmentSum_:function(e,t,n){var r=Ho(e,"x","unsortedSegmentSum"),o=Ho(t,"segmentIds","unsortedSegmentSum","int32");return wn(Rn(n),(function(){return"numSegments must be of dtype int"})),Nr.runKernelFunc((function(e,t){var i=e.unsortedSegmentSum(r,o,n);return t([o]),i}),{$x:r},(function(e,t){var n=t[0];return{$x:function(){return function(e,t){for(var n=vf(t,yi(t)),r=Uf(e,n),o=Df(t,ui(0,"int32")),i=r.rank-o.rank,a=0;a<i;++a)o=Hi(o,a+1);o=ef(o,pi(r.shape,"bool"));var s=yi(r);return of(o,r,s)}(e,n)}}}))}});function Hf(e,t,n,r,o,i,a){void 0===i&&(i="NHWC"),wn(e.length===t.rank,(function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"}));var s=e,u=t,l=!1;3===t.rank&&(l=!0,u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),s=[1,e[0],e[1],e[2]]),wn(4===s.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."})),wn(4===u.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank})),wn(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank}));var c="NHWC"===i?s[3]:s[1],f="NHWC"===i?u.shape[3]:u.shape[1];wn(c===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input ("+c+") must match input depth for filter "+n.shape[2]+"."})),wn(f===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output ("+f+") must match output depth for filter "+n.shape[3]+"."})),null!=a&&wn(Rn(o),(function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."}));var d=Ka(i),p=Ba(s,n.shape,r,1,o,a,!1,d),h=Nr.runKernelFunc((function(e,t){var r=e.conv2dDerInput(u,n,p);return t([n,u]),r}),{dy4D:u,filter:n},(function(e,t){var n=t[0],s=t[1];return{dy4D:function(){return Xf(e,n,r,o,i,1,a)},filter:function(){return Yf(e,s,n.shape,r,o,i,a)}}}));return l?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}function Gf(e){var t=function(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}(e),n=t[0],r=t[1],o=t[2];return 1===n&&1===r&&1===o}function qf(e,t,n,r,o){wn(e.length===t.rank,(function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"}));var i=e,a=t,s=!1;4===t.rank&&(s=!0,a=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),i=[1,e[0],e[1],e[2],e[3]]);var u=i[4],l=a.shape[4];wn(5===i.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."})),wn(5===a.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+a.rank})),wn(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank})),wn(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."})),wn(l===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output ("+l+") must match output depth for filter "+n.shape[4]+"."}));var c=za(i,n.shape,r,1,o),f=Nr.runKernelFunc((function(e){return e.conv3dDerInput(a,n,c)}),{dy5D:a});return s?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}var Kf=ni({conv1d_:function(e,t,n,r,o,i,a){void 0===o&&(o="NWC"),void 0===i&&(i=1);var s=Ho(e,"x","conv1d"),u=Ho(t,"filter","conv1d"),l=s,c=!1;2===s.rank&&(c=!0,l=s.as3D(1,s.shape[0],s.shape[1])),wn(3===l.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."})),wn(3===u.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."})),null!=a&&wn(Rn(r),(function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."})),wn(l.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input ("+l.shape[2]+") must match input depth for filter "+u.shape[1]+"."})),wn(qa(n,i),(function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+i+"'"})),wn("NWC"===o,(function(){return"Error in conv1d: got dataFormat of "+o+" but only NWC is currently supported."}));var f=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),d=l.as4D(l.shape[0],1,l.shape[1],l.shape[2]),p=Xf(d,f,[1,n],r,"NHWC",[1,i],a);return c?p.as2D(p.shape[2],p.shape[3]):p.as3D(p.shape[0],p.shape[2],p.shape[3])}}),Xf=ni({conv2d_:function(e,t,n,r,o,i,a){void 0===o&&(o="NHWC"),void 0===i&&(i=[1,1]);var s=Ho(e,"x","conv2d"),u=Ho(t,"filter","conv2d"),l=s,c=!1;3===s.rank&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),wn(4===l.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."})),wn(4===u.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."})),null!=a&&wn(Rn(r),(function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}));var f="NHWC"===o?l.shape[3]:l.shape[1];wn(f===u.shape[2],(function(){return"Error in conv2d: depth of input ("+f+") must match input depth for filter "+u.shape[2]+"."})),wn(qa(n,i),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}));var d=Ka(o),p=Ba(l.shape,u.shape,n,i,r,a,!1,d),h=[u,l],v=Nr.runKernelFunc((function(e,t){var n=e.conv2d(l,u,p);return t([u,l]),n}),{x:l,filter:u},(function(e,t){var a=t,s=a[0],u=a[1];return wn(Ga(i),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"})),{x:function(){return Qf(u.shape,e,s,n,r,o)},filter:function(){return Yf(u,e,s.shape,n,r,o)}}}),"Conv2D",p,h);return c?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),$f=ni({conv3d_:function(e,t,n,r,o,i){void 0===o&&(o="NDHWC"),void 0===i&&(i=[1,1,1]);var a=Ho(e,"x","conv3d"),s=Ho(t,"filter","conv3d"),u=a,l=!1;4===a.rank&&(l=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),wn(5===u.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."})),wn(5===s.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."})),wn(u.shape[4]===s.shape[3],(function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."})),wn(function(e,t){return Gf(e)||Gf(t)}(n,i),(function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"})),wn("NDHWC"===o,(function(){return"Error in conv3d: got dataFormat of "+o+" but only NDHWC is currently supported."}));var c=za(u.shape,s.shape,n,i,r),f=Nr.runKernelFunc((function(e,t){var n=e.conv3d(u,s,c);return t([u,s]),n}),{x:u,$filter:s},(function(e,t){wn(Gf(i),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}));var o=t[0],a=t[1];return{x:function(){return qf(o.shape,e,a,n,r)},$filter:function(){return function(e,t,n,r,o){var i=e;4===e.rank&&(i=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]));var a=t;4===a.rank&&(a=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3])),wn(5===i.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+i.shape+"."})),wn(5===a.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+a.shape+"."})),wn(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+"."})),wn(i.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input "+i.shape[4]+") must match input depth in filter ("+n[3]+"."})),wn(a.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy ("+a.shape[4]+") must match output depth for filter ("+n[4]+")."}));var s=za(i.shape,n,r,1,o);return Nr.runKernelFunc((function(e){return e.conv3dDerFilter(i,a,s)}),{x5D:i,dy5D:a})}(o,e,a.shape,n,r)}}}));return l?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),Yf=ni({conv2dDerFilter_:function(e,t,n,r,o,i,a){void 0===i&&(i="NHWC");var s=e;3===e.rank&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var u=t;3===u.rank&&(u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),wn(4===s.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."})),wn(4===u.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."})),wn(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."}));var l="NHWC"===i?s.shape[3]:s.shape[1],c="NHWC"===i?u.shape[3]:u.shape[1];wn(l===n[2],(function(){return"Error in conv2dDerFilter: depth of input "+l+") must match input depth in filter ("+n[2]+"."})),wn(c===n[3],(function(){return"Error in conv2dDerFilter: depth of dy ("+c+") must match output depth for filter ("+n[3]+")."})),null!=a&&wn(Rn(o),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."}));var f=Ka(i),d=Ba(s.shape,n,r,1,o,a,!1,f);return Nr.runKernelFunc((function(e){return e.conv2dDerFilter(s,u,d)}),{x4D:s,dy4D:u})}}),Qf=ni({conv2dDerInput_:Hf}),Jf=ni({depthwiseConv2d_:function(e,t,n,r,o,i,a){void 0===o&&(o="NHWC"),void 0===i&&(i=[1,1]);var s=Ho(e,"x","depthwiseConv2d"),u=Ho(t,"filter","depthwiseConv2d"),l=s,c=!1;3===s.rank&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),wn(4===l.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+l.rank+"."})),wn(4===u.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."})),wn(l.shape[3]===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels ("+l.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."})),null==i&&(i=[1,1]),wn(qa(n,i),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"})),null!=a&&wn(Rn(r),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}));var f=Ba(l.shape,u.shape,n,i,r,a,!0),d=[l,u],p=Nr.runKernelFunc((function(e,t){var n=e.depthwiseConv2D(l,u,f);return t([l,u]),n}),{x:l,filter:u},(function(e,t){wn(Ga(i),(function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"}));var n=t[0],r=t[1];return{x:function(){return Zf(n.shape,e,r,f)},filter:function(){return ed(n,e,r.shape,f)}}}),"DepthwiseConv2dNative",f,d);return c?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),Zf=ni({depthwiseConv2dDerInput_:function(e,t,n,r){var o=t,i=!1;3===t.rank&&(i=!0,o=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var a=Nr.runKernelFunc((function(e){return e.depthwiseConv2DDerInput(o,n,r)}),{dy4D:o});return i?a.as3D(a.shape[1],a.shape[2],a.shape[3]):a}}),ed=ni({depthwiseConv2dDerFilter_:function(e,t,n,r){var o=e;3===e.rank&&(o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var i=t;return 3===i.rank&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),Nr.runKernelFunc((function(e){return e.depthwiseConv2DDerFilter(o,i,r)}),{x4D:o,dy4D:i})}}),td=ni({separableConv2d_:function(e,t,n,r,o,i,a){void 0===i&&(i=[1,1]),void 0===a&&(a="NHWC");var s=Ho(e,"x","separableConv2d"),u=Ho(t,"depthwiseFilter","separableConv2d"),l=Ho(n,"pointwiseFilter","separableConv2d"),c=s,f=!1;if(3===s.rank&&(f=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),"NCHW"===a)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");wn(4===c.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got rank "+c.rank+"."})),wn(4===u.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."})),wn(4===l.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."})),wn(1===l.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+l.shape[0]+"."})),wn(1===l.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+l.shape[1]+"."}));var d=u.shape[2],p=u.shape[3];wn(l.shape[2]===d*p,(function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+d*p+", but got "+l.shape[2]+"."}));var h=Jf(c,u,r,o,a,i),v=Xf(h,l,1,"valid",a);return f?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),nd=ni({conv2dTranspose_:function(e,t,n,r,o,i){return Hf(n,Ho(e,"x","conv2dTranspose"),Ho(t,"filter","conv2dTranspose"),r,o,"NHWC",i)}}),rd=ni({conv3dTranspose_:function(e,t,n,r,o){return qf(n,Ho(e,"x","conv3dTranspose"),Ho(t,"filter","conv3dTranspose"),r,o)}}),od=ni({matMul_:function(e,t,n,r){var o;void 0===n&&(n=!1),void 0===r&&(r=!1);var i=Ho(e,"a","matMul"),a=Ho(t,"b","matMul");o=_r(i,a),i=o[0],a=o[1];var s=n?i.shape[i.rank-2]:i.shape[i.rank-1],u=r?a.shape[a.rank-1]:a.shape[a.rank-2],l=n?i.shape[i.rank-1]:i.shape[i.rank-2],c=r?a.shape[a.rank-2]:a.shape[a.rank-1],f=i.shape.slice(0,-2),d=a.shape.slice(0,-2),p=kn(f),h=kn(d);wn(i.rank>=2&&a.rank>=2&&i.rank===a.rank,(function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+a.rank+"."})),wn(_n(f,d),(function(){return"Error in matMul: outer dimensions ("+f+") and ("+d+") of Tensors with shapes "+i.shape+" and "+a.shape+" must match."})),wn(s===u,(function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+i.shape+" and "+a.shape+" and transposeA="+n+" and transposeB="+r+" must match."}));var v=i.shape.slice(0,-2).concat([l,c]),m=n?i.as3D(p,s,l):i.as3D(p,l,s),g=r?a.as3D(h,c,u):a.as3D(h,u,c),y={transposeA:n,transposeB:r};return Nr.runKernelFunc((function(e,t){var o=e.batchMatMul(m,g,n,r);return t([m,g]),o}),{a:m,b:g},(function(e,t){var o=t,i=o[0],a=o[1];return n||r?!n&&r?{a:function(){return e.matMul(a,!1,!1)},b:function(){return e.matMul(i,!0,!1)}}:n&&!r?{a:function(){return a.matMul(e,!1,!0)},b:function(){return i.matMul(e,!1,!1)}}:{a:function(){return a.matMul(e,!0,!0)},b:function(){return e.matMul(i,!0,!0)}}:{a:function(){return e.matMul(a,!1,!0)},b:function(){return i.matMul(e,!0,!1)}}}),"BatchMatMul",y).reshape(v)}}),id=ni({dot_:function(e,t){var n=Ho(e,"t1","dot"),r=Ho(t,"t2","dot");wn(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."}));var o=1===n.rank?n.size:n.shape[1],i=1===r.rank?r.size:r.shape[0];return wn(o===i,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+o+" and "+i+"."})),1===n.rank&&1===r.rank?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():1===n.rank&&2===r.rank?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():2===n.rank&&1===r.rank?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),ad=ni({outerProduct_:function(e,t){var n=Ho(e,"v1","outerProduct"),r=Ho(t,"v2","outerProduct");return wn(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."})),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),sd=ni({reverse_:function(e,t){var n=Ho(e,"x","reverse");if(0===n.rank)return n.clone();var r=Pn(t,n.shape);return Nr.runKernelFunc((function(e){return e.reverse(n,r)}),{$x:n},(function(e){return{$x:function(){return e.reverse(r)}}})).reshapeAs(n)}}),ud=ni({reverse1d_:function(e){var t=Ho(e,"x","reverse");return wn(1===t.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."})),sd(t,0)}}),ld=ni({reverse2d_:function(e,t){var n=Ho(e,"x","reverse");return wn(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."})),sd(n,t)}}),cd=ni({reverse3d_:function(e,t){var n=Ho(e,"x","reverse");return wn(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."})),sd(n,t)}}),fd=ni({reverse4d_:function(e,t){var n=Ho(e,"x","reverse");return wn(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."})),sd(n,t)}});function dd(e,t,n,r,o,i){var a=Ho(e,"x","maxPool"),s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),null==r&&(r=[1,1]),wn(4===s.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."})),wn(qa(n,r),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"})),null!=i&&wn(Rn(o),(function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."}));var l=Fa(s.shape,t,n,r,o,i);if(1===l.filterWidth&&1===l.filterHeight&&_n(l.inShape,l.outShape))return a.clone();var c=[s],f=Nr.runKernelFunc((function(e,t){var n=e.maxPool(s,l);return t([s,n]),n}),{x:s},(function(e,i){var a=i[0],s=i[1];return{x:function(){return function(e,t,n,r,o,i,a,s){var u=Ho(e,"dy","maxPoolBackprop"),l=Ho(t,"input","maxPoolBackprop"),c=Ho(n,"output","maxPoolBackprop");wn(l.rank===u.rank,(function(){return"Rank of input ("+l.rank+") does not match rank of dy ("+u.rank+")"})),null==i&&(i=[1,1]),wn(qa(o,i),(function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+o+" and dilations '"+i+"'"})),wn(4===u.rank,(function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+u.rank+"."})),wn(4===l.rank,(function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+l.rank+"."}));var f=Fa(l.shape,r,o,i,a,s);return Nr.runKernelFunc((function(e){return e.maxPoolBackprop(u,l,c,f)}),{$dy:u,$input:l})}(e,a,s,t,n,r,o)}}}),"MaxPool",l,c);return u?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}function pd(e,t,n,r,o,i){var a=Ho(e,"x","avgPool","float32");null==r&&(r=[1,1]),wn(qa(n,r),(function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}));var s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),wn(4===s.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."})),null!=i&&wn(Rn(o),(function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."}));var l=Fa(s.shape,t,n,r,o,i);if(1===l.filterWidth&&1===l.filterHeight&&_n(l.inShape,l.outShape))return a.clone();var c=Nr.runKernelFunc((function(e){return e.avgPool(s,l)}),{x:s},(function(e){return{x:function(){return function(e,t,n,r,o,i){var a=Ho(e,"dy","avgPoolBackprop"),s=Ho(t,"input","avgPoolBackprop");wn(s.rank===a.rank,(function(){return"Rank of input ("+s.rank+") does not match rank of dy ("+a.rank+")"})),null==o&&(o=[1,1]),wn(qa(r,o),(function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+o+"'"}));var u=s,l=a,c=!1;3===s.rank&&(c=!0,u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2]),l=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),wn(4===l.rank,(function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+l.rank+"."})),wn(4===u.rank,(function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+u.rank+"."}));var f=Fa(u.shape,n,r,o,i),d=Nr.runKernelFunc((function(e){return e.avgPoolBackprop(l,u,f)}),{dy4D:l,input4D:u});return c?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}(e,s,t,n,r,o)}}}),"AvgPool",l);return c=c.cast(a.dtype),u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}var hd=ni({maxPool_:function(e,t,n,r,o){return dd(e,t,n,1,r,o)}}),vd=ni({avgPool_:function(e,t,n,r,o){return pd(e,t,n,1,r,o)}}),md=ni({pool_:function(e,t,n,r,o,i){null==o&&(o=[1,1]),null==i&&(i=1),0===r&&(r="valid");var a=Ho(e,"x","maxPool"),s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),wn(qa(i,o),(function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"}));var l,c=Fa(s.shape,t,i,o,r),f=[c.dilationHeight,c.dilationWidth];l="same"===r?function(e,t){var n=e.map((function(e,n){return e+(e-1)*(t[n]-1)})).map((function(e){return e-1})),r=n.map((function(e){return Math.floor(e/2)})),o=n.map((function(e,t){return e-r[t]}));return n.map((function(e,t){return[r[t],o[t]]}))}([c.filterHeight,c.filterWidth],f):[[0,0],[0,0]];var d=1===f[0]&&1===f[1],p=function(e,t,n){var r=n.map((function(e){return e[0]})),o=n.map((function(e){return e[1]})),i=e.concat(r,o),a=t.map((function(e,t){return(e-i[t]%e)%e})),s=o.map((function(e,t){return e+a[t]}));return[t.map((function(e,t){return[r[t],s[t]]})),t.map((function(e,t){return[0,a[t]]}))]}([c.inHeight,c.inWidth],f,l),h=p[0],v=p[1],m=d?r:"valid",g=d?s:oa(s,f,h),y=("avg"===n?function(){return pd(g,t,i,1,m)}:function(){return dd(g,t,i,1,m)})(),b=d?y:Bi(y,f,v);return u?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),gd=ni({maxPool3d_:function(e,t,n,r,o,i,a){void 0===i&&(i="NDHWC");var s=Ho(e,"x","maxPool3d"),u=s,l=!1;4===s.rank&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==a&&(a=[1,1,1]),wn(5===u.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."})),wn("NDHWC"===i,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i})),wn(qa(n,a),(function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"})),null!=o&&wn(Rn(r),(function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}));var c=La(u.shape,t,n,a,r,o,i),f=Nr.runKernelFunc((function(e,t){var n=e.maxPool3d(u,c);return t([u,n]),n}),{x:u},(function(e,i){var s=i[0],u=i[1];return{x:function(){return function(e,t,n,r,o,i,a,s){var u=Ho(e,"dy","maxPool3dBackprop"),l=Ho(t,"input","maxPool3dBackprop"),c=Ho(n,"output","maxPool3dBackprop"),f=u,d=l,p=c,h=!1;4===l.rank&&(h=!0,f=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]),d=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]),p=c.as5D(1,c.shape[0],c.shape[1],c.shape[2],c.shape[3])),wn(5===f.rank,(function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+f.rank+"."})),wn(5===d.rank,(function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+d.rank+"."})),wn(5===p.rank,(function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+p.rank+"."})),null==i&&(i=[1,1,1]),wn(qa(o,i),(function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+o+" and dilations '"+i+"'"})),null!=s&&wn(Rn(a),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."}));var v=La(d.shape,r,o,i,a,s),m=Nr.runKernelFunc((function(e){return e.maxPool3dBackprop(f,d,p,v)}),{dy5D:f,input5D:d});return h?m.as4D(m.shape[1],m.shape[2],m.shape[3],m.shape[4]):m}(e,s,u,t,n,a,r,o)}}}));return l?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),yd=ni({avgPool3d_:function(e,t,n,r,o,i,a){void 0===i&&(i="NDHWC");var s=Ho(e,"x","avgPool3d","float32"),u=s,l=!1;4===s.rank&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==a&&(a=[1,1,1]),wn(5===u.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."})),wn("NDHWC"===i,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i})),wn(qa(n,a),(function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"})),null!=o&&wn(Rn(r),(function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}));var c=La(u.shape,t,n,a,r,o,i),f=Nr.runKernelFunc((function(e){return e.avgPool3d(u,c)}),{x:u},(function(e){return{x:function(){return function(e,t,n,r,o,i,a){var s=Ho(e,"dy","avgPool3dBackprop"),u=Ho(t,"input","avgPool3dBackprop"),l=s,c=u,f=!1;4===u.rank&&(f=!0,l=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]),c=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3])),wn(5===l.rank,(function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+l.rank+"."})),wn(5===c.rank,(function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+c.rank+"."})),null==o&&(o=[1,1,1]),wn(qa(r,o),(function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+o+"'"})),null!=a&&wn(Rn(i),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."}));var d=La(c.shape,n,r,o,i,a),p=Nr.runKernelFunc((function(e){return e.avgPool3dBackprop(l,c,d)}),{dy5D:l,input5D:c});return f?p.as4D(p.shape[1],p.shape[2],p.shape[3],p.shape[4]):p}(e,u,t,n,a,r,o)}}}));return f=f.cast(u.dtype),l?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),bd=ni({slice_:function(e,t,n){var r,o,i=Ho(e,"x","slice");if(0===i.rank)throw new Error("Slicing scalar is not possible");(r="number"==typeof t?[t].concat(new Array(i.rank-1).fill(0)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(0)):t.slice()).forEach((function(e){wn(-1!==e,(function(){return"slice() does not support negative begin indexing."}))})),o=(o=null==n?new Array(i.rank).fill(-1):"number"==typeof n?[n].concat(new Array(i.rank-1).fill(-1)):n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(-1)):n).map((function(e,t){return e>=0?e:(wn(-1===e,(function(){return"Negative size values should be exactly -1 but got "+e+" for the slice() size at index "+t+"."})),i.shape[t]-r[t])})),xa(i,r,o);var a=i.shape,s={begin:r,size:o};return Nr.runKernelFunc((function(e){return e.slice(i,r,o)}),{x:i},(function(e){for(var t=[],n=0;n<e.rank;n++)t.push([r[n],a[n]-r[n]-o[n]]);return{x:function(){return e.pad(t)}}}),"Slice",s)}}),xd=ni({slice1d_:function(e,t,n){var r=Ho(e,"x","slice1d");return wn(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"})),bd(r,[t],[n])}}),wd=ni({slice2d_:function(e,t,n){var r=Ho(e,"x","slice2d");return wn(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"})),bd(r,t,n)}}),Cd=ni({slice3d_:function(e,t,n){var r=Ho(e,"x","slice3d");return wn(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"})),bd(r,t,n)}}),Ed=ni({slice4d_:function(e,t,n){var r=Ho(e,"x","slice4d");return wn(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"})),bd(r,t,n)}});function Sd(e,t,n,r,o){return t.rank<n.rank&&(t=t.reshape($o(t.shape,r))),e.rank<n.rank&&(e=e.reshape($o(e.shape,r))),{x:function(){var r=e.mul(n.equal(t).cast(e.dtype));return null==o?r:r.transpose(o)}}}var kd=ni({all_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Ho(e,"x","all","bool"),o=Pn(t,r.shape),i=o,a=Qo(i,r.rank);null!=a&&(r=r.transpose(a),i=Zo(i.length,r.rank));var s=Nr.runKernelFunc((function(e){return e.all(r,i)}),{$x:r});if(n){var u=$o(s.shape,o);return s.reshape(u)}return s}}),_d=ni({any_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Ho(e,"x","any","bool"),o=Pn(t,r.shape),i=o,a=Qo(i,r.rank);null!=a&&(r=r.transpose(a),i=Zo(i.length,r.rank));var s=Nr.runKernelFunc((function(e){return e.any(r,i)}),{$x:r});if(n){var u=$o(s.shape,o);return s.reshape(u)}return s}}),Rd=ni({argMax_:function(e,t){void 0===t&&(t=0);var n=Ho(e,"x","argMax");null==t&&(t=0);var r=Pn(t,n.shape),o=Qo(r,n.rank);null!=o&&(n=n.transpose(o),r=Zo(r.length,n.rank));var i={axis:r[0]},a=[n];return Nr.runKernelFunc((function(e,t){var o=e.argMax(n,r[0]);return t([n]),o}),{x:n},(function(e,t){var n=t[0];return{x:function(){return yi(n)}}}),"ArgMax",i,a)}}),Id=ni({argMin_:function(e,t){void 0===t&&(t=0);var n=Ho(e,"x","argMin");null==t&&(t=0);var r=Pn(t,n.shape),o=Qo(r,n.rank);return null!=o&&(n=n.transpose(o),r=Zo(r.length,n.rank)),Nr.runKernelFunc((function(e,t){var o=e.argMin(n,r[0]);return t([n]),o}),{$x:n},(function(e,t){var n=t[0];return{$x:function(){return yi(n)}}}))}}),Td=ni({logSumExp_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Ho(e,"x","logSumExp"),o=Pn(t,r.shape),i=r.max(o,!0),a=r.sub(i).exp().sum(o).log(),s=i.reshape(a.shape).add(a);if(n){var u=$o(s.shape,o);return s.reshape(u)}return s}}),Ad=ni({max_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Ho(e,"x","max"),o=r,i=Pn(t,r.shape),a=i,s=Qo(a,r.rank);null!=s&&(r=r.transpose(s),a=Zo(a.length,r.rank));var u=[r],l=Nr.runKernelFunc((function(e,t){var n=e.max(r,a);return t([o,n]),n}),{x:r},(function(e,t){return Sd(e,t[1],t[0],i,s)}),"Max",{axes:a},u,[!0]);if(n){var c=$o(l.shape,i);l=l.reshape(c)}return l}}),Dd=ni({mean_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Ho(e,"x","mean"),o=Pn(t,r.shape),i=kn(Xo(r.shape,o)[1]);return Ra((function(e){var r=ui(i);return{value:(r.dtype===e.dtype?e:e.cast(r.dtype)).div(r).sum(t,n),gradFunc:function(t){var n=e.shape.slice();return o.forEach((function(e){n[e]=1})),t.reshape(n).mul(pi(e.shape,"float32")).div(i)}}}))(r)}}),Nd=ni({min_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Ho(e,"x","min"),o=r,i=Pn(t,r.shape),a=i,s=Qo(a,r.rank);null!=s&&(r=r.transpose(s),a=Zo(a.length,r.rank));var u=[r],l=Nr.runKernelFunc((function(e,t){var n=e.min(r,a);return t([o,n]),n}),{x:r},(function(e,t){return Sd(e,t[1],t[0],i,s)}),"Min",{axes:a},u,[!0]);if(n){var c=$o(l.shape,i);l=l.reshape(c)}return l}}),Pd=ni({moments_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Pn(t,(e=Ho(e,"x","moments")).shape),o=e.mean(r,n),i=o.shape;n||(i=$o(o.shape,r));var a=e.toFloat().sub(o.reshape(i)).square();return{mean:o,variance:a.mean(r,n)}}}),Md=ni({sum_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Ho(e,"x","sum");"bool"===r.dtype&&(r=r.toInt());var o=Pn(t,r.shape);return Ra((function(e){var t=Qo(o,e.rank),r=o,i=e;null!=t&&(i=e.transpose(t),r=Zo(r.length,e.rank));var a=function(t){var n=e.shape.slice();return o.forEach((function(e){n[e]=1})),t.reshape(n).mul(pi(e.shape,"float32"))},s={axes:r},u=Nr.runKernelFunc((function(e){return e.sum(i,r)}),{x:i},(function(e){return{x:function(){return a(e)}}}),"Sum",s);if(n){var l=$o(u.shape,o);u=u.reshape(l)}return{value:u,gradFunc:a}}))(r)}}),Od=ni({prod_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Ho(e,"x","prod");"bool"===r.dtype&&(r=r.toInt());var o=Pn(t,r.shape),i=Qo(o,r.rank),a=o,s=r;null!=i&&(s=r.transpose(i),a=Zo(a.length,r.rank));var u=Nr.runKernelFunc((function(e){return e.prod(s,a)}),{permutedX:s});if(n){var l=$o(u.shape,o);u=u.reshape(l)}return u}}),Fd=ni({elu_:function(e){var t=Ho(e,"x","elu");return Nr.runKernelFunc((function(e,n){var r=e.elu(t);return n([r]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return Nr.runKernelFunc((function(t){return t.eluDer(e,n)}),{dy:e,y:n})}}}))}}),Ld=ni({leakyRelu_:function(e,t){void 0===t&&(t=.2);var n=Ho(e,"x","leakyRelu");return vf(ui(t).mul(n),n)}}),Bd=ni({prelu_:function(e,t){var n=Ho(e,"x","prelu"),r=Ho(t,"alpha","prelu");return Nr.runKernelFunc((function(e,t){var o=e.prelu(n,r);return t([n,r]),o}),{x:n,alpha:r},(function(e,t){var n=t[0],r=t[1],o=n.greater(0);return{x:function(){return of(o,e,e.mul(r))},alpha:function(){var t=of(o,yi(e),e.mul(n)),i=Ma(r.shape,e.shape);return i.length>0&&(t=t.sum(i)),t.reshape(r.shape)}}}),"Prelu")}}),zd=ni({relu_:function(e){var t=Ho(e,"x","relu");return"bool"===t.dtype?t.toInt():Nr.runKernelFunc((function(e,n){var r=e.relu(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return e.mulStrict(n.step().toFloat())}}}),"Relu")}}),Wd=ni({relu6_:function(e){var t=Ho(e,"x","relu6");return"bool"===t.dtype?t.toInt():Nr.runKernelFunc((function(e,n){var r=e.relu6(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0],r=n.lessEqual(6).mul(n.step());return{x:function(){return e.mulStrict(r.toFloat())}}}),"Relu6")}}),Vd=ni({selu_:function(e){var t=Ho(e,"x","selu");return Nr.runKernelFunc((function(e,n){var r=e.selu(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){var t=n.greater(ui(0)),r=ui(_l),o=ui(Rl),i=e.mul(o),a=e.mul(r).mul(n.toFloat().exp());return of(t,i,a)}}}))}}),Ud=ni({transpose_:function(e,t){var n=Ho(e,"x","transpose");if(null==t&&(t=n.shape.map((function(e,t){return t})).reverse()),wn(n.rank===t.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."})),t.forEach((function(e){wn(e>=0&&e<n.rank,(function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t}))})),n.rank<=1)return n.clone();var r={perm:t};return Nr.runKernelFunc((function(e){return e.transpose(n,t)}),{x:n},(function(e){var n=Jo(t);return{x:function(){return e.transpose(n)}}}),"Transpose",r)}}),jd=ni({localResponseNormalization_:function(e,t,n,r,o){void 0===t&&(t=5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===o&&(o=.5);var i=Ho(e,"x","localResponseNormalization");wn(4===i.rank||3===i.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+i.rank+"."})),wn(Rn(t),(function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."}));var a=i,s=!1;3===i.rank&&(s=!0,a=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var u=Nr.runKernelFunc((function(e,i){var s=e.localResponseNormalization4D(a,t,n,r,o);return i([a,s]),s}),{x4D:a},(function(e,i){var a=i[0],s=i[1];return{x4D:function(){return Nr.runKernelFunc((function(i){return i.LRNGrad(e,a,s,t,n,r,o)}),{})}}}));return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Hd=ni({norm_:function(e,t,n,r){void 0===t&&(t="euclidean"),void 0===n&&(n=null),void 0===r&&(r=!1);var o=function e(t,n,r){if(void 0===r&&(r=null),0===t.rank)return t.abs();if(1!==t.rank&&null===r)return e(t.reshape([-1]),n,r);if(1===t.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return t.abs().sum(r);if(n===1/0)return t.abs().max(r);if(n===-1/0)return t.abs().min(r);if("euclidean"===n||2===n)return t.abs().pow(ui(2,"int32")).sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}if(Array.isArray(r)&&2===r.length){if(1===n)return t.abs().sum(r[0]).max(r[1]-1);if(n===1/0)return t.abs().sum(r[1]).max(r[0]);if(n===-1/0)return t.abs().sum(r[1]).min(r[0]);if("fro"===n||"euclidean"===n)return t.square().sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}throw new Error("Error in norm: invalid axis: "+r)}(e=Ho(e,"x","norm"),t,n),i=o.shape;if(r){var a=Pn(n,e.shape);i=$o(o.shape,a)}return o.reshape(i)}}),Gd=ni({basicLSTMCell_:function(e,t,n,r,o,i){var a=Ho(e,"forgetBias","basicLSTMCell"),s=Ho(t,"lstmKernel","basicLSTMCell"),u=Ho(n,"lstmBias","basicLSTMCell"),l=Ho(r,"data","basicLSTMCell"),c=Ho(o,"c","basicLSTMCell"),f=Ho(i,"h","basicLSTMCell"),d=l.concat(f,1).matMul(s).add(u),p=d.shape[0],h=d.shape[1]/4,v=[p,h],m=d.slice([0,0],v),g=d.slice([0,h],v),y=d.slice([0,2*h],v),b=d.slice([0,3*h],v),x=m.sigmoid().mulStrict(g.tanh()).addStrict(c.mulStrict(a.add(y).sigmoid())),w=x.tanh().mulStrict(b.sigmoid());return[x,w]}}),qd=ni({multiRNNCell_:function(e,t,n,r){for(var o=Ho(t,"data","multiRNNCell"),i=Go(n,"c","multiRNNCell"),a=Go(r,"h","multiRNNCell"),s=o,u=[],l=0;l<e.length;l++){var c=e[l](s,i[l],a[l]);u.push(c[0]),u.push(c[1]),s=c[1]}var f=[],d=[];for(l=0;l<u.length;l+=2)f.push(u[l]),d.push(u[l+1]);return[f,d]}}),Kd=ni({movingAverage_:function(e,t,n,r,o){void 0===o&&(o=!0);var i=Ho(e,"v","movingAverage"),a=Ho(t,"x","movingAverage"),s=Ho(n,"decay","movingAverage");Rr(i,a),wn(_n(i.shape,a.shape),(function(){return"Shape mismatch in v and x"}));var u=ui(1),l=u.sub(s),c=a.sub(i).mul(l);if(o){wn(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var f=Ho(r,"step","movingAverage");c=c.div(u.sub(Ef(s,f)))}return i.add(c)}}),Xd=ni({stridedSlice_:function(e,t,n,r,o,i,a,s,u){if(void 0===o&&(o=0),void 0===i&&(i=0),void 0===a&&(a=0),void 0===s&&(s=0),void 0===u&&(u=0),null==r&&(r=new Array(t.length)),0!==a)throw new Error("ellipsis mask is not yet supported");var l=Ho(e,"x","stridedSlice"),c=wa(s),f=l.shape.slice();c.forEach((function(e){t[e]=0,n[e]=1,f.splice(e,0,1)})),l=l.reshape(f);for(var d=0;d<l.rank;d++)t[d]=Ea(o,t,r,l.shape,d),n[d]=Sa(i,n,r,l.shape,d),r[d]=r[d]||1;var p=wa(u);p.forEach((function(e){n[e]=t[e]+1,r[e]=1}));var h=Ca(t,n,r),v=h.filter((function(e,t){return-1===p.indexOf(t)}));return r.every((function(e){return 1===e}))?bd(l,t,h).reshape(v):Nr.runKernelFunc((function(e){return e.stridedSlice(l,t,n,r)}),{$x:l}).reshape(v)}}),$d=ni({topk_:function(e,t,n){void 0===t&&(t=1),void 0===n&&(n=!0);var r=Ho(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var o=r.shape[r.shape.length-1];if(t>o)throw new Error("'k' passed to topk() must be <= the last dimension ("+o+") but got "+t);var i=Nr.runKernelFunc((function(e){return e.topk(r,t,n)}),{$x:r});return{values:i[0],indices:i[1]}}}),Yd=ni({scatterND_:function(e,t,n){var r=Ho(e,"indices","scatterND","int32"),o=Ho(t,"updates","scatterND");return ya(o,r,n),Nr.runKernelFunc((function(e){return e.scatterND(r,o,n)}),{indices:r,updates:o},null,"ScatterNd",{shape:n})}}),Qd=ni({fft_:function(e){wn("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."}));var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return Nr.runKernelFunc((function(e){return e.fft(r)}),{input:e}).reshape(e.shape)}}),Jd=ni({ifft_:function(e){wn("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."}));var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return Nr.runKernelFunc((function(e){return e.ifft(r)}),{input:e}).reshape(e.shape)}}),Zd=ni({rfft_:function(e,t){wn("float32"===e.dtype,(function(){return"The dtype for rfft() must be real value but got "+e.dtype}));var n,r=e.shape[e.shape.length-1],o=e.size/r;if(null!=t&&t<r){var i=e.shape.map((function(e){return 0})),a=e.shape.map((function(e){return e}));a[e.shape.length-1]=t,n=e.slice(i,a),r=t}else if(null!=t&&t>r){var s=e.shape.map((function(e){return e}));s[e.shape.length-1]=t-r,n=e.concat(hi(s),e.shape.length-1),r=t}else n=e;var u=n.zerosLike(),l=ri(n,u).as2D(o,r),c=Qd(l),f=Math.floor(r/2)+1,d=oi(c),p=ii(c),h=d.split([f,r-f],d.shape.length-1),v=p.split([f,r-f],p.shape.length-1),m=n.shape.slice();return m[n.shape.length-1]=f,ri(h[0],v[0]).reshape(m)}}),ep=ni({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var r=e.as2D(n,t),o=Jd(r);return oi(o)}var i=[n,2*(t-1)],a=oi(e).as2D(n,t),s=ii(e).as2D(n,t),u=a.slice([0,1],[n,t-2]).reverse(1),l=s.slice([0,1],[n,t-2]).reverse(1).mul(ui(-1)),c=a.concat(u,1),f=s.concat(l,1);return r=ri(c,f).as2D(i[0],i[1]),o=Jd(r),oi(o)}}),tp=Object.freeze({fft:Qd,ifft:Jd,rfft:Zd,irfft:ep}),np=ni({sparseToDense_:function(e,t,n,r){void 0===r&&(r=0);var o=Ho(e,"sparseIndices","sparseToDense","int32"),i=Ho(t,"sparseValues","sparseToDense"),a=Ho(r,"defaultValue","sparseToDense",i.dtype);return function(e,t,n,r){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+e.shape+".");var o=e.rank>0?e.shape[0]:1,i=e.rank>1?e.shape[1]:1;if(n.length!==i)throw new Error("outputShape has incorrect number of elements:, "+n.length+", should be: "+i+".");var a=t.size;if(0!==t.rank&&(1!==t.rank||a!==o))throw new Error("sparseValues has incorrect shape "+t.shape+", should be [] or ["+o+"]");if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(o,i,n,a),Nr.runKernelFunc((function(e){return e.sparseToDense(o,i,n,a)}),{$sparseIndices:o,$sparseValues:i,$defaultValue:a})}}),rp=ni({gatherND_:function(e,t){var n=Ho(t,"indices","gatherND","int32"),r=Ho(e,"x","gatherND");return Nr.runKernelFunc((function(e){return e.gatherND(r,n)}),{x:r,indices:n},null,"GatherNd")}}),op=ni({diag_:function(e){var t=Ho(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return Nr.runKernelFunc((function(e){return e.diag(t)}),{$x:t}).reshape(n)}}),ip=ni({dropout_:function(e,t,n,r){var o=Ho(e,"x","dropout");if(wn("float32"===o.dtype,(function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+o.dtype+" tensor instead."})),wn(t>=0&&t<1,(function(){return"rate must be a float in the range [0, 1), but got "+t+"."})),0===t)return e instanceof vr?o.clone():o;var i=function(e,t){if(null==t)return e.shape.slice();if(_n(e.shape,t))return t;if(e.shape.length===t.length){for(var n=[],r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(o,n),a=1-t,s=na(i,0,1,"float32",r).add(a).floor().div(a);return o.mul(s)}});function ap(e,t,n){for(var r=1-e%2,o=new Float32Array(e),i=0;i<e;++i){var a=2*Math.PI*i/(e+r-1);o[i]=t-n*Math.cos(a)}return li(o,"float32")}var sp,up=ni({hannWindow_:function(e){return ap(e,.5,.5)}}),lp=ni({hammingWindow_:function(e){return ap(e,.54,.46)}}),cp=ni({frame_:function(e,t,n,r,o){void 0===r&&(r=!1),void 0===o&&(o=0);for(var i=0,a=[];i+t<=e.size;)a.push(bd(e,i,t)),i+=n;if(r)for(;i<e.size;){var s=i+t-e.size,u=bi([bd(e,i,t-s),vi([s],o)]);a.push(u),i+=n}return 0===a.length?ci([],[0,t]):bi(a).as2D(a.length,t)}}),fp=ni({stft_:function(e,t,n,r,o){var i;void 0===o&&(o=up),null==r&&(i=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var a=cp(e,t,n),s=wf(a,o(t)),u=[],l=0;l<a.shape[0];l++)u.push(Zd(s.slice([l,0],[1,t]),r));return bi(u)}}),dp=Object.freeze({hannWindow:up,hammingWindow:lp,frame:cp,stft:fp});!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(sp||(sp={}));var pp=ni({absoluteDifference_:function(e,t,n,r){void 0===r&&(r=sp.SUM_BY_NONZERO_WEIGHTS);var o=Ho(e,"labels","absoluteDifference"),i=Ho(t,"predictions","absoluteDifference"),a=null;null!=n&&(a=Ho(n,"weights","absoluteDifference")),Cn(o.shape,i.shape,"Error in absoluteDifference: ");var s=o.sub(i).abs();return hp(s,a,r)}}),hp=ni({computeWeightedLoss_:function(e,t,n){void 0===n&&(n=sp.SUM_BY_NONZERO_WEIGHTS);var r=Ho(e,"losses","computeWeightedLoss"),o=null;null!=t&&(o=Ho(t,"weights","computeWeightedLoss"));var i=null==o?r:r.mul(o);if(n===sp.NONE)return i;if(n===sp.SUM)return i.sum();if(n===sp.MEAN){if(null==o)return i.mean();var a=r.size/o.size,s=i.sum().div(o.sum());return a>1?s.div(ui(a)):s}if(n===sp.SUM_BY_NONZERO_WEIGHTS){if(null==o)return i.sum().div(ui(r.size));var u=o.mul(pi(r.shape)).notEqual(ui(0)).sum().toFloat();return i.sum().div(u)}throw Error("Unknown reduction: "+n)}}),vp=ni({cosineDistance_:function(e,t,n,r,o){void 0===o&&(o=sp.SUM_BY_NONZERO_WEIGHTS);var i=Ho(e,"labels","cosineDistance"),a=Ho(t,"predictions","cosineDistance"),s=null;null!=r&&(s=Ho(r,"weights","cosineDistance")),Cn(i.shape,a.shape,"Error in cosineDistance: ");var u=ui(1).sub(i.mul(a).sum(n,!0));return hp(u,s,o)}}),mp=ni({hingeLoss_:function(e,t,n,r){void 0===r&&(r=sp.SUM_BY_NONZERO_WEIGHTS);var o=Ho(e,"labels","hingeLoss"),i=Ho(t,"predictions","hingeLoss"),a=null;null!=n&&(a=Ho(n,"weights","hingeLoss")),Cn(o.shape,i.shape,"Error in hingeLoss: ");var s=ui(1);o=ui(2).mul(o).sub(s);var u=s.sub(o.mul(i)).relu();return hp(u,a,r)}}),gp=ni({huberLoss_:function(e,t,n,r,o){void 0===r&&(r=1),void 0===o&&(o=sp.SUM_BY_NONZERO_WEIGHTS);var i=Ho(e,"labels","huberLoss"),a=Ho(t,"predictions","huberLoss"),s=null;null!=n&&(s=Ho(n,"weights","huberLoss")),Cn(i.shape,a.shape,"Error in huberLoss: ");var u=ui(r),l=a.sub(i).abs(),c=gf(l,u),f=l.sub(c),d=ui(.5).mul(c.square()).add(u.mul(f));return hp(d,s,o)}}),yp=ni({logLoss_:function(e,t,n,r,o){void 0===r&&(r=1e-7),void 0===o&&(o=sp.SUM_BY_NONZERO_WEIGHTS);var i=Ho(e,"labels","logLoss"),a=Ho(t,"predictions","logLoss"),s=null;null!=n&&(s=Ho(n,"weights","logLoss")),Cn(i.shape,a.shape,"Error in logLoss: ");var u=ui(1),l=ui(r),c=i.mul(a.add(l).log()).neg().sub(u.sub(i).mul(u.sub(a).add(l).log()));return hp(c,s,o)}}),bp=ni({meanSquaredError_:function(e,t,n,r){void 0===r&&(r=sp.SUM_BY_NONZERO_WEIGHTS);var o=Ho(e,"labels","meanSquaredError"),i=Ho(t,"predictions","meanSquaredError"),a=null;null!=n&&(a=Ho(n,"weights","meanSquaredError")),Cn(o.shape,i.shape,"Error in meanSquaredError: ");var s=o.squaredDifference(i);return hp(s,a,r)}}),xp=ni({sigmoidCrossEntropy_:function(e,t,n,r,o){void 0===r&&(r=0),void 0===o&&(o=sp.SUM_BY_NONZERO_WEIGHTS);var i=Ho(e,"multiClassLabels","sigmoidCrossEntropy"),a=Ho(t,"logits","sigmoidCrossEntropy"),s=null;if(null!=n&&(s=Ho(n,"weights","sigmoidCrossEntropy")),Cn(i.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=ui(r),l=ui(1),c=ui(.5);i=i.mul(l.sub(u)).add(c.mul(u))}var f=function(e,t){var n=Ho(e,"labels","sigmoidCrossEntropyWithLogits"),r=Ho(t,"logits","sigmoidCrossEntropyWithLogits");Cn(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var o=r.relu(),i=r.mul(n),a=r.abs().neg().exp().log1p();return o.sub(i).add(a)}(i,a);return hp(f,s,o)}}),wp=ni({softmaxCrossEntropy_:function(e,t,n,r,o){void 0===r&&(r=0),void 0===o&&(o=sp.SUM_BY_NONZERO_WEIGHTS);var i=Ho(e,"onehotLabels","softmaxCrossEntropy"),a=Ho(t,"logits","softmaxCrossEntropy"),s=null;if(null!=n&&(s=Ho(n,"weights","softmaxCrossEntropy")),Cn(i.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){var u=ui(r),l=ui(1),c=ui(i.shape[1]);i=i.mul(l.sub(u)).add(u.div(c))}var f=function(e,t,n){if(void 0===n&&(n=-1),-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+t.rank+" and dim was "+n);return Ra((function(e,t,r){var o=t.logSumExp([n],!0),i=t.toFloat().sub(o);return r([e,i]),{value:i.mul(e).neg().sum([n]),gradFunc:function(e,t){var r=t[0],o=t[1],i=$o(e.shape,[n]);return[e.reshape(i).mul(r.toFloat().sub(o.exp())),e.reshape(i).mul(o.exp().sub(r.toFloat()))]}}}))(e,t)}(i,a);return hp(f,s,o)}}),Cp=Object.freeze({get Reduction(){return sp},absoluteDifference:pp,computeWeightedLoss:hp,cosineDistance:vp,hingeLoss:mp,huberLoss:gp,logLoss:yp,meanSquaredError:bp,sigmoidCrossEntropy:xp,softmaxCrossEntropy:wp});function Ep(e,t){return void 0===t&&(t=!1),Nr.tidy((function(){if(2!==e.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],r=e.shape[1],o=Gi(n),i=e.clone(),a=ci([[1]],[1,1]),s=a.clone(),u=n>=r?r:n,l=function(e){var t,u=i,l=s,c=o;t=Nr.tidy((function(){var t=i.slice([e,e],[n-e,1]),u=t.norm(),l=i.slice([e,e],[1,1]),c=ci([[-1]]).where(l.greater(0),ci([[1]])),f=l.sub(c.mul(u)),d=t.div(f);s=1===d.shape[0]?a.clone():a.concat(d.slice([1,0],[d.shape[0]-1,d.shape[1]]),0);var p=c.matMul(f).div(u).neg(),h=i.slice([e,0],[n-e,r]),v=p.mul(s);if(0===e)i=h.sub(v.matMul(s.transpose().matMul(h)));else{var m=h.sub(v.matMul(s.transpose().matMul(h)));i=i.slice([0,0],[e,r]).concat(m,0)}var g=o.slice([0,e],[n,o.shape[1]-e]);if(0===e)o=g.sub(g.matMul(s).matMul(v.transpose()));else{var y=g.sub(g.matMul(s).matMul(v.transpose()));o=o.slice([0,0],[n,e]).concat(y,1)}return[s,i,o]})),s=t[0],i=t[1],o=t[2],Wo([u,l,c])},c=0;c<u;++c)l(c);return!t&&n>r&&(o=o.slice([0,0],[n,r]),i=i.slice([0,0],[r,r])),[o,i]}))}var Sp=ni({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=Ho(e,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var o=r.shape,i=r.shape.slice(-2),a=i[0],s=i[1];if(!(t<=a))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+a+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");t<0&&(t=a),n<0&&(n=s);var u=mi(0,a,1,"int32").reshape([-1,1]),l=mi(0,s,1,"int32"),c=_f(u,l),f=ef(c.lessEqual(ui(+t,"int32")),c.greaterEqual(ui(-n,"int32"))),d=hi([a,s],r.dtype);return aa(la(r.reshape([-1,a,s])).map((function(e){return of(f,e,d)}))).reshape(o)}}),kp=ni({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,wn(null!=e&&e.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=e[0].shape[0],r=function(t){wn(e[t].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[t].shape[0]+" vs. "+n+")"}))},o=1;o<e.length;++o)r(o)}else t=!0,e=Si(e,e.shape[0],0).map((function(e){return ia(e,[0])}));wn(e.length<=e[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."}));var i=[],a=e,s=function(e){i.push(Nr.tidy((function(){var t=a[e];if(e>0)for(var n=0;n<e;++n){var r=Md(i[n].mulStrict(t)).mul(i[n]);t=t.sub(r)}return t.div(Hd(t,"euclidean"))})))};for(o=0;o<e.length;++o)s(o);return t?aa(i,0):i}}),_p=ni({qr_:function(e,t){if(void 0===t&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(2===e.rank)return Ep(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce((function(e,t){return e*t})),r=la(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),o=[],i=[];return r.forEach((function(e){var n=Ep(e,t),r=n[0],a=n[1];o.push(r),i.push(a)})),[aa(o,0).reshape(e.shape),aa(i,0).reshape(e.shape)]}}),Rp=Object.freeze({bandPart:Sp,gramSchmidt:kp,qr:_p});function Ip(e,t,n,r,o,i){null==r&&(r=.5),null==o&&(o=Number.NEGATIVE_INFINITY),null==i&&(i=0);var a=e.shape[0];return n=Math.min(n,a),wn(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"})),wn(2===e.rank,(function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"})),wn(4===e.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]})),wn(1===t.rank,(function(){return"scores must be a 1D tensor"})),wn(t.shape[0]===a,(function(){return"scores has incompatible shape with boxes. Expected "+a+", but was "+t.shape[0]})),wn(0<=i&&i<=1,(function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:o,softNmsSigma:i}}var Tp=ni({resizeBilinear_:function(e,t,n){void 0===n&&(n=!1);var r=Ho(e,"images","resizeBilinear");wn(3===r.rank||4===r.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."})),wn(2===t.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."}));var o=r,i=!1;3===r.rank&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=t[0],s=t[1],u=Nr.runKernelFunc((function(e,t){return t([o]),e.resizeBilinear(o,a,s,n)}),{x:o},(function(e,t){return{x:function(){return Nr.runKernelFunc((function(r){return r.resizeBilinearBackprop(e,t[0],n)}),{})}}}),"ResizeBilinear",{alignCorners:n,newHeight:a,newWidth:s});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Ap=ni({resizeNearestNeighbor_:function(e,t,n){void 0===n&&(n=!1);var r=Ho(e,"images","resizeNearestNeighbor");wn(3===r.rank||4===r.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."})),wn(2===t.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."})),wn("float32"===r.dtype||"int32"===r.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"}));var o=r,i=!1;3===r.rank&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=t[0],s=t[1],u=Nr.runKernelFunc((function(e,t){return t([o]),e.resizeNearestNeighbor(o,a,s,n)}),{batchImages:o},(function(e,t){return{batchImages:function(){return Nr.runKernelFunc((function(r){return r.resizeNearestNeighborBackprop(e,t[0],n)}),{})}}}));return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Dp=ni({nonMaxSuppression_:function(e,t,n,r,o){void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY);var i=Ho(e,"boxes","nonMaxSuppression"),a=Ho(t,"scores","nonMaxSuppression"),s=Ip(i,a,n,r,o);n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold;var u={maxOutputSize:n,iouThreshold:r,scoreThreshold:o};return Nr.runKernelFunc((function(e){return e.nonMaxSuppression(i,a,n,r,o)}),{boxes:i,scores:a},null,"NonMaxSuppressionV3",u)}}),Np=ni({nonMaxSuppressionWithScore_:function(e,t,n,r,o,i){void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY),void 0===i&&(i=0);var a=Ho(e,"boxes","nonMaxSuppression"),s=Ho(t,"scores","nonMaxSuppression"),u=Ip(a,s,n,r,o,i),l={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:o=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},c=Nr.runKernel("NonMaxSuppressionV5",{boxes:a,scores:s},l);return{selectedIndices:c[0],selectedScores:c[1]}}}),Pp=ni({cropAndResize_:function(e,t,n,r,o,i){var a=Ho(e,"image","cropAndResize"),s=Ho(t,"boxes","cropAndResize","float32"),u=Ho(n,"boxInd","cropAndResize","int32");o=o||"bilinear",i=i||0;var l=s.shape[0];return wn(4===a.rank,(function(){return"Error in cropAndResize: image must be rank 4,but got rank "+a.rank+"."})),wn(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size ["+l+",4] but had shape "+s.shape+"."})),wn(1===u.rank&&u.shape[0]===l,(function(){return"Error in cropAndResize: boxInd must be have size ["+l+"] but had shape "+s.shape+"."})),wn(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."})),wn(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was "+r})),wn("bilinear"===o||"nearest"===o,(function(){return"method must be bilinear or nearest, but was "+o})),Nr.runKernelFunc((function(e,t){return e.cropAndResize(a,s,u,r,o,i)}),{images:a,boxes:s,boxInd:u},null,"CropAndResize",{method:o,extrapolationValue:i,cropSize:r})}}),Mp=Object.freeze({resizeBilinear:Tp,resizeNearestNeighbor:Ap,nonMaxSuppression:Dp,nonMaxSuppressionAsync:function(e,t,n,r,o){return void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY),rn(this,void 0,void 0,(function(){var i,a,s,u,l,c,f;return on(this,(function(d){switch(d.label){case 0:return i=Ho(e,"boxes","nonMaxSuppressionAsync"),a=Ho(t,"scores","nonMaxSuppressionAsync"),s=Ip(i,a,n,r,o),n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold,[4,Promise.all([i.data(),a.data()])];case 1:return u=d.sent(),l=u[0],c=u[1],f=rs(l,c,n,r,o),i!==e&&i.dispose(),a!==t&&a.dispose(),[2,f]}}))}))},nonMaxSuppressionWithScore:Np,nonMaxSuppressionWithScoreAsync:function(e,t,n,r,o,i){return void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY),void 0===i&&(i=0),rn(this,void 0,void 0,(function(){var a,s,u,l,c,f,d;return on(this,(function(p){switch(p.label){case 0:return a=Ho(e,"boxes","nonMaxSuppressionAsync"),s=Ho(t,"scores","nonMaxSuppressionAsync"),u=Ip(a,s,n,r,o,i),n=u.maxOutputSize,r=u.iouThreshold,o=u.scoreThreshold,i=u.softNmsSigma,[4,Promise.all([a.data(),s.data()])];case 1:return l=p.sent(),c=l[0],f=l[1],d=os(c,f,n,r,o,i),a!==e&&a.dispose(),s!==t&&s.dispose(),[2,d]}}))}))},cropAndResize:Pp}),Op=function(e,t){return!(e>0)||"linear"===t},Fp=function(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return e.mul(t.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},Lp=function(e,t){var n=t,r=Ma(e.shape,t.shape);return r.length>0&&(n=n.sum(r)),n.reshape(e.shape)},Bp=function(e,t,n){if("linear"===t)return e;if("relu"===t)return zd(e);if("elu"===t)return Fd(e);if("relu6"===t)return Wd(e);if("prelu"===t)return Bd(e,n);throw new Error("Unknown fused activation "+t+".")},zp=ni({fusedMatMul_:function(e){var t,n=e.a,r=e.b,o=e.transposeA,i=void 0!==o&&o,a=e.transposeB,s=void 0!==a&&a,u=e.bias,l=e.activation,c=void 0===l?"linear":l,f=e.preluActivationWeights;if(!1===Op(Nr.state.gradientDepth,c)){var d=od(n,r,i,s);return null!=u&&(d=sf(d,u)),Bp(d,c,f)}var p=Ho(n,"a","fused matMul"),h=Ho(r,"b","fused matMul");t=_r(p,h),p=t[0],h=t[1];var v=i?p.shape[p.rank-2]:p.shape[p.rank-1],m=s?h.shape[h.rank-1]:h.shape[h.rank-2],g=i?p.shape[p.rank-1]:p.shape[p.rank-2],y=s?h.shape[h.rank-2]:h.shape[h.rank-1],b=p.shape.slice(0,-2),x=h.shape.slice(0,-2),w=kn(b),C=kn(x);wn(p.rank>=2&&h.rank>=2&&p.rank===h.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+p.rank+" and "+h.rank+"."})),wn(_n(b,x),(function(){return"Error in fused matMul: outer dimensions ("+b+") and ("+x+") of Tensors with shapes "+p.shape+" and "+h.shape+" must match."})),wn(v===m,(function(){return"Error in fused matMul: inner shapes ("+v+") and ("+m+") of Tensors with shapes "+p.shape+" and "+h.shape+" and transposeA="+i+" and transposeB="+s+" must match."}));var E,S,k=p.shape.slice(0,-2).concat([g,y]),_=i?p.as3D(w,v,g):p.as3D(w,g,v),R=s?h.as3D(C,y,m):h.as3D(C,m,y);null!=u&&Oa(k,(E=_r(E=Ho(u,"bias","fused matMul"),p)[0]).shape),null!=f&&(S=Ho(f,"prelu weights","fused matMul"));var I={a:_,b:R};null!=u&&(I.bias=E),null!=f&&(I.preluActivationWeights=S);var T=[_,R];return Nr.runKernelFunc((function(e,t){var n=e.fusedBatchMatMul({a:_,b:R,transposeA:i,transposeB:s,bias:E,activation:c,preluActivationWeights:S});return t([_,R,n]),n}),I,(function(e,t){var n=t[0],r=t[1],o=t[2],a=Fp(e,o,c),l={};return null!=u&&(l={bias:function(){return Lp(E,a)}}),i||s?!i&&s?Object.assign({a:function(){return a.matMul(r,!1,!1)},b:function(){return a.matMul(n,!0,!1)}},l):i&&!s?Object.assign({a:function(){return r.matMul(a,!1,!0)},b:function(){return n.matMul(a,!1,!1)}},l):Object.assign({a:function(){return r.matMul(a,!0,!0)},b:function(){return a.matMul(n,!0,!0)}},l):Object.assign({a:function(){return a.matMul(r,!1,!0)},b:function(){return n.matMul(a,!0,!1)}},l)}),"_FusedMatMul",{transposeA:i,transposeB:s,activation:c},T,[!0]).reshape(k)}}),Wp=ni({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,o=e.pad,i=e.dataFormat,a=void 0===i?"NHWC":i,s=e.dilations,u=void 0===s?[1,1]:s,l=e.dimRoundingMode,c=e.bias,f=e.activation,d=void 0===f?"linear":f,p=e.preluActivationWeights;if(d=d||"linear",!1===Op(Nr.state.gradientDepth,d)){var h=Xf(t,n,r,o,a,u,l);return null!=c&&(h=sf(h,c)),Bp(h,d,p)}var v=Ho(t,"x","conv2d"),m=Ho(n,"filter","conv2d"),g=v,y=!1;3===v.rank&&(y=!0,g=v.as4D(1,v.shape[0],v.shape[1],v.shape[2])),wn(4===g.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+g.rank+"."})),wn(4===m.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+m.rank+"."})),null!=l&&wn(Rn(o),(function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+l+" but got pad "+o+"."})),wn(g.shape[3]===m.shape[2],(function(){return"Error in conv2d: depth of input ("+g.shape[3]+") must match input depth for filter "+m.shape[2]+"."})),wn(qa(r,u),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"})),wn("NHWC"===a,(function(){return"Error in conv2d: got dataFormat of "+a+" but only NHWC is currently supported."}));var b,x,w=Ba(g.shape,m.shape,r,u,o,l);null!=c&&(b=_r(b=Ho(c,"bias","fused conv2d"),v)[0],Oa(w.outShape,b.shape)),null!=p&&(x=Ho(p,"prelu weights","fused conv2d"));var C={x:g,filter:m};null!=c&&(C.bias=b),null!=p&&(C.preluActivationWeights=x);var E=[m,g],S=Nr.runKernelFunc((function(e,t){var n=e.fusedConv2d({input:g,filter:m,convInfo:w,bias:b,activation:d,preluActivationWeights:x});return t([m,g,n]),n}),C,(function(e,t){var n=t,i=n[0],a=n[1],s=n[2],l=Fp(e,s,d);wn(Ga(u),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"}));var f={};return null!=c&&(f={bias:function(){return Lp(b,l)}}),Object.assign({x:function(){return Qf(a.shape,l,i,r,o)},filter:function(){return Yf(a,l,i.shape,r,o)}},f)}),"FusedConv2D",{convInfo:w,activation:d},E,[!0]);return y?S.as3D(S.shape[1],S.shape[2],S.shape[3]):S}}),Vp=ni({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,o=e.pad,i=e.dataFormat,a=void 0===i?"NHWC":i,s=e.dilations,u=void 0===s?[1,1]:s,l=e.dimRoundingMode,c=e.bias,f=e.activation,d=void 0===f?"linear":f,p=e.preluActivationWeights;if(!1===Op(Nr.state.gradientDepth,d)){var h=Jf(t,n,r,o,a,u,l);return null!=c&&(h=sf(h,c)),Bp(h,d,p)}var v=Ho(t,"x","depthwiseConv2d"),m=Ho(n,"filter","depthwiseConv2d"),g=v,y=!1;3===v.rank&&(y=!0,g=v.as4D(1,v.shape[0],v.shape[1],v.shape[2])),wn(4===g.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+g.rank+"."})),wn(4===m.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+m.rank+"."})),wn(g.shape[3]===m.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels ("+g.shape[3]+") must match the inChannels dimension in filter "+m.shape[2]+"."})),null==u&&(u=[1,1]),wn(qa(r,u),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"})),null!=l&&wn(Rn(o),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+l+" but got pad "+o+"."}));var b,x,w=Ba(g.shape,m.shape,r,u,o,l,!0);null!=c&&(b=_r(b=Ho(c,"bias","fused conv2d"),v)[0],Oa(w.outShape,b.shape)),null!=p&&(x=Ho(p,"prelu weights","fused depthwiseConv2d"));var C={x:g,filter:m};null!=c&&(C.bias=b),null!=p&&(C.preluActivationWeights=x);var E=[m,g],S=Nr.runKernelFunc((function(e,t){var n=e.fusedDepthwiseConv2D({input:g,filter:m,convInfo:w,bias:b,activation:d,preluActivationWeights:x});return t([m,g,n]),n}),C,(function(e,t){wn(Ga(u),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"}));var n=t[0],r=t[1],o=t[2],i=Fp(e,o,d),a={};return null!=c&&(a={bias:function(){return Lp(b,i)}}),Object.assign({x:function(){return Zf(r.shape,i,n,w)},filter:function(){return ed(r,i,n.shape,w)}},a)}),"FusedDepthwiseConv2D",{convInfo:w,activation:d},E,[!0]);return y?S.as3D(S.shape[1],S.shape[2],S.shape[3]):S}}),Up=Object.freeze({matMul:zp,conv2d:Wp,depthwiseConv2d:Vp}),jp=Object.freeze({image:Mp,linalg:Rp,losses:Cp,spectral:tp,fused:Up,signal:dp,square:rc,squaredDifference:ic,conv1d:Kf,conv2d:Xf,conv3d:$f,depthwiseConv2d:Jf,separableConv2d:td,conv2dTranspose:nd,conv3dTranspose:rd,op:ni,batchNormalization2d:qc,batchNormalization3d:Kc,batchNormalization4d:Xc,batchNormalization:$c,batchNorm:Yc,batchNorm2d:Qc,batchNorm3d:Jc,batchNorm4d:Zc,booleanMaskAsync:function(e,t,n){return rn(this,void 0,void 0,(function(){var r,o,i,a,s,u,l,c,f,d,p,h,v;return on(this,(function(m){switch(m.label){case 0:for(r=Ho(e,"tensor","boolMask"),o=Ho(t,"mask","boolMask","bool"),i=null==n?0:n,a=o.rank,s=r.shape,wn(a>0,(function(){return"mask cannot be scalar"})),Cn(s.slice(i,i+a),o.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,l=i;l<i+a;l++)u*=s[l];return c=s.slice(0,i).concat([u],s.slice(i+a)),f=r.reshape(c),d=o.reshape([-1]),[4,af(d)];case 1:return p=m.sent(),h=p.squeeze([1]),v=Uf(f,h,i),e!==r&&r.dispose(),t!==o&&o.dispose(),h.dispose(),f.dispose(),d.dispose(),p.dispose(),[2,v]}}))}))},complex:ri,real:oi,imag:ii,concat:bi,concat1d:xi,concat2d:wi,concat3d:Ci,concat4d:Ei,split:Si,matMul:od,dot:id,outerProduct:ad,reverse:sd,reverse1d:ud,reverse2d:ld,reverse3d:cd,reverse4d:fd,maxPool:hd,avgPool:vd,pool:md,maxPool3d:gd,avgPool3d:yd,slice:bd,slice1d:xd,slice2d:wd,slice3d:Cd,slice4d:Ed,abs:ac,acos:sc,acosh:uc,asin:lc,asinh:cc,atan:fc,atanh:dc,ceil:pc,clipByValue:hc,cos:vc,cosh:mc,erf:gc,exp:yc,expm1:bc,floor:xc,log:wc,log1p:Cc,logSigmoid:Ec,neg:Sc,reciprocal:kc,round:_c,rsqrt:Rc,sigmoid:Ic,sign:Tc,isNaN:Ac,isInf:Dc,isFinite:Nc,sin:Pc,sinh:Mc,softplus:Oc,sqrt:Fc,step:Lc,tan:Bc,tanh:zc,all:kd,any:_d,argMax:Rd,argMin:Id,logSumExp:Td,max:Ad,mean:Dd,min:Nd,moments:Pd,sum:Md,prod:Od,equal:If,equalStrict:Tf,greater:Af,greaterEqual:Df,greaterEqualStrict:Nf,greaterStrict:Pf,less:Mf,lessEqual:Of,lessEqualStrict:Ff,lessStrict:Lf,notEqual:Bf,notEqualStrict:zf,add:sf,addN:uf,addStrict:lf,atan2:cf,div:ff,divNoNan:df,divStrict:pf,floorDiv:hf,maximum:vf,maximumStrict:mf,minimum:gf,minimumStrict:yf,mod:bf,modStrict:xf,mul:wf,mulStrict:Cf,pow:Ef,powStrict:Sf,squaredDifferenceStrict:kf,sub:_f,subStrict:Rf,elu:Fd,leakyRelu:Ld,prelu:Bd,relu:zd,relu6:Wd,selu:Vd,logicalAnd:ef,logicalNot:tf,logicalOr:nf,logicalXor:rf,where:of,whereAsync:af,buffer:Li,print:function(e,t){void 0===t&&(t=!1),console.log(e.toString(t))},batchToSpaceND:Bi,broadcastTo:zi,cast:Wi,clone:Vi,cumsum:Ui,depthToSpace:ji,expandDims:Hi,eye:Gi,multinomial:qi,oneHot:Ki,pad:Xi,pad1d:$i,pad2d:Yi,pad3d:Qi,pad4d:Ji,rand:Zi,randomNormal:ea,randomGamma:ta,randomUniform:na,reshape:ra,spaceToBatchND:oa,squeeze:ia,stack:aa,tile:sa,truncatedNormal:ua,unstack:la,setdiff1dAsync:function(e,t){return rn(this,void 0,void 0,(function(){var n,r,o,i,a,s,u,l,c,f;return on(this,(function(d){switch(d.label){case 0:return n=Ho(e,"x","setdiff1d"),r=Ho(t,"y","setdiff1d"),wn(n.dtype===r.dtype,(function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."})),wn(1===n.rank,(function(){return"x should be 1D tensor, but got x ("+n.shape+")."})),wn(1===r.rank,(function(){return"y should be 1D tensor, but got y ("+r.shape+")."})),[4,n.data()];case 1:return o=d.sent(),[4,r.data()];case 2:for(i=d.sent(),a=new Set(i),s=0,c=0;c<o.length;c++)a.has(o[c])||s++;for(u=new fr([s],n.dtype),l=new fr([s],"int32"),c=0,f=0;c<o.length;c++)a.has(o[c])||(u.values[f]=o[c],l.values[f]=c,f++);return[2,[u.toTensor(),l.toTensor()]]}}))}))},fill:vi,linspace:function(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return Nr.runKernelFunc((function(r){return r.linspace(e,t,n)}),{})},ones:pi,range:mi,scalar:ui,tensor:ai,tensor1d:li,tensor2d:ci,tensor3d:fi,tensor4d:di,tensor5d:function(e,t,n){if(En(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");var r=Uo(e,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return si(e,t,r,n)},tensor6d:function(e,t,n){if(En(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");var r=Uo(e,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return si(e,t=t||r,r,n)},variable:function(e,t,n,r){return void 0===t&&(t=!0),Nr.makeVariable(e,t,n,r)},zeros:hi,onesLike:gi,zerosLike:yi,transpose:Ud,softmax:Ia,logSoftmax:Ta,localResponseNormalization:jd,norm:Hd,gather:Uf,unsortedSegmentSum:jf,basicLSTMCell:Gd,multiRNNCell:qd,movingAverage:Kd,stridedSlice:Xd,topk:$d,scatterND:Yd,fft:Qd,ifft:Jd,rfft:Zd,irfft:ep,sparseToDense:np,gatherND:rp,diag:op,dropout:ip,hannWindow:up,hammingWindow:lp,frame:cp,stft:fp,inTopKAsync:function(e,t,n){return void 0===n&&(n=1),rn(this,void 0,void 0,(function(){var r,o,i,a,s,u,l,c,f,d,p,h,v,m;return on(this,(function(g){switch(g.label){case 0:return r=Ho(e,"predictions","inTopK"),o=Ho(t,"targets","inTopK"),wn(r.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank})),wn(r.rank-1===o.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+o.rank})),Cn(r.shape.slice(0,r.shape.length-1),o.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=r.shape[r.shape.length-1],wn(n>0&&n<=i,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+n})),[4,r.data()];case 1:return a=g.sent(),[4,o.data()];case 2:for(s=g.sent(),u=[a.length/i,i],c=u[1],f=On("bool",l=u[0]),d=0;d<l;d++){for(p=d*c,h=a.subarray(p,p+c),v=[],m=0;m<h.length;m++)v.push({value:h[m],index:m});for(v.sort((function(e,t){return t.value-e.value})),f[d]=0,m=0;m<n;m++)if(v[m].index===s[d]){f[d]=1;break}}return e!==r&&r.dispose(),t!==o&&o.dispose(),[2,ai(f,o.shape,"bool")]}}))}))}});function Hp(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&wn("complex64"!==e.dtype,(function(){return t+" does not support complex64 tensors."}))}))}function Gp(e,t,n,r){if("linear"===n)return e.linear(t);if("relu"===n)return e.relu(t);if("elu"===n)return e.elu(t);if("relu6"===n)return e.relu6(t);if("prelu"===n)return e.prelu(t,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var qp=function(e){function t(){var t=e.call(this)||this;return t.blockSize=48,t.firstUse=!0,t.data=new Aa(t,Nr),t}return nn(t,e),t.prototype.write=function(e,t,n){this.firstUse&&(this.firstUse=!1,un().get("IS_NODE")&&Vo("\n============================\nHi there \ud83d\udc4b. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));var r={};return this.data.set(r,{values:e,dtype:n}),r},t.prototype.move=function(e,t,n,r){this.data.set(e,{values:t,dtype:r})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(e){return rn(this,void 0,void 0,(function(){return on(this,(function(t){return[2,this.readSync(e)]}))}))},t.prototype.readSync=function(e){var t=this.data.get(e),n=t.dtype,r=t.complexTensors;return"complex64"===n?Qa(this.readSync(r.real.dataId),this.readSync(r.imag.dataId)):this.data.get(e).values},t.prototype.bufferSync=function(e){var t=this.readSync(e.dataId),n=t;if("string"===e.dtype)try{n=t.map((function(e){return rr(e)}))}catch(e){throw new Error("Failed to decode encoded string bytes into utf-8")}return Li(e.shape,e.dtype,n)},t.prototype.makeOutput=function(e,t,n){var r=this.write(e,t,n);return Nr.makeTensorFromDataId(r,t,n,this)},t.prototype.disposeData=function(e){if(this.data.has(e)){var t=this.data.get(e).complexTensors;null!=t&&(t.real.dispose(),t.imag.dispose()),this.data.delete(e)}},t.prototype.time=function(e){return rn(this,void 0,void 0,(function(){var t;return on(this,(function(n){return t=er(),e(),[2,{kernelMs:er()-t}]}))}))},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(e,t){var n=this.makeOutput(null,e.shape,"complex64");return this.data.get(n.dataId).complexTensors={real:Nr.keep(e.clone()),imag:Nr.keep(t.clone())},n},t.prototype.real=function(e){return this.data.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.data.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,t,n){if(Hp(e,"slice"),ka(e.shape,t,n)){var r=_a(t,e.strides),o=kn(n);return ai(this.readSync(e.dataId).subarray(r,r+o),n,e.dtype)}for(var i=Li(n,e.dtype),a=this.bufferSync(e),s=0;s<i.size;++s){var u=i.indexToLoc(s).map((function(e,n){return e+t[n]}));i.values[s]=a.get.apply(a,u)}return i.toTensor()},t.prototype.stridedSlice=function(e,t,n,r){Hp(e,"stridedSlice");var o=Ca(t,n,r);if(o.some((function(e){return 0===e})))return ai([],o);for(var i=Li(o,e.dtype),a=this.bufferSync(e),s=0;s<i.size;s++){for(var u=i.indexToLoc(s),l=new Array(u.length),c=0;c<l.length;c++)l[c]=u[c]*r[c]+t[c];i.set.apply(i,[a.get.apply(a,l)].concat(u))}return i.toTensor()},t.prototype.diag=function(e){for(var t=this.readSync(e.dataId),n=Li([e.size,e.size],e.dtype),r=n.values,o=0;o<t.length;o++)r[o*e.size+o]=t[o];return n.toTensor()},t.prototype.unstack=function(e,t){for(var n=e.shape[t],r=new Array(e.rank-1),o=0,i=0;i<e.rank;i++)i!==t&&(r[o++]=e.shape[i]);var a=new Array(e.rank).fill(0),s=e.shape.slice();s[t]=1;var u=new Array(n);for(i=0;i<u.length;i++)a[t]=i,u[i]=this.slice(e,a,s).reshape(r);return u},t.prototype.reverse=function(e,t){Hp(e,"reverse");for(var n=Li(e.shape,e.dtype),r=this.bufferSync(e),o=function(o){var i=n.indexToLoc(o),a=i.slice();t.forEach((function(t){return a[t]=e.shape[t]-1-a[t]})),n.set.apply(n,[r.get.apply(r,a)].concat(i))},i=0;i<n.size;i++)o(i);return n.toTensor()},t.prototype.concat=function(e,t){var n=this;if("complex64"===e[0].dtype){var r=e.map((function(e){return oi(e)})),o=e.map((function(e){return ii(e)}));return ri(this.concat(r,t),this.concat(o,t))}var i=e.map((function(e){var n=kn(e.shape.slice(t));return e.as2D(-1,n)})),a=ti(i.map((function(e){return e.shape})),1),s=Li(a,e[0].dtype).values;if(1===i[0].shape[0]){var u=0;i.forEach((function(e){s.set(n.readSync(e.dataId),u),u+=e.size}))}else{var l=0;i.forEach((function(e){for(var t=n.readSync(e.dataId),r=0,o=0;o<e.shape[0];++o)for(var i=o*a[1]+l,u=0;u<e.shape[1];++u)s[i+u]=t[r++];l+=e.shape[1]}))}var c=ti(e.map((function(e){return e.shape})),t);return ai(s,c,e[0].dtype)},t.prototype.neg=function(e){return Hp(e,"neg"),this.multiply(ui(-1),e)},t.prototype.add=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e+n,imag:t+r}})):this.broadcastedBinaryOp(e,t,Sr(e.dtype,t.dtype),(function(e,t){return e+t}))},t.prototype.addN=function(e){var t=this;Hp(e,"addN");for(var n=e.map((function(e){return t.readSync(e.dataId)})),r=Li(e[0].shape,e[0].dtype),o=r.values,i=0;i<e.length;i++)for(var a=n[i],s=0;s<o.length;s++)o[s]+=a[s];return r.toTensor()},t.prototype.softmax=function(e,t){var n=Pn([t],e.shape),r=this.max(e,n),o=$o(r.shape,n),i=this.subtract(e,r.reshape(o)),a=this.exp(i),s=this.sum(a,n).reshape(o);return this.realDivide(a,s)},t.prototype.subtract=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e-n,imag:t-r}})):this.broadcastedBinaryOp(e,t,Sr(e.dtype,t.dtype),(function(e,t){return e-t}))},t.prototype.pow=function(e,t){return Hp([e,t],"pow"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.pow(e,t)}))},t.prototype.batchMatMul=function(e,t,n,r){Hp([e,t],"matMul");for(var o=n?e.shape[1]:e.shape[2],i=n?e.shape[2]:e.shape[1],a=r?t.shape[1]:t.shape[2],s=e.shape[0],u=this.readSync(e.dataId),l=this.readSync(t.dataId),c=n?[e.strides[0],1,e.strides[1]]:[e.strides[0],e.strides[1],1],f=c[0],d=c[1],p=c[2],h=r?[1,t.strides[1],t.strides[0]]:[t.strides[1],1,t.strides[0]],v=h[0],m=h[1],g=h[2],y=i*a,b=Li([s,i,a],e.dtype),x=b.values,w=this.blockSize,C=0;C<s;C++)for(var E=0;E<i;E+=w)for(var S=0;S<a;S+=w)for(var k=0;k<o;k+=w)for(var _=Math.min(E+w,i),R=Math.min(S+w,a),I=Math.min(k+w,o),T=E;T<_;T++)for(var A=S;A<R;A++){for(var D=0,N=k;N<I;N++)D+=u[C*f+T*d+N*p]*l[N*v+A*m+C*g];x[C*y+(T*a+A)]+=D}return b.toTensor()},t.prototype.fusedBatchMatMul=function(e){var t=e.a,n=e.b,r=e.transposeA,o=e.transposeB,i=e.bias,a=e.activation,s=e.preluActivationWeights,u=this.batchMatMul(t,n,r,o);return i&&(u=this.add(u,i)),a&&(u=Gp(this,u,a,s)),u},t.prototype.multiply=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e*n-t*r,imag:e*r+t*n}})):this.broadcastedBinaryOp(e,t,Sr(e.dtype,t.dtype),(function(e,t){return e*t}))},t.prototype.realDivide=function(e,t){return Hp([e,t],"realDivide"),this.broadcastedBinaryOp(e,t,"float32",(function(e,t){return e/t}))},t.prototype.floorDiv=function(e,t){return Hp([e,t],"floorDiv"),this.broadcastedBinaryOp(e,t,"int32",(function(e,t){return Math.floor(e/t)}))},t.prototype.sum=function(e,t){Hp(e,"sum"),Yo("sum",t,e.rank);for(var n=Xo(e.shape,t),r=n[0],o=n[1],i=hi(r,Sr(e.dtype,"int32")),a=kn(o),s=this.readSync(i.dataId),u=this.readSync(e.dataId),l=0;l<s.length;++l){for(var c=l*a,f=0,d=0;d<a;++d)f+=u[c+d];s[l]=f}return i},t.prototype.prod=function(e,t){Hp(e,"sum");for(var n=Xo(e.shape,t),r=n[0],o=n[1],i=hi(r,Sr(e.dtype,"int32")),a=kn(o),s=this.readSync(i.dataId),u=this.readSync(e.dataId),l=0;l<s.length;++l){for(var c=l*a,f=1,d=0;d<a;++d)f*=u[c+d];s[l]=f}return i},t.prototype.unsortedSegmentSum=function(e,t,n){Hp(e,"unsortedSegmentSum");for(var r=[],o=e.rank-t.rank,i=0;i<o;++i)t=t.expandDims(i+1);for(i=0;i<n;++i){var a=ui(i,"int32"),s=If(a,t).asType("float32").mul(e).sum(0);r.push(s)}return aa(r)},t.prototype.argMin=function(e,t){Hp(e,"argMin");var n=[t];Yo("argMin",n,e.rank);for(var r=Xo(e.shape,n),o=r[0],i=r[1],a=hi(o,"int32"),s=kn(i),u=this.readSync(a.dataId),l=this.readSync(e.dataId),c=0;c<u.length;++c){for(var f=c*s,d=l[f],p=0,h=0;h<s;++h){var v=l[f+h];v<d&&(d=v,p=h)}u[c]=p}return a},t.prototype.argMax=function(e,t){Hp(e,"argMax");var n=[t];Yo("argMax",n,e.rank);for(var r=Xo(e.shape,n),o=r[0],i=r[1],a=hi(o,"int32"),s=kn(i),u=this.readSync(a.dataId),l=this.readSync(e.dataId),c=0;c<u.length;++c){for(var f=c*s,d=l[f],p=0,h=0;h<s;++h){var v=l[f+h];v>d&&(d=v,p=h)}u[c]=p}return a},t.prototype.cumsum=function(e,t,n,r){if(Hp(e,"cumsum"),t!==e.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(e.rank-1)+" but got axis="+t);for(var o=Sr(e.dtype,"int32"),i=hi(e.shape,o),a=this.readSync(i.dataId),s=this.readSync(e.dataId),u=e.shape[e.rank-1],l=r?function(e,t){return e+u-t-1}:function(e,t){return e+t},c=0;c<s.length;c+=u)for(var f=0;f<u;f++){var d=l(c,f);if(0===f)a[d]=n?0:s[d];else{var p=l(c,f-1);a[d]=n?s[p]+a[p]:s[d]+a[p]}}return i},t.prototype.equal=function(e,t){return Hp([e,t],"equal"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e===t?1:0}))},t.prototype.notEqual=function(e,t){return Hp([e,t],"notEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e!==t?1:0}))},t.prototype.less=function(e,t){return Hp([e,t],"less"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e<t?1:0}))},t.prototype.lessEqual=function(e,t){return Hp([e,t],"lessEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e<=t?1:0}))},t.prototype.greater=function(e,t){return Hp([e,t],"greater"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e>t?1:0}))},t.prototype.greaterEqual=function(e,t){return Hp([e,t],"greaterEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e>=t?1:0}))},t.prototype.logicalNot=function(e){Hp(e,"logicalNot");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)n[r]=t[r]?0:1;return this.makeOutput(n,e.shape,"bool")},t.prototype.logicalAnd=function(e,t){return Hp([e,t],"logicalAnd"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e&&t}))},t.prototype.logicalOr=function(e,t){return Hp([e,t],"logicalOr"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e||t}))},t.prototype.select=function(e,t,n){Hp([e,t,n],"select");for(var r=this.readSync(e.dataId),o=this.readSync(t.dataId),i=this.readSync(n.dataId),a=hi(t.shape,Sr(t.dtype,n.dtype)),s=this.readSync(a.dataId),u=0,l=0===e.rank||e.rank>1||1===t.rank?1:kn(t.shape.slice(1)),c=0;c<r.length;c++)for(var f=0;f<l;f++)1===r[c]?s[u++]=o[c]:s[u++]=i[c];return a},t.prototype.where=function(e){Hp([e],"where");var t=this.readSync(e.dataId);return ds(e.shape,t)},t.prototype.topk=function(e,t,n){return Hp(e,"topk"),fs(this.readSync(e.dataId),e.shape,e.dtype,t)},t.prototype.min=function(e,t){Hp(e,"min"),Yo("min",t,e.rank);for(var n=Xo(e.shape,t),r=n[0],o=n[1],i=hi(r,e.dtype),a=kn(o),s=this.readSync(i.dataId),u=this.readSync(e.dataId),l=0;l<s.length;++l){for(var c=l*a,f=u[c],d=0;d<a;++d){var p=u[c+d];p<f&&(f=p)}s[l]=f}return i},t.prototype.minimum=function(e,t){return Hp([e,t],"minimum"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.min(e,t)}))},t.prototype.mod=function(e,t){return Hp([e,t],"mod"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){var n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}))},t.prototype.max=function(e,t){Hp(e,"max"),Yo("max",t,e.rank);for(var n=Xo(e.shape,t),r=n[0],o=n[1],i=hi(r,e.dtype),a=kn(o),s=this.readSync(i.dataId),u=this.readSync(e.dataId),l=0;l<s.length;++l){for(var c=l*a,f=u[c],d=0;d<a;++d){var p=u[c+d];p>f&&(f=p)}s[l]=f}return i},t.prototype.maximum=function(e,t){return Hp([e,t],"maximum"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.max(e,t)}))},t.prototype.all=function(e,t){Hp(e,"all"),Yo("all",t,e.rank);for(var n=Xo(e.shape,t),r=n[0],o=n[1],i=hi(r,e.dtype),a=kn(o),s=this.readSync(i.dataId),u=this.readSync(e.dataId),l=0;l<s.length;++l){for(var c=l*a,f=u[c],d=0;d<a;++d){var p=u[c+d];f=f&&p}s[l]=f}return i},t.prototype.any=function(e,t){Hp(e,"any"),Yo("any",t,e.rank);for(var n=Xo(e.shape,t),r=n[0],o=n[1],i=hi(r,e.dtype),a=kn(o),s=this.readSync(i.dataId),u=this.readSync(e.dataId),l=0;l<s.length;++l){for(var c=l*a,f=u[c],d=0;d<a;++d){var p=u[c+d];f=f||p}s[l]=f}return i},t.prototype.squaredDifference=function(e,t){return Hp([e,t],"squaredDifference"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){var n=e-t;return n*n}))},t.prototype.ceil=function(e){Hp(e,"ceil");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.ceil(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.floor=function(e){Hp(e,"floor");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.floor(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.sign=function(e){Hp(e,"x");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)t[r]<0?n[r]=-1:t[r]>0?n[r]=1:n[r]=0;return this.makeOutput(n,e.shape,"float32")},t.prototype.isNaN=function(e){Hp(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Number.isNaN(t[r])&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")},t.prototype.isInf=function(e){Hp(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Math.abs(t[r])===1/0&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")},t.prototype.isFinite=function(e){Hp(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Number.isFinite(t[r])&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")},t.prototype.round=function(e){Hp(e,"round");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var o=Math.floor(t[r]);t[r]-o<.5?n[r]=Math.floor(t[r]):t[r]-o>.5?n[r]=Math.ceil(t[r]):n[r]=o%2==0?o:o+1}return this.makeOutput(n,e.shape,"float32")},t.prototype.exp=function(e){Hp(e,"exp");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.exp(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.expm1=function(e){Hp(e,"expm1");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.expm1(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.log=function(e){Hp(e,"log");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var o=t[r];n[r]=Math.log(o)}return this.makeOutput(n,e.shape,"float32")},t.prototype.log1p=function(e){Hp(e,"log1p");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var o=t[r];n[r]=Math.log1p(o)}return this.makeOutput(n,e.shape,"float32")},t.prototype.sqrt=function(e){Hp(e,"sqrt");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var o=t[r];n[r]=Math.sqrt(o)}return this.makeOutput(n,e.shape,"float32")},t.prototype.rsqrt=function(e){Hp(e,"rsqrt");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var o=t[r];n[r]=1/Math.sqrt(o)}return this.makeOutput(n,e.shape,"float32")},t.prototype.reciprocal=function(e){Hp(e,"reciprocal");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=1/t[r];return this.makeOutput(n,e.shape,"float32")},t.prototype.linear=function(e){return e},t.prototype.relu=function(e){Hp(e,"relu");for(var t=hi(e.shape,e.dtype),n=this.readSync(t.dataId),r=this.readSync(e.dataId),o=0;o<r.length;++o)n[o]=Math.max(0,r[o]);return t},t.prototype.relu6=function(e){Hp(e,"relu");for(var t=hi(e.shape,e.dtype),n=this.readSync(t.dataId),r=this.readSync(e.dataId),o=0;o<r.length;++o)n[o]=Math.min(Math.max(0,r[o]),6);return t},t.prototype.prelu=function(e,t){return Hp([e,t],"prelu"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return e<0?t*e:e}))},t.prototype.elu=function(e){Hp(e,"elu");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r){var o=n[r];t[r]=o>=0?o:Math.exp(o)-1}return this.makeOutput(t,e.shape,"float32")},t.prototype.eluDer=function(e,t){Hp([e,t],"eluDer");for(var n=new Float32Array(t.size),r=this.readSync(t.dataId),o=this.readSync(e.dataId),i=0;i<r.length;++i){var a=r[i];n[i]=a>=1?o[i]:o[i]*(a+1)}return this.makeOutput(n,t.shape,"float32")},t.prototype.selu=function(e){Hp(e,"selu");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r){var o=n[r];t[r]=o>=0?1.0507009873554805*o:1.7580993408473768*(Math.exp(o)-1)}return this.makeOutput(t,e.shape,"float32")},t.prototype.clip=function(e,t,n){Hp(e,"clip");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i){var a=o[i];r[i]=a>n?n:a<t?t:a}return this.makeOutput(r,e.shape,"float32")},t.prototype.abs=function(e){for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.abs(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.complexAbs=function(e){for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<e.size;++r){var o=n[2*r],i=n[2*r+1];t[r]=Math.hypot(o,i)}return this.makeOutput(t,e.shape,"float32")},t.prototype.int=function(e){Hp(e,"int");for(var t=new Int32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=n[r];return this.makeOutput(t,e.shape,"int32")},t.prototype.sigmoid=function(e){Hp(e,"sigmoid");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=1/(1+Math.exp(-n[r]));return this.makeOutput(t,e.shape,"float32")},t.prototype.softplus=function(e){Hp(e,"softplus");for(var t=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(e.size),r=this.readSync(e.dataId),o=0;o<r.length;++o){var i,a=r[o]>-t,s=r[o]<t,u=Math.exp(r[o]);i=s?u:a?r[o]:Math.log(1+u),n[o]=i}return this.makeOutput(n,e.shape,"float32")},t.prototype.sin=function(e){Hp(e,"sin");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.sin(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.cos=function(e){Hp(e,"cos");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.cos(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.tan=function(e){Hp(e,"tan");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.tan(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.asin=function(e){Hp(e,"asin");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.asin(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.acos=function(e){Hp(e,"acos");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.acos(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.atan=function(e){Hp(e,"atan");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.atan(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.atan2=function(e,t){return Hp([e,t],"atan2"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.atan2(e,t)}))},t.prototype.sinh=function(e){Hp(e,"sinh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.sinh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.cosh=function(e){Hp(e,"cosh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.cosh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.tanh=function(e){Hp(e,"tanh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=In(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.asinh=function(e){Hp(e,"asinh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.asinh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.acosh=function(e){Hp(e,"acosh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.acosh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.atanh=function(e){Hp(e,"atanh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.atanh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.erf=function(e){Hp(e,"erf");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r){var o=Math.sign(n[r]),i=Math.abs(n[r]),a=1/(1+.3275911*i);t[r]=o*(1-((((1.061405429*a-1.453152027)*a+1.421413741)*a-.284496736)*a+.254829592)*a*Math.exp(-i*i))}return this.makeOutput(t,e.shape,"float32")},t.prototype.step=function(e,t){void 0===t&&(t=0),Hp(e,"step");for(var n=new Float32Array(e.size),r=this.readSync(e.dataId),o=0;o<r.length;++o){var i=r[o];isNaN(i)?n[o]=NaN:n[o]=i>0?1:t}return this.makeOutput(n,e.shape,"float32")},t.prototype.fusedConv2d=function(e){var t=e.input,n=e.filter,r=e.convInfo,o=e.bias,i=e.activation,a=e.preluActivationWeights,s=this.conv2d(t,n,r);return o&&(s=this.add(s,o)),i&&(s=Gp(this,s,i,a)),s},t.prototype.conv2d=function(e,t,n){Hp([e,t],"conv2d");for(var r=n.filterHeight,o=n.filterWidth,i=n.dilationHeight,a=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,l="channelsLast"===n.dataFormat,c=Li(n.outShape,e.dtype),f=e.strides[0],d=l?e.strides[1]:e.strides[2],p=l?e.strides[2]:1,h=l?1:e.strides[1],v=c.strides[0],m=l?c.strides[1]:c.strides[2],g=l?c.strides[2]:1,y=l?1:c.strides[1],b=this.readSync(e.dataId),x=this.readSync(t.dataId),w=c.values,C=0;C<n.batchSize;++C)for(var E=C*f,S=C*v,k=0;k<n.outHeight;++k)for(var _=S+k*m,R=k*n.strideHeight-u,I=0;I<r;I++){var T=R+I*i;if(!(T<0||T>=n.inHeight))for(var A=I*t.strides[0],D=E+T*d,N=0;N<n.outWidth;++N)for(var P=_+N*g,M=N*n.strideWidth-s,O=0;O<o;O++){var F=M+O*a;if(!(F<0||F>=n.inWidth))for(var L=D+F*p,B=A+O*t.strides[1],z=0;z<n.inChannels;++z){for(var W=b[L+z*h],V=0;V<n.outChannels;++V)w[P+V*y]+=W*x[B+V];B+=n.outChannels}}}return c.toTensor()},t.prototype.conv3d=function(e,t,n){for(var r=n.filterDepth,o=n.filterHeight,i=n.filterWidth,a=n.dilationDepth,s=n.dilationHeight,u=n.dilationWidth,l=n.padInfo.front,c=n.padInfo.left,f=n.padInfo.top,d=Li(n.outShape,e.dtype),p=this.readSync(e.dataId),h=this.readSync(t.dataId),v=d.values,m=0;m<n.batchSize;++m)for(var g=m*e.strides[0],y=m*d.strides[0],b=0;b<n.outDepth;++b)for(var x=y+b*d.strides[1],w=b*n.strideDepth-l,C=0;C<r;C++){var E=w+C*a;if(!(E<0||E>=n.inDepth))for(var S=C*t.strides[0],k=g+E*e.strides[1],_=0;_<n.outHeight;++_)for(var R=x+_*d.strides[2],I=_*n.strideHeight-f,T=0;T<o;T++){var A=I+T*s;if(!(A<0||A>=n.inHeight))for(var D=S+T*t.strides[1],N=k+A*e.strides[2],P=0;P<n.outWidth;++P)for(var M=R+P*n.outChannels,O=P*n.strideWidth-c,F=0;F<i;F++){var L=O+F*u;if(!(L<0||L>=n.inWidth))for(var B=D+F*t.strides[2],z=N+L*n.inChannels,W=B,V=0;V<n.inChannels;++V){for(var U=p[z+V],j=0;j<n.outChannels;++j)v[M+j]+=U*h[W+j];W+=n.outChannels}}}}return d.toTensor()},t.prototype.conv2dDerInput=function(e,t,n){Hp([e,t],"conv2dDerInput");for(var r=Li(n.inShape,"float32"),o=r.values,i=this.readSync(e.dataId),a=this.readSync(t.dataId),s=t.strides,u=s[0],l=s[1],c=s[2],f=n.batchSize,d=n.filterHeight,p=n.filterWidth,h=n.inChannels,v=n.inHeight,m=n.inWidth,g=n.outChannels,y=n.outHeight,b=n.outWidth,x=n.strideHeight,w=n.strideWidth,C=n.dataFormat,E=d-1-n.padInfo.top,S=p-1-n.padInfo.left,k="channelsLast"===C,_=r.strides[0],R=k?r.strides[1]:r.strides[2],I=k?r.strides[2]:1,T=k?1:r.strides[1],A=e.strides[0],D=k?e.strides[1]:e.strides[2],N=k?e.strides[2]:1,P=k?1:e.strides[1],M=0;M<f;++M)for(var O=0;O<h;++O)for(var F=0;F<v;++F)for(var L=F-E,B=Math.max(0,Math.ceil(L/x)),z=Math.min(y,(d+L)/x),W=0;W<m;++W){for(var V=W-S,U=Math.max(0,Math.ceil(V/w)),j=Math.min(b,(p+V)/w),H=0,G=B;G<z;++G)for(var q=G*x-L,K=U;K<j;++K)for(var X=A*M+D*G+N*K,$=u*(d-1-q)+l*(p-1-(K*w-V))+c*O,Y=0;Y<g;++Y)H+=i[X+P*Y]*a[$+Y];o[_*M+R*F+I*W+T*O]=H}return r.toTensor()},t.prototype.conv3dDerInput=function(e,t,n){for(var r=Li(n.inShape,"float32"),o=r.values,i=r.strides,a=i[0],s=i[1],u=i[2],l=i[3],c=this.readSync(e.dataId),f=e.strides,d=f[0],p=f[1],h=f[2],v=f[3],m=this.readSync(t.dataId),g=t.strides,y=g[0],b=g[1],x=g[2],w=g[3],C=n.batchSize,E=n.filterDepth,S=n.filterHeight,k=n.filterWidth,_=n.inChannels,R=n.inDepth,I=n.inHeight,T=n.inWidth,A=n.outChannels,D=n.outDepth,N=n.outHeight,P=n.outWidth,M=n.strideDepth,O=n.strideHeight,F=n.strideWidth,L=E-1-n.padInfo.front,B=S-1-n.padInfo.top,z=k-1-n.padInfo.left,W=0;W<C;++W)for(var V=0;V<_;++V)for(var U=0;U<R;++U)for(var j=U-L,H=Math.max(0,Math.ceil(j/M)),G=Math.min(D,(E+j)/M),q=0;q<I;++q)for(var K=q-B,X=Math.max(0,Math.ceil(K/O)),$=Math.min(N,(S+K)/O),Y=0;Y<T;++Y){for(var Q=Y-z,J=Math.max(0,Math.ceil(Q/F)),Z=Math.min(P,(k+Q)/F),ee=0,te=H;te<G;++te)for(var ne=te*M-j,re=X;re<$;++re)for(var oe=re*O-K,ie=J;ie<Z;++ie)for(var ae=d*W+p*te+h*re+v*ie,se=y*(E-1-ne)+b*(S-1-oe)+x*(k-1-(ie*F-Q))+w*V,ue=0;ue<A;++ue)ee+=c[ae+ue]*m[se+ue];o[a*W+s*U+u*q+l*Y+V]=ee}return r.toTensor()},t.prototype.conv2dDerFilter=function(e,t,n){Hp([e,t],"conv2dDerFilter");for(var r=n.strideHeight,o=n.strideWidth,i=n.filterHeight,a=n.filterWidth,s="channelsLast"===n.dataFormat,u=Li(n.filterShape,"float32"),l=n.padInfo.left,c=n.padInfo.top,f=this.bufferSync(e),d=this.bufferSync(t),p=0;p<i;++p)for(var h=Math.max(0,Math.ceil((c-p)/r)),v=Math.min(n.outHeight,(n.inHeight+c-p)/r),m=0;m<a;++m)for(var g=Math.max(0,Math.ceil((l-m)/o)),y=Math.min(n.outWidth,(n.inWidth+l-m)/o),b=0;b<n.inChannels;++b)for(var x=0;x<n.outChannels;++x){for(var w=0,C=0;C<n.batchSize;++C)for(var E=h;E<v;++E)for(var S=p+E*r-c,k=g;k<y;++k){var _=m+k*o-l;w+=s?f.get(C,S,_,b)*d.get(C,E,k,x):f.get(C,b,S,_)*d.get(C,x,E,k)}u.set(w,p,m,b,x)}return u.toTensor()},t.prototype.conv3dDerFilter=function(e,t,n){for(var r=n.strideDepth,o=n.strideHeight,i=n.strideWidth,a=n.filterDepth,s=n.filterHeight,u=n.filterWidth,l=Li(n.filterShape,"float32"),c=l.values,f=l.strides,d=f[0],p=f[1],h=f[2],v=f[3],m=this.readSync(t.dataId),g=t.strides,y=g[0],b=g[1],x=g[2],w=g[3],C=this.readSync(e.dataId),E=e.strides,S=E[0],k=E[1],_=E[2],R=E[3],I=n.padInfo.front,T=n.padInfo.left,A=n.padInfo.top,D=0;D<a;++D)for(var N=Math.max(0,Math.ceil((I-D)/r)),P=Math.min(n.outDepth,(n.inDepth+I-D)/r),M=D*d,O=0;O<s;++O)for(var F=Math.max(0,Math.ceil((A-O)/o)),L=Math.min(n.outHeight,(n.inHeight+A-O)/o),B=O*p+M,z=0;z<u;++z)for(var W=Math.max(0,Math.ceil((T-z)/i)),V=Math.min(n.outWidth,(n.inWidth+T-z)/i),U=z*h+B,j=0;j<n.inChannels;++j)for(var H=j*v+U,G=0;G<n.outChannels;++G){for(var q=0,K=0;K<n.batchSize;++K)for(var X=K*S,$=K*y,Y=N;Y<P;++Y)for(var Q=(D+Y*r-I)*k+X,J=Y*b+$,Z=F;Z<L;++Z)for(var ee=(O+Z*o-A)*_+Q,te=Z*x+J,ne=W;ne<V;++ne){var re=ne*w+te;q+=C[(z+ne*i-T)*R+ee+j]*m[re+G]}c[H+G]=q}return l.toTensor()},t.prototype.fusedDepthwiseConv2D=function(e){var t=e.input,n=e.filter,r=e.convInfo,o=e.bias,i=e.activation,a=e.preluActivationWeights,s=this.depthwiseConv2D(t,n,r);return o&&(s=this.add(s,o)),i&&(s=Gp(this,s,i,a)),s},t.prototype.depthwiseConv2D=function(e,t,n){Hp([e,t],"depthwiseConv2D");for(var r=n.filterHeight,o=n.filterWidth,i=n.dilationHeight,a=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,l=n.outChannels/n.inChannels,c=Li(n.outShape,e.dtype),f=this.readSync(e.dataId),d=this.readSync(t.dataId),p=c.values,h=0;h<n.batchSize;++h)for(var v=h*e.strides[0],m=h*c.strides[0],g=0;g<n.outHeight;++g)for(var y=m+g*c.strides[1],b=g*n.strideHeight-s,x=0;x<r;++x){var w=b+x*i;if(!(w<0||w>=n.inHeight))for(var C=x*t.strides[0],E=v+w*e.strides[1],S=0;S<n.outWidth;++S)for(var k=y+S*c.strides[2],_=S*n.strideWidth-u,R=0;R<o;++R){var I=_+R*a;if(!(I<0||I>=n.inWidth))for(var T=C+R*t.strides[1],A=E+I*n.inChannels,D=k,N=T,P=0;P<n.inChannels;++P){for(var M=f[A+P],O=0;O<l;++O)p[D+O]+=M*d[N+O];D+=l,N+=l}}}return c.toTensor()},t.prototype.depthwiseConv2DDerInput=function(e,t,n){Hp([e,t],"depthwiseConv2DDerInput");for(var r=Li(n.inShape,"float32"),o=r.values,i=r.strides,a=i[0],s=i[1],u=i[2],l=this.readSync(e.dataId),c=e.strides,f=c[0],d=c[1],p=c[2],h=this.readSync(t.dataId),v=t.strides,m=v[0],g=v[1],y=v[2],b=n.batchSize,x=n.filterHeight,w=n.filterWidth,C=n.inChannels,E=n.inHeight,S=n.inWidth,k=n.outChannels,_=n.outHeight,R=n.outWidth,I=n.strideHeight,T=n.strideWidth,A=x-1-n.padInfo.top,D=w-1-n.padInfo.left,N=k/C,P=0;P<b;++P)for(var M=0;M<C;++M)for(var O=0;O<E;++O)for(var F=O-A,L=Math.max(0,Math.ceil(F/I)),B=Math.min(_,(x+F)/I),z=0;z<S;++z){for(var W=z-D,V=Math.max(0,Math.ceil(W/T)),U=Math.min(R,(w+W)/T),j=0,H=L;H<B;++H)for(var G=H*I-F,q=V;q<U;++q)for(var K=f*P+d*H+p*q,X=m*(x-1-G)+g*(w-1-(q*T-W))+y*M,$=0;$<N;++$)j+=l[K+(M*N+$)]*h[X+$];o[a*P+s*O+u*z+M]=j}return r.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(e,t,n){Hp([e,t],"depthwiseConv2DDerFilter");for(var r=n.strideHeight,o=n.strideWidth,i=n.filterHeight,a=n.filterWidth,s=Li(n.filterShape,"float32"),u=n.padInfo.left,l=n.padInfo.top,c=n.outChannels/n.inChannels,f=this.bufferSync(e),d=this.bufferSync(t),p=0;p<i;++p)for(var h=Math.max(0,Math.ceil((l-p)/r)),v=Math.min(n.outHeight,(n.inHeight+l-p)/r),m=0;m<a;++m)for(var g=Math.max(0,Math.ceil((u-m)/o)),y=Math.min(n.outWidth,(n.inWidth+u-m)/o),b=0;b<n.outChannels;++b){for(var x=Math.trunc(b/c),w=b%c,C=0,E=0;E<n.batchSize;++E)for(var S=h;S<v;++S)for(var k=p+S*r-l,_=g;_<y;++_){var R=m+_*o-u;C+=f.get(E,k,R,x)*d.get(E,S,_,b)}s.set(C,p,m,x,w)}return s.toTensor()},t.prototype.tile=function(e,t){return Hp(e,"tile"),cs(this.bufferSync(e),t)},t.prototype.pad=function(e,t,n){Hp(e,"pad");var r=t.map((function(t,n){return t[0]+e.shape[n]+t[1]})),o=t.map((function(e){return e[0]})),i=this.bufferSync(e),a=Li(r,e.dtype);0!==n&&a.values.fill(n);for(var s=0;s<e.size;s++){var u=i.indexToLoc(s),l=u.map((function(e,t){return e+o[t]}));a.set.apply(a,[i.get.apply(i,u)].concat(l))}return a.toTensor()},t.prototype.transpose=function(e,t){Hp(e,"transpose");for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[t[r]];var o=this.readSync(e.dataId),i=Li(n,e.dtype),a=this.bufferSync(e);for(r=0;r<e.size;++r){for(var s=a.indexToLoc(r),u=new Array(s.length),l=0;l<u.length;l++)u[l]=s[t[l]];var c=i.locToIndex(u);i.values[c]=o[r]}return i.toTensor()},t.prototype.gather=function(e,t,n){Hp([e,t],"gather");var r=e.shape.slice(),o=this.readSync(t.dataId);r[n]=o.length;for(var i=Li(r,e.dtype),a=this.bufferSync(e),s=0;s<i.size;++s){var u=i.indexToLoc(s),l=u.slice();l[n]=o[u[n]];var c=a.locToIndex(l);i.values[s]=a.values[c]}return i.toTensor()},t.prototype.batchToSpaceND=function(e,t,n){Hp([e],"batchToSpaceND");var r=t.reduce((function(e,t){return e*t})),o=ca(e.shape,t,r),i=fa(o.length,t.length),a=da(e.shape,t,r),s=pa(n,t.length),u=ha(a,n,t.length);return e.reshape(o).transpose(i).reshape(a).slice(s,u)},t.prototype.spaceToBatchND=function(e,t,n){Hp([e],"spaceToBatchND");var r=t.reduce((function(e,t){return e*t})),o=[[0,0]];o.push.apply(o,n);for(var i=1+t.length;i<e.shape.length;++i)o.push([0,0]);var a=e.pad(o),s=ca(a.shape,t,r,!1),u=fa(s.length,t.length,!1),l=da(a.shape,t,r,!1);return a.reshape(s).transpose(u).reshape(l)},t.prototype.pool=function(e,t,n){Hp(e,"pool");for(var r=t.strideHeight,o=t.strideWidth,i=t.dilationHeight,a=t.dilationWidth,s=t.effectiveFilterHeight,u=t.effectiveFilterWidth,l=t.padInfo.top,c=t.padInfo.left,f="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,d=this.readSync(e.dataId),p=Li(t.outShape,e.dtype),h=p.values,v=t.outShape[1]*t.outShape[2]*t.outShape[3],m=t.outShape[2]*t.outShape[3],g=t.outShape[3],y=0;y<t.batchSize;++y)for(var b=y*v,x=y*e.strides[0],w=0;w<t.inChannels;++w)for(var C=0;C<t.outHeight;++C)for(var E=C*r-l,S=Math.max(0,E),k=Math.min(t.inHeight,s+E),_=b+C*m,R=0;R<t.outWidth;++R){for(var I=R*o-c,T=Math.max(0,I),A=Math.min(t.inWidth,u+I),D=f,N=0,P=0,M=S;M<k;M+=i){for(var O=x+M*e.strides[1],F=T;F<A;F+=a){var L=d[O+F*e.strides[2]+w];"max"===n&&L>D?D=L:"avg"===n&&(N+=L,P++)}if(isNaN(D))break}h[_+R*g+w]="avg"===n?N/P:D}return p.toTensor()},t.prototype.maxPool=function(e,t){return this.pool(e,t,"max")},t.prototype.maxPoolPositions=function(e,t){for(var n=Li(t.outShape,"int32"),r=t.strideHeight,o=t.strideWidth,i=t.dilationHeight,a=t.dilationWidth,s=t.effectiveFilterHeight,u=t.effectiveFilterWidth,l=t.padInfo.top,c=t.padInfo.left,f=this.bufferSync(e),d=0;d<t.batchSize;++d)for(var p=0;p<t.inChannels;++p)for(var h=0;h<t.outHeight;++h){for(var v=h*r-l,m=v;m<0;)m+=i;for(var g=Math.min(t.inHeight,s+v),y=0;y<t.outWidth;++y){for(var b=y*o-c,x=b;x<0;)x+=a;for(var w=Math.min(t.inWidth,u+b),C=Number.NEGATIVE_INFINITY,E=-1,S=m;S<g;S+=i)for(var k=S-v,_=x;_<w;_+=a){var R=_-b,I=f.get(d,S,_,p);I>C&&(C=I,E=k*u+R)}n.set(E,d,h,y,p)}}return n.toTensor()},t.prototype.maxPoolBackprop=function(e,t,n,r){Hp([t,n],"maxPoolBackprop");for(var o=this.maxPoolPositions(t,r),i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,f=c-1-r.padInfo.left,d=l-1-r.padInfo.top,p=Li(t.shape,"float32"),h=this.bufferSync(o),v=this.bufferSync(e),m=0;m<r.batchSize;++m)for(var g=0;g<r.inChannels;++g)for(var y=0;y<r.inHeight;++y)for(var b=0;b<r.inWidth;++b){for(var x=y-d,w=b-f,C=0,E=0;E<l;E+=s){var S=(x+E)/i;if(!(S<0||S>=r.outHeight||Math.floor(S)!==S))for(var k=0;k<c;k+=u){var _=(w+k)/a;if(!(_<0||_>=r.outWidth||Math.floor(_)!==_)){var R=l*c-1-h.get(m,S,_,g)===E*c+k?1:0;0!==R&&(C+=v.get(m,S,_,g)*R)}}}p.set(C,m,y,b,g)}return p.toTensor()},t.prototype.avgPoolBackprop=function(e,t,n){Hp([e,t],"avgPoolBackprop");for(var r=n.strideHeight,o=n.strideWidth,i=n.filterHeight,a=n.filterWidth,s=n.dilationHeight,u=n.dilationWidth,l=n.effectiveFilterHeight,c=n.effectiveFilterWidth,f=c-1-n.padInfo.left,d=l-1-n.padInfo.top,p=Li(t.shape,"float32"),h=1/(i*a),v=this.bufferSync(e),m=0;m<n.batchSize;++m)for(var g=0;g<n.inChannels;++g)for(var y=0;y<n.inHeight;++y)for(var b=0;b<n.inWidth;++b){for(var x=y-d,w=b-f,C=0,E=0;E<l;E+=s){var S=(x+E)/r;if(!(S<0||S>=n.outHeight||Math.floor(S)!==S))for(var k=0;k<c;k+=u){var _=(w+k)/o;_<0||_>=n.outWidth||Math.floor(_)!==_||(C+=v.get(m,S,_,g))}}p.set(C*h,m,y,b,g)}return p.toTensor()},t.prototype.pool3d=function(e,t,n){Hp(e,"pool3d");for(var r=t.strideDepth,o=t.strideHeight,i=t.strideWidth,a=t.dilationDepth,s=t.dilationHeight,u=t.dilationWidth,l=t.effectiveFilterDepth,c=t.effectiveFilterHeight,f=t.effectiveFilterWidth,d=t.padInfo.front,p=t.padInfo.top,h=t.padInfo.left,v="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=this.readSync(e.dataId),g=Li(t.outShape,e.dtype),y=g.values,b=t.outShape[1]*t.outShape[2]*t.outShape[3]*t.outShape[4],x=t.outShape[2]*t.outShape[3]*t.outShape[4],w=t.outShape[3]*t.outShape[4],C=t.outShape[4],E=0;E<t.batchSize;++E)for(var S=E*b,k=E*e.strides[0],_=0;_<t.inChannels;++_)for(var R=0;R<t.outDepth;++R){for(var I=R*r-d,T=I;T<0;)T+=a;for(var A=Math.min(t.inDepth,l+I),D=S+R*x,N=0;N<t.outHeight;++N){for(var P=N*o-p,M=P;M<0;)M+=s;for(var O=Math.min(t.inHeight,c+P),F=D+N*w,L=0;L<t.outWidth;++L){for(var B=L*i-h,z=B;z<0;)z+=u;for(var W=Math.min(t.inWidth,f+B),V=F+L*C,U=v,j=0,H=0,G=T;G<A;G+=a){for(var q=k+G*e.strides[1],K=M;K<O;K+=s){for(var X=q+K*e.strides[2],$=z;$<W;$+=u){var Y=m[X+$*e.strides[3]+_];if("max"===n&&Y>U?U=Y:"avg"===n&&(j+=Y,H++),isNaN(U))break}if(isNaN(U))break}if(isNaN(U))break}y[V+_]="avg"===n?j/H:U}}}return g.toTensor()},t.prototype.avgPool3d=function(e,t){return Hp(e,"avgPool3d"),this.pool3d(e,t,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(e,t,n){Hp([e,t],"avgPool3dBackprop");for(var r=n.strideDepth,o=n.strideHeight,i=n.strideWidth,a=n.filterDepth,s=n.filterHeight,u=n.filterWidth,l=n.dilationDepth,c=n.dilationHeight,f=n.dilationWidth,d=n.effectiveFilterDepth,p=n.effectiveFilterHeight,h=n.effectiveFilterWidth,v=d-1-n.padInfo.front,m=h-1-n.padInfo.left,g=p-1-n.padInfo.top,y=Li(t.shape,"float32"),b=1/(a*s*u),x=this.bufferSync(e),w=0;w<n.batchSize;++w)for(var C=0;C<n.inChannels;++C)for(var E=0;E<n.inDepth;++E)for(var S=0;S<n.inHeight;++S)for(var k=0;k<n.inWidth;++k){for(var _=E-v,R=S-g,I=k-m,T=0,A=0;A<d;A+=l){var D=(_+A)/r;if(!(D<0||D>=n.outDepth||Math.floor(D)!==D))for(var N=0;N<p;N+=c){var P=(R+N)/o;if(!(P<0||P>=n.outHeight||Math.floor(P)!==P))for(var M=0;M<h;M+=f){var O=(I+M)/i;O<0||O>=n.outWidth||Math.floor(O)!==O||(T+=x.get(w,D,P,O,C))}}}y.set(T*b,w,E,S,k,C)}return y.toTensor()},t.prototype.maxPool3d=function(e,t){return Hp(e,"maxPool3d"),this.pool3d(e,t,"max").toFloat()},t.prototype.maxPool3dPositions=function(e,t){for(var n=Li(t.outShape,"int32"),r=t.strideDepth,o=t.strideHeight,i=t.strideWidth,a=t.dilationDepth,s=t.dilationHeight,u=t.dilationWidth,l=t.effectiveFilterDepth,c=t.effectiveFilterHeight,f=t.effectiveFilterWidth,d=t.padInfo.front,p=t.padInfo.top,h=t.padInfo.left,v=this.bufferSync(e),m=0;m<t.batchSize;++m)for(var g=0;g<t.inChannels;++g)for(var y=0;y<t.outDepth;++y){for(var b=y*r-d,x=b;x<0;)x+=a;for(var w=Math.min(t.inDepth,l+b),C=0;C<t.outHeight;++C){for(var E=C*o-p,S=E;S<0;)S+=s;for(var k=Math.min(t.inHeight,c+E),_=0;_<t.outWidth;++_){for(var R=_*i-h,I=R;I<0;)I+=u;for(var T=Math.min(t.inWidth,f+R),A=Number.NEGATIVE_INFINITY,D=-1,N=x;N<w;N+=a)for(var P=N-b,M=S;M<k;M+=s)for(var O=M-E,F=I;F<T;F+=u){var L=F-R,B=v.get(m,N,M,F,g);B>=A&&(A=B,D=P*c*f+O*c+L)}n.set(D,m,y,C,_,g)}}}return n.toTensor()},t.prototype.maxPool3dBackprop=function(e,t,n,r){Hp([t,n],"maxPool3dBackprop");for(var o=this.maxPool3dPositions(t,r),i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterDepth,d=r.effectiveFilterHeight,p=r.effectiveFilterWidth,h=f-1-r.padInfo.front,v=p-1-r.padInfo.left,m=d-1-r.padInfo.top,g=Li(t.shape,"float32"),y=this.bufferSync(o),b=this.bufferSync(e),x=0;x<r.batchSize;++x)for(var w=0;w<r.inChannels;++w)for(var C=0;C<r.inDepth;++C)for(var E=0;E<r.inHeight;++E)for(var S=0;S<r.inWidth;++S){for(var k=C-h,_=E-m,R=S-v,I=0,T=0;T<f;T+=u){var A=(k+T)/i;if(!(A<0||A>=r.outDepth||Math.floor(A)!==A))for(var D=0;D<d;D+=l){var N=(_+D)/a;if(!(N<0||N>=r.outHeight||Math.floor(N)!==N))for(var P=0;P<p;P+=c){var M=(R+P)/s;if(!(M<0||M>=r.outWidth||Math.floor(M)!==M)){var O=f*d*p-1-y.get(x,A,N,M,w)===T*d*p+D*p+P?1:0;0!==O&&(I+=b.get(x,A,N,M,w)*O)}}}}g.set(I,x,C,E,S,w)}return g.toTensor()},t.prototype.cast=function(e,t){return Xa(e,t,this)},t.prototype.reshape=function(e,t){return $a(e,t)},t.prototype.avgPool=function(e,t){return Hp(e,"avgPool"),this.pool(e,t,"avg").toFloat()},t.prototype.resizeBilinear=function(e,t,n,r){Hp(e,"resizeBilinear");for(var o=e.shape,i=o[0],a=o[1],s=o[2],u=o[3],l=this.readSync(e.dataId),c=new Float32Array(kn([i,t,n,u])),f=[r&&t>1?a-1:a,r&&n>1?s-1:s],d=[r&&t>1?t-1:t,r&&n>1?n-1:n],p=0,h=f[0]/d[0],v=f[1]/d[1],m=0;m<i;m++)for(var g=0;g<t;g++)for(var y=h*g,b=Math.floor(y),x=y-b,w=Math.min(a-1,Math.ceil(y)),C=m*e.strides[0]+b*e.strides[1],E=m*e.strides[0]+w*e.strides[1],S=0;S<n;S++)for(var k=v*S,_=Math.floor(k),R=k-_,I=Math.min(s-1,Math.ceil(k)),T=C+_*e.strides[2],A=E+_*e.strides[2],D=C+I*e.strides[2],N=E+I*e.strides[2],P=0;P<u;P++){var M=l[T+P],O=l[A+P],F=M+(l[D+P]-M)*R,L=F+(O+(l[N+P]-O)*R-F)*x;c[p++]=L}return ai(c,[i,t,n,u])},t.prototype.resizeBilinearBackprop=function(e,t,n){Hp([e,t],"resizeBilinearBackprop");for(var r=t.shape,o=r[0],i=r[1],a=r[2],s=r[3],u=e.shape,l=u[1],c=u[2],f=new Float32Array(o*i*a*s),d=[n&&l>1?i-1:i,n&&c>1?a-1:a],p=[n&&l>1?l-1:l,n&&c>1?c-1:c],h=d[0]/p[0],v=d[1]/p[1],m=this.readSync(e.dataId),g=0,y=0;y<o;y++)for(var b=y*t.strides[0],x=0;x<l;x++)for(var w=x*h,C=Math.floor(w),E=Math.min(Math.ceil(w),i-1),S=b+C*t.strides[1],k=b+E*t.strides[1],_=w-C,R=1-_,I=0;I<c;I++)for(var T=I*v,A=Math.floor(T),D=Math.min(Math.ceil(T),a-1),N=T-A,P=1-N,M=S+A*t.strides[2],O=S+D*t.strides[2],F=k+A*t.strides[2],L=k+D*t.strides[2],B=R*P,z=R*N,W=_*P,V=_*N,U=0;U<s;U++){var j=m[g++];f[M+U]+=j*B,f[O+U]+=j*z,f[F+U]+=j*W,f[L+U]+=j*V}return di(f,[o,a,i,s],t.dtype)},t.prototype.resizeNearestNeighbor=function(e,t,n,r){Hp(e,"resizeNearestNeighbor");for(var o=e.shape,i=o[0],a=o[1],s=o[2],u=o[3],l=this.readSync(e.dataId),c=new Float32Array(i*t*n*u),f=[r&&t>1?a-1:a,r&&n>1?s-1:s],d=[r&&t>1?t-1:t,r&&n>1?n-1:n],p=f[0]/d[0],h=f[1]/d[1],v=0,m=0;m<i;m++)for(var g=m*e.strides[0],y=0;y<t;y++)for(var b=p*y,x=g+Math.min(a-1,r?Math.round(b):Math.floor(b))*e.strides[1],w=0;w<n;w++)for(var C=h*w,E=x+Math.min(s-1,r?Math.round(C):Math.floor(C))*e.strides[2],S=0;S<u;S++){var k=l[E+S];c[v++]=k}return ai(c,[i,t,n,u],e.dtype)},t.prototype.resizeNearestNeighborBackprop=function(e,t,n){Hp([e,t],"resizeNearestNeighborBackprop");for(var r=t.shape,o=r[0],i=r[1],a=r[2],s=r[3],u=e.shape,l=u[1],c=u[2],f=new Float32Array(o*i*a*s),d=this.readSync(e.dataId),p=[n&&l>1?i-1:i,n&&c>1?a-1:a],h=[n&&l>1?l-1:l,n&&c>1?c-1:c],v=p[0]/h[0],m=p[1]/h[1],g=1/v,y=1/m,b=2*Math.ceil(g)+2,x=2*Math.ceil(y)+2,w=0;w<o;w++)for(var C=w*t.strides[0],E=0;E<i;E++)for(var S=C+E*t.strides[1],k=Math.floor(E*g),_=Math.floor(k-b/2),R=0;R<a;R++)for(var I=S+R*t.strides[2],T=Math.floor(R*y),A=Math.floor(T-x/2),D=0;D<s;D++){for(var N=0,P=0;P<b;P++){var M=P+_;if(!(M<0||M>=l)){var O=C+M*e.strides[1],F=M*v;if(E===Math.min(i-1,n?Math.round(F):Math.floor(F)))for(var L=0;L<x;L++){var B=L+A;if(!(B<0||B>=c)){var z=O+B*e.strides[2],W=B*m;R===Math.min(a-1,n?Math.round(W):Math.floor(W))&&(N+=d[z+D])}}}}f[I+D]=N}return di(f,t.shape,t.dtype)},t.prototype.batchNormalization=function(e,t,n,r,o,i){Hp([e,t,n,o,i],"batchNorm");for(var a=this.readSync(e.dataId),s=this.readSync(t.dataId),u=this.readSync(n.dataId),l=o?this.readSync(o.dataId):new Float32Array([1]),c=i?this.readSync(i.dataId):new Float32Array([0]),f=new Float32Array(a.length),d=c.length,p=l.length,h=u.length,v=s.length,m=0,g=0,y=0,b=0,x=0;x<a.length;++x)f[x]=c[m++]+(a[x]-s[g++])*l[y++]/Math.sqrt(u[b++]+r),m>=d&&(m=0),g>=v&&(g=0),y>=p&&(y=0),b>=h&&(b=0);return di(f,e.shape)},t.prototype.localResponseNormalization4D=function(e,t,n,r,o){Hp(e,"localResponseNormalization4D");var i=e.shape[3],a=i-1,s=this.readSync(e.dataId),u=e.size,l=new Float32Array(u);function c(e){for(var n=e%i,r=e-n+Math.max(0,n-t),o=e-n+Math.min(n+t,a),u=0;r<=o;r++){var l=s[r];u+=l*l}return u}for(var f=0;f<u;f++){var d=c(f),p=s[f]*Math.pow(n+r*d,-o);l[f]=p}return di(l,e.shape)},t.prototype.LRNGrad=function(e,t,n,r,o,i,a){Hp(e,"LRNGrad");for(var s=e.shape[3],u=this.readSync(e.dataId),l=this.readSync(t.dataId),c=this.readSync(n.dataId),f=new Float32Array(e.size),d=e.size,p=0;p<d;p++){for(var h=p%s,v=p-h+Math.max(0,h-r),m=p-h+Math.min(s,h+r+1),g=0,y=v;y<m;y++)g+=Math.pow(l[y],2);for(g=i*g+o,y=v;y<m;y++){var b=-2*i*a*l[y]*c[p]/g;p===y&&(b+=Math.pow(g,-a)),b*=u[p],f[y]+=b}}return di(f,e.shape)},t.prototype.multinomial=function(e,t,n,r){Hp(e,"multinomial");for(var o=t?e:Ia(e),i=o.shape[0],a=o.shape[1],s=hi([i,n],"int32"),u=this.readSync(s.dataId),l=this.readSync(o.dataId),c=0;c<i;++c){var f=c*a,d=new Float32Array(a-1);d[0]=l[f];for(var p=1;p<d.length;++p)d[p]=d[p-1]+l[f+p];for(var h=Pi(r.toString()),v=c*n,m=0;m<n;++m){var g=h();u[v+m]=d.length;for(var y=0;y<d.length;y++)if(g<d[y]){u[v+m]=y;break}}}return s},t.prototype.oneHot=function(e,t,n,r){Hp(e,"oneHot");var o=new Float32Array(e.size*t);o.fill(r);for(var i=this.readSync(e.dataId),a=0;a<e.size;++a)i[a]>=0&&i[a]<t&&(o[a*t+i[a]]=n);return ci(o,[e.size,t],"int32")},t.prototype.nonMaxSuppression=function(e,t,n,r,o){return Hp(e,"nonMaxSuppression"),rs(this.readSync(e.dataId),this.readSync(t.dataId),n,r,o)},t.prototype.fft=function(e){return this.fftBatch(e,!1)},t.prototype.ifft=function(e){return this.fftBatch(e,!0)},t.prototype.fftBatch=function(e,t){for(var n=e.shape[0],r=e.shape[1],o=Li(e.shape,"float32"),i=Li(e.shape,"float32"),a=oi(e).as2D(n,r),s=ii(e).as2D(n,r),u=0;u<n;u++)for(var l=a.slice([u,0],[1,r]),c=s.slice([u,0],[1,r]),f=ri(l,c),d=this.readSync(this.fftImpl(f,t).dataId),p=0;p<r;p++){var h=Ja(d,p);o.values[u*r+p]=h.real,i.values[u*r+p]=h.imag}return ri(o.toTensor(),i.toTensor()).as2D(n,r)},t.prototype.fftImpl=function(e,t){var n=e.as1D(),r=n.size;if(this.isExponentOf2(r)){var o=this.fftRadix2(n,r,t).as2D(e.shape[0],e.shape[1]);return t&&(o=ri(oi(o).div(ui(r)),ii(o).div(ui(r)))),o}var i=this.readSync(e.dataId),a=function(e){for(var t=new Float32Array(e.length/2),n=new Float32Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}(this.fourierTransformByMatmul(i,r,t));return ri(a.real,a.imag).as2D(e.shape[0],e.shape[1])},t.prototype.isExponentOf2=function(e){return 0==(e&e-1)},t.prototype.fftRadix2=function(e,t,n){if(1===t)return e;var r=this.readSync(e.dataId),o=t/2,i=function(e){for(var t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t),o=0;o<e.length;o+=4)n[Math.floor(o/4)]=e[o],r[Math.floor(o/4)]=e[o+1];return{real:n,imag:r}}(r),a=ri(i.real,i.imag).as1D(),s=function(e){for(var t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t),o=2;o<e.length;o+=4)n[Math.floor(o/4)]=e[o],r[Math.floor(o/4)]=e[o+1];return{real:n,imag:r}}(r),u=ri(s.real,s.imag).as1D();a=this.fftRadix2(a,o,n),u=this.fftRadix2(u,o,n);var l=function(e,t){for(var n=new Float32Array(e/2),r=new Float32Array(e/2),o=0;o<Math.ceil(e/2);o++){var i=(t?2:-2)*Math.PI*(o/e);n[o]=Math.cos(i),r[o]=Math.sin(i)}return{real:n,imag:r}}(t,n),c=ri(l.real,l.imag).mul(u),f=a.add(c),d=a.sub(c),p=oi(f).concat(oi(d)),h=ii(f).concat(ii(d));return ri(p,h).as1D()},t.prototype.fourierTransformByMatmul=function(e,t,n){for(var r=new Float32Array(2*t),o=0;o<t;o++){for(var i=0,a=0,s=0;s<t;s++){var u=es(o*s,t,n),l=Ja(e,s);i+=l.real*u.real-l.imag*u.imag,a+=l.real*u.imag+l.imag*u.real}n&&(i/=t,a/=t),Za(r,i,a,o)}return r},t.prototype.depthToSpace=function(e,t,n){wn("NHWC"===n,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+n})),wn(t>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+t}));for(var r=e.shape[0],o=e.shape[1],i=e.shape[2],a=e.shape[3],s=o*t,u=i*t,l=a/(t*t),c=this.readSync(e.dataId),f=new Float32Array(r*s*u*l),d=0,p=0;p<r;++p)for(var h=0;h<s;++h)for(var v=Math.floor(h/t),m=h%t,g=0;g<u;++g)for(var y=Math.floor(g/t),b=(m*t+g%t)*l,x=0;x<l;++x){var w=x+b+a*(y+i*(v+o*p));f[d++]=c[w]}return di(f,[r,s,u,l])},t.prototype.broadcastedBinaryOp=function(e,t,n,r){var o=Oa(e.shape,t.shape),i=Li(o,n),a=this.readSync(e.dataId),s=this.readSync(t.dataId),u=Pa(e.shape,o),l=Pa(t.shape,o),c=i.values;if(u.length+l.length===0)for(var f=0;f<c.length;++f)c[f]=r(a[f%a.length],s[f%s.length]);else{var d=this.bufferSync(e),p=this.bufferSync(t),h=function(n){var o=i.indexToLoc(n),f=o.slice(-e.rank);u.forEach((function(e){return f[e]=0}));var h=d.locToIndex(f),v=o.slice(-t.rank);l.forEach((function(e){return v[e]=0}));var m=p.locToIndex(v);c[n]=r(a[h],s[m])};for(f=0;f<c.length;++f)h(f)}return i.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(e,t,n){var r=Oa(e.shape,t.shape),o=Li(r,"float32"),i=Li(r,"float32"),a=this.readSync(e.dataId),s=this.readSync(t.dataId),u=Pa(e.shape,r),l=Pa(t.shape,r),c=o.values,f=i.values;if(u.length+l.length===0)for(var d=0;d<c.length;d++){var p=d%a.length,h=d%s.length,v=n(a[2*p],a[2*p+1],s[2*h],s[2*h+1]);c[d]=v.real,f[d]=v.imag}else{var m=this.bufferSync(this.data.get(e.dataId).complexTensors.real),g=this.bufferSync(this.data.get(t.dataId).complexTensors.real),y=function(r){var i=o.indexToLoc(r),d=i.slice(-e.rank);u.forEach((function(e){return d[e]=0}));var p=m.locToIndex(d),h=i.slice(-t.rank);l.forEach((function(e){return h[e]=0}));var v=g.locToIndex(h),y=n(a[2*p],a[2*p+1],s[2*v],s[2*v+1]);c[r]=y.real,f[r]=y.imag};for(d=0;d<c.length;d++)y(d)}return this.complex(o.toTensor(),i.toTensor())},t.prototype.split=function(e,t,n){return ls(e,t,n)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(e,t,n,r,o,i){for(var a=e.shape,s=a[0],u=a[1],l=a[2],c=a[3],f=t.shape[0],d=r[0],p=r[1],h=Li([f,d,p,c],"float32"),v=this.readSync(t.dataId),m=this.readSync(n.dataId),g=this.readSync(e.dataId),y=e.strides,b=h.strides,x=0;x<f;x++){var w=4*x,C=v[w],E=v[w+1],S=v[w+2],k=v[w+3],_=m[x];if(!(_>=s))for(var R=d>1?(S-C)*(u-1)/(d-1):0,I=p>1?(k-E)*(l-1)/(p-1):0,T=0;T<d;T++){var A=d>1?C*(u-1)+T*R:.5*(C+S)*(u-1);if(A<0||A>u-1)for(var D=0;D<p;D++)for(var N=0;N<c;N++){var P=N+D*b[2]+T*b[1]+x*b[0];h.values[P]=i}else if("bilinear"===o){var M=Math.floor(A),O=Math.ceil(A),F=A-M;for(D=0;D<p;D++)if((G=p>1?E*(l-1)+D*I:.5*(E+k)*(l-1))<0||G>l-1)for(N=0;N<c;N++)P=N+D*b[2]+T*b[1]+x*b[0],h.values[P]=i;else{var L=Math.floor(G),B=Math.ceil(G),z=G-L;for(N=0;N<c;N++){var W=g[P=N+L*y[2]+M*y[1]+_*y[0]],V=g[P=N+B*y[2]+M*y[1]+_*y[0]],U=g[P=N+L*y[2]+O*y[1]+_*y[0]],j=W+(V-W)*z,H=U+(g[P=N+B*y[2]+O*y[1]+_*y[0]]-U)*z;P=N+D*b[2]+T*b[1]+x*b[0],h.values[P]=j+(H-j)*F}}}else for(D=0;D<p;++D){var G;if((G=p>1?E*(l-1)+D*I:.5*(E+k)*(l-1))<0||G>l-1)for(N=0;N<c;N++)P=N+D*b[2]+T*b[1]+x*b[0],h.values[P]=i;else{var q=Math.round(G),K=Math.round(A);for(N=0;N<c;N++){var X=N+q*y[2]+K*y[1]+_*y[0],$=N+D*b[2]+T*b[1]+x*b[0];h.values[$]=g[X]}}}}}return h.toTensor()},t.prototype.sparseToDense=function(e,t,n,r){var o=ba(0,e,n),i=o.sliceRank,a=o.numUpdates,s=o.sliceSize,u=o.strides,l=o.outputSize;return this.scatter(e,t,n,l,s,a,i,u,r,!1)},t.prototype.gatherND=function(e,t){var n=t.shape,r=n[n.length-1],o=va(e,t),i=o[0],a=o[1],s=o[2],u=o[3];if(0===a)return ai([],i,e.dtype);for(var l=new fr([a,s],e.dtype),c=this.readSync(t.dataId),f=this.readSync(e.dataId),d=0;d<a;d++){for(var p=[],h=0,v=0;v<r;v++){var m=c[d*r+v];h+=m*u[v],p.push(m)}if(h<0||h>=e.size/s)throw new Error("Invalid indices: "+p+" does not index into "+e.shape);for(var g=0;g<s;g++)l.values[d*s+g]=f[h*s+g]}return l.toTensor().reshape(i)},t.prototype.scatterND=function(e,t,n){var r=ba(0,e,n),o=r.sliceRank,i=r.numUpdates,a=r.sliceSize,s=r.strides,u=r.outputSize,l=ui(0);return this.scatter(e,t,n,u,a,i,o,s,l,!0)},t.prototype.fill=function(e,t,n){var r=Fn(n=n||qn(t),kn(e));return r.fill(t),Nr.makeTensor(r,e,n,this)},t.prototype.onesLike=function(e){if("string"===e.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){var t=Fn(e.dtype,kn(e.shape));return this.makeOutput(t,e.shape,e.dtype)},t.prototype.linspace=function(e,t,n){return Ya(e,t,n)},t.prototype.scatter=function(e,t,n,r,o,i,a,s,u,l){var c=[r/o,o],f=this.readSync(e.dataId),d=this.readSync(t.dataId);if(0===r)return ai([],n,t.dtype);var p=new fr(c,t.dtype);p.values.fill(this.readSync(u.dataId)[0]);for(var h=0;h<i;h++){for(var v=[],m=0,g=0;g<a;g++){var y=f[h*a+g];v.push(y),m+=y*s[g]}if(m<0||m>=r/o)throw new Error("Invalid indices: "+v+" does not index into "+n);for(var b=0;b<o;b++)l?p.values[m*o+b]+=d[h*o+b]:p.values[m*o+b]=0===t.rank?d[0]:d[h*o+b]}return p.toTensor().reshape(n)},t}(Da);Nr.registerBackend("cpu",(function(){return new qp}),1);for(var Kp=0,Xp=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t,i=o.boxes,a=o.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,f=s.softNmsSigma,d=n;Hp(i,"NonMaxSuppressionWithScore");var p=os(d.data.get(i.dataId).values,d.data.get(a.dataId).values,u,l,c,f);return[p.selectedIndices,p.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,o=n;Hp(r,"square");for(var i=o.data.get(r.dataId).values,a=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];a[s]=u*u}return{dataId:o.write(a,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:oc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,o=r.a,i=r.b,a=n;Hp([o,i],oc);var s=a.data.get(o.dataId).values,u=a.data.get(i.dataId).values,l=function(e,t,n,r,o,i){var a=Oa(e,t),s=a.length,u=$n(a),l=On(o,kn(a)),c=e.length,f=t.length,d=$n(e),p=$n(t),h=Pa(e,a),v=Pa(t,a);if(h.length+v.length===0)for(var m=0;m<l.length;++m)l[m]=i(n[m%n.length],r[m%r.length]);else{var g=function(e){var t=ir(e,s,u),o=t.slice(-c);h.forEach((function(e){return o[e]=0}));var a=or(o,c,d),m=t.slice(-f);v.forEach((function(e){return m[e]=0}));var g=or(m,f,p);l[e]=i(n[a],r[g])};for(m=0;m<l.length;++m)g(m)}return[l,a]}(o.shape,i.shape,s,u,o.dtype,(function(e,t){var n=e-t;return n*n})),c=l[0],f=l[1];return{dataId:a.write(c,f,o.dtype),shape:f,dtype:o.dtype}}}];Kp<Xp.length;Kp++)hn(Xp[Kp]);for(var $p,Yp=function(e){this.variableNames=["A"];var t=ys(),n=e[0],r=e[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n\n        vec4 values = "+t.texture2D+"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "},Qp=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=ys(),n=e[0],r=e[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2("+r+".0, "+n+".0);\n            vec4 values = "+t.texture2D+"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        "+t.output+" = result;\n      }\n    "},Jp=0,Zp=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.pixels,i=r.numChannels,a="undefined"!=typeof HTMLVideoElement&&o instanceof HTMLVideoElement,s="undefined"!=typeof HTMLImageElement&&o instanceof HTMLImageElement,u=a?[o.videoWidth,o.videoHeight]:[o.width,o.height],l=u[0],c=u[1],f=[c,l],d=[c,l,i];(s||a)&&(null==$p&&($p=document.createElement("canvas").getContext("2d")),$p.canvas.width=l,$p.canvas.height=c,$p.drawImage(o,0,0,l,c),o=$p.canvas);var p=n.makeTensorInfo(f,"int32");n.texData.get(p.dataId).usage=Fr.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),o);var h=un().getBool("WEBGL_PACK")?new Qp(d):new Yp(d),v=n.runWebGLProgram(h,[p],"int32");return n.disposeData(p.dataId),v}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;Vo("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var o=t,i=o.boxes,a=o.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,f=s.softNmsSigma,d=n,p=os(d.readSync(i.dataId),d.readSync(a.dataId),u,l,c,f);return[p.selectedIndices,p.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,o=n,i=new Il(r.shape,"return x * x;");return o.runWebGLProgram(i,[r],r.dtype)}},{kernelName:oc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,o=r.a,i=r.b,a=n,s=un().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qs("return (a - b) * (a - b);",o.shape,i.shape):new Hs("return (a - b) * (a - b);",o.shape,i.shape);return a.compileAndRun(s,[o,i])}}];Jp<Zp.length;Jp++)hn(Zp[Jp]);for(var eh=0,th=[{kernelName:"Square",gradFunc:function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().mul(2))}}}},{kernelName:oc,gradFunc:function(e,t){var n=t[0],r=t[1],o=ui(2);return{a:function(){return wf(e,wf(o,_f(n,r)))},b:function(){return wf(e,wf(o,_f(r,n)))}}}}];eh<th.length;eh++)vn(th[eh]);var nh=function(){function e(){}return e.prototype.fetch=function(e,t){return fetch(e,t)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got "+t);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)},e.prototype.decode=function(e,t){return new TextDecoder(t).decode(e)},e}();un().get("IS_BROWSER")&&un().setPlatform("browser",new nh);var rh,oh=function(){function e(){this.util=n(753),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(e,t){return null!=un().global.fetch?un().global.fetch(e,t):(null==rh&&(rh=n(522)),rh(e,t))},e.prototype.now=function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6},e.prototype.encode=function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got "+t);return this.textEncoder.encode(e)},e.prototype.decode=function(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)},e}();un().get("IS_NODE")&&un().setPlatform("node",new oh);var ih={float32:4,int32:4,uint16:2,uint8:1,bool:1};function ah(e,t){for(var n={},r=0,o=function(t){var o=t.name,i=t.dtype,a=t.shape,s=kn(a),u=void 0;if("quantization"in t){var l=t.quantization;if("uint8"!==l.dtype&&"uint16"!==l.dtype)throw new Error("Weight "+t.name+" has unknown quantization dtype "+l.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var c=ih[l.dtype],f=e.slice(r,r+s*c),d="uint8"===l.dtype?new Uint8Array(f):new Uint16Array(f);if("float32"===i)u=Float32Array.from(d,(function(e){return e*l.scale+l.min}));else{if("int32"!==i)throw new Error("Unsupported dtype in weight '"+o+"': "+i);u=Int32Array.from(d,(function(e){return Math.round(e*l.scale+l.min)}))}r+=s*c}else if("string"===i){var p=kn(t.shape);u=[];for(var h=0;h<p;h++){var v=new Uint32Array(e.slice(r,r+4))[0];r+=4;var m=new Uint8Array(e.slice(r,r+v));u.push(m),r+=v}}else{var g=ih[i];if(f=e.slice(r,r+s*g),"float32"===i)u=new Float32Array(f);else if("int32"===i)u=new Int32Array(f);else{if("bool"!==i)throw new Error("Unsupported dtype in weight '"+o+"': "+i);u=new Uint8Array(f)}r+=s*g}n[o]=ai(u,a,i)},i=0,a=t;i<a.length;i++)o(a[i]);return n}function sh(e){if(null===e)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach((function(e){if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+e.constructor.name)}));var r=new Uint8Array(t),o=0;return n.forEach((function(e){r.set(new Uint8Array(e.buffer),o),o+=e.byteLength})),r.buffer}var uh="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function lh(e){return uh?Buffer.byteLength(e):new Blob([e]).size}function ch(e){var t=0;e.forEach((function(e){t+=e.byteLength}));var n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(new Uint8Array(e),r),r+=e.byteLength})),n.buffer}function fh(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function dh(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:lh(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:lh(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}var ph=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,n){return e.getHandlers(t,"load",n)},e.getHandlers=function(t,n,r){var o=[];return("load"===n?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach((function(e){var n=e(t,r);null!==n&&o.push(n)})),o},e}(),hh="://",vh=function(){function e(){this.managers={}}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.registerManager=function(t,n){wn(null!=t,(function(){return"scheme must not be undefined or null."})),t.endsWith(hh)&&(t=t.slice(0,t.indexOf(hh))),wn(t.length>0,(function(){return"scheme must not be an empty string."}));var r=e.getInstance();wn(null==r.managers[t],(function(){return"A model store manager is already registered for scheme '"+t+"'."})),r.managers[t]=n},e.getManager=function(e){var t=this.getInstance().managers[e];if(null==t)throw new Error("Cannot find model manager for scheme '"+e+"'");return t},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function mh(e){if(-1===e.indexOf(hh))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+vh.getSchemes().join(","));return{scheme:e.split(hh)[0],path:e.split(hh)[1]}}function gh(e,t,n){return void 0===n&&(n=!1),rn(this,void 0,void 0,(function(){var r,o,i,a,s,u,l,c,f;return on(this,(function(d){switch(d.label){case 0:return wn(e!==t,(function(){return"Old path and new path are the same: '"+e+"'"})),wn((r=ph.getLoadHandlers(e)).length>0,(function(){return"Copying failed because no load handler is found for source URL "+e+"."})),wn(r.length<2,(function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."})),o=r[0],wn((i=ph.getSaveHandlers(t)).length>0,(function(){return"Copying failed because no save handler is found for destination URL "+t+"."})),wn(i.length<2,(function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."})),a=i[0],s=mh(e).scheme,u=mh(e).path,l=s===mh(e).scheme,[4,o.load()];case 1:return c=d.sent(),n&&l?[4,vh.getManager(s).removeModel(u)]:[3,3];case 2:d.sent(),d.label=3;case 3:return[4,a.save(c)];case 4:return f=d.sent(),!n||l?[3,6]:[4,vh.getManager(s).removeModel(u)];case 5:d.sent(),d.label=6;case 6:return[2,f.modelArtifactsInfo]}}))}))}var yh="models_store",bh="model_info_store";function xh(){if(!un().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function wh(e){var t=e.result;t.createObjectStore(yh,{keyPath:"modelPath"}),t.createObjectStore(bh,{keyPath:"modelPath"})}var Ch=function(){function e(e){if(this.indexedDB=xh(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}return e.prototype.save=function(e){return rn(this,void 0,void 0,(function(){return on(this,(function(t){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,e)]}))}))},e.prototype.load=function(){return rn(this,void 0,void 0,(function(){return on(this,(function(e){return[2,this.databaseAction(this.modelPath)]}))}))},e.prototype.databaseAction=function(e,t){var n=this;return new Promise((function(e,r){var o=n.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return wh(o)},o.onsuccess=function(){var i=o.result;if(null==t){var a=i.transaction(yh,"readonly"),s=a.objectStore(yh).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return i.close(),r(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));e(s.result.modelArtifacts)},s.onerror=function(e){return i.close(),r(s.error)},a.oncomplete=function(){return i.close()}}else{var u,l=dh(t),c=i.transaction(bh,"readwrite"),f=c.objectStore(bh),d=f.put({modelPath:n.modelPath,modelArtifactsInfo:l});d.onsuccess=function(){var o=(u=i.transaction(yh,"readwrite")).objectStore(yh).put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:l});o.onsuccess=function(){return e({modelArtifactsInfo:l})},o.onerror=function(e){var t=(f=c.objectStore(bh)).delete(n.modelPath);t.onsuccess=function(){return i.close(),r(o.error)},t.onerror=function(e){return i.close(),r(o.error)}}},d.onerror=function(e){return i.close(),r(d.error)},c.oncomplete=function(){null==u?i.close():u.oncomplete=function(){return i.close()}}}},o.onerror=function(e){return r(o.error)}}))},e.URL_SCHEME="indexeddb://",e}(),Eh=function(e){return un().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Ch.URL_SCHEME)?(t=e.slice(Ch.URL_SCHEME.length),new Ch(t)):null;var t};ph.registerSaveRouter(Eh),ph.registerLoadRouter(Eh);var Sh=function(){function e(){this.indexedDB=xh()}return e.prototype.listModels=function(){return rn(this,void 0,void 0,(function(){var e=this;return on(this,(function(t){return[2,new Promise((function(t,n){var r=e.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=function(){return wh(r)},r.onsuccess=function(){var e=r.result,o=e.transaction(bh,"readonly"),i=o.objectStore(bh).getAll();i.onsuccess=function(){for(var e={},n=0,r=i.result;n<r.length;n++){var o=r[n];e[o.modelPath]=o.modelArtifactsInfo}t(e)},i.onerror=function(t){return e.close(),n(i.error)},o.oncomplete=function(){return e.close()}},r.onerror=function(e){return n(r.error)}}))]}))}))},e.prototype.removeModel=function(e){return rn(this,void 0,void 0,(function(){var t=this;return on(this,(function(n){var r;return e=(r=e).startsWith(Ch.URL_SCHEME)?r.slice(Ch.URL_SCHEME.length):r,[2,new Promise((function(n,r){var o=t.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return wh(o)},o.onsuccess=function(){var t,i=o.result,a=i.transaction(bh,"readwrite"),s=a.objectStore(bh),u=s.get(e);u.onsuccess=function(){if(null==u.result)return i.close(),r(new Error("Cannot find model with path '"+e+"' in IndexedDB."));var o=s.delete(e),a=function(){var o=(t=i.transaction(yh,"readwrite")).objectStore(yh).delete(e);o.onsuccess=function(){return n(u.result.modelArtifactsInfo)},o.onerror=function(e){return r(u.error)}};o.onsuccess=a,o.onerror=function(e){return a(),i.close(),r(u.error)}},u.onerror=function(e){return i.close(),r(u.error)},a.oncomplete=function(){null==t?i.close():t.oncomplete=function(){return i.close()}}},o.onerror=function(e){return r(o.error)}}))]}))}))},e}();if(un().getBool("IS_BROWSER"))try{vh.registerManager(Ch.URL_SCHEME,new Sh)}catch(wr){}var kh="/",_h="tensorflowjs_models",Rh="info",Ih="model_topology",Th="weight_specs",Ah="weight_data",Dh="model_metadata";function Nh(e){return{info:[_h,e,Rh].join(kh),topology:[_h,e,Ih].join(kh),weightSpecs:[_h,e,Th].join(kh),weightData:[_h,e,Ah].join(kh),modelMetadata:[_h,e,Dh].join(kh)}}function Ph(e){var t=e.split(kh);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(kh)}var Mh=function(){function e(e){if(!un().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=Nh(this.modelPath)}return e.prototype.save=function(e){return rn(this,void 0,void 0,(function(){var t,n,r;return on(this,(function(o){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),r=dh(e);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(e){if(uh)return Buffer.from(e).toString("base64");for(var t=new Uint8Array(e),n="",r=0,o=t.length;r<o;r++)n+=String.fromCharCode(t[r]);return btoa(n)}(e.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata})),[2,{modelArtifactsInfo:r}]}catch(e){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+r.modelTopologyBytes+", weightSpecsBytes="+r.weightSpecsBytes+", weightDataBytes="+r.weightDataBytes+".")}return[2]}))}))},e.prototype.load=function(){return rn(this,void 0,void 0,(function(){var e,t,n,r,o,i,a;return on(this,(function(s){if(null==(e=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(t={},null==(n=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(t.modelTopology=n,null==(r=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(t.weightSpecs=r,null!=(o=this.LS.getItem(this.keys.modelMetadata))&&(i=JSON.parse(o),t.format=i.format,t.generatedBy=i.generatedBy,t.convertedBy=i.convertedBy,t.userDefinedMetadata=i.userDefinedMetadata),null==(a=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return t.weightData=function(e){if(uh){var t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}for(var n=atob(e),r=new Uint8Array(n.length),o=0;o<n.length;++o)r.set([n.charCodeAt(o)],o);return r.buffer}(a),[2,t]}))}))},e.URL_SCHEME="localstorage://",e}(),Oh=function(e){return un().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Mh.URL_SCHEME)?(t=e.slice(Mh.URL_SCHEME.length),new Mh(t)):null;var t};ph.registerSaveRouter(Oh),ph.registerLoadRouter(Oh);var Fh=function(){function e(){wn(un().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),wn("undefined"==typeof window||void 0!==window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return e.prototype.listModels=function(){return rn(this,void 0,void 0,(function(){var e,t,n,r,o,i;return on(this,(function(a){for(e={},t=_h+kh,n=kh+Rh,r=0;r<this.LS.length;++r)(o=this.LS.key(r)).startsWith(t)&&o.endsWith(n)&&(i=Ph(o),e[i]=JSON.parse(this.LS.getItem(o)));return[2,e]}))}))},e.prototype.removeModel=function(e){return rn(this,void 0,void 0,(function(){var t,n;return on(this,(function(r){var o;if(e=(o=e).startsWith(Mh.URL_SCHEME)?o.slice(Mh.URL_SCHEME.length):o,t=Nh(e),null==this.LS.getItem(t.info))throw new Error("Cannot find model at path '"+e+"'");return n=JSON.parse(this.LS.getItem(t.info)),this.LS.removeItem(t.info),this.LS.removeItem(t.topology),this.LS.removeItem(t.weightSpecs),this.LS.removeItem(t.weightData),[2,n]}))}))},e}();if(un().getBool("IS_BROWSER"))try{vh.registerManager(Mh.URL_SCHEME,new Fh)}catch(wr){}function Lh(e){return new Promise((function(e){return setTimeout(e)})).then(e)}var Bh=function(){function e(t){if(!un().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelTopologyFileName=t+".json",this.weightDataFileName=t+".weights.bin"}return e.prototype.save=function(e){return rn(this,void 0,void 0,(function(){var t,n,r,o,i,a;return on(this,(function(s){switch(s.label){case 0:if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),!(e.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:n},o=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),(i=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,i.href=o,[4,Lh((function(){return i.dispatchEvent(new MouseEvent("click"))}))];case 2:return s.sent(),null==e.weightData?[3,4]:((a=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,a.href=t,[4,Lh((function(){return a.dispatchEvent(new MouseEvent("click"))}))]);case 3:s.sent(),s.label=4;case 4:return[2,{modelArtifactsInfo:dh(e)}]}}))}))},e.URL_SCHEME="downloads://",e}(),zh=function(){function e(e){if(null==e||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+e);this.files=e}return e.prototype.load=function(){return rn(this,void 0,void 0,(function(){var e,t,n=this;return on(this,(function(r){return e=this.files[0],t=this.files.slice(1),[2,new Promise((function(r,o){var i=new FileReader;i.onload=function(i){var a=JSON.parse(i.target.result),s=a.modelTopology;if(null!=s){0===t.length&&r({modelTopology:s});var u=a.weightsManifest;if(null!=u){var l;try{l=n.checkManifestAndWeightFiles(u,t)}catch(e){return void o(e)}var c=[],f=[],d=[];u.forEach((function(e){e.paths.forEach((function(e){f.push(e),d.push(null)})),c.push.apply(c,e.weights)})),u.forEach((function(e){e.paths.forEach((function(e){var t=new FileReader;t.onload=function(t){var n=t.target.result,o=f.indexOf(e);d[o]=n,-1===d.indexOf(null)&&r({modelTopology:s,weightSpecs:c,weightData:ch(d),format:a.format,generatedBy:a.generatedBy,convertedBy:a.convertedBy,userDefinedMetadata:a.userDefinedMetadata})},t.onerror=function(t){return o("Failed to weights data from file of path '"+e+"'.")},t.readAsArrayBuffer(l[e])}))}))}else o(new Error("weightManifest field is missing from file "+e.name))}else o(new Error("modelTopology field is missing from file "+e.name))},i.onerror=function(t){return o("Failed to read model topology and weights manifest JSON from file '"+e.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},i.readAsText(e)}))]}))}))},e.prototype.checkManifestAndWeightFiles=function(e,t){for(var n=[],r=t.map((function(e){return fh(e.name)})),o={},i=0,a=e;i<a.length;i++)a[i].paths.forEach((function(e){var i=fh(e);if(-1!==n.indexOf(i))throw new Error("Duplicate file basename found in weights manifest: '"+i+"'");if(n.push(i),-1===r.indexOf(i))throw new Error("Weight file with basename '"+i+"' is not provided.");o[e]=t[r.indexOf(i)]}));if(n.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+t.length+").");return o},e}();function Wh(e,t,n,r){!function(e){wn(null!=e&&Array.isArray(e)&&e.length>0,(function(){return"promises must be a none empty array"}))}(e),function(e,t){wn(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but got startFraction "+e})),wn(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but got endFraction "+t})),wn(t>=e,(function(){return"startFraction must be no more than endFraction, but got startFraction "+e+" and endFraction "+t}))}(n=null==n?0:n,r=null==r?1:r);var o=0;return Promise.all(e.map((function(i){return i.then((function(i){var a=n+ ++o/e.length*(r-n);return t(a),i})),i})))}function Vh(e,t){return rn(this,void 0,void 0,(function(){var n,r,o,i,a,s,u,l,c;return on(this,(function(f){switch(f.label){case 0:return null==t&&(t={}),n=null==t.fetchFunc?un().platform.fetch:t.fetchFunc,r=e.map((function(e){return n(e,t.requestInit,{isBinary:!0})})),o=0,i=.5,null!=t.onProgress?[3,2]:[4,Promise.all(r)];case 1:return a=f.sent(),[3,4];case 2:return[4,Wh(r,t.onProgress,o,i)];case 3:a=f.sent(),f.label=4;case 4:return s=a.map((function(e){return e.arrayBuffer()})),u=.5,l=1,null!=t.onProgress?[3,6]:[4,Promise.all(s)];case 5:return c=f.sent(),[3,8];case 6:return[4,Wh(s,t.onProgress,u,l)];case 7:c=f.sent(),f.label=8;case 8:return[2,c]}}))}))}function Uh(e){var t=this;return function(n,r,o){return void 0===r&&(r=""),rn(t,void 0,void 0,(function(){var t,i,a,s,u,l,c,f,d,p;return on(this,(function(h){switch(h.label){case 0:if(t=n.map((function(){return!1})),i={},a=null!=o?o.map((function(){return!1})):[],s=[],n.forEach((function(e,n){var r=0;e.weights.forEach((function(e){var u="quantization"in e?e.quantization.dtype:e.dtype,l=ih[u]*kn(e.shape),c=function(){t[n]=!0,null==i[n]&&(i[n]=[]),i[n].push({manifestEntry:e,groupOffset:r,sizeBytes:l})};null!=o?o.forEach((function(t,n){t===e.name&&(c(),a[n]=!0)})):c(),s.push(e.name),r+=l}))})),!a.every((function(e){return e})))throw u=o.filter((function(e,t){return!a[t]})),new Error("Could not find weights in manifest with names: "+u.join(", ")+". \nManifest JSON has weights with names: "+s.join(", ")+".");return l=t.reduce((function(e,t,n){return t&&e.push(n),e}),[]),c=[],l.forEach((function(e){n[e].paths.forEach((function(e){var t=r+(r.endsWith("/")?"":"/")+e;c.push(t)}))})),[4,e(c)];case 1:return f=h.sent(),d={},p=0,l.forEach((function(e){for(var t=n[e].paths.length,r=0,o=0;o<t;o++)r+=f[p+o].byteLength;for(var a=new ArrayBuffer(r),s=new Uint8Array(a),u=0,l=0;l<t;l++){var c=new Uint8Array(f[p+l]);s.set(c,u),u+=c.byteLength}i[e].forEach((function(e){var t=ah(a.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(var n in t)d[n]=t[n]})),p+=t})),[2,d]}}))}))}}ph.registerSaveRouter((function(e){return un().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Bh.URL_SCHEME)?function(e){return void 0===e&&(e="model"),new Bh(e)}(e.slice(Bh.URL_SCHEME.length)):null}));var jh=function(){function e(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,null!=t.fetchFunc?(wn("function"==typeof t.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=t.fetchFunc):this.fetch=un().platform.fetch,wn(null!=e&&e.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(e)&&wn(2===e.length,(function(){return"URL paths for http must have a length of 2, (actual length is "+e.length+")."})),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}return e.prototype.save=function(e){return rn(this,void 0,void 0,(function(){var t,n,r,o;return on(this,(function(i){switch(i.label){case 0:if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata,weightsManifest:n},t.body.append("model.json",new Blob([JSON.stringify(r)],{type:"application/json"}),"model.json"),null!=e.weightData&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,t)];case 1:if((o=i.sent()).ok)return[2,{modelArtifactsInfo:dh(e),responses:[o]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+o.status+".")}}))}))},e.prototype.load=function(){return rn(this,void 0,void 0,(function(){var e,t,n,r,o,i,a,s,u,l,c,f;return on(this,(function(d){switch(d.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(e=d.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+e.status+". Please verify this URL points to the model JSON of the model to load.");d.label=2;case 2:return d.trys.push([2,4,,5]),[4,e.json()];case 3:return t=d.sent(),[3,5];case 4:throw d.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(r=t.modelTopology,o=t.weightsManifest,i=t.generatedBy,a=t.convertedBy,s=t.format,u=t.userDefinedMetadata,null==r&&null==o)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return null==o?[3,7]:[4,this.loadWeights(o)];case 6:f=d.sent(),l=f[0],c=f[1],d.label=7;case 7:return[2,{modelTopology:r,weightSpecs:l,weightData:c,userDefinedMetadata:u,generatedBy:i,convertedBy:a,format:s}]}}))}))},e.prototype.loadWeights=function(e){return rn(this,void 0,void 0,(function(){var t,n,r,o,i,a,s,u,l,c,f;return on(this,(function(d){switch(d.label){case 0:for(t=Array.isArray(this.path)?this.path[1]:this.path,n=function(e){var t=e.lastIndexOf("/"),n=e.lastIndexOf("?");return[e.substring(0,t)+"/",n>t?e.substring(n):""]}(t),r=n[0],o=n[1],i=this.weightPathPrefix||r,a=[],s=0,u=e;s<u.length;s++)l=u[s],a.push.apply(a,l.weights);return c=[],e.forEach((function(e){e.paths.forEach((function(e){c.push(i+e+o)}))})),[4,Vh(c,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return f=d.sent(),[2,[a,ch(f)]]}}))}))},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function Hh(e){return null!=e.match(jh.URL_SCHEME_REGEX)}var Gh=function(e,t){return"undefined"==typeof fetch?null:(Array.isArray(e)?e.every((function(e){return Hh(e)})):Hh(e))?qh(e,{onProgress:t}):null};function qh(e,t){return new jh(e,t)}ph.registerSaveRouter(Gh),ph.registerLoadRouter(Gh);var Kh,Xh=function(){function e(e){this.modelArtifacts=e}return e.prototype.load=function(){return rn(this,void 0,void 0,(function(){return on(this,(function(e){return[2,this.modelArtifacts]}))}))},e}(),$h=function(){function e(e){this.saveHandler=e}return e.prototype.save=function(e){return rn(this,void 0,void 0,(function(){return on(this,(function(t){return[2,this.saveHandler(e)]}))}))},e}(),Yh=Object.freeze({browserFiles:function(e){return new zh(e)},browserHTTPRequest:function(e,t){return qh(e,t)},concatenateArrayBuffers:ch,decodeWeights:ah,encodeWeights:function(e,t){return rn(this,void 0,void 0,(function(){var n,r,o,i,a,s=this;return on(this,(function(u){switch(u.label){case 0:for(n=[],r=[],o=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e),i=function(i){var a=o[i],u=Array.isArray(e)?e[i].tensor:e[a];if("float32"!==u.dtype&&"int32"!==u.dtype&&"bool"!==u.dtype&&"string"!==u.dtype)throw new Error("Unsupported dtype in weight '"+a+"': "+u.dtype);var l={name:a,shape:u.shape,dtype:u.dtype};if("string"===u.dtype){var c=new Promise((function(e){return rn(s,void 0,void 0,(function(){var t,n,r,o,i,a,s;return on(this,(function(l){switch(l.label){case 0:return[4,u.bytes()];case 1:for(t=l.sent(),n=t.reduce((function(e,t){return e+t.length}),0)+4*t.length,r=new Uint8Array(n),o=0,i=0;i<t.length;i++)a=t[i],s=new Uint8Array(new Uint32Array([a.length]).buffer),r.set(s,o),o+=4,r.set(a,o),o+=a.length;return e(r),[2]}}))}))}));r.push(c)}else r.push(u.data());null!=t&&(l.group=t),n.push(l)},a=0;a<o.length;++a)i(a);return[4,Promise.all(r)];case 1:return[2,{data:sh(u.sent()),specs:n}]}}))}))},fromMemory:function(e,t,n,r){return 1===arguments.length?null!=e.modelTopology||null!=e.weightSpecs?new Xh(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Xh({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Xh({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))},getLoadHandlers:function(e,t){return ph.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:dh,getSaveHandlers:function(e){return ph.getSaveHandlers(e)},http:qh,isHTTPScheme:Hh,loadWeights:function(e,t,n,r){return void 0===t&&(t=""),rn(this,void 0,void 0,(function(){return on(this,(function(o){return[2,Uh((function(e){return Vh(e,{requestInit:r})}))(e,t,n)]}))}))},registerLoadRouter:function(e){return ph.registerLoadRouter(e)},registerSaveRouter:function(e){return ph.registerSaveRouter(e)},weightsLoaderFactory:Uh,withSaveHandler:function(e){return new $h(e)},copyModel:function(e,t){return rn(this,void 0,void 0,(function(){return on(this,(function(n){return[2,gh(e,t,!1)]}))}))},listModels:function(){return rn(this,void 0,void 0,(function(){var e,t,n,r,o,i,a;return on(this,(function(s){switch(s.label){case 0:e=vh.getSchemes(),t={},n=0,r=e,s.label=1;case 1:return n<r.length?(o=r[n],[4,vh.getManager(o).listModels()]):[3,4];case 2:for(a in i=s.sent())t[o+hh+a]=i[a];s.label=3;case 3:return n++,[3,1];case 4:return[2,t]}}))}))},moveModel:function(e,t){return rn(this,void 0,void 0,(function(){return on(this,(function(n){return[2,gh(e,t,!0)]}))}))},removeModel:function(e){return rn(this,void 0,void 0,(function(){var t;return on(this,(function(n){return t=mh(e),[2,vh.getManager(t.scheme).removeModel(t.path)]}))}))}}),Qh=ni({confusionMatrix_:function(e,t,n){var r=Ho(e,"labels","confusionMatrix"),o=Ho(t,"predictions","confusionMatrix");wn(null==n||n>0&&Number.isInteger(n),(function(){return"If provided, numClasses must be a positive integer, but got "+n})),wn(1===r.rank,(function(){return"Expected the rank of labels to be 1, but got "+r.rank})),wn(1===o.rank,(function(){return"Expected the rank of predictions to be 1, but got "+o.rank})),wn(r.shape[0]===o.shape[0],(function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+o.shape[0]+". Labels and predictions should have the same number of elements."})),wn(n>0&&Number.isInteger(n),(function(){return"numClasses is required to be a positive integer, but got "+n}));var i=Ki(r.asType("int32"),n),a=Ki(o.asType("int32"),n);return i.transpose().matMul(a).asType("int32")}}),Jh=(Object.freeze({confusionMatrix:Qh}),ni({fromPixels_:function(e,t){if(void 0===t&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,o=!1,i=!1,a=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement)o=!0;else if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)i=!0;else{if(null==e.getContext)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);a=!0}if(o&&o&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(null!=dn("FromPixels",Nr.backendName))return Nr.runKernel("FromPixels",{pixels:e},{numChannels:t});var s,u,l=o?[e.videoWidth,e.videoHeight]:[e.width,e.height],c=l[0],f=l[1];if(a?s=e.getContext("2d").getImageData(0,0,c,f).data:r||n?s=e.data:(i||o)&&(null==Kh&&(Kh=document.createElement("canvas").getContext("2d")),Kh.canvas.width=c,Kh.canvas.height=f,Kh.drawImage(e,0,0,c,f),s=Kh.getImageData(0,0,c,f).data),4===t)u=new Int32Array(s);else{var d=c*f;u=new Int32Array(d*t);for(var p=0;p<d;p++)for(var h=0;h<t;++h)u[p*t+h]=s[4*p+h]}return fi(u,[f,c,t],"int32")}})),Zh=Object.freeze({toPixels:function(e,t){return rn(this,void 0,void 0,(function(){var n,r,o,i,a,s,u,l,c,f,d,p,h,v,m,g,y,b,x,w,C,E,S;return on(this,(function(k){switch(k.label){case 0:if(n=Ho(e,"img","toPixels"),e instanceof vr||(n=n.toInt()),2!==n.rank&&3!==n.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),o=r[0],i=r[1],(a=2===n.rank?1:n.shape[2])>4||2===a)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+a);return[4,n.data()];case 1:return s=k.sent(),u=n.min(),l=n.max(),[4,Promise.all([u.data(),l.data()])];case 2:if(c=k.sent(),f=c[0],d=c[1],p=f[0],h=d[0],u.dispose(),l.dispose(),"float32"===n.dtype){if(p<0||h>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+p+" - "+h+"].")}else{if("int32"!==n.dtype)throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(p<0||h>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+p+" - "+h+"].")}for(v="float32"===n.dtype?255:1,m=new Uint8ClampedArray(i*o*4),g=0;g<o*i;++g)y=void 0,b=void 0,x=void 0,w=void 0,1===a?(y=s[g]*v,b=s[g]*v,x=s[g]*v,w=255):3===a?(y=s[3*g]*v,b=s[3*g+1]*v,x=s[3*g+2]*v,w=255):4===a&&(y=s[4*g]*v,b=s[4*g+1]*v,x=s[4*g+2]*v,w=s[4*g+3]*v),m[0+(C=4*g)]=Math.round(y),m[C+1]=Math.round(b),m[C+2]=Math.round(x),m[C+3]=Math.round(w);return null!=t&&(t.width=i,t.height=o,E=t.getContext("2d"),S=new ImageData(m,i,o),E.putImageData(S,0,0)),n!==e&&n.dispose(),[2,m]}}))}))},fromPixels:Jh}),ev=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(e,t){return new e(t)},e}(),tv=function(){function e(){this.classNameMap={}}return e.getMap=function(){return null==e.instance&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function nv(e){wn(null!=e.className,(function(){return"Class being registered does not have the static className property defined."})),wn("string"==typeof e.className,(function(){return"className is required to be a string, but got type "+typeof e.className})),wn(e.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),tv.register(e)}Object.freeze({Serializable:ev,SerializationMap:tv,registerClass:nv});function rv(){return 32===Nr.backend.floatPrecision()?.001:.1}function ov(e,t,n){var r=!0;if((Wn(e)||Wn(t))&&(r=!1),Wn(e)&&Wn(t)&&(r=!0),r){var o=e.constructor.name,i=t.constructor.name;if(o!==i)throw new Error("Arrays are of different type. Actual: "+o+". Expected: "+i)}if(Array.isArray(e)&&Array.isArray(t)){var a=Uo(e),s=Uo(t);if(!_n(a,s))throw new Error("Arrays have different shapes. Actual: ["+a+"]. Expected: ["+s+"]")}var u=Wn(e)?e:Sn(e),l=Wn(t)?t:Sn(t);if(u.length!==l.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+l.length+".\nActual:   "+u+".\nExpected: "+l+".");for(var c=0;c<l.length;++c){var f=u[c],d=l[c];if(!n(f,d))throw new Error("Arrays differ: actual["+c+"] = "+f+", expected["+c+"] = "+d+".\nActual:   "+u+".\nExpected: "+l+".")}}function iv(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}Object.freeze({TEST_EPSILON_FLOAT16:.1,expectArraysClose:function(e,t,n){return null==n&&(n=rv()),ov(e,t,(function(e,t){return iv(e,t,n)}))},testEpsilon:rv,expectPromiseToFail:function(e,t){e().then((function(){return t.fail()}),(function(){return t()}))},expectArraysEqual:function(e,t){var n="string"==typeof t||"number"==typeof t||"boolean"==typeof t?[t]:t;return jn(e)||jn(e[0])||jn(t)||jn(t[0])?ov(e,n,(function(e,t){return e==t})):ov(e,t,(function(e,t){return iv(e,t,0)}))},expectNumbersClose:function(e,t,n){if(null==n&&(n=rv()),!iv(e,t,n))throw new Error("Numbers differ: actual === "+e+", expected === "+t)},expectValuesInRange:function(e,t,n){for(var r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error("Value out of range:"+e[r]+" low: "+t+", high: "+n)},expectArrayBuffersEqual:function(e,t){expect(new Float32Array(e)).toEqual(new Float32Array(t))}}),Object.freeze({gpgpu_util:Vu,webgl_util:Fo,forceHalfFloat:function(){un().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:nc,setWebGLContext:Wr,GPGPUContext:Uu});var av=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return nn(t,e),t.prototype.minimize=function(e,t,n){void 0===t&&(t=!1);var r=this.computeGradients(e,n),o=r.value,i=r.grads;if(null!=n){var a=n.map((function(e){return{name:e.name,tensor:i[e.name]}}));this.applyGradients(a)}else this.applyGradients(i);return Wo(i),t?o:(o.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(e,t){return function(e,t){wn(Kn(e),(function(){return"The f passed in variableGrads(f) must be a function"})),wn(null==t||Array.isArray(t)&&t.every((function(e){return e instanceof Cr})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=t;if(!n)for(var r in t=[],Nr.registeredVariables)t.push(Nr.registeredVariables[r]);var o=n?t.filter((function(e){return!e.trainable})):null,i=t.length;wn((t=t.filter((function(e){return e.trainable}))).length>0,(function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."}));var a=Nr.gradients(e,t,null,!0),s=a.value,u=a.grads;wn(u.some((function(e){return null!=e})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),wn(0===s.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"}));var l={};return t.forEach((function(e,t){null!=u[t]&&(l[e.name]=u[t])})),null!=o&&o.forEach((function(e){return l[e.name]=null})),{value:s,grads:l}}(e,t)},t.prototype.dispose=function(){null!=this.iterations_&&Wo(this.iterations_)},t.prototype.saveIterations=function(){return rn(this,void 0,void 0,(function(){return on(this,(function(e){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:ui(this.iterations_,"int32")}]}))}))},t.prototype.getWeights=function(){return rn(this,void 0,void 0,(function(){return on(this,(function(e){throw new Error("getWeights() is not implemented for this optimizer yet.")}))}))},t.prototype.setWeights=function(e){return rn(this,void 0,void 0,(function(){return on(this,(function(e){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}))}))},t.prototype.extractIterations=function(e){return rn(this,void 0,void 0,(function(){var t;return on(this,(function(n){switch(n.label){case 0:return t=this,[4,e[0].tensor.data()];case 1:return t.iterations_=n.sent()[0],[2,e.slice(1)]}}))}))},t}(ev);Object.defineProperty(av,Symbol.hasInstance,{value:function(e){return null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients}});var sv=function(e){function t(t,n,r){void 0===r&&(r=null);var o=e.call(this)||this;return o.learningRate=t,o.rho=n,o.epsilon=r,o.accumulatedGrads=[],o.accumulatedUpdates=[],null==r&&(o.epsilon=Nr.backend.epsilon()),o}return nn(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var o=Nr.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:n+"/accum_grad",variable:zo((function(){return yi(o).variable(!1)}))}),null==t.accumulatedUpdates[r]&&(t.accumulatedUpdates[r]={originalName:n+"/accum_var",variable:zo((function(){return yi(o).variable(!1)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var a=t.accumulatedGrads[r].variable,s=t.accumulatedUpdates[r].variable;zo((function(){var e=a.mul(t.rho).add(i.square().mul(1-t.rho)),n=s.add(t.epsilon).sqrt().div(a.add(t.epsilon).sqrt()).mul(i),r=s.mul(t.rho).add(n.square().mul(1-t.rho));a.assign(e),s.assign(r);var u=n.mul(-t.learningRate).add(o);o.assign(u)}))}})),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedUpdates&&(Wo(this.accumulatedGrads.map((function(e){return e.variable}))),Wo(this.accumulatedUpdates.map((function(e){return e.variable}))))},t.prototype.getWeights=function(){return rn(this,void 0,void 0,(function(){var e;return on(this,(function(t){switch(t.label){case 0:return e=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return rn(this,void 0,void 0,(function(){var t;return on(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),t=e.length/2,this.accumulatedGrads=e.slice(0,t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.accumulatedUpdates=e.slice(t,2*t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(e,t){return new e(t.learningRate,t.rho,t.epsilon)},t.className="Adadelta",t}(av);nv(sv);var uv=function(e){function t(t,n){void 0===n&&(n=.1);var r=e.call(this)||this;return r.learningRate=t,r.initialAccumulatorValue=n,r.accumulatedGrads=[],r}return nn(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var o=Nr.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:n+"/accumulator",variable:zo((function(){return vi(o.shape,t.initialAccumulatorValue).variable(!1)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var a=t.accumulatedGrads[r].variable;zo((function(){var e=a.add(i.square());a.assign(e);var n=i.div(e.add(Nr.backend.epsilon()).sqrt()).mul(-t.learningRate).add(o);o.assign(n)}))}})),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedGrads&&Wo(this.accumulatedGrads.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return rn(this,void 0,void 0,(function(){return on(this,(function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulatedGrads.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return rn(this,void 0,void 0,(function(){return on(this,(function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:return e=t.sent(),this.accumulatedGrads=e.map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(e,t){return new e(t.learningRate,t.initialAccumulatorValue)},t.className="Adagrad",t}(av);nv(uv);var lv=function(e){function t(t,n,r,o){void 0===o&&(o=null);var i=e.call(this)||this;return i.learningRate=t,i.beta1=n,i.beta2=r,i.epsilon=o,i.accumulatedFirstMoment=[],i.accumulatedSecondMoment=[],zo((function(){i.accBeta1=ui(n).variable(),i.accBeta2=ui(r).variable()})),null==o&&(i.epsilon=Nr.backend.epsilon()),i}return nn(t,e),t.prototype.applyGradients=function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);zo((function(){var r=_f(1,t.accBeta1),o=_f(1,t.accBeta2);n.forEach((function(n,i){var a=Nr.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:n+"/m",variable:zo((function(){return yi(a).variable(!1)}))}),null==t.accumulatedSecondMoment[i]&&(t.accumulatedSecondMoment[i]={originalName:n+"/v",variable:zo((function(){return yi(a).variable(!1)}))});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,l=t.accumulatedSecondMoment[i].variable,c=u.mul(t.beta1).add(s.mul(1-t.beta1)),f=l.mul(t.beta2).add(s.square().mul(1-t.beta2)),d=c.div(r),p=f.div(o);u.assign(c),l.assign(f);var h=d.div(p.sqrt().add(t.epsilon)).mul(-t.learningRate).add(a);a.assign(h)}})),t.accBeta1.assign(t.accBeta1.mul(t.beta1)),t.accBeta2.assign(t.accBeta2.mul(t.beta2))})),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Wo(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedSecondMoment&&Wo(this.accumulatedSecondMoment.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return rn(this,void 0,void 0,(function(){var e;return on(this,(function(t){switch(t.label){case 0:return e=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return rn(this,void 0,void 0,(function(){var t,n=this;return on(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:return e=r.sent(),zo((function(){n.accBeta1.assign(Ef(n.beta1,n.iterations_+1)),n.accBeta2.assign(Ef(n.beta2,n.iterations_+1))})),t=e.length/2,this.accumulatedFirstMoment=e.slice(0,t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.accumulatedSecondMoment=e.slice(t,2*t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)},t.className="Adam",t}(av);nv(lv);var cv=function(e){function t(t,n,r,o,i){void 0===o&&(o=null),void 0===i&&(i=0);var a=e.call(this)||this;return a.learningRate=t,a.beta1=n,a.beta2=r,a.epsilon=o,a.decay=i,a.accumulatedFirstMoment=[],a.accumulatedWeightedInfNorm=[],zo((function(){a.iteration=ui(0).variable(),a.accBeta1=ui(n).variable()})),null==o&&(a.epsilon=Nr.backend.epsilon()),a}return nn(t,e),t.prototype.applyGradients=function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);zo((function(){var r=_f(1,t.accBeta1),o=ff(-t.learningRate,t.iteration.mul(t.decay).add(1));n.forEach((function(n,i){var a=Nr.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:n+"/m",variable:yi(a).variable(!1)}),null==t.accumulatedWeightedInfNorm[i]&&(t.accumulatedWeightedInfNorm[i]={originalName:n+"/v",variable:yi(a).variable(!1)});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,l=t.accumulatedWeightedInfNorm[i].variable,c=u.mul(t.beta1).add(s.mul(1-t.beta1)),f=l.mul(t.beta2),d=s.abs(),p=f.maximum(d);u.assign(c),l.assign(p);var h=o.div(r).mul(c.div(p.add(t.epsilon))).add(a);a.assign(h)}})),t.iteration.assign(t.iteration.add(1)),t.accBeta1.assign(t.accBeta1.mul(t.beta1))})),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Wo(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedWeightedInfNorm&&Wo(this.accumulatedWeightedInfNorm.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return rn(this,void 0,void 0,(function(){return on(this,(function(e){throw new Error("getWeights() is not implemented for Adamax yet.")}))}))},t.prototype.setWeights=function(e){return rn(this,void 0,void 0,(function(){return on(this,(function(e){throw new Error("setWeights() is not implemented for Adamax yet.")}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)},t.className="Adamax",t}(av);nv(cv);var fv=function(e){function t(t){var n=e.call(this)||this;return n.learningRate=t,n.setLearningRate(t),n}return nn(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var o=Array.isArray(e)?e[r].tensor:e[n];if(null!=o){var i=Nr.registeredVariables[n];zo((function(){var e=t.c.mul(o).add(i);i.assign(e)}))}})),this.incrementIterations()},t.prototype.setLearningRate=function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=function(e){return Nr.keep(e)}(ui(-e))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return rn(this,void 0,void 0,(function(){return on(this,(function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()]]}}))}))},t.prototype.setWeights=function(e){return rn(this,void 0,void 0,(function(){return on(this,(function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:if(0!==(e=t.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(e,t){return new e(t.learningRate)},t.className="SGD",t}(av);nv(fv);var dv=function(e){function t(t,n,r){void 0===r&&(r=!1);var o=e.call(this,t)||this;return o.learningRate=t,o.momentum=n,o.useNesterov=r,o.accumulations=[],o.m=ui(o.momentum),o}return nn(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var o=Nr.registeredVariables[n];null==t.accumulations[r]&&(t.accumulations[r]={originalName:n+"/momentum",variable:zo((function(){return yi(o).variable(!1)}))});var i=t.accumulations[r].variable,a=Array.isArray(e)?e[r].tensor:e[n];null!=a&&zo((function(){var e,n=t.m.mul(i).add(a);e=t.useNesterov?t.c.mul(a.add(n.mul(t.m))).add(o):t.c.mul(n).add(o),i.assign(n),o.assign(e)}))})),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&Wo(this.accumulations.map((function(e){return e.variable})))},t.prototype.setMomentum=function(e){this.momentum=e},t.prototype.getWeights=function(){return rn(this,void 0,void 0,(function(){return on(this,(function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulations.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return rn(this,void 0,void 0,(function(){return on(this,(function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:return e=t.sent(),this.accumulations=e.map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)},t.className="Momentum",t}(fv);nv(dv);var pv=function(e){function t(t,n,r,o,i){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===o&&(o=null),void 0===i&&(i=!1);var a=e.call(this)||this;if(a.learningRate=t,a.decay=n,a.momentum=r,a.epsilon=o,a.accumulatedMeanSquares=[],a.accumulatedMoments=[],a.accumulatedMeanGrads=[],a.centered=i,null==o&&(a.epsilon=Nr.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.");return a}return nn(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var o=Nr.registeredVariables[n];null==t.accumulatedMeanSquares[r]&&(t.accumulatedMeanSquares[r]={originalName:n+"/rms",variable:zo((function(){return yi(o).variable(!1)}))}),null==t.accumulatedMoments[r]&&(t.accumulatedMoments[r]={originalName:n+"/momentum",variable:zo((function(){return yi(o).variable(!1)}))}),null==t.accumulatedMeanGrads[r]&&t.centered&&(t.accumulatedMeanGrads[r]={originalName:n+"/mg",variable:zo((function(){return yi(o).variable(!1)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var a=t.accumulatedMeanSquares[r].variable,s=t.accumulatedMoments[r].variable;zo((function(){var e=a.mul(t.decay).add(i.square().mul(1-t.decay));if(t.centered){var n=t.accumulatedMeanGrads[r].variable,u=n.mul(t.decay).add(i.mul(1-t.decay)),l=s.mul(t.momentum).add(i.mul(t.learningRate).div(e.sub(u.square().add(t.epsilon)).sqrt()));a.assign(e),n.assign(u),s.assign(l);var c=o.sub(l);o.assign(c)}else{var f=a.mul(t.decay).add(i.square().mul(1-t.decay));l=s.mul(t.momentum).add(i.mul(t.learningRate).div(f.add(t.epsilon).sqrt())),a.assign(f),s.assign(l),c=o.sub(l),o.assign(c)}}))}})),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&Wo(this.accumulatedMeanSquares.map((function(e){return e.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&Wo(this.accumulatedMeanGrads.map((function(e){return e.variable}))),null!=this.accumulatedMoments&&Wo(this.accumulatedMoments.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return rn(this,void 0,void 0,(function(){var e;return on(this,(function(t){switch(t.label){case 0:return e=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&e.push.apply(e,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return rn(this,void 0,void 0,(function(){var t;return on(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),t=this.centered?e.length/3:e.length/2,this.accumulatedMeanSquares=e.slice(0,t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.accumulatedMoments=e.slice(t,2*t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.centered&&(this.accumulatedMeanGrads=e.slice(2*t,3*t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}))),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)},t.className="RMSProp",t}(av);nv(pv);var hv=function(){function e(){}return e.sgd=function(e){return new fv(e)},e.momentum=function(e,t,n){return void 0===n&&(n=!1),new dv(e,t,n)},e.rmsprop=function(e,t,n,r,o){return void 0===t&&(t=.9),void 0===n&&(n=0),void 0===r&&(r=null),void 0===o&&(o=!1),new pv(e,t,n,r,o)},e.adam=function(e,t,n,r){return void 0===e&&(e=.001),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===r&&(r=null),new lv(e,t,n,r)},e.adadelta=function(e,t,n){return void 0===e&&(e=.001),void 0===t&&(t=.95),void 0===n&&(n=null),new sv(e,t,n)},e.adamax=function(e,t,n,r,o){return void 0===e&&(e=.002),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===r&&(r=null),void 0===o&&(o=0),new cv(e,t,n,r,o)},e.adagrad=function(e,t){return void 0===t&&(t=.1),new uv(e,t)},e}();hv.sgd,hv.momentum,hv.adadelta,hv.adagrad,hv.rmsprop,hv.adamax,hv.adam,"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate&&setImmediate;vr.prototype.squaredDifference=function(e){return ic(this,e)},pr=jp;var vv=function(e,t){return vv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},vv(e,t)};function mv(e,t){function n(){this.constructor=e}vv(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var gv=function(){return gv=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},gv.apply(this,arguments)};function yv(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(nn){i(nn)}}function s(e){try{u(r.throw(e))}catch(nn){i(nn)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function bv(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(nn){i=[6,nn],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function xv(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}var wv=function(){function e(e,t){if(!Tv(e)||!Tv(t))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:e,height:t}));this._width=e,this._height=t}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),e.prototype.reverse=function(){return new e(1/this.width,1/this.height)},e}();function Cv(e,t){return e instanceof vr&&e.shape.length===t}function Ev(e){return Cv(e,3)}function Sv(e){return Cv(e,4)}function kv(e){return e%2===0}function _v(e){return e&&e.width&&e.height}function Rv(e){return e.reduce((function(e,t){return e.add(t)}),new Dv(0,0)).div(new Dv(e.length,e.length))}function Iv(e,t,n){return Array(e).fill(0).map((function(e,r){return t+r*n}))}function Tv(e){return!!e&&e!==1/0&&e!==-1/0&&!isNaN(e)||0===e}function Av(e){return Tv(e)&&0<=e&&e<=1}var Dv=function(){function e(e,t){this._x=e,this._y=t}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.sub=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.mul=function(t){return new e(this.x*t.x,this.y*t.y)},e.prototype.div=function(t){return new e(this.x/t.x,this.y/t.y)},e.prototype.abs=function(){return new e(Math.abs(this.x),Math.abs(this.y))},e.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},e.prototype.floor=function(){return new e(Math.floor(this.x),Math.floor(this.y))},e}(),Nv=function(){function e(t,n){void 0===n&&(n=!0);var r=t||{},o=[r.left,r.top,r.right,r.bottom].every(Tv),i=[r.x,r.y,r.width,r.height].every(Tv);if(!i&&!o)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var a=i?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],s=a[0],u=a[1],l=a[2],c=a[3];e.assertIsValidBox({x:s,y:u,width:l,height:c},"Box.constructor",n),this._x=s,this._y=u,this._width=l,this._height=c}return e.isRect=function(e){return!!e&&[e.x,e.y,e.width,e.height].every(Tv)},e.assertIsValidBox=function(t,n,r){if(void 0===r&&(r=!1),!e.isRect(t))throw new Error(n+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!r&&(t.width<0||t.height<0))throw new Error(n+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topLeft",{get:function(){return new Dv(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topRight",{get:function(){return new Dv(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomLeft",{get:function(){return new Dv(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomRight",{get:function(){return new Dv(this.right,this.bottom)},enumerable:!0,configurable:!0}),e.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map((function(e){return Math.round(e)}));return new e({x:t[0],y:t[1],width:t[2],height:t[3]})},e.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map((function(e){return Math.floor(e)}));return new e({x:t[0],y:t[1],width:t[2],height:t[3]})},e.prototype.toSquare=function(){var t=this,n=t.x,r=t.y,o=t.width,i=t.height,a=Math.abs(o-i);return o<i&&(n-=a/2,o+=a),i<o&&(r-=a/2,i+=a),new e({x:n,y:r,width:o,height:i})},e.prototype.rescale=function(t){var n=_v(t)?t.width:t,r=_v(t)?t.height:t;return new e({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})},e.prototype.pad=function(t,n){var r=[this.x-t/2,this.y-n/2,this.width+t,this.height+n];return new e({x:r[0],y:r[1],width:r[2],height:r[3]})},e.prototype.clipAtImageBorders=function(t,n){var r=this,o=r.x,i=r.y,a=r.right,s=r.bottom,u=Math.max(o,0),l=Math.max(i,0),c=a-u,f=s-l;return new e({x:u,y:l,width:Math.min(c,t-u),height:Math.min(f,n-l)}).floor()},e.prototype.shift=function(t,n){var r=this.width,o=this.height;return new e({x:this.x+t,y:this.y+n,width:r,height:o})},e.prototype.padAtBorders=function(e,t){var n=this.width+1,r=this.height+1,o=n,i=r,a=this.left,s=this.top,u=this.right,l=this.bottom;return u>t&&(o=-u+t+n,u=t),l>e&&(i=-l+e+r,l=e),a<1&&(i=2-a,a=1),s<1&&(i=2-s,s=1),{dy:1,edy:i,dx:1,edx:o,y:s,ey:l,x:a,ex:u,w:n,h:r}},e.prototype.calibrate=function(t){return new e({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},e}(),Pv=function(e){function t(t,n,r,o,i){return void 0===i&&(i=!1),e.call(this,{left:t,top:n,right:r,bottom:o},i)||this}return mv(t,e),t}(Nv),Mv=function(){function e(e,t,n,r,o){this._imageDims=new wv(o.width,o.height),this._score=e,this._classScore=t,this._className=n,this._box=new Nv(r).rescale(this._imageDims)}return Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativeBox",{get:function(){return new Nv(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new e(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:n})},e}(),Ov=function(e){function t(t,n,r){return e.call(this,t,t,"",n,r)||this}return mv(t,e),t.prototype.forSize=function(n,r){var o=e.prototype.forSize.call(this,n,r);return new t(o.score,o.relativeBox,o.imageDims)},t}(Mv);function Fv(e,t,n){void 0===n&&(n=!0);var r=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left))*Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top));return n?r/(e.area+t.area-r):r/Math.min(e.area,t.area)}function Lv(e,t,n,r){void 0===r&&(r=!0);for(var o=t.map((function(e,t){return{score:e,boxIndex:t}})).sort((function(e,t){return e.score-t.score})).map((function(e){return e.boxIndex})),i=[],a=function(){var t=o.pop();i.push(t);for(var a=o,s=[],u=0;u<a.length;u++){var l=a[u],c=e[t],f=e[l];s.push(Fv(c,f,r))}o=o.filter((function(e,t){return s[t]<=n}))};o.length>0;)a();return i}function Bv(e,t){return zo((function(){var n=t[0],r=t[1],o=t[2],i=vi(xv(e.shape.slice(0,3),[1]),n),a=vi(xv(e.shape.slice(0,3),[1]),r),s=vi(xv(e.shape.slice(0,3),[1]),o),u=bi([i,a,s],3);return _f(e,u)}))}function zv(e){return 1/(1+Math.exp(-e))}var Wv,Vv=function(e){function t(t,n,r,o,i){return void 0===i&&(i=!1),e.call(this,{x:t,y:n,width:r,height:o},i)||this}return mv(t,e),t}(Nv),Uv=function(){function e(e,t,n){void 0===n&&(n=new Dv(0,0));var r=t.width,o=t.height;this._imgDims=new wv(r,o),this._shift=n,this._positions=e.map((function(e){return e.mul(new Dv(r,o)).add(n)}))}return Object.defineProperty(e.prototype,"shift",{get:function(){return new Dv(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativePositions",{get:function(){var e=this;return this._positions.map((function(t){return t.sub(e._shift).div(new Dv(e.imageWidth,e.imageHeight))}))},enumerable:!0,configurable:!0}),e.prototype.forSize=function(e,t){return new this.constructor(this.relativePositions,{width:e,height:t})},e.prototype.shiftBy=function(e,t){return new this.constructor(this.relativePositions,this._imgDims,new Dv(e,t))},e.prototype.shiftByPoint=function(e){return this.shiftBy(e.x,e.y)},e.prototype.align=function(e,t){if(void 0===t&&(t={}),e){var n=e instanceof Ov?e.box.floor():new Nv(e);return this.shiftBy(n.x,n.y).align(null,t)}var r=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},t),o=r.useDlibAlignment,i=r.minBoxPadding;return o?this.alignDlib():this.alignMinBbox(i)},e.prototype.alignDlib=function(){var e=this.getRefPointsForAlignment(),t=e[0],n=e[1],r=e[2],o=function(e){return r.sub(e).magnitude()},i=(o(t)+o(n))/2,a=Math.floor(i/.45),s=Rv(e),u=Math.floor(Math.max(0,s.x-.5*a)),l=Math.floor(Math.max(0,s.y-.43*a));return new Vv(u,l,Math.min(a,this.imageWidth+u),Math.min(a,this.imageHeight+l))},e.prototype.alignMinBbox=function(e){var t=function(e){var t=e.map((function(e){return e.x})),n=e.map((function(e){return e.y})),r=t.reduce((function(e,t){return t<e?t:e}),1/0),o=n.reduce((function(e,t){return t<e?t:e}),1/0),i=t.reduce((function(e,t){return e<t?t:e}),0),a=n.reduce((function(e,t){return e<t?t:e}),0);return new Pv(r,o,i,a)}(this.positions);return t.pad(t.width*e,t.height*e)},e.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},e}(),jv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mv(t,e),t.prototype.getRefPointsForAlignment=function(){var e=this.positions;return[e[0],e[1],Rv([e[3],e[4]])]},t}(Uv),Hv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mv(t,e),t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(Rv)},t}(Uv),Gv=function(){function e(e,t){this._label=e,this._distance=t}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),e.prototype.toString=function(e){return void 0===e&&(e=!0),this.label+(e?" ("+function(e,t){void 0===t&&(t=2);var n=Math.pow(10,t);return Math.floor(e*n)/n}(this.distance)+")":"")},e}(),qv=function(e){function t(t,n){var r=e.call(this,t)||this;return r._label=n,r}return mv(t,e),t.assertIsValidLabeledBox=function(e,t){if(Nv.assertIsValidBox(e,t),!Tv(e.label))throw new Error(t+" - expected property label ("+e.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t}(Nv),Kv=function(){function e(e,t){if("string"!==typeof e)throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(t)||t.some((function(e){return!(e instanceof Float32Array)})))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=e,this._descriptors=t}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map((function(e){return Array.from(e)}))}},e.fromJSON=function(t){var n=t.descriptors.map((function(e){return new Float32Array(e)}));return new e(t.label,n)},e}();!function(e){function t(t,n,r,o){var i=e.call(this,t,n)||this;return i._score=r,i._classScore=o,i}mv(t,e),t.assertIsValidPredictedBox=function(e,t){if(qv.assertIsValidLabeledBox(e,t),!Av(e.score)||!Av(e.classScore))throw new Error(t+" - expected properties score ("+e.score+") and ("+e.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0})}(qv);function Xv(e,t){var n={detection:t};return Object.assign({},e,n)}function $v(){var e=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D:CanvasRenderingContext2D,Image:HTMLImageElement,ImageData:ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:e,readFile:function(){throw new Error("readFile - filesystem not available for browser environment")}}}function Yv(e){var t="";if(!e)try{e=n(Object(function(){var e=new Error("Cannot find module 'fs'");throw e.code="MODULE_NOT_FOUND",e}()))}catch(r){t=r.toString()}return{readFile:e?function(t){return new Promise((function(n,r){e.readFile(t,(function(e,t){return e?r(e):n(t)}))}))}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)}}}function Qv(){var e=n.g.Canvas||n.g.HTMLCanvasElement,t=n.g.Image||n.g.HTMLImageElement,r=n.g.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},o=Yv();return gv({Canvas:e||function(){},CanvasRenderingContext2D:n.g.CanvasRenderingContext2D||function(){},Image:t||function(){},ImageData:n.g.ImageData||function(){},Video:n.g.HTMLVideoElement||function(){},createCanvasElement:function(){if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},createImageElement:function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},fetch:r},o)}function Jv(){return"object"===typeof window&&"undefined"!==typeof document&&"undefined"!==typeof HTMLImageElement&&"undefined"!==typeof HTMLCanvasElement&&"undefined"!==typeof HTMLVideoElement&&"undefined"!==typeof ImageData&&"undefined"!==typeof CanvasRenderingContext2D}function Zv(){return"object"===typeof n.g&&"undefined"!==typeof process&&!!process.version}function em(e){Wv=e}function tm(){Jv()&&em($v()),Zv()&&em(Qv())}var nm,rm={getEnv:function(){if(!Wv)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return Wv},setEnv:em,initialize:tm,createBrowserEnv:$v,createFileSystem:Yv,createNodejsEnv:Qv,monkeyPatch:function(e){if(Wv||tm(),!Wv)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=e.Canvas,n=void 0===t?Wv.Canvas:t,r=e.Image,o=void 0===r?Wv.Image:r;Wv.Canvas=n,Wv.Image=o,Wv.createCanvasElement=e.createCanvasElement||function(){return new n},Wv.createImageElement=e.createImageElement||function(){return new o},Wv.ImageData=e.ImageData||Wv.ImageData,Wv.Video=e.Video||Wv.Video,Wv.fetch=e.fetch||Wv.fetch,Wv.readFile=e.readFile||Wv.readFile},isBrowser:Jv,isNodejs:Zv};function om(e){return rm.isNodejs()||"string"!==typeof e?e:document.getElementById(e)}function im(e){var t=rm.getEnv(),n=t.Canvas;if(e instanceof t.CanvasRenderingContext2D)return e;var r=om(e);if(!(r instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var o=r.getContext("2d");if(!o)throw new Error("resolveContext2d - canvas 2d context is null");return o}tm(),function(e){e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT"}(nm||(nm={}));var am=function(e){void 0===e&&(e={});var t=e.anchorPosition,n=e.backgroundColor,r=e.fontColor,o=e.fontSize,i=e.fontStyle,a=e.padding;this.anchorPosition=t||nm.TOP_LEFT,this.backgroundColor=n||"rgba(0, 0, 0, 0.5)",this.fontColor=r||"rgba(255, 255, 255, 1)",this.fontSize=o||14,this.fontStyle=i||"Georgia",this.padding=a||4},sm=function(){function e(t,n,r){void 0===r&&(r={}),this.text="string"===typeof t?[t]:t instanceof e?t.text:t,this.anchor=n,this.options=new am(r)}return e.prototype.measureWidth=function(e){var t=this.options.padding;return this.text.map((function(t){return e.measureText(t).width})).reduce((function(e,t){return e<t?t:e}),0)+2*t},e.prototype.measureHeight=function(){var e=this.options,t=e.fontSize,n=e.padding;return this.text.length*t+2*n},e.prototype.getUpperLeft=function(e,t){var n=this.options.anchorPosition,r=n===nm.BOTTOM_RIGHT||n===nm.TOP_RIGHT,o=n===nm.BOTTOM_LEFT||n===nm.BOTTOM_RIGHT,i=this.measureWidth(e),a=this.measureHeight(),s=r?this.anchor.x-i:this.anchor.x,u=o?this.anchor.y-a:this.anchor.y;if(t){var l=t.width,c=t.height;return{x:Math.max(Math.min(s,l-i),0),y:Math.max(Math.min(u,c-a),0)}}return{x:s,y:u}},e.prototype.draw=function(e){var t=om(e),n=im(t),r=this.options,o=r.backgroundColor,i=r.fontColor,a=r.fontSize,s=r.fontStyle,u=r.padding;n.font=a+"px "+s;var l=this.measureWidth(n),c=this.measureHeight();n.fillStyle=o;var f=this.getUpperLeft(n,t);n.fillRect(f.x,f.y,l,c),n.fillStyle=i,this.text.forEach((function(e,t){var r=u+f.x,o=u+f.y+(t+1)*a;n.fillText(e,r,o)}))},e}(),um=function(e){void 0===e&&(e={});var t=e.boxColor,n=e.lineWidth,r=e.label,o=e.drawLabelOptions;this.boxColor=t||"rgba(0, 0, 255, 1)",this.lineWidth=n||2,this.label=r;var i={anchorPosition:nm.BOTTOM_LEFT,backgroundColor:this.boxColor};this.drawLabelOptions=new am(Object.assign({},i,o))};!function(){function e(e,t){void 0===t&&(t={}),this.box=new Nv(e),this.options=new um(t)}e.prototype.draw=function(e){var t=im(e),n=this.options,r=n.boxColor,o=n.lineWidth,i=this.box,a=i.x,s=i.y,u=i.width,l=i.height;t.strokeStyle=r,t.lineWidth=o,t.strokeRect(a,s,u,l);var c=this.options.label;c&&new sm([c],{x:a-o/2,y:s},this.options.drawLabelOptions).draw(e)}}();function lm(e){var t=rm.getEnv(),n=t.Image,r=t.Video;return e instanceof n&&e.complete||e instanceof r&&e.readyState>=3}function cm(e){var t=rm.getEnv(),n=t.Image,r=t.Video;return e instanceof n?new wv(e.naturalWidth,e.naturalHeight):e instanceof r?new wv(e.videoWidth,e.videoHeight):new wv(e.width,e.height)}function fm(e){var t=e.width,n=e.height,r=(0,rm.getEnv().createCanvasElement)();return r.width=t,r.height=n,r}function dm(e,t){var n=rm.getEnv().ImageData;if(!(e instanceof n)&&!lm(e))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=t||cm(e),o=r.width,i=r.height,a=fm({width:o,height:i});return e instanceof n?im(a).putImageData(e,0,0):im(a).drawImage(e,0,0,o,i),a}function pm(e,t){return yv(this,void 0,void 0,(function(){var n,r,o,i,a,s;return bv(this,(function(u){switch(u.label){case 0:return n=t||rm.getEnv().createCanvasElement(),r=e.shape.slice(Sv(e)?1:0),o=r[0],i=r[1],a=r[2],s=zo((function(){return e.as3D(o,i,a).toInt()})),[4,Zh.toPixels(s,n)];case 1:return u.sent(),s.dispose(),[2,n]}}))}))}function hm(e){var t=rm.getEnv(),n=t.Image,r=t.Canvas,o=t.Video;return e instanceof n||e instanceof r||e instanceof o}var vm=function(){function e(e,t){var n=this;if(void 0===t&&(t=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(e))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+e);this._treatAsBatchInput=t,this._batchSize=e.length,e.forEach((function(e,t){if(Ev(e))return n._imageTensors[t]=e,void(n._inputDimensions[t]=e.shape);if(Sv(e)){var r=e.shape[0];if(1!==r)throw new Error("NetInput - tf.Tensor4D with batchSize "+r+" passed, but not supported in input array");return n._imageTensors[t]=e,void(n._inputDimensions[t]=e.shape.slice(1))}var o=e instanceof rm.getEnv().Canvas?e:dm(e);n._canvases[t]=o,n._inputDimensions[t]=[o.height,o.width,3]}))}return Object.defineProperty(e.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reshapedInputDimensions",{get:function(){var e=this;return Iv(this.batchSize,0,1).map((function(t,n){return e.getReshapedInputDimensions(n)}))},enumerable:!0,configurable:!0}),e.prototype.getInput=function(e){return this.canvases[e]||this.imageTensors[e]},e.prototype.getInputDimensions=function(e){return this._inputDimensions[e]},e.prototype.getInputHeight=function(e){return this._inputDimensions[e][0]},e.prototype.getInputWidth=function(e){return this._inputDimensions[e][1]},e.prototype.getReshapedInputDimensions=function(e){if("number"!==typeof this.inputSize)throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");return function(e,t){var n=e.width,r=e.height,o=t/Math.max(r,n);return new wv(Math.round(n*o),Math.round(r*o))}({width:this.getInputWidth(e),height:this.getInputHeight(e)},this.inputSize)},e.prototype.toBatchTensor=function(e,t){var n=this;return void 0===t&&(t=!0),this._inputSize=e,zo((function(){var r=Iv(n.batchSize,0,1).map((function(r){var o=n.getInput(r);if(o instanceof vr){var i=Sv(o)?o:o.expandDims();return i=function(e,t){return void 0===t&&(t=!1),zo((function(){var n=e.shape.slice(1),r=n[0],o=n[1];if(r===o)return e;var i=Math.abs(r-o),a=Math.round(i*(t?.5:1)),s=r>o?2:1,u=function(t){var n=e.shape.slice();return n[s]=t,vi(n,0)},l=u(a),c=i-l.shape[s],f=[t&&c?u(c):null,e,l].filter((function(e){return!!e})).map((function(e){return e.toFloat()}));return bi(f,s)}))}(i,t),i.shape[1]===e&&i.shape[2]===e||(i=Mp.resizeBilinear(i,[e,e])),i.as3D(e,e,3)}if(o instanceof rm.getEnv().Canvas)return Zh.fromPixels(function(e,t,n){void 0===n&&(n=!1);var r=rm.getEnv(),o=r.Image,i=r.Canvas;if(!(e instanceof o||e instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var a=cm(e),s=t/Math.max(a.height,a.width),u=s*a.width,l=s*a.height,c=fm({width:t,height:t}),f=e instanceof i?e:dm(e),d=Math.abs(u-l)/2,p=n&&u<l?d:0,h=n&&l<u?d:0;return im(c).drawImage(f,p,h,u,l),c}(o,e,t));throw new Error("toBatchTensor - at batchIdx "+r+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+o)})),o=aa(r.map((function(e){return e.toFloat()}))).as4D(n.batchSize,e,e,3);return o}))},e}();function mm(e){return yv(this,void 0,void 0,(function(){var t,n,r;return bv(this,(function(o){switch(o.label){case 0:if(e instanceof vm)return[2,e];if(!(t=Array.isArray(e)?e:[e]).length)throw new Error("toNetInput - empty array passed as input");return n=function(t){return Array.isArray(e)?" at input index "+t+":":""},(r=t.map(om)).forEach((function(e,r){if(!hm(e)&&!Ev(e)&&!Sv(e)){if("string"===typeof t[r])throw new Error("toNetInput -"+n(r)+" string passed, but could not resolve HTMLElement for element id "+t[r]);throw new Error("toNetInput -"+n(r)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id")}if(Sv(e)){var o=e.shape[0];if(1!==o)throw new Error("toNetInput -"+n(r)+" tf.Tensor4D with batchSize "+o+" passed, but not supported in input array")}})),[4,Promise.all(r.map((function(e){return hm(e)&&(t=e,new Promise((function(e,n){if(t instanceof rm.getEnv().Canvas||lm(t))return e();function r(t){t.currentTarget&&(t.currentTarget.removeEventListener("load",r),t.currentTarget.removeEventListener("error",o),e(t))}function o(e){e.currentTarget&&(e.currentTarget.removeEventListener("load",r),e.currentTarget.removeEventListener("error",o),n(e))}t.addEventListener("load",r),t.addEventListener("error",o)})));var t})))];case 1:return o.sent(),[2,new vm(r,Array.isArray(e))]}}))}))}function gm(e,t){return yv(this,void 0,void 0,(function(){var n,r,o,i,a,s;return bv(this,(function(u){switch(u.label){case 0:return n=rm.getEnv().Canvas,r=e,e instanceof n?[3,5]:[4,mm(e)];case 1:if((o=u.sent()).batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return(i=o.getInput(0))instanceof n?(a=i,[3,4]):[3,2];case 2:return[4,pm(i)];case 3:a=u.sent(),u.label=4;case 4:r=a,u.label=5;case 5:return s=im(r),[2,t.map((function(e){return e instanceof Ov?e.forSize(r.width,r.height).box.floor():e})).map((function(e){return e.clipAtImageBorders(r.width,r.height)})).map((function(e){var t=e.x,n=e.y,r=e.width,o=e.height,i=fm({width:r,height:o});return im(i).putImageData(s.getImageData(t,n,r,o),0,0),i}))]}}))}))}function ym(e,t){return yv(this,void 0,void 0,(function(){return bv(this,(function(n){if(!Ev(e)&&!Sv(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Sv(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,zo((function(){var n=e.shape.slice(Sv(e)?1:0),r=n[0],o=n[1],i=n[2],a=t.map((function(e){return e instanceof Ov?e.forSize(o,r).box:e})).map((function(e){return e.clipAtImageBorders(o,r)})).map((function(t){var n=t.x,a=t.y,s=t.width,u=t.height;return Cd(e.as3D(r,o,i),[a,n,0],[u,s,i])}));return a}))]}))}))}function bm(e,t){return yv(this,void 0,void 0,(function(){var n;return bv(this,(function(r){switch(r.label){case 0:return[4,(0,rm.getEnv().fetch)(e,t)];case 1:if(!((n=r.sent()).status<400))throw new Error("failed to fetch: ("+n.status+") "+n.statusText+", from url: "+n.url);return[2,n]}}))}))}function xm(e){return yv(this,void 0,void 0,(function(){return bv(this,(function(t){switch(t.label){case 0:return[4,bm(e)];case 1:return[2,t.sent().json()]}}))}))}function wm(e,t){var n=t+"-weights_manifest.json";if(!e)return{modelBaseUri:"",manifestUri:n};if("/"===e)return{modelBaseUri:"/",manifestUri:"/"+n};var r=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"",o=(e=e.replace(r,"")).split("/").filter((function(e){return e})),i=e.endsWith(".json")?o[o.length-1]:n,a=r+(e.endsWith(".json")?o.slice(0,o.length-1):o).join("/");return{modelBaseUri:a=e.startsWith("/")?"/"+a:a,manifestUri:"/"===a?"/"+i:a+"/"+i}}function Cm(e,t){return yv(this,void 0,void 0,(function(){var n,r,o,i;return bv(this,(function(a){switch(a.label){case 0:return n=wm(e,t),r=n.manifestUri,o=n.modelBaseUri,[4,xm(r)];case 1:return i=a.sent(),[2,Yh.loadWeights(i,o)]}}))}))}var Em=function(){function e(e){this._name=e,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(e.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),e.prototype.getParamFromPath=function(e){var t=this.traversePropertyPath(e);return t.obj[t.objProp]},e.prototype.reassignParamFromPath=function(e,t){var n=this.traversePropertyPath(e),r=n.obj,o=n.objProp;r[o].dispose(),r[o]=t},e.prototype.getParamList=function(){var e=this;return this._paramMappings.map((function(t){var n=t.paramPath;return{path:n,tensor:e.getParamFromPath(n)}}))},e.prototype.getTrainableParams=function(){return this.getParamList().filter((function(e){return e.tensor instanceof Cr}))},e.prototype.getFrozenParams=function(){return this.getParamList().filter((function(e){return!(e.tensor instanceof Cr)}))},e.prototype.variable=function(){var e=this;this.getFrozenParams().forEach((function(t){var n=t.path,r=t.tensor;e.reassignParamFromPath(n,r.variable())}))},e.prototype.freeze=function(){var e=this;this.getTrainableParams().forEach((function(t){var n=t.path,r=t.tensor,o=ai(r.dataSync());r.dispose(),e.reassignParamFromPath(n,o)}))},e.prototype.dispose=function(e){void 0===e&&(e=!0),this.getParamList().forEach((function(t){if(e&&t.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+t.path);t.tensor.dispose()})),this._params=void 0},e.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map((function(e){var t=e.tensor;return Array.from(t.dataSync())})).reduce((function(e,t){return e.concat(t)})))},e.prototype.load=function(e){return yv(this,void 0,void 0,(function(){return bv(this,(function(t){switch(t.label){case 0:return e instanceof Float32Array?(this.extractWeights(e),[2]):[4,this.loadFromUri(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.loadFromUri=function(e){return yv(this,void 0,void 0,(function(){var t;return bv(this,(function(n){switch(n.label){case 0:if(e&&"string"!==typeof e)throw new Error(this._name+".loadFromUri - expected model uri");return[4,Cm(e,this.getDefaultModelName())];case 1:return t=n.sent(),this.loadFromWeightMap(t),[2]}}))}))},e.prototype.loadFromDisk=function(e){return yv(this,void 0,void 0,(function(){var t,n,r,o,i,a,s,u,l,c;return bv(this,(function(f){switch(f.label){case 0:if(e&&"string"!==typeof e)throw new Error(this._name+".loadFromDisk - expected model file path");return t=rm.getEnv().readFile,n=wm(e,this.getDefaultModelName()),r=n.manifestUri,o=n.modelBaseUri,i=function(e){return Promise.all(e.map((function(e){return t(e).then((function(e){return e.buffer}))})))},a=Yh.weightsLoaderFactory(i),l=(u=JSON).parse,[4,t(r)];case 1:return s=l.apply(u,[f.sent().toString()]),[4,a(s,o)];case 2:return c=f.sent(),this.loadFromWeightMap(c),[2]}}))}))},e.prototype.loadFromWeightMap=function(e){var t=this.extractParamsFromWeigthMap(e),n=t.paramMappings,r=t.params;this._paramMappings=n,this._params=r},e.prototype.extractWeights=function(e){var t=this.extractParams(e),n=t.paramMappings,r=t.params;this._paramMappings=n,this._params=r},e.prototype.traversePropertyPath=function(e){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var t=e.split("/").reduce((function(t,n){if(!t.nextObj.hasOwnProperty(n))throw new Error("traversePropertyPath - object does not have property "+n+", for path "+e);return{obj:t.nextObj,objProp:n,nextObj:t.nextObj[n]}}),{nextObj:this.params}),n=t.obj,r=t.objProp;if(!n||!r||!(n[r]instanceof vr))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+e);return{obj:n,objProp:r}},e}();function Sm(e,t,n){return zo((function(){var r=td(e,t.depthwise_filter,t.pointwise_filter,n,"same");return r=sf(r,t.bias)}))}function km(e,t,n){return void 0===n&&(n=!1),zo((function(){var r=zd(n?sf(Xf(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):Sm(e,t.conv0,[2,2])),o=Sm(r,t.conv1,[1,1]),i=Sm(zd(sf(r,o)),t.conv2,[1,1]);return zd(sf(r,sf(o,i)))}))}function _m(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),zo((function(){var o=zd(n?sf(Xf(e,t.conv0.filters,r?[2,2]:[1,1],"same"),t.conv0.bias):Sm(e,t.conv0,r?[2,2]:[1,1])),i=Sm(o,t.conv1,[1,1]),a=Sm(zd(sf(o,i)),t.conv2,[1,1]),s=Sm(zd(sf(o,sf(i,a))),t.conv3,[1,1]);return zd(sf(o,sf(i,sf(a,s))))}))}function Rm(e,t,n,r){return void 0===n&&(n="same"),void 0===r&&(r=!1),zo((function(){var o=sf(Xf(e,t.filters,[1,1],n),t.bias);return r?zd(o):o}))}function Im(e,t){Object.keys(e).forEach((function(n){t.some((function(e){return e.originalPath===n}))||e[n].dispose()}))}function Tm(e,t){return function(n,r,o,i){var a=di(e(n*r*o*o),[o,o,n,r]),s=li(e(r));return t.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:a,bias:s}}}function Am(e,t){return function(n,r,o){var i=ci(e(n*r),[n,r]),a=li(e(r));return t.push({paramPath:o+"/weights"},{paramPath:o+"/bias"}),{weights:i,bias:a}}}var Dm=function(e,t,n){this.depthwise_filter=e,this.pointwise_filter=t,this.bias=n};function Nm(e,t){return function(n,r,o){var i=di(e(9*n),[3,3,n,1]),a=di(e(n*r),[1,1,n,r]),s=li(e(r));return t.push({paramPath:o+"/depthwise_filter"},{paramPath:o+"/pointwise_filter"},{paramPath:o+"/bias"}),new Dm(i,a,s)}}function Pm(e){return function(t){var n=e(t+"/depthwise_filter",4),r=e(t+"/pointwise_filter",4),o=e(t+"/bias",1);return new Dm(n,r,o)}}function Mm(e,t){return function(n,r,o){var i=e[n];if(!Cv(i,r))throw new Error("expected weightMap["+n+"] to be a Tensor"+r+"D, instead have "+i);return t.push({originalPath:n,paramPath:o||n}),i}}function Om(e){var t=e;return{extractWeights:function(e){var n=t.slice(0,e);return t=t.slice(e),n},getRemainingWeights:function(){return t}}}function Fm(e,t){var n=Tm(e,t),r=Nm(e,t);function o(e,t,o,i){return void 0===i&&(i=!1),{conv0:i?n(e,t,3,o+"/conv0"):r(e,t,o+"/conv0"),conv1:r(t,t,o+"/conv1"),conv2:r(t,t,o+"/conv2")}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:function(e,t,n,i){void 0===i&&(i=!1);var a=o(e,t,n,i);return{conv0:a.conv0,conv1:a.conv1,conv2:a.conv2,conv3:r(t,t,n+"/conv3")}}}}function Lm(e){return function(t){return{filters:e(t+"/filters",4),bias:e(t+"/bias",1)}}}function Bm(e,t){var n=Mm(e,t),r=Lm(n),o=Pm(n);return{extractDenseBlock3Params:function(e,t){return void 0===t&&(t=!1),{conv0:t?r(e+"/conv0"):o(e+"/conv0"),conv1:o(e+"/conv1"),conv2:o(e+"/conv2")}},extractDenseBlock4Params:function(e,t){return void 0===t&&(t=!1),{conv0:t?r(e+"/conv0"):o(e+"/conv0"),conv1:o(e+"/conv1"),conv2:o(e+"/conv2"),conv3:o(e+"/conv3")}}}}var zm=function(e){function t(){return e.call(this,"FaceFeatureExtractor")||this}return mv(t,e),t.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("FaceFeatureExtractor - load model before inference");return zo((function(){var n=_m(Bv(e.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(ui(255)),t.dense0,!0);return n=_m(n,t.dense1),n=_m(n,t.dense2),n=_m(n,t.dense3),n=vd(n,[7,7],[2,2],"valid")}))},t.prototype.forward=function(e){return yv(this,void 0,void 0,(function(){var t;return bv(this,(function(n){switch(n.label){case 0:return t=this.forwardInput,[4,mm(e)];case 1:return[2,t.apply(this,[n.sent()])]}}))}))},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(e){return function(e){var t=[],n=Bm(e,t).extractDenseBlock4Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return Im(e,t),{params:r,paramMappings:t}}(e)},t.prototype.extractParams=function(e){return function(e){var t=[],n=Om(e),r=n.extractWeights,o=n.getRemainingWeights,i=Fm(r,t).extractDenseBlock4Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2"),l=i(128,256,"dense3");if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{dense0:a,dense1:s,dense2:u,dense3:l}}}(e)},t}(Em);function Wm(e,t){return zo((function(){return sf(od(e,t.weights),t.bias)}))}function Vm(e){var t={},n={};return Object.keys(e).forEach((function(r){(r.startsWith("fc")?n:t)[r]=e[r]})),{featureExtractorMap:t,classifierMap:n}}var Um=function(e){function t(t,n){var r=e.call(this,t)||this;return r._faceFeatureExtractor=n,r}return mv(t,e),Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var t=this,n=this.params;if(!n)throw new Error(this._name+" - load model before inference");return zo((function(){var r=e instanceof vm?t.faceFeatureExtractor.forwardInput(e):e;return Wm(r.as2D(r.shape[0],-1),n.fc)}))},t.prototype.dispose=function(t){void 0===t&&(t=!0),this.faceFeatureExtractor.dispose(t),e.prototype.dispose.call(this,t)},t.prototype.loadClassifierParams=function(e){var t=this.extractClassifierParams(e),n=t.params,r=t.paramMappings;this._params=n,this._paramMappings=r},t.prototype.extractClassifierParams=function(e){return function(e,t,n){var r=[],o=Om(e),i=o.extractWeights,a=o.getRemainingWeights,s=Am(i,r)(t,n,"fc");if(0!==a().length)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:r,params:{fc:s}}}(e,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(e){var t=Vm(e),n=t.featureExtractorMap,r=t.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(n),function(e){var t=[],n=Mm(e,t),r={fc:function(e){return{weights:n(e+"/weights",2),bias:n(e+"/bias",1)}}("fc")};return Im(e,t),{params:r,paramMappings:t}}(r)},t.prototype.extractParams=function(e){var t=this.getClassifierChannelsIn(),n=this.getClassifierChannelsOut(),r=n*t+n,o=e.slice(0,e.length-r),i=e.slice(e.length-r);return this.faceFeatureExtractor.extractWeights(o),this.extractClassifierParams(i)},t}(Em),jm=["neutral","happy","sad","angry","fearful","disgusted","surprised"],Hm=function(){function e(e){var t=this;if(7!==e.length)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+e.length);jm.forEach((function(n,r){t[n]=e[r]}))}return e.prototype.asSortedArray=function(){var e=this;return jm.map((function(t){return{expression:t,probability:e[t]}})).sort((function(e,t){return t.probability-e.probability}))},e}(),Gm=function(e){function t(t){return void 0===t&&(t=new zm),e.call(this,"FaceExpressionNet",t)||this}return mv(t,e),t.prototype.forwardInput=function(e){var t=this;return zo((function(){return Ia(t.runNet(e))}))},t.prototype.forward=function(e){return yv(this,void 0,void 0,(function(){var t;return bv(this,(function(n){switch(n.label){case 0:return t=this.forwardInput,[4,mm(e)];case 1:return[2,t.apply(this,[n.sent()])]}}))}))},t.prototype.predictExpressions=function(e){return yv(this,void 0,void 0,(function(){var t,n,r,o,i=this;return bv(this,(function(a){switch(a.label){case 0:return[4,mm(e)];case 1:return t=a.sent(),[4,this.forwardInput(t)];case 2:return n=a.sent(),[4,Promise.all(la(n).map((function(e){return yv(i,void 0,void 0,(function(){var t;return bv(this,(function(n){switch(n.label){case 0:return[4,e.data()];case 1:return t=n.sent(),e.dispose(),[2,t]}}))}))})))];case 3:return r=a.sent(),n.dispose(),o=r.map((function(e){return new Hm(e)})),[2,t.isBatchInput?o:o[0]]}}))}))},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t}(Um);function qm(e,t){var n={expressions:t};return Object.assign({},e,n)}function Km(e){return function(e){return e.detection instanceof Ov}(e)&&e.landmarks instanceof Uv&&e.unshiftedLandmarks instanceof Uv&&e.alignedRect instanceof Ov}function Xm(e,t){var n=e.detection.box,r=t.shiftBy(n.x,n.y),o=r.align(),i=e.detection.imageDims,a={landmarks:r,unshiftedLandmarks:t,alignedRect:new Ov(e.detection.score,o.rescale(i.reverse()),i)};return Object.assign({},e,a)}function $m(e,t,n){if(void 0===n&&(n=!1),e.beginPath(),t.slice(1).forEach((function(n,r){var o=n.x,i=n.y,a=t[r];e.moveTo(a.x,a.y),e.lineTo(o,i)})),n){var r=t[t.length-1],o=t[0];if(!r||!o)return;e.moveTo(r.x,r.y),e.lineTo(o.x,o.y)}e.stroke()}var Ym=function(e){void 0===e&&(e={});var t=e.drawLines,n=void 0===t||t,r=e.drawPoints,o=void 0===r||r,i=e.lineWidth,a=e.lineColor,s=e.pointSize,u=e.pointColor;this.drawLines=n,this.drawPoints=o,this.lineWidth=i||1,this.pointSize=s||2,this.lineColor=a||"rgba(0, 255, 255, 1)",this.pointColor=u||"rgba(255, 0, 255, 1)"};!function(){function e(e,t){void 0===t&&(t={}),this.faceLandmarks=e,this.options=new Ym(t)}e.prototype.draw=function(e){var t=im(e),n=this.options,r=n.drawLines,o=n.drawPoints,i=n.lineWidth,a=n.lineColor,s=n.pointSize,u=n.pointColor;if(r&&this.faceLandmarks instanceof Hv&&(t.strokeStyle=a,t.lineWidth=i,$m(t,this.faceLandmarks.getJawOutline()),$m(t,this.faceLandmarks.getLeftEyeBrow()),$m(t,this.faceLandmarks.getRightEyeBrow()),$m(t,this.faceLandmarks.getNose()),$m(t,this.faceLandmarks.getLeftEye(),!0),$m(t,this.faceLandmarks.getRightEye(),!0),$m(t,this.faceLandmarks.getMouth(),!0)),o){t.strokeStyle=u,t.fillStyle=u;this.faceLandmarks.positions.forEach((function(e){t.beginPath(),t.arc(e.x,e.y,s,0,2*Math.PI),t.fill()}))}}}();function Qm(e,t){var n=[],r=Om(e),o=r.extractWeights,i=r.getRemainingWeights,a=function(e,t){var n=Tm(e,t),r=Nm(e,t);return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:function(e,t,o){return{separable_conv0:r(e,t,o+"/separable_conv0"),separable_conv1:r(t,t,o+"/separable_conv1"),expansion_conv:n(e,t,1,o+"/expansion_conv")}},extractMainBlockParams:function(e,t){return{separable_conv0:r(e,e,t+"/separable_conv0"),separable_conv1:r(e,e,t+"/separable_conv1"),separable_conv2:r(e,e,t+"/separable_conv2")}}}}(o,n),s=a.extractConvParams,u=a.extractSeparableConvParams,l=a.extractReductionBlockParams,c=a.extractMainBlockParams,f={conv_in:s(3,32,3,"entry_flow/conv_in"),reduction_block_0:l(32,64,"entry_flow/reduction_block_0"),reduction_block_1:l(64,128,"entry_flow/reduction_block_1")},d={};Iv(t,0,1).forEach((function(e){d["main_block_"+e]=c(128,"middle_flow/main_block_"+e)}));var p={reduction_block:l(128,256,"exit_flow/reduction_block"),separable_conv:u(256,512,"exit_flow/separable_conv")};if(0!==i().length)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:n,params:{entry_flow:f,middle_flow:d,exit_flow:p}}}function Jm(e,t){var n=[],r=function(e,t){var n=Mm(e,t),r=Lm(n),o=Pm(n);return{extractConvParams:r,extractSeparableConvParams:o,extractReductionBlockParams:function(e){return{separable_conv0:o(e+"/separable_conv0"),separable_conv1:o(e+"/separable_conv1"),expansion_conv:r(e+"/expansion_conv")}},extractMainBlockParams:function(e){return{separable_conv0:o(e+"/separable_conv0"),separable_conv1:o(e+"/separable_conv1"),separable_conv2:o(e+"/separable_conv2")}}}}(e,n),o=r.extractConvParams,i=r.extractSeparableConvParams,a=r.extractReductionBlockParams,s=r.extractMainBlockParams,u={conv_in:o("entry_flow/conv_in"),reduction_block_0:a("entry_flow/reduction_block_0"),reduction_block_1:a("entry_flow/reduction_block_1")},l={};Iv(t,0,1).forEach((function(e){l["main_block_"+e]=s("middle_flow/main_block_"+e)}));var c={reduction_block:a("exit_flow/reduction_block"),separable_conv:i("exit_flow/separable_conv")};return Im(e,n),{params:{entry_flow:u,middle_flow:l,exit_flow:c},paramMappings:n}}function Zm(e,t,n){return sf(Xf(e,t.filters,n,"same"),t.bias)}function eg(e,t,n){void 0===n&&(n=!0);var r=n?zd(e):e;return r=Sm(r,t.separable_conv0,[1,1]),r=Sm(zd(r),t.separable_conv1,[1,1]),r=hd(r,[3,3],[2,2],"same"),r=sf(r,Zm(e,t.expansion_conv,[2,2]))}var tg,ng=function(e){function t(t){var n=e.call(this,"TinyXception")||this;return n._numMainBlocks=t,n}return mv(t,e),t.prototype.forwardInput=function(e){var t=this,n=this.params;if(!n)throw new Error("TinyXception - load model before inference");return zo((function(){var r=Bv(e.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(ui(256)),o=zd(Zm(r,n.entry_flow.conv_in,[2,2]));return o=eg(o,n.entry_flow.reduction_block_0,!1),o=eg(o,n.entry_flow.reduction_block_1),Iv(t._numMainBlocks,0,1).forEach((function(e){o=function(e,t){var n=Sm(zd(e),t.separable_conv0,[1,1]);return n=Sm(zd(n),t.separable_conv1,[1,1]),n=Sm(zd(n),t.separable_conv2,[1,1]),sf(n,e)}(o,n.middle_flow["main_block_"+e])})),o=eg(o,n.exit_flow.reduction_block),o=zd(Sm(o,n.exit_flow.separable_conv,[1,1]))}))},t.prototype.forward=function(e){return yv(this,void 0,void 0,(function(){var t;return bv(this,(function(n){switch(n.label){case 0:return t=this.forwardInput,[4,mm(e)];case 1:return[2,t.apply(this,[n.sent()])]}}))}))},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(e){return Jm(e,this._numMainBlocks)},t.prototype.extractParams=function(e){return Qm(e,this._numMainBlocks)},t}(Em);!function(e){e.FEMALE="female",e.MALE="male"}(tg||(tg={}));var rg=function(e){function t(t){void 0===t&&(t=new ng(2));var n=e.call(this,"AgeGenderNet")||this;return n._faceFeatureExtractor=t,n}return mv(t,e),Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var t=this,n=this.params;if(!n)throw new Error(this._name+" - load model before inference");return zo((function(){var r=e instanceof vm?t.faceFeatureExtractor.forwardInput(e):e,o=vd(r,[7,7],[2,2],"valid").as2D(r.shape[0],-1);return{age:Wm(o,n.fc.age).as1D(),gender:Wm(o,n.fc.gender)}}))},t.prototype.forwardInput=function(e){var t=this;return zo((function(){var n=t.runNet(e),r=n.age,o=n.gender;return{age:r,gender:Ia(o)}}))},t.prototype.forward=function(e){return yv(this,void 0,void 0,(function(){var t;return bv(this,(function(n){switch(n.label){case 0:return t=this.forwardInput,[4,mm(e)];case 1:return[2,t.apply(this,[n.sent()])]}}))}))},t.prototype.predictAgeAndGender=function(e){return yv(this,void 0,void 0,(function(){var t,n,r,o,i,a,s=this;return bv(this,(function(u){switch(u.label){case 0:return[4,mm(e)];case 1:return t=u.sent(),[4,this.forwardInput(t)];case 2:return n=u.sent(),r=la(n.age),o=la(n.gender),i=r.map((function(e,t){return{ageTensor:e,genderTensor:o[t]}})),[4,Promise.all(i.map((function(e){var t=e.ageTensor,n=e.genderTensor;return yv(s,void 0,void 0,(function(){var e,r,o,i,a;return bv(this,(function(s){switch(s.label){case 0:return[4,t.data()];case 1:return e=s.sent()[0],[4,n.data()];case 2:return r=s.sent()[0],i=(o=r>.5)?tg.MALE:tg.FEMALE,a=o?r:1-r,t.dispose(),n.dispose(),[2,{age:e,gender:i,genderProbability:a}]}}))}))})))];case 3:return a=u.sent(),n.age.dispose(),n.gender.dispose(),[2,t.isBatchInput?a:a[0]]}}))}))},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(t){void 0===t&&(t=!0),this.faceFeatureExtractor.dispose(t),e.prototype.dispose.call(this,t)},t.prototype.loadClassifierParams=function(e){var t=this.extractClassifierParams(e),n=t.params,r=t.paramMappings;this._params=n,this._paramMappings=r},t.prototype.extractClassifierParams=function(e){return function(e){var t=[],n=Om(e),r=n.extractWeights,o=n.getRemainingWeights,i=Am(r,t),a=i(512,1,"fc/age"),s=i(512,2,"fc/gender");if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{fc:{age:a,gender:s}}}}(e)},t.prototype.extractParamsFromWeigthMap=function(e){var t=Vm(e),n=t.featureExtractorMap,r=t.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(n),function(e){var t=[],n=Mm(e,t);function r(e){return{weights:n(e+"/weights",2),bias:n(e+"/bias",1)}}var o={fc:{age:r("fc/age"),gender:r("fc/gender")}};return Im(e,t),{params:o,paramMappings:t}}(r)},t.prototype.extractParams=function(e){var t=e.slice(0,e.length-1539),n=e.slice(e.length-1539);return this.faceFeatureExtractor.extractWeights(t),this.extractClassifierParams(n)},t}(Em),og=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mv(t,e),t.prototype.postProcess=function(e,t,n){var r=n.map((function(e){var n=e.width,r=e.height,o=t/Math.max(r,n);return{width:n*o,height:r*o}})),o=r.length;return zo((function(){var n=function(e,t){return aa([vi([68],e),vi([68],t)],1).as2D(1,136).as1D()},i=function(e,t){var n=r[e],o=n.width,i=n.height;return t(o,i)?Math.abs(o-i)/2:0},a=e.mul(vi([o,136],t)).sub(aa(Array.from(Array(o),(function(e,t){return n(function(e){return i(e,(function(e,t){return e<t}))}(t),function(e){return i(e,(function(e,t){return t<e}))}(t))})))).div(aa(Array.from(Array(o),(function(e,t){return n(r[t].width,r[t].height)}))));return a}))},t.prototype.forwardInput=function(e){var t=this;return zo((function(){var n=t.runNet(e);return t.postProcess(n,e.inputSize,e.inputDimensions.map((function(e){return{height:e[0],width:e[1]}})))}))},t.prototype.forward=function(e){return yv(this,void 0,void 0,(function(){var t;return bv(this,(function(n){switch(n.label){case 0:return t=this.forwardInput,[4,mm(e)];case 1:return[2,t.apply(this,[n.sent()])]}}))}))},t.prototype.detectLandmarks=function(e){return yv(this,void 0,void 0,(function(){var t,n,r,o=this;return bv(this,(function(i){switch(i.label){case 0:return[4,mm(e)];case 1:return t=i.sent(),n=zo((function(){return la(o.forwardInput(t))})),[4,Promise.all(n.map((function(e,n){return yv(o,void 0,void 0,(function(){var r,o,i,a,s;return bv(this,(function(u){switch(u.label){case 0:return i=(o=Array).from,[4,e.data()];case 1:return r=i.apply(o,[u.sent()]),a=r.filter((function(e,t){return kv(t)})),s=r.filter((function(e,t){return!kv(t)})),[2,new Hv(Array(68).fill(0).map((function(e,t){return new Dv(a[t],s[t])})),{height:t.getInputHeight(n),width:t.getInputWidth(n)})]}}))}))})))];case 2:return r=i.sent(),n.forEach((function(e){return e.dispose()})),[2,t.isBatchInput?r:r[0]]}}))}))},t.prototype.getClassifierChannelsOut=function(){return 136},t}(Um),ig=function(e){function t(t){return void 0===t&&(t=new zm),e.call(this,"FaceLandmark68Net",t)||this}return mv(t,e),t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t}(og);var ag=function(e){function t(){return e.call(this,"TinyFaceFeatureExtractor")||this}return mv(t,e),t.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("TinyFaceFeatureExtractor - load model before inference");return zo((function(){var n=km(Bv(e.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(ui(255)),t.dense0,!0);return n=km(n,t.dense1),n=km(n,t.dense2),n=vd(n,[14,14],[2,2],"valid")}))},t.prototype.forward=function(e){return yv(this,void 0,void 0,(function(){var t;return bv(this,(function(n){switch(n.label){case 0:return t=this.forwardInput,[4,mm(e)];case 1:return[2,t.apply(this,[n.sent()])]}}))}))},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(e){return function(e){var t=[],n=Bm(e,t).extractDenseBlock3Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return Im(e,t),{params:r,paramMappings:t}}(e)},t.prototype.extractParams=function(e){return function(e){var t=[],n=Om(e),r=n.extractWeights,o=n.getRemainingWeights,i=Fm(r,t).extractDenseBlock3Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2");if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{dense0:a,dense1:s,dense2:u}}}(e)},t}(Em),sg=function(e){function t(t){return void 0===t&&(t=new ag),e.call(this,"FaceLandmark68TinyNet",t)||this}return mv(t,e),t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t}(og);!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}mv(t,e)}(ig);function ug(e,t,n,r,o){void 0===o&&(o="same");var i=t.conv,a=i.filters,s=i.bias,u=Xf(e,a,n,o);return u=function(e,t){return sf(wf(e,t.weights),t.biases)}(u=sf(u,s),t.scale),r?zd(u):u}function lg(e,t){return ug(e,t,[1,1],!1)}function cg(e,t){return ug(e,t,[2,2],!0,"valid")}function fg(e,t){function n(n,r,o,i){var a=function(t,n,r){var o=e(t),i=o.length/(n*r*r);if(i%1!==0)throw new Error("depth has to be an integer: "+i+", weights.length: "+o.length+", numFilters: "+n+", filterSize: "+r);return zo((function(){return Ud(di(o,[n,i,r,r]),[2,3,1,0])}))}(n,r,o),s=li(e(r));return t.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:a,bias:s}}function r(r,o,i,a){var s=n(r,o,i,a+"/conv"),u=function(n,r){var o=li(e(n)),i=li(e(n));return t.push({paramPath:r+"/weights"},{paramPath:r+"/biases"}),{weights:o,biases:i}}(o,a+"/scale");return{conv:s,scale:u}}return{extractConvLayerParams:r,extractResidualLayerParams:function(e,t,n,o,i){return void 0===i&&(i=!1),{conv1:r((i?.5:1)*e,t,n,o+"/conv1"),conv2:r(e,t,n,o+"/conv2")}}}}function dg(e,t){var n=Mm(e,t);function r(e){var t=n(e+"/conv/filters",4),r=n(e+"/conv/bias",1),o=function(e){return{weights:n(e+"/scale/weights",1),biases:n(e+"/scale/biases",1)}}(e);return{conv:{filters:t,bias:r},scale:o}}return{extractConvLayerParams:r,extractResidualLayerParams:function(e){return{conv1:r(e+"/conv1"),conv2:r(e+"/conv2")}}}}function pg(e){var t=[],n=dg(e,t),r=n.extractConvLayerParams,o=n.extractResidualLayerParams,i=r("conv32_down"),a=o("conv32_1"),s=o("conv32_2"),u=o("conv32_3"),l=o("conv64_down"),c=o("conv64_1"),f=o("conv64_2"),d=o("conv64_3"),p=o("conv128_down"),h=o("conv128_1"),v=o("conv128_2"),m=o("conv256_down"),g=o("conv256_1"),y=o("conv256_2"),b=o("conv256_down_out"),x=e.fc;if(t.push({originalPath:"fc",paramPath:"fc"}),!Cv(x,2))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+x);var w={conv32_down:i,conv32_1:a,conv32_2:s,conv32_3:u,conv64_down:l,conv64_1:c,conv64_2:f,conv64_3:d,conv128_down:p,conv128_1:h,conv128_2:v,conv256_down:m,conv256_1:g,conv256_2:y,conv256_down_out:b,fc:x};return Im(e,t),{params:w,paramMappings:t}}function hg(e,t){var n=function(e,t){return ug(e,t,[1,1],!0)}(e,t.conv1);return n=lg(n,t.conv2),n=sf(n,e),n=zd(n)}function vg(e,t){var n=cg(e,t.conv1);n=lg(n,t.conv2);var r=vd(e,2,2,"valid"),o=hi(r.shape),i=r.shape[3]!==n.shape[3];if(r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2]){var a=xv(n.shape);a[1]=1;var s=hi(a),u=xv((n=bi([n,s],1)).shape);u[2]=1;var l=hi(u);n=bi([n,l],2)}return r=i?bi([r,o],3):r,n=sf(r,n),n=zd(n)}var mg=function(e){function t(){return e.call(this,"FaceRecognitionNet")||this}return mv(t,e),t.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("FaceRecognitionNet - load model before inference");return zo((function(){var n=cg(Bv(e.toBatchTensor(150,!0).toFloat(),[122.782,117.001,104.298]).div(ui(256)),t.conv32_down);n=hg(n=hd(n,3,2,"valid"),t.conv32_1),n=hg(n,t.conv32_2),n=hg(n,t.conv32_3),n=hg(n=vg(n,t.conv64_down),t.conv64_1),n=hg(n,t.conv64_2),n=hg(n,t.conv64_3),n=hg(n=vg(n,t.conv128_down),t.conv128_1),n=hg(n,t.conv128_2),n=hg(n=vg(n,t.conv256_down),t.conv256_1);var r=(n=vg(n=hg(n,t.conv256_2),t.conv256_down_out)).mean([1,2]);return od(r,t.fc)}))},t.prototype.forward=function(e){return yv(this,void 0,void 0,(function(){var t;return bv(this,(function(n){switch(n.label){case 0:return t=this.forwardInput,[4,mm(e)];case 1:return[2,t.apply(this,[n.sent()])]}}))}))},t.prototype.computeFaceDescriptor=function(e){return yv(this,void 0,void 0,(function(){var t,n,r,o=this;return bv(this,(function(i){switch(i.label){case 0:return[4,mm(e)];case 1:return t=i.sent(),n=zo((function(){return la(o.forwardInput(t))})),[4,Promise.all(n.map((function(e){return e.data()})))];case 2:return r=i.sent(),n.forEach((function(e){return e.dispose()})),[2,t.isBatchInput?r:r[0]]}}))}))},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(e){return pg(e)},t.prototype.extractParams=function(e){return function(e){var t=Om(e),n=t.extractWeights,r=t.getRemainingWeights,o=[],i=fg(n,o),a=i.extractConvLayerParams,s=i.extractResidualLayerParams,u=a(4704,32,7,"conv32_down"),l=s(9216,32,3,"conv32_1"),c=s(9216,32,3,"conv32_2"),f=s(9216,32,3,"conv32_3"),d=s(36864,64,3,"conv64_down",!0),p=s(36864,64,3,"conv64_1"),h=s(36864,64,3,"conv64_2"),v=s(36864,64,3,"conv64_3"),m=s(147456,128,3,"conv128_down",!0),g=s(147456,128,3,"conv128_1"),y=s(147456,128,3,"conv128_2"),b=s(589824,256,3,"conv256_down",!0),x=s(589824,256,3,"conv256_1"),w=s(589824,256,3,"conv256_2"),C=s(589824,256,3,"conv256_down_out"),E=zo((function(){return Ud(ci(n(32768),[128,256]),[1,0])}));if(o.push({paramPath:"fc"}),0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{params:{conv32_down:u,conv32_1:l,conv32_2:c,conv32_3:f,conv64_down:d,conv64_1:p,conv64_2:h,conv64_3:v,conv128_down:m,conv128_1:g,conv128_2:y,conv256_down:b,conv256_1:x,conv256_2:w,conv256_down_out:C,fc:E},paramMappings:o}}(e)},t}(Em);function gg(e,t,n){var r={gender:t,genderProbability:n};return Object.assign({},e,r)}var yg=function(){function e(e){var t=void 0===e?{}:e,n=t.minFaceSize,r=t.scaleFactor,o=t.maxNumScales,i=t.scoreThresholds,a=t.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=n||20,this._scaleFactor=r||.709,this._maxNumScales=o||10,this._scoreThresholds=i||[.6,.7,.7],this._scaleSteps=a,"number"!==typeof this._minFaceSize||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if("number"!==typeof this._scaleFactor||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if("number"!==typeof this._maxNumScales||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||3!==this._scoreThresholds.length||this._scoreThresholds.some((function(e){return"number"!==typeof e})))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some((function(e){return"number"!==typeof e}))))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(e.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),e}();function bg(e,t){function n(n,r,o,i,a){var s=di(e(n*r*o*o),[o,o,n,r]),u=li(e(r));return t.push({paramPath:i+"/filters"},{paramPath:i+"/"+(a?"batch_norm_offset":"bias")}),{filters:s,bias:u}}function r(e,t,r,o){var i=n(e,t,r,o,!0);return{filters:i.filters,batch_norm_offset:i.bias}}function o(n,o,i){var a=function(n,r){var o=di(e(9*n),[3,3,n,1]),i=li(e(n)),a=li(e(n)),s=li(e(n)),u=li(e(n));return t.push({paramPath:r+"/filters"},{paramPath:r+"/batch_norm_scale"},{paramPath:r+"/batch_norm_offset"},{paramPath:r+"/batch_norm_mean"},{paramPath:r+"/batch_norm_variance"}),{filters:o,batch_norm_scale:i,batch_norm_offset:a,batch_norm_mean:s,batch_norm_variance:u}}(n,i+"/depthwise_conv");return{depthwise_conv:a,pointwise_conv:r(n,o,1,i+"/pointwise_conv")}}return{extractMobilenetV1Params:function(){return{conv_0:r(3,32,3,"mobilenetv1/conv_0"),conv_1:o(32,64,"mobilenetv1/conv_1"),conv_2:o(64,128,"mobilenetv1/conv_2"),conv_3:o(128,128,"mobilenetv1/conv_3"),conv_4:o(128,256,"mobilenetv1/conv_4"),conv_5:o(256,256,"mobilenetv1/conv_5"),conv_6:o(256,512,"mobilenetv1/conv_6"),conv_7:o(512,512,"mobilenetv1/conv_7"),conv_8:o(512,512,"mobilenetv1/conv_8"),conv_9:o(512,512,"mobilenetv1/conv_9"),conv_10:o(512,512,"mobilenetv1/conv_10"),conv_11:o(512,512,"mobilenetv1/conv_11"),conv_12:o(512,1024,"mobilenetv1/conv_12"),conv_13:o(1024,1024,"mobilenetv1/conv_13")}},extractPredictionLayerParams:function(){return{conv_0:r(1024,256,1,"prediction_layer/conv_0"),conv_1:r(256,512,3,"prediction_layer/conv_1"),conv_2:r(512,128,1,"prediction_layer/conv_2"),conv_3:r(128,256,3,"prediction_layer/conv_3"),conv_4:r(256,128,1,"prediction_layer/conv_4"),conv_5:r(128,256,3,"prediction_layer/conv_5"),conv_6:r(256,64,1,"prediction_layer/conv_6"),conv_7:r(64,128,3,"prediction_layer/conv_7"),box_predictor_0:{box_encoding_predictor:n(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),class_predictor:n(512,9,1,"prediction_layer/box_predictor_0/class_predictor")},box_predictor_1:{box_encoding_predictor:n(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),class_predictor:n(1024,18,1,"prediction_layer/box_predictor_1/class_predictor")},box_predictor_2:{box_encoding_predictor:n(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),class_predictor:n(512,18,1,"prediction_layer/box_predictor_2/class_predictor")},box_predictor_3:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_3/class_predictor")},box_predictor_4:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_4/class_predictor")},box_predictor_5:{box_encoding_predictor:n(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),class_predictor:n(128,18,1,"prediction_layer/box_predictor_5/class_predictor")}}}}}function xg(e){var t=[],n=function(e,t){var n=Mm(e,t);function r(e,t,r){return{filters:n(e+"/Conv2d_"+t+"_pointwise/weights",4,r+"/filters"),batch_norm_offset:n(e+"/Conv2d_"+t+"_pointwise/convolution_bn_offset",1,r+"/batch_norm_offset")}}function o(e){var t="mobilenetv1/conv_"+e,o="MobilenetV1/Conv2d_"+e+"_depthwise",i=t+"/depthwise_conv",a=t+"/pointwise_conv";return{depthwise_conv:{filters:n(o+"/depthwise_weights",4,i+"/filters"),batch_norm_scale:n(o+"/BatchNorm/gamma",1,i+"/batch_norm_scale"),batch_norm_offset:n(o+"/BatchNorm/beta",1,i+"/batch_norm_offset"),batch_norm_mean:n(o+"/BatchNorm/moving_mean",1,i+"/batch_norm_mean"),batch_norm_variance:n(o+"/BatchNorm/moving_variance",1,i+"/batch_norm_variance")},pointwise_conv:r("MobilenetV1",e,a)}}function i(e,t){return{filters:n(e+"/weights",4,t+"/filters"),bias:n(e+"/biases",1,t+"/bias")}}function a(e){return{box_encoding_predictor:i("Prediction/BoxPredictor_"+e+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+e+"/box_encoding_predictor"),class_predictor:i("Prediction/BoxPredictor_"+e+"/ClassPredictor","prediction_layer/box_predictor_"+e+"/class_predictor")}}return{extractMobilenetV1Params:function(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:o(1),conv_2:o(2),conv_3:o(3),conv_4:o(4),conv_5:o(5),conv_6:o(6),conv_7:o(7),conv_8:o(8),conv_9:o(9),conv_10:o(10),conv_11:o(11),conv_12:o(12),conv_13:o(13)}},extractPredictionLayerParams:function(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:a(0),box_predictor_1:a(1),box_predictor_2:a(2),box_predictor_3:a(3),box_predictor_4:a(4),box_predictor_5:a(5)}}}}(e,t),r=n.extractMobilenetV1Params,o=n.extractPredictionLayerParams,i=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!Ev(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var a={mobilenetv1:r(),prediction_layer:o(),output_layer:{extra_dim:i}};return Im(e,t),{params:a,paramMappings:t}}function wg(e,t,n){return zo((function(){var r=Xf(e,t.filters,n,"same");return r=sf(r,t.batch_norm_offset),hc(r,0,6)}))}function Cg(e,t){return zo((function(){var n=null,r=wg(e,t.conv_0,[2,2]);if([t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13].forEach((function(e,t){var o=t+1,i=function(e){return[2,4,6,12].some((function(t){return t===e}))?[2,2]:[1,1]}(o);r=function(e,t,n){return zo((function(){var r=Jf(e,t.filters,n,"same");return r=Yc(r,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,.0010000000474974513),hc(r,0,6)}))}(r,e.depthwise_conv,i),r=wg(r,e.pointwise_conv,[1,1]),11===o&&(n=r)})),null===n)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}}))}function Eg(e,t,n){var r=e.arraySync(),o=Math.min(r[t][0],r[t][2]),i=Math.min(r[t][1],r[t][3]),a=Math.max(r[t][0],r[t][2]),s=Math.max(r[t][1],r[t][3]),u=Math.min(r[n][0],r[n][2]),l=Math.min(r[n][1],r[n][3]),c=Math.max(r[n][0],r[n][2]),f=Math.max(r[n][1],r[n][3]),d=(a-o)*(s-i),p=(c-u)*(f-l);if(d<=0||p<=0)return 0;var h=Math.max(o,u),v=Math.max(i,l),m=Math.min(a,c),g=Math.min(s,f),y=Math.max(m-h,0)*Math.max(g-v,0);return y/(d+p-y)}function Sg(e,t){var n=function(e){var t=la(Ud(e,[1,0])),n=[_f(t[2],t[0]),_f(t[3],t[1])];return{sizes:n,centers:[sf(t[0],ff(n[0],ui(2))),sf(t[1],ff(n[1],ui(2)))]}}(e),r=n.sizes,o=n.centers,i=la(Ud(t,[1,0])),a=ff(wf(yc(ff(i[2],ui(5))),r[0]),ui(2)),s=sf(wf(ff(i[0],ui(10)),r[0]),o[0]),u=ff(wf(yc(ff(i[3],ui(5))),r[1]),ui(2)),l=sf(wf(ff(i[1],ui(10)),r[1]),o[1]);return Ud(aa([_f(s,a),_f(l,u),sf(s,a),sf(l,u)]),[1,0])}function kg(e,t){return zo((function(){var n=e.shape[0];return{boxPredictionEncoding:ra(Rm(e,t.box_encoding_predictor),[n,-1,1,4]),classPrediction:ra(Rm(e,t.class_predictor),[n,-1,3])}}))}var _g=function(){function e(e){var t=void 0===e?{}:e,n=t.minConfidence,r=t.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=n||.5,this._maxResults=r||100,"number"!==typeof this._minConfidence||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if("number"!==typeof this._maxResults)throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(e.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),e}(),Rg=function(e){function t(){return e.call(this,"SsdMobilenetv1")||this}return mv(t,e),t.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("SsdMobilenetv1 - load model before inference");return zo((function(){var n=e.toBatchTensor(512,!1).toFloat(),r=Cg(_f(wf(n,ui(.007843137718737125)),ui(1)),t.mobilenetv1),o=function(e,t,n){return zo((function(){var r=wg(e,n.conv_0,[1,1]),o=wg(r,n.conv_1,[2,2]),i=wg(o,n.conv_2,[1,1]),a=wg(i,n.conv_3,[2,2]),s=wg(a,n.conv_4,[1,1]),u=wg(s,n.conv_5,[2,2]),l=wg(u,n.conv_6,[1,1]),c=wg(l,n.conv_7,[2,2]),f=kg(t,n.box_predictor_0),d=kg(e,n.box_predictor_1),p=kg(o,n.box_predictor_2),h=kg(a,n.box_predictor_3),v=kg(u,n.box_predictor_4),m=kg(c,n.box_predictor_5);return{boxPredictions:bi([f.boxPredictionEncoding,d.boxPredictionEncoding,p.boxPredictionEncoding,h.boxPredictionEncoding,v.boxPredictionEncoding,m.boxPredictionEncoding],1),classPredictions:bi([f.classPrediction,d.classPrediction,p.classPrediction,h.classPrediction,v.classPrediction,m.classPrediction],1)}}))}(r.out,r.conv11,t.prediction_layer);return function(e,t,n){return zo((function(){var r=e.shape[0],o=Sg(ra(sa(n.extra_dim,[r,1,1]),[-1,4]),ra(e,[-1,4]));o=ra(o,[r,o.shape[0]/r,4]);var i=Ic(bd(t,[0,0,1],[-1,-1,-1])),a=bd(i,[0,0,0],[-1,-1,1]);return a=ra(a,[r,a.shape[1]]),{boxes:la(o),scores:la(a)}}))}(o.boxPredictions,o.classPredictions,t.output_layer)}))},t.prototype.forward=function(e){return yv(this,void 0,void 0,(function(){var t;return bv(this,(function(n){switch(n.label){case 0:return t=this.forwardInput,[4,mm(e)];case 1:return[2,t.apply(this,[n.sent()])]}}))}))},t.prototype.locateFaces=function(e,t){return void 0===t&&(t={}),yv(this,void 0,void 0,(function(){var n,r,o,i,a,s,u,l,c,f,d,p,h,v,m,g,y,b,x,w;return bv(this,(function(C){switch(C.label){case 0:return n=new _g(t),r=n.maxResults,o=n.minConfidence,[4,mm(e)];case 1:for(i=C.sent(),a=this.forwardInput(i),s=a.boxes,u=a.scores,l=s[0],c=u[0],f=1;f<s.length;f++)s[f].dispose(),u[f].dispose();return h=(p=Array).from,[4,c.data()];case 2:return d=h.apply(p,[C.sent()]),.5,v=function(e,t,n,r,o){var i=e.shape[0],a=Math.min(n,i),s=t.map((function(e,t){return{score:e,boxIndex:t}})).filter((function(e){return e.score>o})).sort((function(e,t){return t.score-e.score})),u=function(e){return e<=r?1:0},l=[];return s.forEach((function(t){if(!(l.length>=a)){for(var n=t.score,r=l.length-1;r>=0;--r){var i=Eg(e,t.boxIndex,l[r]);if(0!==i&&(t.score*=u(i),t.score<=o))break}n===t.score&&l.push(t.boxIndex)}})),l}(l,d,r,.5,o),m=i.getReshapedInputDimensions(0),g=i.inputSize,y=g/m.width,b=g/m.height,x=l.arraySync(),w=v.map((function(e){var t=[Math.max(0,x[e][0]),Math.min(1,x[e][2])].map((function(e){return e*b})),n=t[0],r=t[1],o=[Math.max(0,x[e][1]),Math.min(1,x[e][3])].map((function(e){return e*y})),a=o[0],s=o[1];return new Ov(d[e],new Vv(a,n,s-a,r-n),{height:i.getInputHeight(0),width:i.getInputWidth(0)})})),l.dispose(),c.dispose(),[2,w]}}))}))},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(e){return xg(e)},t.prototype.extractParams=function(e){return function(e){var t=[],n=Om(e),r=n.extractWeights,o=n.getRemainingWeights,i=bg(r,t),a=i.extractMobilenetV1Params,s=i.extractPredictionLayerParams,u=a(),l=s(),c={extra_dim:fi(r(20472),[1,5118,4])};if(t.push({paramPath:"output_layer/extra_dim"}),0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{params:{mobilenetv1:u,prediction_layer:l,output_layer:c},paramMappings:t}}(e)},t}(Em);!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}mv(t,e)}(Rg);var Ig,Tg=[new Dv(.738768,.874946),new Dv(2.42204,2.65704),new Dv(4.30971,7.04493),new Dv(10.246,4.59428),new Dv(12.6868,11.8741)],Ag=[new Dv(1.603231,2.094468),new Dv(6.041143,7.080126),new Dv(2.882459,3.518061),new Dv(4.266906,5.178857),new Dv(9.041765,10.66308)],Dg=[117.001,114.697,97.404],Ng=function(e){return"number"===typeof e};function Pg(e){return zo((function(){var t=wf(e,ui(.10000000149011612));return sf(zd(_f(e,t)),t)}))}function Mg(e,t){return zo((function(){var n=Xi(e,[[0,0],[1,1],[1,1],[0,0]]);return n=Xf(n,t.conv.filters,[1,1],"valid"),n=_f(n,t.bn.sub),n=wf(n,t.bn.truediv),Pg(n=sf(n,t.conv.bias))}))}function Og(e,t){return zo((function(){var n=Xi(e,[[0,0],[1,1],[1,1],[0,0]]);return n=td(n,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),Pg(n=sf(n,t.bias))}))}function Fg(e,t){var n=Tm(e,t);var r=Nm(e,t);return{extractConvParams:n,extractConvWithBatchNormParams:function(r,o,i){var a=n(r,o,3,i+"/conv"),s=function(n,r){var o=li(e(n)),i=li(e(n));return t.push({paramPath:r+"/sub"},{paramPath:r+"/truediv"}),{sub:o,truediv:i}}(o,i+"/bn");return{conv:a,bn:s}},extractSeparableConvParams:r}}function Lg(e,t){var n=Mm(e,t);function r(e){return{filters:n(e+"/filters",4),bias:n(e+"/bias",1)}}return{extractConvParams:r,extractConvWithBatchNormParams:function(e){var t=r(e+"/conv"),o=function(e){return{sub:n(e+"/sub",1),truediv:n(e+"/truediv",1)}}(e+"/bn");return{conv:t,bn:o}},extractSeparableConvParams:Pm(n)}}!function(e){e[e.XS=224]="XS",e[e.SM=320]="SM",e[e.MD=416]="MD",e[e.LG=608]="LG"}(Ig||(Ig={}));var Bg=function(){function e(e){var t=void 0===e?{}:e,n=t.inputSize,r=t.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=n||416,this._scoreThreshold=r||.5,"number"!==typeof this._inputSize||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if("number"!==typeof this._scoreThreshold||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),e}(),zg=function(e){function t(t){var n=e.call(this,"TinyYolov2")||this;return function(e){if(!e)throw new Error("invalid config: "+e);if("boolean"!==typeof e.withSeparableConvs)throw new Error("config.withSeparableConvs has to be a boolean, have: "+e.withSeparableConvs);if(!Ng(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+e.iouThreshold);if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every((function(e){return"string"===typeof e})))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(e.classes));if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map((function(e){return e||{}})).every((function(e){return Ng(e.x)&&Ng(e.y)})))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(e.anchors));if(e.meanRgb&&(!Array.isArray(e.meanRgb)||3!==e.meanRgb.length||!e.meanRgb.every(Ng)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(e.meanRgb))}(t),n._config=t,n}return mv(t,e),Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(e,t){var n=Mg(e,t.conv0);return n=Mg(n=hd(n,[2,2],[2,2],"same"),t.conv1),n=Mg(n=hd(n,[2,2],[2,2],"same"),t.conv2),n=Mg(n=hd(n,[2,2],[2,2],"same"),t.conv3),n=Mg(n=hd(n,[2,2],[2,2],"same"),t.conv4),n=Mg(n=hd(n,[2,2],[2,2],"same"),t.conv5),n=Mg(n=hd(n,[2,2],[1,1],"same"),t.conv6),Rm(n=Mg(n,t.conv7),t.conv8,"valid",!1)},t.prototype.runMobilenet=function(e,t){var n=this.config.isFirstLayerConv2d?Pg(Rm(e,t.conv0,"valid",!1)):Og(e,t.conv0);return n=Og(n=hd(n,[2,2],[2,2],"same"),t.conv1),n=Og(n=hd(n,[2,2],[2,2],"same"),t.conv2),n=Og(n=hd(n,[2,2],[2,2],"same"),t.conv3),n=Og(n=hd(n,[2,2],[2,2],"same"),t.conv4),n=Og(n=hd(n,[2,2],[2,2],"same"),t.conv5),n=hd(n,[2,2],[1,1],"same"),n=t.conv6?Og(n,t.conv6):n,Rm(n=t.conv7?Og(n,t.conv7):n,t.conv8,"valid",!1)},t.prototype.forwardInput=function(e,t){var n=this,r=this.params;if(!r)throw new Error("TinyYolov2 - load model before inference");return zo((function(){var o=e.toBatchTensor(t,!1).toFloat();return o=(o=n.config.meanRgb?Bv(o,n.config.meanRgb):o).div(ui(256)),n.config.withSeparableConvs?n.runMobilenet(o,r):n.runTinyYolov2(o,r)}))},t.prototype.forward=function(e,t){return yv(this,void 0,void 0,(function(){var n;return bv(this,(function(r){switch(r.label){case 0:return n=this.forwardInput,[4,mm(e)];case 1:return[4,n.apply(this,[r.sent(),t])];case 2:return[2,r.sent()]}}))}))},t.prototype.detect=function(e,t){return void 0===t&&(t={}),yv(this,void 0,void 0,(function(){var n,r,o,i,a,s,u,l,c,f,d,p,h,v=this;return bv(this,(function(m){switch(m.label){case 0:return n=new Bg(t),r=n.inputSize,o=n.scoreThreshold,[4,mm(e)];case 1:return i=m.sent(),[4,this.forwardInput(i,r)];case 2:return a=m.sent(),s=zo((function(){return la(a)[0].expandDims()})),u={width:i.getInputWidth(0),height:i.getInputHeight(0)},[4,this.extractBoxes(s,i.getReshapedInputDimensions(0),o)];case 3:return l=m.sent(),a.dispose(),s.dispose(),c=l.map((function(e){return e.box})),f=l.map((function(e){return e.score})),d=l.map((function(e){return e.classScore})),p=l.map((function(e){return v.config.classes[e.label]})),h=Lv(c.map((function(e){return e.rescale(r)})),f,this.config.iouThreshold,!0),[2,h.map((function(e){return new Mv(f[e],d[e],p[e],c[e],u)}))]}}))}))},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(e){return function(e,t){var n,r=[],o=Lg(e,r),i=o.extractConvParams,a=o.extractConvWithBatchNormParams,s=o.extractSeparableConvParams;if(t.withSeparableConvs){var u=t.filterSizes&&t.filterSizes.length||9;n={conv0:t.isFirstLayerConv2d?i("conv0"):s("conv0"),conv1:s("conv1"),conv2:s("conv2"),conv3:s("conv3"),conv4:s("conv4"),conv5:s("conv5"),conv6:u>7?s("conv6"):void 0,conv7:u>8?s("conv7"):void 0,conv8:i("conv8")}}else n={conv0:a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:a("conv6"),conv7:a("conv7"),conv8:i("conv8")};return Im(e,r),{params:n,paramMappings:r}}(e,this.config)},t.prototype.extractParams=function(e){var n=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,r=n?n.length:void 0;if(7!==r&&8!==r&&9!==r)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+r+" filterSizes in config");return function(e,t,n,r){var o,i=Om(e),a=i.extractWeights,s=i.getRemainingWeights,u=[],l=Fg(a,u),c=l.extractConvParams,f=l.extractConvWithBatchNormParams,d=l.extractSeparableConvParams;if(t.withSeparableConvs){var p=r[0],h=r[1],v=r[2],m=r[3],g=r[4],y=r[5],b=r[6],x=r[7],w=r[8];o={conv0:t.isFirstLayerConv2d?c(p,h,3,"conv0"):d(p,h,"conv0"),conv1:d(h,v,"conv1"),conv2:d(v,m,"conv2"),conv3:d(m,g,"conv3"),conv4:d(g,y,"conv4"),conv5:d(y,b,"conv5"),conv6:x?d(b,x,"conv6"):void 0,conv7:w?d(x,w,"conv7"):void 0,conv8:c(w||x||b,5*n,1,"conv8")}}else p=r[0],h=r[1],v=r[2],m=r[3],g=r[4],y=r[5],b=r[6],x=r[7],w=r[8],o={conv0:f(p,h,"conv0"),conv1:f(h,v,"conv1"),conv2:f(v,m,"conv2"),conv3:f(m,g,"conv3"),conv4:f(g,y,"conv4"),conv5:f(y,b,"conv5"),conv6:f(b,x,"conv6"),conv7:f(x,w,"conv7"),conv8:c(w,5*n,1,"conv8")};if(0!==s().length)throw new Error("weights remaing after extract: "+s().length);return{params:o,paramMappings:u}}(e,this.config,this.boxEncodingSize,n)},t.prototype.extractBoxes=function(e,t,n){return yv(this,void 0,void 0,(function(){var r,o,i,a,s,u,l,c,f,d,p,h,v,m,g,y,b,x,w,C,E,S,k,_,R,I,T,A,D,N=this;return bv(this,(function(P){switch(P.label){case 0:return r=t.width,o=t.height,i=Math.max(r,o),a=i/r,s=i/o,u=e.shape[1],l=this.config.anchors.length,c=zo((function(){var t=e.reshape([u,u,l,N.boxEncodingSize]);return[t.slice([0,0,0,0],[u,u,l,4]),t.slice([0,0,0,4],[u,u,l,1]),N.withClassScores?Ia(t.slice([0,0,0,5],[u,u,l,N.config.classes.length]),3):ui(0)]})),f=c[0],d=c[1],p=c[2],h=[],[4,d.array()];case 1:return v=P.sent(),[4,f.array()];case 2:m=P.sent(),g=0,P.label=3;case 3:if(!(g<u))return[3,12];y=0,P.label=4;case 4:if(!(y<u))return[3,11];b=0,P.label=5;case 5:return b<l?(x=zv(v[g][y][b][0]),!n||x>n?(w=(y+zv(m[g][y][b][0]))/u*a,C=(g+zv(m[g][y][b][1]))/u*s,E=Math.exp(m[g][y][b][2])*this.config.anchors[b].x/u*a,S=Math.exp(m[g][y][b][3])*this.config.anchors[b].y/u*s,k=w-E/2,_=C-S/2,R={row:g,col:y,anchor:b},this.withClassScores?[4,this.extractPredictedClass(p,R)]:[3,7]):[3,9]):[3,10];case 6:return D=P.sent(),[3,8];case 7:D={classScore:1,label:0},P.label=8;case 8:T=(I=D).classScore,A=I.label,h.push(gv({box:new Pv(k,_,k+E,_+S),score:x,classScore:x*T,label:A},R)),P.label=9;case 9:return b++,[3,5];case 10:return y++,[3,4];case 11:return g++,[3,3];case 12:return f.dispose(),d.dispose(),p.dispose(),[2,h]}}))}))},t.prototype.extractPredictedClass=function(e,t){return yv(this,void 0,void 0,(function(){var n,r,o,i;return bv(this,(function(a){switch(a.label){case 0:return n=t.row,r=t.col,o=t.anchor,[4,e.array()];case 1:return i=a.sent(),[2,Array(this.config.classes.length).fill(0).map((function(e,t){return i[n][r][o][t]})).map((function(e,t){return{classScore:e,label:t}})).reduce((function(e,t){return e.classScore>t.classScore?e:t}))]}}))}))},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t}(Em),Wg=function(e){function t(t){void 0===t&&(t=!0);var n=Object.assign({},{withSeparableConvs:t,iouThreshold:.4,classes:["face"]},t?{anchors:Ag,meanRgb:Dg}:{anchors:Tg,withClassScores:!0});return e.call(this,n)||this}return mv(t,e),Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,t){return yv(this,void 0,void 0,(function(){return bv(this,(function(n){switch(n.label){case 0:return[4,this.detect(e,t)];case 1:return[2,n.sent().map((function(e){return new Ov(e.score,e.relativeBox,{width:e.imageWidth,height:e.imageHeight})}))]}}))}))},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?"tiny_yolov2_separable_conv_model":"tiny_yolov2_model"},t.prototype.extractParamsFromWeigthMap=function(t){return e.prototype.extractParamsFromWeigthMap.call(this,t)},t}(zg);var Vg=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._name="TinyFaceDetectorOptions",t}return mv(t,e),t}(Bg),Ug=function(){function e(){}return e.prototype.then=function(e){return yv(this,void 0,void 0,(function(){var t;return bv(this,(function(n){switch(n.label){case 0:return t=e,[4,this.run()];case 1:return[2,t.apply(void 0,[n.sent()])]}}))}))},e.prototype.run=function(){return yv(this,void 0,void 0,(function(){return bv(this,(function(e){throw new Error("ComposableTask - run is not implemented")}))}))},e}();function jg(e,t){var n={descriptor:t};return Object.assign({},e,n)}function Hg(e,t,n,r,o){return void 0===o&&(o=function(e){return e.alignedRect}),yv(this,void 0,void 0,(function(){var i,a,s,u,l;return bv(this,(function(c){switch(c.label){case 0:return i=e.map((function(e){return Km(e)?o(e):e.detection})),(s=r)?[3,5]:t instanceof vr?[4,ym(t,i)]:[3,2];case 1:return u=c.sent(),[3,4];case 2:return[4,gm(t,i)];case 3:u=c.sent(),c.label=4;case 4:s=u,c.label=5;case 5:return[4,n(a=s)];case 6:return l=c.sent(),a.forEach((function(e){return e instanceof vr&&e.dispose()})),[2,l]}}))}))}function Gg(e,t,n,r,o){return yv(this,void 0,void 0,(function(){var i=this;return bv(this,(function(a){return[2,Hg([e],t,(function(e){return yv(i,void 0,void 0,(function(){return bv(this,(function(t){return[2,n(e[0])]}))}))}),r,o)]}))}))}function qg(e){var t=Om(e),n=t.extractWeights,r=t.getRemainingWeights,o=[],i=function(e,t){var n=Tm(e,t),r=Am(e,t);function o(n,r){var o=li(e(n));return t.push({paramPath:r}),o}function i(e,t,r){return void 0===r&&(r=!1),{conv1:n(e[0],e[1],3,t+"/conv1"),prelu1_alpha:o(e[1],t+"/prelu1_alpha"),conv2:n(e[1],e[2],3,t+"/conv2"),prelu2_alpha:o(e[2],t+"/prelu2_alpha"),conv3:n(e[2],e[3],r?2:3,t+"/conv3"),prelu3_alpha:o(e[3],t+"/prelu3_alpha")}}return{extractPNetParams:function(){var e=i([3,10,16,32],"pnet"),t=n(32,2,1,"pnet/conv4_1"),r=n(32,4,1,"pnet/conv4_2");return gv(gv({},e),{conv4_1:t,conv4_2:r})},extractRNetParams:function(){var e=i([3,28,48,64],"rnet",!0),t=r(576,128,"rnet/fc1"),n=o(128,"rnet/prelu4_alpha"),a=r(128,2,"rnet/fc2_1"),s=r(128,4,"rnet/fc2_2");return gv(gv({},e),{fc1:t,prelu4_alpha:n,fc2_1:a,fc2_2:s})},extractONetParams:function(){var e=i([3,32,64,64],"onet"),t=n(64,128,2,"onet/conv4"),a=o(128,"onet/prelu4_alpha"),s=r(1152,256,"onet/fc1"),u=o(256,"onet/prelu5_alpha"),l=r(256,2,"onet/fc2_1"),c=r(256,4,"onet/fc2_2"),f=r(256,10,"onet/fc2_3");return gv(gv({},e),{conv4:t,prelu4_alpha:a,fc1:s,prelu5_alpha:u,fc2_1:l,fc2_2:c,fc2_3:f})}}}(n,o),a=i.extractPNetParams,s=i.extractRNetParams,u=i.extractONetParams,l=a(),c=s(),f=u();if(0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:l,rnet:c,onet:f},paramMappings:o}}function Kg(e){var t=[],n=function(e,t){var n=Mm(e,t);function r(e){return{filters:n(e+"/weights",4,e+"/filters"),bias:n(e+"/bias",1)}}function o(e){return{weights:n(e+"/weights",2),bias:n(e+"/bias",1)}}function i(e){return n(e,1)}function a(e){return{conv1:r(e+"/conv1"),prelu1_alpha:i(e+"/prelu1_alpha"),conv2:r(e+"/conv2"),prelu2_alpha:i(e+"/prelu2_alpha"),conv3:r(e+"/conv3"),prelu3_alpha:i(e+"/prelu3_alpha")}}return{extractPNetParams:function(){var e=a("pnet"),t=r("pnet/conv4_1"),n=r("pnet/conv4_2");return gv(gv({},e),{conv4_1:t,conv4_2:n})},extractRNetParams:function(){var e=a("rnet"),t=o("rnet/fc1"),n=i("rnet/prelu4_alpha"),r=o("rnet/fc2_1"),s=o("rnet/fc2_2");return gv(gv({},e),{fc1:t,prelu4_alpha:n,fc2_1:r,fc2_2:s})},extractONetParams:function(){var e=a("onet"),t=r("onet/conv4"),n=i("onet/prelu4_alpha"),s=o("onet/fc1"),u=i("onet/prelu5_alpha"),l=o("onet/fc2_1"),c=o("onet/fc2_2"),f=o("onet/fc2_3");return gv(gv({},e),{conv4:t,prelu4_alpha:n,fc1:s,prelu5_alpha:u,fc2_1:l,fc2_2:c,fc2_3:f})}}}(e,t),r=n.extractPNetParams,o=n.extractRNetParams,i=n.extractONetParams,a=r(),s=o(),u=i();return Im(e,t),{params:{pnet:a,rnet:s,onet:u},paramMappings:t}}function Xg(e,t){var n=t[0],r=t[1];return{height:Math.floor(n*e),width:Math.floor(r*e)}}var $g=function(e){function t(t,n,r,o){return e.call(this,{left:t,top:n,right:r,bottom:o},!0)||this}return mv(t,e),t}(Nv);function Yg(e){return zo((function(){return wf(_f(e,ui(127.5)),ui(.0078125))}))}function Qg(e,t){return zo((function(){return sf(zd(e),wf(t,Sc(zd(Sc(e)))))}))}function Jg(e,t,n){return void 0===n&&(n=!1),zo((function(){var r=Rm(e,t.conv1,"valid");return r=Qg(r,t.prelu1_alpha),r=Qg(r=Rm(r=hd(r,n?[2,2]:[3,3],[2,2],"same"),t.conv2,"valid"),t.prelu2_alpha),r=Qg(r=Rm(r=n?r:hd(r,[3,3],[2,2],"valid"),t.conv3,"valid"),t.prelu3_alpha)}))}function Zg(e,t,n,r,o){o.stage1=[];var i=t.map((function(t){return zo((function(){var n={scale:t},o=function(e,t){return zo((function(){var n=Xg(t,e.shape.slice(1)),r=n.height,o=n.width,i=Yg(Mp.resizeBilinear(e,[r,o]));return Ud(i,[0,2,1,3])}))}(e,t),i=Date.now(),a=function(e,t){return zo((function(){var n=Jg(e,t,!0),r=Rm(n,t.conv4_1,"valid"),o=Hi(Ad(r,3),3);return{prob:Ia(_f(r,o),3),regions:Rm(n,t.conv4_2,"valid")}}))}(o,r),s=a.prob,u=a.regions;return n.pnet=Date.now()-i,{scoresTensor:la(la(s,3)[1])[0],regionsTensor:la(u)[0],scale:t,statsForScale:n}}))})),a=i.map((function(e){var t=e.scoresTensor,r=e.regionsTensor,i=e.scale,a=e.statsForScale,s=function(e,t,n,r){for(var o=[],i=e.arraySync(),a=0;a<e.shape[0];a++)for(var s=0;s<e.shape[1];s++)i[a][s]>=r&&o.push(new Dv(s,a));return o.map((function(e){var r=new Pv(Math.round((2*e.y+1)/n),Math.round((2*e.x+1)/n),Math.round((2*e.y+12)/n),Math.round((2*e.x+12)/n)),o=i[e.y][e.x],a=t.arraySync();return{cell:r,score:o,region:new $g(a[e.y][e.x][0],a[e.y][e.x][1],a[e.y][e.x][2],a[e.y][e.x][3])}}))}(t,r,i,n);if(t.dispose(),r.dispose(),!s.length)return o.stage1.push(a),[];var u=Date.now(),l=Lv(s.map((function(e){return e.cell})),s.map((function(e){return e.score})),.5);return a.nms=Date.now()-u,a.numBoxes=l.length,o.stage1.push(a),l.map((function(e){return s[e]}))})),s=a.reduce((function(e,t){return e.concat(t)}),[]),u=[],l=[];if(s.length>0){var c=Date.now(),f=Lv(s.map((function(e){return e.cell})),s.map((function(e){return e.score})),.7);o.stage1_nms=Date.now()-c,l=f.map((function(e){return s[e].score})),u=f.map((function(e){return s[e]})).map((function(e){var t=e.cell,n=e.region;return new Pv(t.left+n.left*t.width,t.top+n.top*t.height,t.right+n.right*t.width,t.bottom+n.bottom*t.height).toSquare().round()}))}return{boxes:u,scores:l}}function ey(e,t,n){var r=n.width,o=n.height;return yv(this,void 0,void 0,(function(){var n,i,a,s=this;return bv(this,(function(u){switch(u.label){case 0:return n=im(e),[4,Promise.all(t.map((function(t){return yv(s,void 0,void 0,(function(){var r,o,i,a,s,u,l,c;return bv(this,(function(f){return r=t.padAtBorders(e.height,e.width),o=r.y,i=r.ey,a=r.x,s=r.ex,u=a-1,l=o-1,c=n.getImageData(u,l,s-u,i-l),[2,rm.isNodejs()?dm(c):createImageBitmap(c)]}))}))})))];case 1:return i=u.sent(),a=[],i.forEach((function(e){var t=im(fm({width:r,height:o}));t.drawImage(e,0,0,r,o);for(var n=t.getImageData(0,0,r,o).data,i=[],s=0;s<n.length;s+=4)i.push(n[s+2]),i.push(n[s+1]),i.push(n[s]);a.push(i)})),[2,a.map((function(e){return zo((function(){return Yg(Ud(di(e,[1,r,o,3]),[0,2,1,3]).toFloat())}))}))]}}))}))}function ty(e,t,n,r,o){return yv(this,void 0,void 0,(function(){var i,a,s,u,l,c,f,d,p,h,v,m,g,y;return bv(this,(function(b){switch(b.label){case 0:return i=Date.now(),[4,ey(e,t,{width:24,height:24})];case 1:return a=b.sent(),o.stage2_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map((function(e){var t=function(e,t){return zo((function(){var n=Jg(e,t),r=Qg(Wm(ra(n,[n.shape[0],t.fc1.weights.shape[0]]),t.fc1),t.prelu4_alpha),o=Wm(r,t.fc2_1),i=Hi(Ad(o,1),1),a=Ia(_f(o,i),1),s=Wm(r,t.fc2_2);return{scores:la(a,1)[1],regions:s}}))}(e,r);return e.dispose(),t})),o.stage2_rnet=Date.now()-i,u=s.length>1?bi(s.map((function(e){return e.scores}))):s[0].scores,f=(c=Array).from,[4,u.data()];case 2:return l=f.apply(c,[b.sent()]),u.dispose(),d=l.map((function(e,t){return{score:e,idx:t}})).filter((function(e){return e.score>n})).map((function(e){return e.idx})),p=d.map((function(e){return t[e]})),h=d.map((function(e){return l[e]})),v=[],m=[],p.length>0&&(i=Date.now(),g=Lv(p,h,.7),o.stage2_nms=Date.now()-i,y=g.map((function(e){var t=s[d[e]].regions.arraySync();return new $g(t[0][0],t[0][1],t[0][2],t[0][3])})),m=g.map((function(e){return h[e]})),v=g.map((function(e,t){return p[e].calibrate(y[t])}))),s.forEach((function(e){e.regions.dispose(),e.scores.dispose()})),[2,{boxes:v,scores:m}]}}))}))}function ny(e,t,n,r,o){return yv(this,void 0,void 0,(function(){var i,a,s,u,l,c,f,d,p,h,v,m,g,y,b;return bv(this,(function(x){switch(x.label){case 0:return i=Date.now(),[4,ey(e,t,{width:48,height:48})];case 1:return a=x.sent(),o.stage3_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map((function(e){var t=function(e,t){return zo((function(){var n=Jg(e,t);n=Qg(n=Rm(n=hd(n,[2,2],[2,2],"same"),t.conv4,"valid"),t.prelu4_alpha);var r=Qg(Wm(ra(n,[n.shape[0],t.fc1.weights.shape[0]]),t.fc1),t.prelu5_alpha),o=Wm(r,t.fc2_1),i=Hi(Ad(o,1),1),a=Ia(_f(o,i),1),s=Wm(r,t.fc2_2),u=Wm(r,t.fc2_3);return{scores:la(a,1)[1],regions:s,points:u}}))}(e,r);return e.dispose(),t})),o.stage3_onet=Date.now()-i,u=s.length>1?bi(s.map((function(e){return e.scores}))):s[0].scores,f=(c=Array).from,[4,u.data()];case 2:return l=f.apply(c,[x.sent()]),u.dispose(),d=l.map((function(e,t){return{score:e,idx:t}})).filter((function(e){return e.score>n})).map((function(e){return e.idx})),p=d.map((function(e){var t=s[e].regions.arraySync();return new $g(t[0][0],t[0][1],t[0][2],t[0][3])})),h=d.map((function(e,n){return t[e].calibrate(p[n])})),v=d.map((function(e){return l[e]})),m=[],g=[],y=[],h.length>0&&(i=Date.now(),b=Lv(h,v,.7,!1),o.stage3_nms=Date.now()-i,m=b.map((function(e){return h[e]})),g=b.map((function(e){return v[e]})),y=b.map((function(e,t){return Array(5).fill(0).map((function(n,r){var o=s[e].points.arraySync();return new Dv(o[0][r]*(m[t].width+1)+m[t].left,o[0][r+5]*(m[t].height+1)+m[t].top)}))}))),s.forEach((function(e){e.regions.dispose(),e.scores.dispose(),e.points.dispose()})),[2,{boxes:m,scores:g,points:y}]}}))}))}var ry=function(e){function t(){return e.call(this,"Mtcnn")||this}return mv(t,e),t.prototype.load=function(t){return yv(this,void 0,void 0,(function(){return bv(this,(function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.load.call(this,t)]}))}))},t.prototype.loadFromDisk=function(t){return yv(this,void 0,void 0,(function(){return bv(this,(function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.loadFromDisk.call(this,t)]}))}))},t.prototype.forwardInput=function(e,t){return void 0===t&&(t={}),yv(this,void 0,void 0,(function(){var n,r,o,i,a,s,u,l,c,f,d,p,h,v,m,g,y,b,x,w,C;return bv(this,(function(E){switch(E.label){case 0:if(!(n=this.params))throw new Error("Mtcnn - load model before inference");if(!(r=e.canvases[0]))throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return o={},i=Date.now(),a=zo((function(){return e=Hi(Zh.fromPixels(r)).toFloat(),zo((function(){return aa(la(e,3).reverse(),3)}));var e})),s=function(e){return a.dispose(),o.total=Date.now()-i,e},u=a.shape.slice(1),l=u[0],c=u[1],f=new yg(t),d=f.minFaceSize,p=f.scaleFactor,h=f.maxNumScales,v=f.scoreThresholds,m=f.scaleSteps,g=(m||function(e,t,n){for(var r=n[0],o=n[1],i=12/e,a=[],s=Math.min(r,o)*i,u=0;s>=12;)a.push(i*Math.pow(t,u)),s*=t,u+=1;return a}(d,p,[l,c])).filter((function(e){var t=Xg(e,[l,c]);return Math.min(t.width,t.height)>12})).slice(0,h),o.scales=g,o.pyramid=g.map((function(e){return Xg(e,[l,c])})),y=Date.now(),[4,Zg(a,g,v[0],n.pnet,o)];case 1:return b=E.sent(),o.total_stage1=Date.now()-y,b.boxes.length?(o.stage2_numInputBoxes=b.boxes.length,y=Date.now(),[4,ty(r,b.boxes,v[1],n.rnet,o)]):[2,s({results:[],stats:o})];case 2:return x=E.sent(),o.total_stage2=Date.now()-y,x.boxes.length?(o.stage3_numInputBoxes=x.boxes.length,y=Date.now(),[4,ny(r,x.boxes,v[2],n.onet,o)]):[2,s({results:[],stats:o})];case 3:return w=E.sent(),o.total_stage3=Date.now()-y,C=w.boxes.map((function(e,t){return Xm(Xv({},new Ov(w.scores[t],new Vv(e.left/c,e.top/l,e.width/c,e.height/l),{height:l,width:c})),new jv(w.points[t].map((function(t){return t.sub(new Dv(e.left,e.top)).div(new Dv(e.width,e.height))})),{width:e.width,height:e.height}))})),[2,s({results:C,stats:o})]}}))}))},t.prototype.forward=function(e,t){return void 0===t&&(t={}),yv(this,void 0,void 0,(function(){var n;return bv(this,(function(r){switch(r.label){case 0:return n=this.forwardInput,[4,mm(e)];case 1:return[4,n.apply(this,[r.sent(),t])];case 2:return[2,r.sent().results]}}))}))},t.prototype.forwardWithStats=function(e,t){return void 0===t&&(t={}),yv(this,void 0,void 0,(function(){var n;return bv(this,(function(r){switch(r.label){case 0:return n=this.forwardInput,[4,mm(e)];case 1:return[2,n.apply(this,[r.sent(),t])]}}))}))},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(e){return Kg(e)},t.prototype.extractParams=function(e){return qg(e)},t}(Em),oy=[new Dv(1.603231,2.094468),new Dv(6.041143,7.080126),new Dv(2.882459,3.518061),new Dv(4.266906,5.178857),new Dv(9.041765,10.66308)],iy=[117.001,114.697,97.404],ay=function(e){function t(){var t={withSeparableConvs:!0,iouThreshold:.4,classes:["face"],anchors:oy,meanRgb:iy,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return e.call(this,t)||this}return mv(t,e),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,t){return yv(this,void 0,void 0,(function(){return bv(this,(function(n){switch(n.label){case 0:return[4,this.detect(e,t)];case 1:return[2,n.sent().map((function(e){return new Ov(e.score,e.relativeBox,{width:e.imageWidth,height:e.imageHeight})}))]}}))}))},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(t){return e.prototype.extractParamsFromWeigthMap.call(this,t)},t}(zg),sy={ssdMobilenetv1:new Rg,tinyFaceDetector:new ay,tinyYolov2:new Wg,mtcnn:new ry,faceLandmark68Net:new ig,faceLandmark68TinyNet:new sg,faceRecognitionNet:new mg,faceExpressionNet:new Gm,ageGenderNet:new rg},uy=function(e){return sy.ssdMobilenetv1.load(e)};function ly(e,t){var n={age:t};return Object.assign({},e,n)}var cy=function(e){function t(t,n,r){var o=e.call(this)||this;return o.parentTask=t,o.input=n,o.extractedFaces=r,o}return mv(t,e),t}(Ug),fy=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mv(t,e),t.prototype.run=function(){return yv(this,void 0,void 0,(function(){var e,t,n=this;return bv(this,(function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return[4,Hg(e=r.sent(),this.input,(function(e){return yv(n,void 0,void 0,(function(){return bv(this,(function(t){switch(t.label){case 0:return[4,Promise.all(e.map((function(e){return sy.faceExpressionNet.predictExpressions(e)})))];case 1:return[2,t.sent()]}}))}))}),this.extractedFaces)];case 2:return t=r.sent(),[2,e.map((function(e,n){return qm(e,t[n])}))]}}))}))},t.prototype.withAgeAndGender=function(){return new my(this,this.input)},t}(cy),dy=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mv(t,e),t.prototype.run=function(){return yv(this,void 0,void 0,(function(){var e,t;return bv(this,(function(n){switch(n.label){case 0:return[4,this.parentTask];case 1:return(e=n.sent())?[4,Gg(e,this.input,(function(e){return sy.faceExpressionNet.predictExpressions(e)}),this.extractedFaces)]:[2];case 2:return t=n.sent(),[2,qm(e,t)]}}))}))},t.prototype.withAgeAndGender=function(){return new gy(this,this.input)},t}(cy),py=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mv(t,e),t.prototype.withAgeAndGender=function(){return new yy(this,this.input)},t.prototype.withFaceDescriptors=function(){return new wy(this,this.input)},t}(fy),hy=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mv(t,e),t.prototype.withAgeAndGender=function(){return new by(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Cy(this,this.input)},t}(dy),vy=function(e){function t(t,n,r){var o=e.call(this)||this;return o.parentTask=t,o.input=n,o.extractedFaces=r,o}return mv(t,e),t}(Ug),my=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mv(t,e),t.prototype.run=function(){return yv(this,void 0,void 0,(function(){var e,t,n=this;return bv(this,(function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return[4,Hg(e=r.sent(),this.input,(function(e){return yv(n,void 0,void 0,(function(){return bv(this,(function(t){switch(t.label){case 0:return[4,Promise.all(e.map((function(e){return sy.ageGenderNet.predictAgeAndGender(e)})))];case 1:return[2,t.sent()]}}))}))}),this.extractedFaces)];case 2:return t=r.sent(),[2,e.map((function(e,n){var r=t[n],o=r.age;return ly(gg(e,r.gender,r.genderProbability),o)}))]}}))}))},t.prototype.withFaceExpressions=function(){return new fy(this,this.input)},t}(vy),gy=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mv(t,e),t.prototype.run=function(){return yv(this,void 0,void 0,(function(){var e,t,n,r,o;return bv(this,(function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return(e=i.sent())?[4,Gg(e,this.input,(function(e){return sy.ageGenderNet.predictAgeAndGender(e)}),this.extractedFaces)]:[2];case 2:return t=i.sent(),n=t.age,r=t.gender,o=t.genderProbability,[2,ly(gg(e,r,o),n)]}}))}))},t.prototype.withFaceExpressions=function(){return new dy(this,this.input)},t}(vy),yy=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mv(t,e),t.prototype.withFaceExpressions=function(){return new py(this,this.input)},t.prototype.withFaceDescriptors=function(){return new wy(this,this.input)},t}(my),by=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mv(t,e),t.prototype.withFaceExpressions=function(){return new hy(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Cy(this,this.input)},t}(gy),xy=function(e){function t(t,n){var r=e.call(this)||this;return r.parentTask=t,r.input=n,r}return mv(t,e),t}(Ug),wy=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mv(t,e),t.prototype.run=function(){return yv(this,void 0,void 0,(function(){var e;return bv(this,(function(t){switch(t.label){case 0:return[4,this.parentTask];case 1:return[4,Hg(e=t.sent(),this.input,(function(e){return Promise.all(e.map((function(e){return sy.faceRecognitionNet.computeFaceDescriptor(e)})))}),null,(function(e){return e.landmarks.align(null,{useDlibAlignment:!0})}))];case 2:return[2,t.sent().map((function(t,n){return jg(e[n],t)}))]}}))}))},t.prototype.withFaceExpressions=function(){return new py(this,this.input)},t.prototype.withAgeAndGender=function(){return new yy(this,this.input)},t}(xy),Cy=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mv(t,e),t.prototype.run=function(){return yv(this,void 0,void 0,(function(){var e,t;return bv(this,(function(n){switch(n.label){case 0:return[4,this.parentTask];case 1:return(e=n.sent())?[4,Gg(e,this.input,(function(e){return sy.faceRecognitionNet.computeFaceDescriptor(e)}),null,(function(e){return e.landmarks.align(null,{useDlibAlignment:!0})}))]:[2];case 2:return t=n.sent(),[2,jg(e,t)]}}))}))},t.prototype.withFaceExpressions=function(){return new hy(this,this.input)},t.prototype.withAgeAndGender=function(){return new by(this,this.input)},t}(xy),Ey=function(e){function t(t,n,r){var o=e.call(this)||this;return o.parentTask=t,o.input=n,o.useTinyLandmarkNet=r,o}return mv(t,e),Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?sy.faceLandmark68TinyNet:sy.faceLandmark68Net},enumerable:!0,configurable:!0}),t}(Ug),Sy=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mv(t,e),t.prototype.run=function(){return yv(this,void 0,void 0,(function(){var e,t,n,r,o,i=this;return bv(this,(function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return e=a.sent(),t=e.map((function(e){return e.detection})),this.input instanceof vr?[4,ym(this.input,t)]:[3,3];case 2:return r=a.sent(),[3,5];case 3:return[4,gm(this.input,t)];case 4:r=a.sent(),a.label=5;case 5:return n=r,[4,Promise.all(n.map((function(e){return i.landmarkNet.detectLandmarks(e)})))];case 6:return o=a.sent(),n.forEach((function(e){return e instanceof vr&&e.dispose()})),[2,e.map((function(e,t){return Xm(e,o[t])}))]}}))}))},t.prototype.withFaceExpressions=function(){return new py(this,this.input)},t.prototype.withAgeAndGender=function(){return new yy(this,this.input)},t.prototype.withFaceDescriptors=function(){return new wy(this,this.input)},t}(Ey),ky=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mv(t,e),t.prototype.run=function(){return yv(this,void 0,void 0,(function(){var e,t,n,r,o;return bv(this,(function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return(e=i.sent())?(t=e.detection,this.input instanceof vr?[4,ym(this.input,[t])]:[3,3]):[2];case 2:return r=i.sent(),[3,5];case 3:return[4,gm(this.input,[t])];case 4:r=i.sent(),i.label=5;case 5:return n=r,[4,this.landmarkNet.detectLandmarks(n[0])];case 6:return o=i.sent(),n.forEach((function(e){return e instanceof vr&&e.dispose()})),[2,Xm(e,o)]}}))}))},t.prototype.withFaceExpressions=function(){return new hy(this,this.input)},t.prototype.withAgeAndGender=function(){return new by(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Cy(this,this.input)},t}(Ey),_y=function(e){function t(t,n){void 0===n&&(n=new _g);var r=e.call(this)||this;return r.input=t,r.options=n,r}return mv(t,e),t}(Ug),Ry=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mv(t,e),t.prototype.run=function(){return yv(this,void 0,void 0,(function(){var e,t,n,r;return bv(this,(function(o){switch(o.label){case 0:return t=(e=this).input,(n=e.options)instanceof yg?[4,sy.mtcnn.forward(t,n)]:[3,2];case 1:return[2,o.sent().map((function(e){return e.detection}))];case 2:if(r=n instanceof Vg?function(e){return sy.tinyFaceDetector.locateFaces(e,n)}:n instanceof _g?function(e){return sy.ssdMobilenetv1.locateFaces(e,n)}:n instanceof Bg?function(e){return sy.tinyYolov2.locateFaces(e,n)}:null,!r)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,r(t)]}}))}))},t.prototype.runAndExtendWithFaceDetections=function(){var e=this;return new Promise((function(t){return yv(e,void 0,void 0,(function(){var e;return bv(this,(function(n){switch(n.label){case 0:return[4,this.run()];case 1:return e=n.sent(),[2,t(e.map((function(e){return Xv({},e)})))]}}))}))}))},t.prototype.withFaceLandmarks=function(e){return void 0===e&&(e=!1),new Sy(this.runAndExtendWithFaceDetections(),this.input,e)},t.prototype.withFaceExpressions=function(){return new fy(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new my(this.runAndExtendWithFaceDetections(),this.input)},t}(_y);!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}mv(t,e),t.prototype.run=function(){return yv(this,void 0,void 0,(function(){var e,t;return bv(this,(function(n){switch(n.label){case 0:return[4,new Ry(this.input,this.options)];case 1:return e=n.sent(),t=e[0],e.forEach((function(e){e.score>t.score&&(t=e)})),[2,t]}}))}))},t.prototype.runAndExtendWithFaceDetection=function(){var e=this;return new Promise((function(t){return yv(e,void 0,void 0,(function(){var e;return bv(this,(function(n){switch(n.label){case 0:return[4,this.run()];case 1:return e=n.sent(),[2,t(e?Xv({},e):void 0)]}}))}))}))},t.prototype.withFaceLandmarks=function(e){return void 0===e&&(e=!1),new ky(this.runAndExtendWithFaceDetection(),this.input,e)},t.prototype.withFaceExpressions=function(){return new dy(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new gy(this.runAndExtendWithFaceDetection(),this.input)}}(_y);!function(){function e(e,t){void 0===t&&(t=.6),this._distanceThreshold=t;var n=Array.isArray(e)?e:[e];if(!n.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var r=1,o=function(){return"person "+r++};this._labeledDescriptors=n.map((function(e){if(e instanceof Kv)return e;if(e instanceof Float32Array)return new Kv(o(),[e]);if(e.descriptor&&e.descriptor instanceof Float32Array)return new Kv(o(),[e.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")}))}Object.defineProperty(e.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),e.prototype.computeMeanDistance=function(e,t){return t.map((function(t){return function(e,t){if(e.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(e),r=Array.from(t);return Math.sqrt(n.map((function(e,t){return e-r[t]})).reduce((function(e,t){return e+Math.pow(t,2)}),0))}(t,e)})).reduce((function(e,t){return e+t}),0)/(t.length||1)},e.prototype.matchDescriptor=function(e){var t=this;return this.labeledDescriptors.map((function(n){var r=n.descriptors,o=n.label;return new Gv(o,t.computeMeanDistance(e,r))})).reduce((function(e,t){return e.distance<t.distance?e:t}))},e.prototype.findBestMatch=function(e){var t=this.matchDescriptor(e);return t.distance<this.distanceThreshold?t:new Gv("unknown",t.distance)},e.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map((function(e){return e.toJSON()}))}},e.fromJSON=function(t){var n=t.labeledDescriptors.map((function(e){return Kv.fromJSON(e)}));return new e(n,t.distanceThreshold)}}();function Iy(){return Iy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Iy.apply(this,arguments)}var Ty=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,Ay=me((function(e){return Ty.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91})),Dy=function(e){return"theme"!==e},Ny=function(e){return"string"===typeof e&&e.charCodeAt(0)>96?Ay:Dy},Py=function(e,t,n){var r;if(t){var o=t.shouldForwardProp;r=e.__emotion_forwardProp&&o?function(t){return e.__emotion_forwardProp(t)&&o(t)}:o}return"function"!==typeof r&&n&&(r=e.__emotion_forwardProp),r},My=function(e){var t=e.cache,n=e.serialized,r=e.isStringTag;de(t,n,r);Ie((function(){return pe(t,n,r)}));return null},Oy=function t(n,r){var o,i,a=n.__emotion_real===n,s=a&&n.__emotion_base||n;void 0!==r&&(o=r.label,i=r.target);var u=Py(n,r,a),l=u||Ny(s),c=!l("as");return function(){var f=arguments,d=a&&void 0!==n.__emotion_styles?n.__emotion_styles.slice(0):[];if(void 0!==o&&d.push("label:"+o+";"),null==f[0]||void 0===f[0].raw)d.push.apply(d,f);else{0,d.push(f[0][0]);for(var p=f.length,h=1;h<p;h++)d.push(f[h],f[0][h])}var v=Ne((function(t,n,r){var o=c&&t.as||s,a="",f=[],p=t;if(null==t.theme){for(var h in p={},t)p[h]=t[h];p.theme=(0,e.useContext)(Pe)}"string"===typeof t.className?a=fe(n.registered,f,t.className):null!=t.className&&(a=t.className+" ");var v=_e(d.concat(f),n.registered,p);a+=n.key+"-"+v.name,void 0!==i&&(a+=" "+i);var m=c&&void 0===u?Ny(o):l,g={};for(var y in t)c&&"as"===y||m(y)&&(g[y]=t[y]);return g.className=a,g.ref=r,(0,e.createElement)(e.Fragment,null,(0,e.createElement)(My,{cache:n,serialized:v,isStringTag:"string"===typeof o}),(0,e.createElement)(o,g))}));return v.displayName=void 0!==o?o:"Styled("+("string"===typeof s?s:s.displayName||s.name||"Component")+")",v.defaultProps=n.defaultProps,v.__emotion_real=v,v.__emotion_base=s,v.__emotion_styles=d,v.__emotion_forwardProp=u,Object.defineProperty(v,"toString",{value:function(){return"."+i}}),v.withComponent=function(e,n){return t(e,Iy({},r,n,{shouldForwardProp:Py(v,n,!0)})).apply(void 0,d)},v}},Fy=Oy.bind();["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){Fy[e]=Fy(e)}));var Ly=Fy;function By(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var zy=["__themeKey","__css","variant","css","sx","as"],Wy=["size"],Vy=["size","strokeWidth","max","title","duration"];function Uy(){return Uy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Uy.apply(this,arguments)}var jy=["margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","m","mt","mr","mb","ml","mx","my","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","p","pt","pr","pb","pl","px","py","color","backgroundColor","bg","opacity"],Hy=function(e){return jy.includes(e)},Gy=function(e){var t,n={},r=function(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=He(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(jy);try{for(r.s();!(t=r.n()).done;){var o=t.value;n[o]=e[o]}}catch(i){r.e(i)}finally{r.f()}return n},qy=(0,e.forwardRef)((function(t,n){var r=(0,e.useContext)(Pe),o=t.__themeKey,i=void 0===o?"variants":o,a=t.__css,s=t.variant,u=t.css,l=t.sx,c=t.as,f=void 0===c?"div":c,d=By(t,zy),p=ot(a)(r),h=Xe(r,"".concat(i,".").concat(s))||Xe(r,s),v=[{boxSizing:"border-box",margin:0,minWidth:0},p,h&&ot(h)(r),ot(l)(r),ot(Gy(d))(r),u];return jy.forEach((function(e){delete d[e]})),Be(f,Uy({ref:n,css:v},d))})),Ky=function(e){return function(t){var n={};for(var r in t)e(r||"")&&(n[r]=t[r]);return n}},Xy=/^m[trblxy]?$/;Ky((function(e){return Xy.test(e)})),Ky((function(e){return!Xy.test(e)}));var $y=e.forwardRef((function(t,n){return e.createElement(qy,Uy({ref:n,as:"h2",variant:"heading"},t,{__themeKey:"text",__css:{fontFamily:"heading",fontWeight:"heading",lineHeight:"heading"}}))})),Yy=e.forwardRef((function(t,n){var r=t.size,o=void 0===r?24:r,i=u({xmlns:"http://www.w3.org/2000/svg",width:o,height:o,viewBox:"0 0 24 24",fill:"currentcolor"},By(t,Wy));return e.createElement(qy,Uy({ref:n,as:"svg"},i))}));Yy.displayName="SVG";var Qy=function(){var e=We.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}({from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}}),Jy=e.forwardRef((function(t,n){var r=t.size,o=void 0===r?48:r,i=t.strokeWidth,a=void 0===i?4:i,s=(t.max,t.title),u=void 0===s?"Loading...":s,l=t.duration,c=void 0===l?500:l,f=By(t,Vy),d=16-a,p=2*d*Math.PI,h={cx:16,cy:16,r:d,strokeDasharray:p,strokeDashoffset:p-1/4*p},v={transformOrigin:"50% 50%",animationName:Qy.toString(),animationTimingFunction:"linear",animationDuration:c+"ms",animationIterationCount:"infinite"},m={strokeWidth:a,viewBox:"0 0 32 32",width:o,height:o,fill:"none",stroke:"currentColor",role:"img"};return e.createElement(qy,Uy({ref:n,as:"svg"},m,f,{__css:{color:"primary",overflow:"visible"}}),e.createElement("title",null,u),e.createElement("circle",{cx:16,cy:16,r:d,opacity:1/8}),e.createElement(qy,Uy({as:"circle"},h,{__css:v})))})),Zy=(Ky(Hy),Ky((function(e){return!Hy(e)})),n(184));var eb=function(e){var t=e.onClick;return(0,Zy.jsx)(Zy.Fragment,{children:(0,Zy.jsxs)(qy,{sx:{position:"fixed",top:0,left:0,background:"#000",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontSize:28,fontWeight:100,width:"100%",height:"100%",color:"#fff"},onClick:t,children:[(0,Zy.jsx)($y,{as:"h1",sx:{position:"absolute",top:"20%"},children:"Welcome to Teamz"}),(0,Zy.jsx)(Jy,{size:60,strokeWidth:2})]})})},tb=function(e,t){return tb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},tb(e,t)};function nb(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}tb(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var rb=function(){return rb=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},rb.apply(this,arguments)};function ob(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}Object.create;function ib(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(s){o={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function ab(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}Object.create;function sb(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}Object.create;Object.create;var ub=function(e,t,n){return Math.min(Math.max(n,e),t)},lb=.001;function cb(e){var t,n,r=e.duration,o=void 0===r?800:r,i=e.bounce,a=void 0===i?.25:i,s=e.velocity,u=void 0===s?0:s,l=e.mass,c=void 0===l?1:l,f=1-a;f=ub(.05,1,f),o=ub(.01,10,o/1e3),f<1?(t=function(e){var t=e*f,n=t*o,r=t-u,i=fb(e,f),a=Math.exp(-n);return lb-r/i*a},n=function(e){var n=e*f*o,r=n*u+u,i=Math.pow(f,2)*Math.pow(e,2)*o,a=Math.exp(-n),s=fb(Math.pow(e,2),f);return(-t(e)+lb>0?-1:1)*((r-i)*a)/s}):(t=function(e){return Math.exp(-e*o)*((e-u)*o+1)-.001},n=function(e){return Math.exp(-e*o)*(o*o*(u-e))});var d=function(e,t,n){for(var r=n,o=1;o<12;o++)r-=e(r)/t(r);return r}(t,n,5/o);if(o*=1e3,isNaN(d))return{stiffness:100,damping:10,duration:o};var p=Math.pow(d,2)*c;return{stiffness:p,damping:2*f*Math.sqrt(c*p),duration:o}}function fb(e,t){return e*Math.sqrt(1-t*t)}var db=["duration","bounce"],pb=["stiffness","damping","mass"];function hb(e,t){return t.some((function(t){return void 0!==e[t]}))}function vb(e){var t=e.from,n=void 0===t?0:t,r=e.to,o=void 0===r?1:r,i=e.restSpeed,a=void 0===i?2:i,s=e.restDelta,u=sb(e,["from","to","restSpeed","restDelta"]),l={done:!1,value:n},c=function(e){var t=Object.assign({velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1},e);if(!hb(e,pb)&&hb(e,db)){var n=cb(e);(t=Object.assign(Object.assign(Object.assign({},t),n),{velocity:0,mass:1})).isResolvedFromDuration=!0}return t}(u),f=c.stiffness,d=c.damping,p=c.mass,h=c.velocity,v=c.duration,m=c.isResolvedFromDuration,g=mb,y=mb;function b(){var e=h?-h/1e3:0,t=o-n,r=d/(2*Math.sqrt(f*p)),i=Math.sqrt(f/p)/1e3;if(void 0===s&&(s=Math.min(Math.abs(o-n)/100,.4)),r<1){var a=fb(i,r);g=function(n){var s=Math.exp(-r*i*n);return o-s*((e+r*i*t)/a*Math.sin(a*n)+t*Math.cos(a*n))},y=function(n){var o=Math.exp(-r*i*n);return r*i*o*(Math.sin(a*n)*(e+r*i*t)/a+t*Math.cos(a*n))-o*(Math.cos(a*n)*(e+r*i*t)-a*t*Math.sin(a*n))}}else if(1===r)g=function(n){return o-Math.exp(-i*n)*(t+(e+i*t)*n)};else{var u=i*Math.sqrt(r*r-1);g=function(n){var a=Math.exp(-r*i*n),s=Math.min(u*n,300);return o-a*((e+r*i*t)*Math.sinh(s)+u*t*Math.cosh(s))/u}}}return b(),{next:function(e){var t=g(e);if(m)l.done=e>=v;else{var n=1e3*y(e),r=Math.abs(n)<=a,i=Math.abs(o-t)<=s;l.done=r&&i}return l.value=l.done?o:t,l},flipTarget:function(){h=-h;var e=[o,n];n=e[0],o=e[1],b()}}}vb.needsInterpolation=function(e,t){return"string"===typeof e||"string"===typeof t};var mb=function(e){return 0},gb=function(e,t,n){var r=t-e;return 0===r?1:(n-e)/r},yb=function(e,t,n){return-n*e+n*t+e},bb=function(e,t){return function(n){return Math.max(Math.min(n,t),e)}},xb=function(e){return e%1?Number(e.toFixed(5)):e},wb=/(-)?([\d]*\.?[\d])+/g,Cb=/(#[0-9a-f]{6}|#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2,3}\s*\/*\s*[\d\.]+%?\))/gi,Eb=/^(#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2,3}\s*\/*\s*[\d\.]+%?\))$/i;function Sb(e){return"string"===typeof e}var kb={test:function(e){return"number"===typeof e},parse:parseFloat,transform:function(e){return e}},_b=Object.assign(Object.assign({},kb),{transform:bb(0,1)}),Rb=Object.assign(Object.assign({},kb),{default:1}),Ib=function(e,t){return function(n){return Boolean(Sb(n)&&Eb.test(n)&&n.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(n,t))}},Tb=function(e,t,n){return function(r){var o;if(!Sb(r))return r;var i=gt(r.match(wb),4),s=i[0],u=i[1],l=i[2],c=i[3];return a(o={},e,parseFloat(s)),a(o,t,parseFloat(u)),a(o,n,parseFloat(l)),a(o,"alpha",void 0!==c?parseFloat(c):1),o}},Ab=bb(0,255),Db=Object.assign(Object.assign({},kb),{transform:function(e){return Math.round(Ab(e))}}),Nb={test:Ib("rgb","red"),parse:Tb("red","green","blue"),transform:function(e){var t=e.red,n=e.green,r=e.blue,o=e.alpha,i=void 0===o?1:o;return"rgba("+Db.transform(t)+", "+Db.transform(n)+", "+Db.transform(r)+", "+xb(_b.transform(i))+")"}};var Pb={test:Ib("#"),parse:function(e){var t="",n="",r="",o="";return e.length>5?(t=e.substr(1,2),n=e.substr(3,2),r=e.substr(5,2),o=e.substr(7,2)):(t=e.substr(1,1),n=e.substr(2,1),r=e.substr(3,1),o=e.substr(4,1),t+=t,n+=n,r+=r,o+=o),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:o?parseInt(o,16)/255:1}},transform:Nb.transform},Mb=function(e){return{test:function(t){return Sb(t)&&t.endsWith(e)&&1===t.split(" ").length},parse:parseFloat,transform:function(t){return"".concat(t).concat(e)}}},Ob=Mb("deg"),Fb=Mb("%"),Lb=Mb("px"),Bb=Mb("vh"),zb=Mb("vw"),Wb=Object.assign(Object.assign({},Fb),{parse:function(e){return Fb.parse(e)/100},transform:function(e){return Fb.transform(100*e)}}),Vb={test:Ib("hsl","hue"),parse:Tb("hue","saturation","lightness"),transform:function(e){var t=e.hue,n=e.saturation,r=e.lightness,o=e.alpha,i=void 0===o?1:o;return"hsla("+Math.round(t)+", "+Fb.transform(xb(n))+", "+Fb.transform(xb(r))+", "+xb(_b.transform(i))+")"}};function Ub(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function jb(e){var t=e.hue,n=e.saturation,r=e.lightness,o=e.alpha;t/=360,r/=100;var i=0,a=0,s=0;if(n/=100){var u=r<.5?r*(1+n):r+n-r*n,l=2*r-u;i=Ub(l,u,t+1/3),a=Ub(l,u,t),s=Ub(l,u,t-1/3)}else i=a=s=r;return{red:Math.round(255*i),green:Math.round(255*a),blue:Math.round(255*s),alpha:o}}var Hb=function(e,t,n){var r=e*e,o=t*t;return Math.sqrt(Math.max(0,n*(o-r)+r))},Gb=[Pb,Nb,Vb],qb=function(e){return Gb.find((function(t){return t.test(e)}))},Kb=function(e){return"'".concat(e,"' is not an animatable color. Use the equivalent color code instead.")},Xb=function(e,t){var n=qb(e),r=qb(t);Kb(e),Kb(t);var o=n.parse(e),i=r.parse(t);n===Vb&&(o=jb(o),n=Nb),r===Vb&&(i=jb(i),r=Nb);var a=Object.assign({},o);return function(e){for(var t in a)"alpha"!==t&&(a[t]=Hb(o[t],i[t],e));return a.alpha=yb(o.alpha,i.alpha,e),n.transform(a)}},$b={test:function(e){return Nb.test(e)||Pb.test(e)||Vb.test(e)},parse:function(e){return Nb.test(e)?Nb.parse(e):Vb.test(e)?Vb.parse(e):Pb.parse(e)},transform:function(e){return Sb(e)?e:e.hasOwnProperty("red")?Nb.transform(e):Vb.transform(e)}},Yb="${c}",Qb="${n}";function Jb(e){"number"===typeof e&&(e="".concat(e));var t=[],n=0,r=e.match(Cb);r&&(n=r.length,e=e.replace(Cb,Yb),t.push.apply(t,Ge(r.map($b.parse))));var o=e.match(wb);return o&&(e=e.replace(wb,Qb),t.push.apply(t,Ge(o.map(kb.parse)))),{values:t,numColors:n,tokenised:e}}function Zb(e){return Jb(e).values}function ex(e){var t=Jb(e),n=t.values,r=t.numColors,o=t.tokenised,i=n.length;return function(e){for(var t=o,n=0;n<i;n++)t=t.replace(n<r?Yb:Qb,n<r?$b.transform(e[n]):xb(e[n]));return t}}var tx=function(e){return"number"===typeof e?0:e};var nx={test:function(e){var t,n,r,o;return isNaN(e)&&Sb(e)&&(null!==(n=null===(t=e.match(wb))||void 0===t?void 0:t.length)&&void 0!==n?n:0)+(null!==(o=null===(r=e.match(Cb))||void 0===r?void 0:r.length)&&void 0!==o?o:0)>0},parse:Zb,createTransformer:ex,getAnimatableNone:function(e){var t=Zb(e);return ex(e)(t.map(tx))}},rx=function(e){return"number"===typeof e},ox=function(e,t){return function(n){return t(e(n))}},ix=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(ox)};function ax(e,t){return rx(e)?function(n){return yb(e,t,n)}:$b.test(e)?Xb(e,t):cx(e,t)}var sx=function(e,t){var n=Ge(e),r=n.length,o=e.map((function(e,n){return ax(e,t[n])}));return function(e){for(var t=0;t<r;t++)n[t]=o[t](e);return n}},ux=function(e,t){var n=Object.assign(Object.assign({},e),t),r={};for(var o in n)void 0!==e[o]&&void 0!==t[o]&&(r[o]=ax(e[o],t[o]));return function(e){for(var t in r)n[t]=r[t](e);return n}};function lx(e){for(var t=nx.parse(e),n=t.length,r=0,o=0,i=0,a=0;a<n;a++)r||"number"===typeof t[a]?r++:void 0!==t[a].hue?i++:o++;return{parsed:t,numNumbers:r,numRGB:o,numHSL:i}}var cx=function(e,t){var n=nx.createTransformer(t),r=lx(e),o=lx(t);return r.numHSL===o.numHSL&&r.numRGB===o.numRGB&&r.numNumbers>=o.numNumbers?ix(sx(r.parsed,o.parsed),n):("Complex values '".concat(e,"' and '").concat(t,"' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition."),function(n){return"".concat(n>0?t:e)})},fx=function(e,t){return function(n){return yb(e,t,n)}};function dx(e,t,n){for(var r=[],o=n||function(e){return"number"===typeof e?fx:"string"===typeof e?$b.test(e)?Xb:cx:Array.isArray(e)?sx:"object"===typeof e?ux:void 0}(e[0]),i=e.length-1,a=0;a<i;a++){var s=o(e[a],e[a+1]);if(t){var u=Array.isArray(t)?t[a]:t;s=ix(u,s)}r.push(s)}return r}function px(e,t){var n=gt(e,2),r=n[0],o=n[1],i=gt(t,1)[0];return function(e){return i(gb(r,o,e))}}function hx(e,t){var n=e.length,r=n-1;return function(o){var i=0,a=!1;if(o<=e[0]?a=!0:o>=e[r]&&(i=r-1,a=!0),!a){for(var s=1;s<n&&!(e[s]>o||s===r);s++);i=s-1}var u=gb(e[i],e[i+1],o);return t[i](u)}}function vx(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.clamp,o=void 0===r||r,i=n.ease,a=n.mixer,s=e.length;t.length,!i||!Array.isArray(i)||i.length,e[0]>e[s-1]&&(e=[].concat(e),t=[].concat(t),e.reverse(),t.reverse());var u=dx(t,i,a),l=2===s?px(e,u):hx(e,u);return o?function(t){return l(ub(e[0],e[s-1],t))}:l}var mx,gx=function(e){return function(t){return 1-e(1-t)}},yx=function(e){return function(t){return t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2}},bx=function(e){return function(t){return t*t*((e+1)*t-e)}},xx=function(e){return e},wx=(mx=2,function(e){return Math.pow(e,mx)}),Cx=gx(wx),Ex=yx(wx),Sx=function(e){return 1-Math.sin(Math.acos(e))},kx=gx(Sx),_x=yx(kx),Rx=bx(1.525),Ix=gx(Rx),Tx=yx(Rx),Ax=function(e){var t=bx(e);return function(e){return(e*=2)<1?.5*t(e):.5*(2-Math.pow(2,-10*(e-1)))}}(1.525),Dx=function(e){if(1===e||0===e)return e;var t=e*e;return e<.36363636363636365?7.5625*t:e<.7272727272727273?9.075*t-9.9*e+3.4:e<.9?12.066481994459833*t-19.63545706371191*e+8.898060941828255:10.8*e*e-20.52*e+10.72},Nx=gx(Dx);function Px(e,t){return e.map((function(){return t||Ex})).splice(0,e.length-1)}function Mx(e){var t=e.from,n=void 0===t?0:t,r=e.to,o=void 0===r?1:r,i=e.ease,a=e.offset,s=e.duration,u=void 0===s?300:s,l={done:!1,value:n},c=Array.isArray(o)?o:[n,o],f=function(e,t){return e.map((function(e){return e*t}))}(a&&a.length===c.length?a:function(e){var t=e.length;return e.map((function(e,n){return 0!==n?n/(t-1):0}))}(c),u);function d(){return vx(f,c,{ease:Array.isArray(i)?i:Px(c,i)})}var p=d();return{next:function(e){return l.value=p(e),l.done=e>=u,l},flipTarget:function(){c.reverse(),p=d()}}}var Ox={keyframes:Mx,spring:vb,decay:function(e){var t=e.velocity,n=void 0===t?0:t,r=e.from,o=void 0===r?0:r,i=e.power,a=void 0===i?.8:i,s=e.timeConstant,u=void 0===s?350:s,l=e.restDelta,c=void 0===l?.5:l,f=e.modifyTarget,d={done:!1,value:o},p=a*n,h=o+p,v=void 0===f?h:f(h);return v!==h&&(p=v-o),{next:function(e){var t=-p*Math.exp(-e/u);return d.done=!(t>c||t<-c),d.value=d.done?v:v+t,d},flipTarget:function(){}}}};var Fx=1/60*1e3,Lx="undefined"!==typeof performance?function(){return performance.now()}:function(){return Date.now()},Bx="undefined"!==typeof window?function(e){return window.requestAnimationFrame(e)}:function(e){return setTimeout((function(){return e(Lx())}),Fx)};var zx=!0,Wx=!1,Vx=!1,Ux={delta:0,timestamp:0},jx=["read","update","preRender","render","postRender"],Hx=jx.reduce((function(e,t){return e[t]=function(e){var t=[],n=[],r=0,o=!1,i=!1,a=new WeakSet,s={schedule:function(e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&o,s=i?t:n;return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&a.add(e),-1===s.indexOf(e)&&(s.push(e),i&&o&&(r=t.length)),e},cancel:function(e){var t=n.indexOf(e);-1!==t&&n.splice(t,1),a.delete(e)},process:function(u){if(o)i=!0;else{o=!0;var l=[n,t];if(t=l[0],(n=l[1]).length=0,r=t.length)for(var c=0;c<r;c++){var f=t[c];f(u),a.has(f)&&(s.schedule(f),e())}o=!1,i&&(i=!1,s.process(u))}}};return s}((function(){return Wx=!0})),e}),{}),Gx=jx.reduce((function(e,t){var n=Hx[t];return e[t]=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Wx||Yx(),n.schedule(e,t,r)},e}),{}),qx=jx.reduce((function(e,t){return e[t]=Hx[t].cancel,e}),{}),Kx=jx.reduce((function(e,t){return e[t]=function(){return Hx[t].process(Ux)},e}),{}),Xx=function(e){return Hx[e].process(Ux)},$x=function e(t){Wx=!1,Ux.delta=zx?Fx:Math.max(Math.min(t-Ux.timestamp,40),1),Ux.timestamp=t,Vx=!0,jx.forEach(Xx),Vx=!1,Wx&&(zx=!1,Bx(e))},Yx=function(){Wx=!0,zx=!0,Vx||Bx($x)},Qx=function(){return Ux},Jx=Gx;function Zx(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e-t-n}var ew=function(e){var t=function(t){var n=t.delta;return e(n)};return{start:function(){return Jx.update(t,!0)},stop:function(){return qx.update(t)}}};function tw(e){var t,n,r,o,i,a=e.from,s=e.autoplay,u=void 0===s||s,l=e.driver,c=void 0===l?ew:l,f=e.elapsed,d=void 0===f?0:f,p=e.repeat,h=void 0===p?0:p,v=e.repeatType,m=void 0===v?"loop":v,g=e.repeatDelay,y=void 0===g?0:g,b=e.onPlay,x=e.onStop,w=e.onComplete,C=e.onRepeat,E=e.onUpdate,S=sb(e,["from","autoplay","driver","elapsed","repeat","repeatType","repeatDelay","onPlay","onStop","onComplete","onRepeat","onUpdate"]),k=S.to,_=0,R=S.duration,I=!1,T=!0,A=function(e){if(Array.isArray(e.to))return Mx;if(Ox[e.type])return Ox[e.type];var t=new Set(Object.keys(e));return t.has("ease")||t.has("duration")&&!t.has("dampingRatio")?Mx:t.has("dampingRatio")||t.has("stiffness")||t.has("mass")||t.has("damping")||t.has("restSpeed")||t.has("restDelta")?vb:Mx}(S);(null===(n=(t=A).needsInterpolation)||void 0===n?void 0:n.call(t,a,k))&&(i=vx([0,100],[a,k],{clamp:!1}),a=0,k=100);var D=A(Object.assign(Object.assign({},S),{from:a,to:k}));function N(){_++,"reverse"===m?d=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return r?Zx(t+-e,t,n):t-(e-t)+n}(d,R,y,T=_%2===0):(d=Zx(d,R,y),"mirror"===m&&D.flipTarget()),I=!1,C&&C()}function P(e){if(T||(e=-e),d+=e,!I){var t=D.next(Math.max(0,d));o=t.value,i&&(o=i(o)),I=T?t.done:d<=0}null===E||void 0===E||E(o),I&&(0===_&&(null!==R&&void 0!==R||(R=d)),_<h?function(e,t,n,r){return r?e>=t+n:e<=-n}(d,R,y,T)&&N():(r.stop(),w&&w()))}return u&&(null===b||void 0===b||b(),(r=c(P)).start()),{stop:function(){null===x||void 0===x||x(),r.stop()}}}function nw(e,t){return t?e*(1e3/t):0}var rw=function(e){return 1e3*e},ow=function(e,t){return 1-3*t+3*e},iw=function(e,t){return 3*t-6*e},aw=function(e){return 3*e},sw=function(e,t,n){return((ow(t,n)*e+iw(t,n))*e+aw(t))*e},uw=function(e,t,n){return 3*ow(t,n)*e*e+2*iw(t,n)*e+aw(t)};var lw=.1;function cw(e,t,n,r){if(e===t&&n===r)return xx;for(var o=new Float32Array(11),i=0;i<11;++i)o[i]=sw(i*lw,e,n);function a(t){for(var r=0,i=1;10!==i&&o[i]<=t;++i)r+=lw;--i;var a=r+(t-o[i])/(o[i+1]-o[i])*lw,s=uw(a,e,n);return s>=.001?function(e,t,n,r){for(var o=0;o<8;++o){var i=uw(t,n,r);if(0===i)return t;t-=(sw(t,n,r)-e)/i}return t}(t,a,e,n):0===s?a:function(e,t,n,r,o){var i,a,s=0;do{(i=sw(a=t+(n-t)/2,r,o)-e)>0?n=a:t=a}while(Math.abs(i)>1e-7&&++s<10);return a}(t,r,r+lw,e,n)}return function(e){return 0===e||1===e?e:sw(a(e),t,r)}}var fw={linear:xx,easeIn:wx,easeInOut:Ex,easeOut:Cx,circIn:Sx,circInOut:_x,circOut:kx,backIn:Rx,backInOut:Tx,backOut:Ix,anticipate:Ax,bounceIn:Nx,bounceInOut:function(e){return e<.5?.5*(1-Dx(1-2*e)):.5*Dx(2*e-1)+.5},bounceOut:Dx},dw=function(e){if(Array.isArray(e)){e.length;var t=ib(e,4);return cw(t[0],t[1],t[2],t[3])}return"string"===typeof e?("Invalid easing type '".concat(e,"'"),fw[e]):e},pw=function(e,t){return"zIndex"!==e&&(!("number"!==typeof t&&!Array.isArray(t))||!("string"!==typeof t||!nx.test(t)||t.startsWith("url(")))},hw=function(e){return Array.isArray(e)},vw=function(){return{type:"spring",stiffness:500,damping:25,restSpeed:10}},mw=function(e){return{type:"spring",stiffness:550,damping:0===e?2*Math.sqrt(550):30,restSpeed:10}},gw=function(){return{type:"keyframes",ease:"linear",duration:.3}},yw=function(e){return{type:"keyframes",duration:.8,values:e}},bw={x:vw,y:vw,z:vw,rotate:vw,rotateX:vw,rotateY:vw,rotateZ:vw,scaleX:mw,scaleY:mw,scale:mw,opacity:gw,backgroundColor:gw,color:gw,default:mw},xw=new Set(["brightness","contrast","saturate","opacity"]);function ww(e){var t=gt(e.slice(0,-1).split("("),2),n=t[0],r=t[1];if("drop-shadow"===n)return e;var o=gt(r.match(wb)||[],1)[0];if(!o)return e;var i=r.replace(o,""),a=xw.has(n)?1:0;return o!==r&&(a*=100),n+"("+a+i+")"}var Cw=/([a-z-]*)\(.*?\)/g,Ew=Object.assign(Object.assign({},nx),{getAnimatableNone:function(e){var t=e.match(Cw);return t?t.map(ww).join(" "):e}}),Sw=rb(rb({},kb),{transform:Math.round}),kw={borderWidth:Lb,borderTopWidth:Lb,borderRightWidth:Lb,borderBottomWidth:Lb,borderLeftWidth:Lb,borderRadius:Lb,radius:Lb,borderTopLeftRadius:Lb,borderTopRightRadius:Lb,borderBottomRightRadius:Lb,borderBottomLeftRadius:Lb,width:Lb,maxWidth:Lb,height:Lb,maxHeight:Lb,size:Lb,top:Lb,right:Lb,bottom:Lb,left:Lb,padding:Lb,paddingTop:Lb,paddingRight:Lb,paddingBottom:Lb,paddingLeft:Lb,margin:Lb,marginTop:Lb,marginRight:Lb,marginBottom:Lb,marginLeft:Lb,rotate:Ob,rotateX:Ob,rotateY:Ob,rotateZ:Ob,scale:Rb,scaleX:Rb,scaleY:Rb,scaleZ:Rb,skew:Ob,skewX:Ob,skewY:Ob,distance:Lb,translateX:Lb,translateY:Lb,translateZ:Lb,x:Lb,y:Lb,z:Lb,perspective:Lb,transformPerspective:Lb,opacity:_b,originX:Wb,originY:Wb,originZ:Lb,zIndex:Sw,fillOpacity:_b,strokeOpacity:_b,numOctaves:Sw},_w=rb(rb({},kw),{color:$b,backgroundColor:$b,outlineColor:$b,fill:$b,stroke:$b,borderColor:$b,borderTopColor:$b,borderRightColor:$b,borderBottomColor:$b,borderLeftColor:$b,filter:Ew,WebkitFilter:Ew}),Rw=function(e){return _w[e]};function Iw(e,t){var n,r=Rw(e);return r!==Ew&&(r=nx),null===(n=r.getAnimatableNone)||void 0===n?void 0:n.call(r,t)}var Tw=!1,Aw=function(e){return hw(e)?e[e.length-1]||0:e};function Dw(e){var t=e.ease,n=e.times,r=e.yoyo,o=e.flip,i=e.loop,a=ob(e,["ease","times","yoyo","flip","loop"]),s=rb({},a);return n&&(s.offset=n),a.duration&&(s.duration=rw(a.duration)),a.repeatDelay&&(s.repeatDelay=rw(a.repeatDelay)),t&&(s.ease=function(e){return Array.isArray(e)&&"number"!==typeof e[0]}(t)?t.map(dw):dw(t)),"tween"===a.type&&(s.type="keyframes"),(r||i||o)&&(!0,r?s.repeatType="reverse":i?s.repeatType="loop":o&&(s.repeatType="mirror"),s.repeat=i||r||o||a.repeat),"spring"!==a.type&&(s.type="keyframes"),s}function Nw(e,t,n){var r;return Array.isArray(t.to)&&(null!==(r=e.duration)&&void 0!==r||(e.duration=.8)),function(e){Array.isArray(e.to)&&null===e.to[0]&&(e.to=ab([],ib(e.to),!1),e.to[0]=e.from)}(t),function(e){e.when,e.delay,e.delayChildren,e.staggerChildren,e.staggerDirection,e.repeat,e.repeatType,e.repeatDelay,e.from;var t=ob(e,["when","delay","delayChildren","staggerChildren","staggerDirection","repeat","repeatType","repeatDelay","from"]);return!!Object.keys(t).length}(e)||(e=rb(rb({},e),function(e,t){var n;return n=hw(t)?yw:bw[e]||bw.default,rb({to:t},n(t))}(n,t.to))),rb(rb({},t),Dw(e))}function Pw(e,t,n,r,o){var i,a=Fw(r,e),s=null!==(i=a.from)&&void 0!==i?i:t.get(),u=pw(e,n);"none"===s&&u&&"string"===typeof n?s=Iw(e,n):Mw(s)&&"string"===typeof n?s=Ow(n):!Array.isArray(n)&&Mw(n)&&"string"===typeof s&&(n=Ow(s));var l=pw(e,s);return"You are trying to animate ".concat(e,' from "').concat(s,'" to "').concat(n,'". ').concat(s," is not an animatable value - to enable this animation set ").concat(s," to a value animatable to ").concat(n," via the `style` property."),l&&u&&!1!==a.type?function(){var r={from:s,to:n,velocity:t.getVelocity(),onComplete:o,onUpdate:function(e){return t.set(e)}};return"inertia"===a.type||"decay"===a.type?function(e){var t,n=e.from,r=void 0===n?0:n,o=e.velocity,i=void 0===o?0:o,a=e.min,s=e.max,u=e.power,l=void 0===u?.8:u,c=e.timeConstant,f=void 0===c?750:c,d=e.bounceStiffness,p=void 0===d?500:d,h=e.bounceDamping,v=void 0===h?10:h,m=e.restDelta,g=void 0===m?1:m,y=e.modifyTarget,b=e.driver,x=e.onUpdate,w=e.onComplete,C=e.onStop;function E(e){return void 0!==a&&e<a||void 0!==s&&e>s}function S(e){return void 0===a?s:void 0===s||Math.abs(a-e)<Math.abs(s-e)?a:s}function k(e){null===t||void 0===t||t.stop(),t=tw(Object.assign(Object.assign({},e),{driver:b,onUpdate:function(t){var n;null===x||void 0===x||x(t),null===(n=e.onUpdate)||void 0===n||n.call(e,t)},onComplete:w,onStop:C}))}function _(e){k(Object.assign({type:"spring",stiffness:p,damping:v,restDelta:g},e))}if(E(r))_({from:r,velocity:i,to:S(r)});else{var R=l*i+r;"undefined"!==typeof y&&(R=y(R));var I,T,A=S(R),D=A===a?-1:1;k({type:"decay",from:r,velocity:i,timeConstant:f,power:l,restDelta:g,modifyTarget:y,onUpdate:E(R)?function(e){I=T,T=e,i=nw(e-I,Qx().delta),(1===D&&e>A||-1===D&&e<A)&&_({from:e,to:A,velocity:i})}:void 0})}return{stop:function(){return null===t||void 0===t?void 0:t.stop()}}}(rb(rb({},r),a)):tw(rb(rb({},Nw(a,r,e)),{onUpdate:function(e){var t;r.onUpdate(e),null===(t=a.onUpdate)||void 0===t||t.call(a,e)},onComplete:function(){var e;r.onComplete(),null===(e=a.onComplete)||void 0===e||e.call(a)}}))}:function(){var e,r,i=Aw(n);return t.set(i),o(),null===(e=null===a||void 0===a?void 0:a.onUpdate)||void 0===e||e.call(a,i),null===(r=null===a||void 0===a?void 0:a.onComplete)||void 0===r||r.call(a),{stop:function(){}}}}function Mw(e){return 0===e||"string"===typeof e&&0===parseFloat(e)&&-1===e.indexOf(" ")}function Ow(e){return"number"===typeof e?0:Iw("",e)}function Fw(e,t){return e[t]||e.default||e}function Lw(e,t,n,r){return void 0===r&&(r={}),Tw&&(r={type:!1}),t.start((function(o){var i,a,s=Pw(e,t,n,r,o),u=function(e,t){var n,r;return null!==(r=null!==(n=(Fw(e,t)||{}).delay)&&void 0!==n?n:e.delay)&&void 0!==r?r:0}(r,e),l=function(){return a=s()};return u?i=window.setTimeout(l,rw(u)):l(),function(){clearTimeout(i),null===a||void 0===a||a.stop()}}))}var Bw=function(e){return/^\-?\d*\.?\d+$/.test(e)},zw=function(e){return/^0[^.\s]+$/.test(e)};function Ww(e,t){-1===e.indexOf(t)&&e.push(t)}function Vw(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var Uw=function(){function e(){this.subscriptions=[]}return e.prototype.add=function(e){var t=this;return Ww(this.subscriptions,e),function(){return Vw(t.subscriptions,e)}},e.prototype.notify=function(e,t,n){var r=this.subscriptions.length;if(r)if(1===r)this.subscriptions[0](e,t,n);else for(var o=0;o<r;o++){var i=this.subscriptions[o];i&&i(e,t,n)}},e.prototype.getSize=function(){return this.subscriptions.length},e.prototype.clear=function(){this.subscriptions.length=0},e}(),jw=function(){function e(e){var t,n=this;this.version="6.5.1",this.timeDelta=0,this.lastUpdated=0,this.updateSubscribers=new Uw,this.velocityUpdateSubscribers=new Uw,this.renderSubscribers=new Uw,this.canTrackVelocity=!1,this.updateAndNotify=function(e,t){void 0===t&&(t=!0),n.prev=n.current,n.current=e;var r=Qx(),o=r.delta,i=r.timestamp;n.lastUpdated!==i&&(n.timeDelta=o,n.lastUpdated=i,Jx.postRender(n.scheduleVelocityCheck)),n.prev!==n.current&&n.updateSubscribers.notify(n.current),n.velocityUpdateSubscribers.getSize()&&n.velocityUpdateSubscribers.notify(n.getVelocity()),t&&n.renderSubscribers.notify(n.current)},this.scheduleVelocityCheck=function(){return Jx.postRender(n.velocityCheck)},this.velocityCheck=function(e){e.timestamp!==n.lastUpdated&&(n.prev=n.current,n.velocityUpdateSubscribers.notify(n.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=(t=this.current,!isNaN(parseFloat(t)))}return e.prototype.onChange=function(e){return this.updateSubscribers.add(e)},e.prototype.clearListeners=function(){this.updateSubscribers.clear()},e.prototype.onRenderRequest=function(e){return e(this.get()),this.renderSubscribers.add(e)},e.prototype.attach=function(e){this.passiveEffect=e},e.prototype.set=function(e,t){void 0===t&&(t=!0),t&&this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e,t)},e.prototype.get=function(){return this.current},e.prototype.getPrevious=function(){return this.prev},e.prototype.getVelocity=function(){return this.canTrackVelocity?nw(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0},e.prototype.start=function(e){var t=this;return this.stop(),new Promise((function(n){t.hasAnimated=!0,t.stopAnimation=e(n)})).then((function(){return t.clearAnimation()}))},e.prototype.stop=function(){this.stopAnimation&&this.stopAnimation(),this.clearAnimation()},e.prototype.isAnimating=function(){return!!this.stopAnimation},e.prototype.clearAnimation=function(){this.stopAnimation=null},e.prototype.destroy=function(){this.updateSubscribers.clear(),this.renderSubscribers.clear(),this.stop()},e}();function Hw(e){return new jw(e)}var Gw=function(e){return function(t){return t.test(e)}},qw=[kb,Lb,Fb,Ob,zb,Bb,{test:function(e){return"auto"===e},parse:function(e){return e}}],Kw=function(e){return qw.find(Gw(e))},Xw=ab(ab([],ib(qw),!1),[$b,nx],!1),$w=function(e){return Xw.find(Gw(e))};function Yw(e){return Array.isArray(e)}function Qw(e){return"string"===typeof e||Yw(e)}function Jw(e,t,n,r,o){var i;return void 0===r&&(r={}),void 0===o&&(o={}),"function"===typeof t&&(t=t(null!==n&&void 0!==n?n:e.custom,r,o)),"string"===typeof t&&(t=null===(i=e.variants)||void 0===i?void 0:i[t]),"function"===typeof t&&(t=t(null!==n&&void 0!==n?n:e.custom,r,o)),t}function Zw(e,t,n){var r=e.getProps();return Jw(r,t,null!==n&&void 0!==n?n:r.custom,function(e){var t={};return e.forEachValue((function(e,n){return t[n]=e.get()})),t}(e),function(e){var t={};return e.forEachValue((function(e,n){return t[n]=e.getVelocity()})),t}(e))}function eC(e){var t;return"function"===typeof(null===(t=e.animate)||void 0===t?void 0:t.start)||Qw(e.initial)||Qw(e.animate)||Qw(e.whileHover)||Qw(e.whileDrag)||Qw(e.whileTap)||Qw(e.whileFocus)||Qw(e.exit)}function tC(e){return Boolean(eC(e)||e.variants)}function nC(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,Hw(n))}function rC(e,t){var n=Zw(e,t),r=n?e.makeTargetAnimatable(n,!1):{},o=r.transitionEnd,i=void 0===o?{}:o;r.transition;var a=ob(r,["transitionEnd","transition"]);for(var s in a=rb(rb({},a),i)){nC(e,s,Aw(a[s]))}}function oC(e,t){ab([],ib(t),!1).reverse().forEach((function(n){var r,o=e.getVariant(n);o&&rC(e,o),null===(r=e.variantChildren)||void 0===r||r.forEach((function(e){oC(e,t)}))}))}function iC(e,t){if(t)return(t[e]||t.default||t).from}var aC=["","X","Y","Z"],sC=["transformPerspective","x","y","z"];function uC(e,t){return sC.indexOf(e)-sC.indexOf(t)}["translate","scale","rotate","skew"].forEach((function(e){return aC.forEach((function(t){return sC.push(e+t)}))}));var lC=new Set(sC);function cC(e){return lC.has(e)}var fC=new Set(["originX","originY","originZ"]);function dC(e){return fC.has(e)}function pC(e,t,n){var r;if(void 0===n&&(n={}),e.notifyAnimationStart(t),Array.isArray(t)){var o=t.map((function(t){return hC(e,t,n)}));r=Promise.all(o)}else if("string"===typeof t)r=hC(e,t,n);else{var i="function"===typeof t?Zw(e,t,n.custom):t;r=vC(e,i,n)}return r.then((function(){return e.notifyAnimationComplete(t)}))}function hC(e,t,n){var r;void 0===n&&(n={});var o=Zw(e,t,n.custom),i=(o||{}).transition,a=void 0===i?e.getDefaultTransition()||{}:i;n.transitionOverride&&(a=n.transitionOverride);var s=o?function(){return vC(e,o,n)}:function(){return Promise.resolve()},u=(null===(r=e.variantChildren)||void 0===r?void 0:r.size)?function(r){void 0===r&&(r=0);var o=a.delayChildren,i=void 0===o?0:o,s=a.staggerChildren,u=a.staggerDirection;return function(e,t,n,r,o,i){void 0===n&&(n=0);void 0===r&&(r=0);void 0===o&&(o=1);var a=[],s=(e.variantChildren.size-1)*r,u=1===o?function(e){return void 0===e&&(e=0),e*r}:function(e){return void 0===e&&(e=0),s-e*r};return Array.from(e.variantChildren).sort(mC).forEach((function(e,r){a.push(hC(e,t,rb(rb({},i),{delay:n+u(r)})).then((function(){return e.notifyAnimationComplete(t)})))})),Promise.all(a)}(e,t,i+r,s,u,n)}:function(){return Promise.resolve()},l=a.when;if(l){var c=ib("beforeChildren"===l?[s,u]:[u,s],2),f=c[0],d=c[1];return f().then(d)}return Promise.all([s(),u(n.delay)])}function vC(e,t,n){var r,o=void 0===n?{}:n,i=o.delay,a=void 0===i?0:i,s=o.transitionOverride,u=o.type,l=e.makeTargetAnimatable(t),c=l.transition,f=void 0===c?e.getDefaultTransition():c,d=l.transitionEnd,p=ob(l,["transition","transitionEnd"]);s&&(f=s);var h=[],v=u&&(null===(r=e.animationState)||void 0===r?void 0:r.getState()[u]);for(var m in p){var g=e.getValue(m),y=p[m];if(!(!g||void 0===y||v&&gC(v,m))){var b=rb({delay:a},f);e.shouldReduceMotion&&cC(m)&&(b=rb(rb({},b),{type:!1,delay:0}));var x=Lw(m,g,y,b);h.push(x)}}return Promise.all(h).then((function(){d&&rC(e,d)}))}function mC(e,t){return e.sortNodePosition(t)}function gC(e,t){var n=e.protectedKeys,r=e.needsAnimating,o=n.hasOwnProperty(t)&&!0!==r[t];return r[t]=!1,o}function yC(){var e=!1,t=[],n=new Set,r={subscribe:function(e){return n.add(e),function(){n.delete(e)}},start:function(r,o){if(e){var i=[];return n.forEach((function(e){i.push(pC(e,r,{transitionOverride:o}))})),Promise.all(i)}return new Promise((function(e){t.push({animation:[r,o],resolve:e})}))},set:function(e){return n.forEach((function(t){!function(e,t){Array.isArray(t)?oC(e,t):"string"===typeof t?oC(e,[t]):rC(e,t)}(t,e)}))},stop:function(){n.forEach((function(e){!function(e){e.forEachValue((function(e){return e.stop()}))}(e)}))},mount:function(){return e=!0,t.forEach((function(e){var t=e.animation,n=e.resolve;r.start.apply(r,ab([],ib(t),!1)).then(n)})),function(){e=!1,r.stop()}}};return r}function bC(t){var n=(0,e.useRef)(null);return null===n.current&&(n.current=t()),n.current}var xC=function(){var t=bC(yC);return(0,e.useEffect)(t.mount,[]),t},wC=function(e){return{isEnabled:function(t){return e.some((function(e){return!!t[e]}))}}},CC={measureLayout:wC(["layout","layoutId","drag"]),animation:wC(["animate","exit","variants","whileHover","whileTap","whileFocus","whileDrag","whileInView"]),exit:wC(["exit"]),drag:wC(["drag","dragControls"]),focus:wC(["whileFocus"]),hover:wC(["whileHover","onHoverStart","onHoverEnd"]),tap:wC(["whileTap","onTap","onTapStart","onTapCancel"]),pan:wC(["onPan","onPanStart","onPanSessionStart","onPanEnd"]),inView:wC(["whileInView","onViewportEnter","onViewportLeave"])};var EC=(0,e.createContext)({strict:!1}),SC=Object.keys(CC),kC=SC.length;var _C=(0,e.createContext)({transformPagePoint:function(e){return e},isStatic:!1,reducedMotion:"never"}),RC=(0,e.createContext)({});var IC=(0,e.createContext)(null),TC="undefined"!==typeof document,AC=TC?e.useLayoutEffect:e.useEffect,DC={current:null},NC=!1;function PC(){return!NC&&function(){if(NC=!0,TC)if(window.matchMedia){var e=window.matchMedia("(prefers-reduced-motion)"),t=function(){return DC.current=e.matches};e.addListener(t),t()}else DC.current=!1}(),ib((0,e.useState)(DC.current),1)[0]}function MC(t,n,r,o){var i=(0,e.useContext)(EC),a=(0,e.useContext)(RC).visualElement,s=(0,e.useContext)(IC),u=function(){var t=PC(),n=(0,e.useContext)(_C).reducedMotion;return"never"!==n&&("always"===n||t)}(),l=(0,e.useRef)(void 0);o||(o=i.renderer),!l.current&&o&&(l.current=o(t,{visualState:n,parent:a,props:r,presenceId:null===s||void 0===s?void 0:s.id,blockInitialAnimation:!1===(null===s||void 0===s?void 0:s.initial),shouldReduceMotion:u}));var c=l.current;return AC((function(){null===c||void 0===c||c.syncRender()})),(0,e.useEffect)((function(){var e;null===(e=null===c||void 0===c?void 0:c.animationState)||void 0===e||e.animateChanges()})),AC((function(){return function(){return null===c||void 0===c?void 0:c.notifyUnmount()}}),[]),c}function OC(e){return"object"===typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}function FC(t){var n=function(e,t){if(eC(e)){var n=e.initial,r=e.animate;return{initial:!1===n||Qw(n)?n:void 0,animate:Qw(r)?r:void 0}}return!1!==e.inherit?t:{}}(t,(0,e.useContext)(RC)),r=n.initial,o=n.animate;return(0,e.useMemo)((function(){return{initial:r,animate:o}}),[LC(r),LC(o)])}function LC(e){return Array.isArray(e)?e.join(" "):e}var BC={hasAnimatedSinceResize:!0,hasEverUpdated:!1},zC=1;var WC=(0,e.createContext)({}),VC=(0,e.createContext)({});var UC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return nb(t,e),t.prototype.getSnapshotBeforeUpdate=function(){return this.updateProps(),null},t.prototype.componentDidUpdate=function(){},t.prototype.updateProps=function(){var e=this.props,t=e.visualElement,n=e.props;t&&t.setProps(n)},t.prototype.render=function(){return this.props.children},t}(e.Component);function jC(t){var n=t.preloadedFeatures,r=t.createVisualElement,o=t.projectionNodeConstructor,i=t.useRender,a=t.useVisualState,s=t.Component;return n&&function(e){for(var t in e)null!==e[t]&&("projectionNodeConstructor"===t?CC.projectionNodeConstructor=e[t]:CC[t].Component=e[t])}(n),(0,e.forwardRef)((function(t,n){var u=function(t){var n,r=t.layoutId,o=null===(n=(0,e.useContext)(WC))||void 0===n?void 0:n.id;return o&&void 0!==r?o+"-"+r:r}(t);t=rb(rb({},t),{layoutId:u});var l=(0,e.useContext)(_C),c=null,f=FC(t),d=l.isStatic?void 0:bC((function(){if(BC.hasEverUpdated)return zC++})),p=a(t,l.isStatic);return!l.isStatic&&TC&&(f.visualElement=MC(s,p,rb(rb({},l),t),r),function(t,n,r,o){var i,a=n.layoutId,s=n.layout,u=n.drag,l=n.dragConstraints,c=n.layoutScroll,f=(0,e.useContext)(VC);o&&r&&!(null===r||void 0===r?void 0:r.projection)&&(r.projection=new o(t,r.getLatestValues(),null===(i=r.parent)||void 0===i?void 0:i.projection),r.projection.setOptions({layoutId:a,layout:s,alwaysMeasureLayout:Boolean(u)||l&&OC(l),visualElement:r,scheduleRender:function(){return r.scheduleRender()},animationType:"string"===typeof s?s:"both",initialPromotionConfig:f,layoutScroll:c}))}(d,t,f.visualElement,o||CC.projectionNodeConstructor),c=function(t,n,r){var o=[];if((0,e.useContext)(EC),!n)return null;for(var i=0;i<kC;i++){var a=SC[i],s=CC[a],u=s.isEnabled,l=s.Component;u(t)&&l&&o.push(e.createElement(l,rb({key:a},t,{visualElement:n})))}return o}(t,f.visualElement)),e.createElement(UC,{visualElement:f.visualElement,props:rb(rb({},l),t)},c,e.createElement(RC.Provider,{value:f},i(s,t,d,function(t,n,r){return(0,e.useCallback)((function(e){var o;e&&(null===(o=t.mount)||void 0===o||o.call(t,e)),n&&(e?n.mount(e):n.unmount()),r&&("function"===typeof r?r(e):OC(r)&&(r.current=e))}),[n])}(p,f.visualElement,n),p,l.isStatic,f.visualElement)))}))}function HC(e){function t(t,n){return void 0===n&&(n={}),jC(e(t,n))}if("undefined"===typeof Proxy)return t;var n=new Map;return new Proxy(t,{get:function(e,r){return n.has(r)||n.set(r,t(r)),n.get(r)}})}var GC=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","svg","switch","symbol","text","tspan","use","view"];function qC(e){return"string"===typeof e&&!e.includes("-")&&!!(GC.indexOf(e)>-1||/[A-Z]/.test(e))}var KC={};function XC(e,t){var n=t.layout,r=t.layoutId;return cC(e)||dC(e)||(n||void 0!==r)&&(!!KC[e]||"opacity"===e)}var $C=function(e){return Boolean(null!==e&&"object"===typeof e&&e.getVelocity)},YC={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"};function QC(e){return e.startsWith("--")}var JC=function(e,t){return t&&"number"===typeof e?t.transform(e):e};function ZC(e,t,n,r){var o,i=e.style,a=e.vars,s=e.transform,u=e.transformKeys,l=e.transformOrigin;u.length=0;var c=!1,f=!1,d=!0;for(var p in t){var h=t[p];if(QC(p))a[p]=h;else{var v=kw[p],m=JC(h,v);if(cC(p)){if(c=!0,s[p]=m,u.push(p),!d)continue;h!==(null!==(o=v.default)&&void 0!==o?o:0)&&(d=!1)}else dC(p)?(l[p]=m,f=!0):i[p]=m}}c?i.transform=function(e,t,n,r){var o=e.transform,i=e.transformKeys,a=t.enableHardwareAcceleration,s=void 0===a||a,u=t.allowTransformNone,l=void 0===u||u,c="";i.sort(uC);for(var f=!1,d=i.length,p=0;p<d;p++){var h=i[p];c+="".concat(YC[h]||h,"(").concat(o[h],") "),"z"===h&&(f=!0)}return!f&&s?c+="translateZ(0)":c=c.trim(),r?c=r(o,n?"":c):l&&n&&(c="none"),c}(e,n,d,r):r?i.transform=r({},""):!t.transform&&i.transform&&(i.transform="none"),f&&(i.transformOrigin=function(e){var t=e.originX,n=void 0===t?"50%":t,r=e.originY,o=void 0===r?"50%":r,i=e.originZ,a=void 0===i?0:i;return"".concat(n," ").concat(o," ").concat(a)}(l))}var eE=function(){return{style:{},transform:{},transformKeys:[],transformOrigin:{},vars:{}}};function tE(e,t,n){for(var r in t)$C(t[r])||XC(r,n)||(e[r]=t[r])}function nE(t,n,r){var o={};return tE(o,t.style||{},t),Object.assign(o,function(t,n,r){var o=t.transformTemplate;return(0,e.useMemo)((function(){var e={style:{},transform:{},transformKeys:[],transformOrigin:{},vars:{}};ZC(e,n,{enableHardwareAcceleration:!r},o);var t=e.style;return rb(rb({},e.vars),t)}),[n])}(t,n,r)),t.transformValues&&(o=t.transformValues(o)),o}function rE(e,t,n){var r={},o=nE(e,t,n);return Boolean(e.drag)&&!1!==e.dragListener&&(r.draggable=!1,o.userSelect=o.WebkitUserSelect=o.WebkitTouchCallout="none",o.touchAction=!0===e.drag?"none":"pan-".concat("x"===e.drag?"y":"x")),r.style=o,r}var oE=new Set(["initial","animate","exit","style","variants","transition","transformTemplate","transformValues","custom","inherit","layout","layoutId","layoutDependency","onLayoutAnimationStart","onLayoutAnimationComplete","onLayoutMeasure","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","drag","dragControls","dragListener","dragConstraints","dragDirectionLock","dragSnapToOrigin","_dragX","_dragY","dragElastic","dragMomentum","dragPropagation","dragTransition","whileDrag","onPan","onPanStart","onPanEnd","onPanSessionStart","onTap","onTapStart","onTapCancel","onHoverStart","onHoverEnd","whileFocus","whileTap","whileHover","whileInView","onViewportEnter","onViewportLeave","viewport","layoutScroll"]);function iE(e){return oE.has(e)}var aE,sE=function(e){return!iE(e)};try{(aE=require("@emotion/is-prop-valid").default)&&(sE=function(e){return e.startsWith("on")?!iE(e):aE(e)})}catch(Vs){}function uE(e,t,n){return"string"===typeof e?e:Lb.transform(t+n*e)}var lE={offset:"stroke-dashoffset",array:"stroke-dasharray"},cE={offset:"strokeDashoffset",array:"strokeDasharray"};function fE(e,t,n,r){var o=t.attrX,i=t.attrY,a=t.originX,s=t.originY,u=t.pathLength,l=t.pathSpacing,c=void 0===l?1:l,f=t.pathOffset,d=void 0===f?0:f;ZC(e,ob(t,["attrX","attrY","originX","originY","pathLength","pathSpacing","pathOffset"]),n,r),e.attrs=e.style,e.style={};var p=e.attrs,h=e.style,v=e.dimensions;p.transform&&(v&&(h.transform=p.transform),delete p.transform),v&&(void 0!==a||void 0!==s||h.transform)&&(h.transformOrigin=function(e,t,n){var r=uE(t,e.x,e.width),o=uE(n,e.y,e.height);return"".concat(r," ").concat(o)}(v,void 0!==a?a:.5,void 0!==s?s:.5)),void 0!==o&&(p.x=o),void 0!==i&&(p.y=i),void 0!==u&&function(e,t,n,r,o){void 0===n&&(n=1),void 0===r&&(r=0),void 0===o&&(o=!0),e.pathLength=1;var i=o?lE:cE;e[i.offset]=Lb.transform(-r);var a=Lb.transform(t),s=Lb.transform(n);e[i.array]="".concat(a," ").concat(s)}(p,u,c,d,!1)}var dE=function(){return rb(rb({},{style:{},transform:{},transformKeys:[],transformOrigin:{},vars:{}}),{attrs:{}})};function pE(t,n){var r=(0,e.useMemo)((function(){var e=dE();return fE(e,n,{enableHardwareAcceleration:!1},t.transformTemplate),rb(rb({},e.attrs),{style:rb({},e.style)})}),[n]);if(t.style){var o={};tE(o,t.style,t),r.style=rb(rb({},o),r.style)}return r}function hE(t){void 0===t&&(t=!1);return function(n,r,o,i,a,s){var u=a.latestValues,l=(qC(n)?pE:rE)(r,u,s),c=function(e,t,n){var r={};for(var o in e)(sE(o)||!0===n&&iE(o)||!t&&!iE(o)||e.draggable&&o.startsWith("onDrag"))&&(r[o]=e[o]);return r}(r,"string"===typeof n,t),f=rb(rb(rb({},c),l),{ref:i});return o&&(f["data-projection-id"]=o),(0,e.createElement)(n,f)}}var vE=/([a-z])([A-Z])/g,mE=function(e){return e.replace(vE,"$1-$2").toLowerCase()};function gE(e,t,n,r){var o=t.style,i=t.vars;for(var a in Object.assign(e.style,o,r&&r.getProjectionStyles(n)),i)e.style.setProperty(a,i[a])}var yE=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength"]);function bE(e,t,n,r){for(var o in gE(e,t,void 0,r),t.attrs)e.setAttribute(yE.has(o)?o:mE(o),t.attrs[o])}function xE(e){var t=e.style,n={};for(var r in t)($C(t[r])||XC(r,e))&&(n[r]=t[r]);return n}function wE(e){var t=xE(e);for(var n in e){if($C(e[n]))t["x"===n||"y"===n?"attr"+n.toUpperCase():n]=e[n]}return t}function CE(e){return"object"===typeof e&&"function"===typeof e.start}function EE(e){var t=$C(e)?e.get():e;return function(e){return Boolean(e&&"object"===typeof e&&e.mix&&e.toValue)}(t)?t.toValue():t}function SE(e,t,n,r){var o=e.scrapeMotionValuesFromProps,i=e.createRenderState,a=e.onMount,s={latestValues:_E(t,n,r,o),renderState:i()};return a&&(s.mount=function(e){return a(t,e,s)}),s}var kE=function(t){return function(n,r){var o=(0,e.useContext)(RC),i=(0,e.useContext)(IC);return r?SE(t,n,o,i):bC((function(){return SE(t,n,o,i)}))}};function _E(e,t,n,r){var o={},i=!1===(null===n||void 0===n?void 0:n.initial),a=r(e);for(var s in a)o[s]=EE(a[s]);var u=e.initial,l=e.animate,c=eC(e),f=tC(e);t&&f&&!c&&!1!==e.inherit&&(null!==u&&void 0!==u||(u=t.initial),null!==l&&void 0!==l||(l=t.animate));var d=i||!1===u,p=d?l:u;p&&"boolean"!==typeof p&&!CE(p)&&(Array.isArray(p)?p:[p]).forEach((function(t){var n=Jw(e,t);if(n){var r=n.transitionEnd;n.transition;var i=ob(n,["transitionEnd","transition"]);for(var a in i){var s=i[a];if(Array.isArray(s))s=s[d?s.length-1:0];null!==s&&(o[a]=s)}for(var a in r)o[a]=r[a]}}));return o}var RE,IE={useVisualState:kE({scrapeMotionValuesFromProps:wE,createRenderState:dE,onMount:function(e,t,n){var r=n.renderState,o=n.latestValues;try{r.dimensions="function"===typeof t.getBBox?t.getBBox():t.getBoundingClientRect()}catch(nn){r.dimensions={x:0,y:0,width:0,height:0}}fE(r,o,{enableHardwareAcceleration:!1},e.transformTemplate),bE(t,r)}})},TE={useVisualState:kE({scrapeMotionValuesFromProps:xE,createRenderState:eE})};function AE(e,t,n,r){return void 0===r&&(r={passive:!0}),e.addEventListener(t,n,r),function(){return e.removeEventListener(t,n)}}function DE(t,n,r,o){(0,e.useEffect)((function(){var e=t.current;if(r&&e)return AE(e,n,r,o)}),[t,n,r,o])}function NE(e){return"undefined"!==typeof PointerEvent&&e instanceof PointerEvent?!("mouse"!==e.pointerType):e instanceof MouseEvent}function PE(e){return!!e.touches}!function(e){e.Animate="animate",e.Hover="whileHover",e.Tap="whileTap",e.Drag="whileDrag",e.Focus="whileFocus",e.InView="whileInView",e.Exit="exit"}(RE||(RE={}));var ME={pageX:0,pageY:0};function OE(e,t){void 0===t&&(t="page");var n=e.touches[0]||e.changedTouches[0]||ME;return{x:n[t+"X"],y:n[t+"Y"]}}function FE(e,t){return void 0===t&&(t="page"),{x:e[t+"X"],y:e[t+"Y"]}}function LE(e,t){return void 0===t&&(t="page"),{point:PE(e)?OE(e,t):FE(e,t)}}var BE=function(e,t){void 0===t&&(t=!1);var n,r=function(t){return e(t,LE(t))};return t?(n=r,function(e){var t=e instanceof MouseEvent;(!t||t&&0===e.button)&&n(e)}):r},zE={pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointercancel:"mousecancel",pointerover:"mouseover",pointerout:"mouseout",pointerenter:"mouseenter",pointerleave:"mouseleave"},WE={pointerdown:"touchstart",pointermove:"touchmove",pointerup:"touchend",pointercancel:"touchcancel"};function VE(e){return TC&&null===window.onpointerdown?e:TC&&null===window.ontouchstart?WE[e]:TC&&null===window.onmousedown?zE[e]:e}function UE(e,t,n,r){return AE(e,VE(t),BE(n,"pointerdown"===t),r)}function jE(e,t,n,r){return DE(e,VE(t),n&&BE(n,"pointerdown"===t),r)}function HE(e){var t=null;return function(){return null===t&&(t=e,function(){t=null})}}var GE=HE("dragHorizontal"),qE=HE("dragVertical");function KE(e){var t=!1;if("y"===e)t=qE();else if("x"===e)t=GE();else{var n=GE(),r=qE();n&&r?t=function(){n(),r()}:(n&&n(),r&&r())}return t}function XE(){var e=KE(!0);return!e||(e(),!1)}function $E(e,t,n){return function(r,o){var i;NE(r)&&!XE()&&(null===(i=e.animationState)||void 0===i||i.setActive(RE.Hover,t),null===n||void 0===n||n(r,o))}}var YE=function e(t,n){return!!n&&(t===n||e(t,n.parentElement))};function QE(t){return(0,e.useEffect)((function(){return function(){return t()}}),[])}new Set;var JE=new WeakMap,ZE=new WeakMap,eS=function(e){var t;null===(t=JE.get(e.target))||void 0===t||t(e)},tS=function(e){e.forEach(eS)};function nS(e,t,n){var r=function(e){var t=e.root,n=ob(e,["root"]),r=t||document;ZE.has(r)||ZE.set(r,{});var o=ZE.get(r),i=JSON.stringify(n);return o[i]||(o[i]=new IntersectionObserver(tS,rb({root:t},n))),o[i]}(t);return JE.set(e,n),r.observe(e),function(){JE.delete(e),r.unobserve(e)}}var rS={some:0,all:1};function oS(t,n,r,o){var i=o.root,a=o.margin,s=o.amount,u=void 0===s?"some":s,l=o.once;(0,e.useEffect)((function(){if(t){var e={root:null===i||void 0===i?void 0:i.current,rootMargin:a,threshold:"number"===typeof u?u:rS[u]};return nS(r.getInstance(),e,(function(e){var t,o=e.isIntersecting;if(n.isInView!==o&&(n.isInView=o,!l||o||!n.hasEnteredView)){o&&(n.hasEnteredView=!0),null===(t=r.animationState)||void 0===t||t.setActive(RE.InView,o);var i=r.getProps(),a=o?i.onViewportEnter:i.onViewportLeave;null===a||void 0===a||a(e)}}))}}),[t,i,a,u])}function iS(t,n,r,o){var i=o.fallback,a=void 0===i||i;(0,e.useEffect)((function(){t&&a&&requestAnimationFrame((function(){var e;n.hasEnteredView=!0;var t=r.getProps().onViewportEnter;null===t||void 0===t||t(null),null===(e=r.animationState)||void 0===e||e.setActive(RE.InView,!0)}))}),[t])}var aS=function(e){return function(t){return e(t),null}},sS={inView:aS((function(t){var n=t.visualElement,r=t.whileInView,o=t.onViewportEnter,i=t.onViewportLeave,a=t.viewport,s=void 0===a?{}:a,u=(0,e.useRef)({hasEnteredView:!1,isInView:!1}),l=Boolean(r||o||i);s.once&&u.current.hasEnteredView&&(l=!1),("undefined"===typeof IntersectionObserver?iS:oS)(l,u.current,n,s)})),tap:aS((function(t){var n=t.onTap,r=t.onTapStart,o=t.onTapCancel,i=t.whileTap,a=t.visualElement,s=n||r||o||i,u=(0,e.useRef)(!1),l=(0,e.useRef)(null),c={passive:!(r||n||o||v)};function f(){var e;null===(e=l.current)||void 0===e||e.call(l),l.current=null}function d(){var e;return f(),u.current=!1,null===(e=a.animationState)||void 0===e||e.setActive(RE.Tap,!1),!XE()}function p(e,t){d()&&(YE(a.getInstance(),e.target)?null===n||void 0===n||n(e,t):null===o||void 0===o||o(e,t))}function h(e,t){d()&&(null===o||void 0===o||o(e,t))}function v(e,t){var n;f(),u.current||(u.current=!0,l.current=ix(UE(window,"pointerup",p,c),UE(window,"pointercancel",h,c)),null===(n=a.animationState)||void 0===n||n.setActive(RE.Tap,!0),null===r||void 0===r||r(e,t))}jE(a,"pointerdown",s?v:void 0,c),QE(f)})),focus:aS((function(e){var t=e.whileFocus,n=e.visualElement;DE(n,"focus",t?function(){var e;null===(e=n.animationState)||void 0===e||e.setActive(RE.Focus,!0)}:void 0),DE(n,"blur",t?function(){var e;null===(e=n.animationState)||void 0===e||e.setActive(RE.Focus,!1)}:void 0)})),hover:aS((function(e){var t=e.onHoverStart,n=e.onHoverEnd,r=e.whileHover,o=e.visualElement;jE(o,"pointerenter",t||r?$E(o,!0,t):void 0,{passive:!t}),jE(o,"pointerleave",n||r?$E(o,!1,n):void 0,{passive:!n})}))},uS=0,lS=function(){return uS++};function cS(){var t=(0,e.useContext)(IC);if(null===t)return[!0,null];var n=t.isPresent,r=t.onExitComplete,o=t.register,i=bC(lS);(0,e.useEffect)((function(){return o(i)}),[]);return!n&&r?[!1,function(){return null===r||void 0===r?void 0:r(i)}]:[!0]}function fS(e,t){if(!Array.isArray(t))return!1;var n=t.length;if(n!==e.length)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}var dS=[RE.Animate,RE.InView,RE.Focus,RE.Hover,RE.Tap,RE.Drag,RE.Exit],pS=ab([],ib(dS),!1).reverse(),hS=dS.length;function vS(e){var t=function(e){return function(t){return Promise.all(t.map((function(t){var n=t.animation,r=t.options;return pC(e,n,r)})))}}(e),n=function(){var e;return e={},e[RE.Animate]=mS(!0),e[RE.InView]=mS(),e[RE.Hover]=mS(),e[RE.Tap]=mS(),e[RE.Drag]=mS(),e[RE.Focus]=mS(),e[RE.Exit]=mS(),e}(),r={},o=!0,i=function(t,n){var r=Zw(e,n);if(r){r.transition;var o=r.transitionEnd,i=ob(r,["transition","transitionEnd"]);t=rb(rb(rb({},t),i),o)}return t};function a(a,s){for(var u,l=e.getProps(),c=e.getVariantContext(!0)||{},f=[],d=new Set,p={},h=1/0,v=function(t){var r=pS[t],v=n[r],m=null!==(u=l[r])&&void 0!==u?u:c[r],g=Qw(m),y=r===s?v.isActive:null;!1===y&&(h=t);var b=m===c[r]&&m!==l[r]&&g;if(b&&o&&e.manuallyAnimateOnMount&&(b=!1),v.protectedKeys=rb({},p),!v.isActive&&null===y||!m&&!v.prevProp||CE(m)||"boolean"===typeof m)return"continue";var x=function(e,t){if("string"===typeof t)return t!==e;if(Yw(t))return!fS(t,e);return!1}(v.prevProp,m),w=x||r===s&&v.isActive&&!b&&g||t>h&&g,C=Array.isArray(m)?m:[m],E=C.reduce(i,{});!1===y&&(E={});var S=v.prevResolvedValues,k=void 0===S?{}:S,_=rb(rb({},k),E),R=function(e){w=!0,d.delete(e),v.needsAnimating[e]=!0};for(var I in _){var T=E[I],A=k[I];p.hasOwnProperty(I)||(T!==A?hw(T)&&hw(A)?!fS(T,A)||x?R(I):v.protectedKeys[I]=!0:void 0!==T?R(I):d.add(I):void 0!==T&&d.has(I)?R(I):v.protectedKeys[I]=!0)}v.prevProp=m,v.prevResolvedValues=E,v.isActive&&(p=rb(rb({},p),E)),o&&e.blockInitialAnimation&&(w=!1),w&&!b&&f.push.apply(f,ab([],ib(C.map((function(e){return{animation:e,options:rb({type:r},a)}}))),!1))},m=0;m<hS;m++)v(m);if(r=rb({},p),d.size){var g={};d.forEach((function(t){var n=e.getBaseTarget(t);void 0!==n&&(g[t]=n)})),f.push({animation:g})}var y=Boolean(f.length);return o&&!1===l.initial&&!e.manuallyAnimateOnMount&&(y=!1),o=!1,y?t(f):Promise.resolve()}return{isAnimated:function(e){return void 0!==r[e]},animateChanges:a,setActive:function(t,r,o){var i;if(n[t].isActive===r)return Promise.resolve();null===(i=e.variantChildren)||void 0===i||i.forEach((function(e){var n;return null===(n=e.animationState)||void 0===n?void 0:n.setActive(t,r)})),n[t].isActive=r;var s=a(o,t);for(var u in n)n[u].protectedKeys={};return s},setAnimateFunction:function(n){t=n(e)},getState:function(){return n}}}function mS(e){return void 0===e&&(e=!1),{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}var gS={animation:aS((function(t){var n=t.visualElement,r=t.animate;n.animationState||(n.animationState=vS(n)),CE(r)&&(0,e.useEffect)((function(){return r.subscribe(n)}),[r])})),exit:aS((function(t){var n=t.custom,r=t.visualElement,o=ib(cS(),2),i=o[0],a=o[1],s=(0,e.useContext)(IC);(0,e.useEffect)((function(){var e,t;r.isPresent=i;var o=null===(e=r.animationState)||void 0===e?void 0:e.setActive(RE.Exit,!i,{custom:null!==(t=null===s||void 0===s?void 0:s.custom)&&void 0!==t?t:n});!i&&(null===o||void 0===o||o.then(a))}),[i])}))},yS=function(e){return e.hasOwnProperty("x")&&e.hasOwnProperty("y")},bS=function(e){return yS(e)&&e.hasOwnProperty("z")},xS=function(e,t){return Math.abs(e-t)};function wS(e,t){if(rx(e)&&rx(t))return xS(e,t);if(yS(e)&&yS(t)){var n=xS(e.x,t.x),r=xS(e.y,t.y),o=bS(e)&&bS(t)?xS(e.z,t.z):0;return Math.sqrt(Math.pow(n,2)+Math.pow(r,2)+Math.pow(o,2))}}var CS=function(){function e(e,t,n){var r=this,o=(void 0===n?{}:n).transformPagePoint;if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.updatePoint=function(){if(r.lastMoveEvent&&r.lastMoveEventInfo){var e=kS(r.lastMoveEventInfo,r.history),t=null!==r.startEvent,n=wS(e.offset,{x:0,y:0})>=3;if(t||n){var o=e.point,i=Qx().timestamp;r.history.push(rb(rb({},o),{timestamp:i}));var a=r.handlers,s=a.onStart,u=a.onMove;t||(s&&s(r.lastMoveEvent,e),r.startEvent=r.lastMoveEvent),u&&u(r.lastMoveEvent,e)}}},this.handlePointerMove=function(e,t){r.lastMoveEvent=e,r.lastMoveEventInfo=ES(t,r.transformPagePoint),NE(e)&&0===e.buttons?r.handlePointerUp(e,t):Jx.update(r.updatePoint,!0)},this.handlePointerUp=function(e,t){r.end();var n=r.handlers,o=n.onEnd,i=n.onSessionEnd,a=kS(ES(t,r.transformPagePoint),r.history);r.startEvent&&o&&o(e,a),i&&i(e,a)},!(PE(e)&&e.touches.length>1)){this.handlers=t,this.transformPagePoint=o;var i=ES(LE(e),this.transformPagePoint),a=i.point,s=Qx().timestamp;this.history=[rb(rb({},a),{timestamp:s})];var u=t.onSessionStart;u&&u(e,kS(i,this.history)),this.removeListeners=ix(UE(window,"pointermove",this.handlePointerMove),UE(window,"pointerup",this.handlePointerUp),UE(window,"pointercancel",this.handlePointerUp))}}return e.prototype.updateHandlers=function(e){this.handlers=e},e.prototype.end=function(){this.removeListeners&&this.removeListeners(),qx.update(this.updatePoint)},e}();function ES(e,t){return t?{point:t(e.point)}:e}function SS(e,t){return{x:e.x-t.x,y:e.y-t.y}}function kS(e,t){var n=e.point;return{point:n,delta:SS(n,RS(t)),offset:SS(n,_S(t)),velocity:IS(t,.1)}}function _S(e){return e[0]}function RS(e){return e[e.length-1]}function IS(e,t){if(e.length<2)return{x:0,y:0};for(var n=e.length-1,r=null,o=RS(e);n>=0&&(r=e[n],!(o.timestamp-r.timestamp>rw(t)));)n--;if(!r)return{x:0,y:0};var i=(o.timestamp-r.timestamp)/1e3;if(0===i)return{x:0,y:0};var a={x:(o.x-r.x)/i,y:(o.y-r.y)/i};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function TS(e){return e.max-e.min}function AS(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=.01),wS(e,t)<n}function DS(e,t,n,r){void 0===r&&(r=.5),e.origin=r,e.originPoint=yb(t.min,t.max,e.origin),e.scale=TS(n)/TS(t),(AS(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=yb(n.min,n.max,e.origin)-e.originPoint,(AS(e.translate)||isNaN(e.translate))&&(e.translate=0)}function NS(e,t,n,r){DS(e.x,t.x,n.x,null===r||void 0===r?void 0:r.originX),DS(e.y,t.y,n.y,null===r||void 0===r?void 0:r.originY)}function PS(e,t,n){e.min=n.min+t.min,e.max=e.min+TS(t)}function MS(e,t,n){e.min=t.min-n.min,e.max=e.min+TS(t)}function OS(e,t,n){MS(e.x,t.x,n.x),MS(e.y,t.y,n.y)}function FS(e,t,n){return{min:void 0!==t?e.min+t:void 0,max:void 0!==n?e.max+n-(e.max-e.min):void 0}}function LS(e,t){var n,r=t.min-e.min,o=t.max-e.max;return t.max-t.min<e.max-e.min&&(r=(n=ib([o,r],2))[0],o=n[1]),{min:r,max:o}}var BS=.35;function zS(e,t,n){return{min:WS(e,t),max:WS(e,n)}}function WS(e,t){var n;return"number"===typeof e?e:null!==(n=e[t])&&void 0!==n?n:0}function VS(e){return[e("x"),e("y")]}function US(e){var t=e.top;return{x:{min:e.left,max:e.right},y:{min:t,max:e.bottom}}}function jS(e){return void 0===e||1===e}function HS(e){var t=e.scale,n=e.scaleX,r=e.scaleY;return!jS(t)||!jS(n)||!jS(r)}function GS(e){return HS(e)||qS(e.x)||qS(e.y)||e.z||e.rotate||e.rotateX||e.rotateY}function qS(e){return e&&"0%"!==e}function KS(e,t,n){return n+t*(e-n)}function XS(e,t,n,r,o){return void 0!==o&&(e=KS(e,o,r)),KS(e,n,r)+t}function $S(e,t,n,r,o){void 0===t&&(t=0),void 0===n&&(n=1),e.min=XS(e.min,t,n,r,o),e.max=XS(e.max,t,n,r,o)}function YS(e,t){var n=t.x,r=t.y;$S(e.x,n.translate,n.scale,n.originPoint),$S(e.y,r.translate,r.scale,r.originPoint)}function QS(e,t){e.min=e.min+t,e.max=e.max+t}function JS(e,t,n){var r=ib(n,3),o=r[0],i=r[1],a=r[2],s=void 0!==t[a]?t[a]:.5,u=yb(e.min,e.max,s);$S(e,t[o],t[i],u,t.scale)}var ZS=["x","scaleX","originX"],ek=["y","scaleY","originY"];function tk(e,t){JS(e.x,t,ZS),JS(e.y,t,ek)}function nk(e,t){return US(function(e,t){if(!t)return e;var n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}(e.getBoundingClientRect(),t))}var rk=new WeakMap,ok=function(){function e(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic={x:{min:0,max:0},y:{min:0,max:0}},this.visualElement=e}return e.prototype.start=function(e,t){var n=this,r=(void 0===t?{}:t).snapToCursor,o=void 0!==r&&r;if(!1!==this.visualElement.isPresent){this.panSession=new CS(e,{onSessionStart:function(e){n.stopAnimation(),o&&n.snapToCursor(LE(e,"page").point)},onStart:function(e,t){var r,o=n.getProps(),i=o.drag,a=o.dragPropagation,s=o.onDragStart;(!i||a||(n.openGlobalLock&&n.openGlobalLock(),n.openGlobalLock=KE(i),n.openGlobalLock))&&(n.isDragging=!0,n.currentDirection=null,n.resolveConstraints(),n.visualElement.projection&&(n.visualElement.projection.isAnimationBlocked=!0,n.visualElement.projection.target=void 0),VS((function(e){var t,r,o=n.getAxisMotionValue(e).get()||0;if(Fb.test(o)){var i=null===(r=null===(t=n.visualElement.projection)||void 0===t?void 0:t.layout)||void 0===r?void 0:r.actual[e];if(i)o=TS(i)*(parseFloat(o)/100)}n.originPoint[e]=o})),null===s||void 0===s||s(e,t),null===(r=n.visualElement.animationState)||void 0===r||r.setActive(RE.Drag,!0))},onMove:function(e,t){var r=n.getProps(),o=r.dragPropagation,i=r.dragDirectionLock,a=r.onDirectionLock,s=r.onDrag;if(o||n.openGlobalLock){var u=t.offset;if(i&&null===n.currentDirection)return n.currentDirection=function(e,t){void 0===t&&(t=10);var n=null;Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x");return n}(u),void(null!==n.currentDirection&&(null===a||void 0===a||a(n.currentDirection)));n.updateAxis("x",t.point,u),n.updateAxis("y",t.point,u),n.visualElement.syncRender(),null===s||void 0===s||s(e,t)}},onSessionEnd:function(e,t){return n.stop(e,t)}},{transformPagePoint:this.visualElement.getTransformPagePoint()})}},e.prototype.stop=function(e,t){var n=this.isDragging;if(this.cancel(),n){var r=t.velocity;this.startAnimation(r);var o=this.getProps().onDragEnd;null===o||void 0===o||o(e,t)}},e.prototype.cancel=function(){var e,t;this.isDragging=!1,this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!1),null===(e=this.panSession)||void 0===e||e.end(),this.panSession=void 0,!this.getProps().dragPropagation&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),null===(t=this.visualElement.animationState)||void 0===t||t.setActive(RE.Drag,!1)},e.prototype.updateAxis=function(e,t,n){var r=this.getProps().drag;if(n&&ik(e,r,this.currentDirection)){var o=this.getAxisMotionValue(e),i=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(i=function(e,t,n){var r=t.min,o=t.max;return void 0!==r&&e<r?e=n?yb(r,e,n.min):Math.max(e,r):void 0!==o&&e>o&&(e=n?yb(o,e,n.max):Math.min(e,o)),e}(i,this.constraints[e],this.elastic[e])),o.set(i)}},e.prototype.resolveConstraints=function(){var e=this,t=this.getProps(),n=t.dragConstraints,r=t.dragElastic,o=(this.visualElement.projection||{}).layout,i=this.constraints;n&&OC(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):this.constraints=!(!n||!o)&&function(e,t){var n=t.top,r=t.left,o=t.bottom,i=t.right;return{x:FS(e.x,r,i),y:FS(e.y,n,o)}}(o.actual,n),this.elastic=function(e){return void 0===e&&(e=BS),!1===e?e=0:!0===e&&(e=BS),{x:zS(e,"left","right"),y:zS(e,"top","bottom")}}(r),i!==this.constraints&&o&&this.constraints&&!this.hasMutatedConstraints&&VS((function(t){e.getAxisMotionValue(t)&&(e.constraints[t]=function(e,t){var n={};return void 0!==t.min&&(n.min=t.min-e.min),void 0!==t.max&&(n.max=t.max-e.min),n}(o.actual[t],e.constraints[t]))}))},e.prototype.resolveRefConstraints=function(){var e=this.getProps(),t=e.dragConstraints,n=e.onMeasureDragConstraints;if(!t||!OC(t))return!1;var r=t.current,o=this.visualElement.projection;if(!o||!o.layout)return!1;var i=function(e,t,n){var r=nk(e,n),o=t.scroll;return o&&(QS(r.x,o.x),QS(r.y,o.y)),r}(r,o.root,this.visualElement.getTransformPagePoint()),a=function(e,t){return{x:LS(e.x,t.x),y:LS(e.y,t.y)}}(o.layout.actual,i);if(n){var s=n(function(e){var t=e.x,n=e.y;return{top:n.min,right:t.max,bottom:n.max,left:t.min}}(a));this.hasMutatedConstraints=!!s,s&&(a=US(s))}return a},e.prototype.startAnimation=function(e){var t=this,n=this.getProps(),r=n.drag,o=n.dragMomentum,i=n.dragElastic,a=n.dragTransition,s=n.dragSnapToOrigin,u=n.onDragTransitionEnd,l=this.constraints||{},c=VS((function(n){var u;if(ik(n,r,t.currentDirection)){var c=null!==(u=null===l||void 0===l?void 0:l[n])&&void 0!==u?u:{};s&&(c={min:0,max:0});var f=i?200:1e6,d=i?40:1e7,p=rb(rb({type:"inertia",velocity:o?e[n]:0,bounceStiffness:f,bounceDamping:d,timeConstant:750,restDelta:1,restSpeed:10},a),c);return t.startAxisValueAnimation(n,p)}}));return Promise.all(c).then(u)},e.prototype.startAxisValueAnimation=function(e,t){return Lw(e,this.getAxisMotionValue(e),0,t)},e.prototype.stopAnimation=function(){var e=this;VS((function(t){return e.getAxisMotionValue(t).stop()}))},e.prototype.getAxisMotionValue=function(e){var t,n,r="_drag"+e.toUpperCase(),o=this.visualElement.getProps()[r];return o||this.visualElement.getValue(e,null!==(n=null===(t=this.visualElement.getProps().initial)||void 0===t?void 0:t[e])&&void 0!==n?n:0)},e.prototype.snapToCursor=function(e){var t=this;VS((function(n){if(ik(n,t.getProps().drag,t.currentDirection)){var r=t.visualElement.projection,o=t.getAxisMotionValue(n);if(r&&r.layout){var i=r.layout.actual[n],a=i.min,s=i.max;o.set(e[n]-yb(a,s,.5))}}}))},e.prototype.scalePositionWithinConstraints=function(){var e,t=this,n=this.getProps(),r=n.drag,o=n.dragConstraints,i=this.visualElement.projection;if(OC(o)&&i&&this.constraints){this.stopAnimation();var a={x:0,y:0};VS((function(e){var n=t.getAxisMotionValue(e);if(n){var r=n.get();a[e]=function(e,t){var n=.5,r=TS(e),o=TS(t);return o>r?n=gb(t.min,t.max-r,e.min):r>o&&(n=gb(e.min,e.max-o,t.min)),ub(0,1,n)}({min:r,max:r},t.constraints[e])}}));var s=this.visualElement.getProps().transformTemplate;this.visualElement.getInstance().style.transform=s?s({},""):"none",null===(e=i.root)||void 0===e||e.updateScroll(),i.updateLayout(),this.resolveConstraints(),VS((function(e){if(ik(e,r,null)){var n=t.getAxisMotionValue(e),o=t.constraints[e],i=o.min,s=o.max;n.set(yb(i,s,a[e]))}}))}},e.prototype.addListeners=function(){var e,t=this;rk.set(this.visualElement,this);var n=UE(this.visualElement.getInstance(),"pointerdown",(function(e){var n=t.getProps(),r=n.drag,o=n.dragListener;r&&(void 0===o||o)&&t.start(e)})),r=function(){OC(t.getProps().dragConstraints)&&(t.constraints=t.resolveRefConstraints())},o=this.visualElement.projection,i=o.addEventListener("measure",r);o&&!o.layout&&(null===(e=o.root)||void 0===e||e.updateScroll(),o.updateLayout()),r();var a=AE(window,"resize",(function(){return t.scalePositionWithinConstraints()}));return o.addEventListener("didUpdate",(function(e){var n=e.delta,r=e.hasLayoutChanged;t.isDragging&&r&&(VS((function(e){var r=t.getAxisMotionValue(e);r&&(t.originPoint[e]+=n[e].translate,r.set(r.get()+n[e].translate))})),t.visualElement.syncRender())})),function(){a(),n(),i()}},e.prototype.getProps=function(){var e=this.visualElement.getProps(),t=e.drag,n=void 0!==t&&t,r=e.dragDirectionLock,o=void 0!==r&&r,i=e.dragPropagation,a=void 0!==i&&i,s=e.dragConstraints,u=void 0!==s&&s,l=e.dragElastic,c=void 0===l?BS:l,f=e.dragMomentum,d=void 0===f||f;return rb(rb({},e),{drag:n,dragDirectionLock:o,dragPropagation:a,dragConstraints:u,dragElastic:c,dragMomentum:d})},e}();function ik(e,t,n){return(!0===t||t===e)&&(null===n||n===e)}var ak={pan:aS((function(t){var n=t.onPan,r=t.onPanStart,o=t.onPanEnd,i=t.onPanSessionStart,a=t.visualElement,s=n||r||o||i,u=(0,e.useRef)(null),l=(0,e.useContext)(_C).transformPagePoint,c={onSessionStart:i,onStart:r,onMove:n,onEnd:function(e,t){u.current=null,o&&o(e,t)}};(0,e.useEffect)((function(){null!==u.current&&u.current.updateHandlers(c)})),jE(a,"pointerdown",s&&function(e){u.current=new CS(e,c,{transformPagePoint:l})}),QE((function(){return u.current&&u.current.end()}))})),drag:aS((function(t){var n=t.dragControls,r=t.visualElement,o=bC((function(){return new ok(r)}));(0,e.useEffect)((function(){return n&&n.subscribe(o)}),[o,n]),(0,e.useEffect)((function(){return o.addListeners()}),[o])}))},sk=["LayoutMeasure","BeforeLayoutMeasure","LayoutUpdate","ViewportBoxUpdate","Update","Render","AnimationComplete","LayoutAnimationComplete","AnimationStart","LayoutAnimationStart","SetAxisTarget","Unmount"];var uk=function(e){var t=e.treeType,n=void 0===t?"":t,r=e.build,o=e.getBaseTarget,i=e.makeTargetAnimatable,a=e.measureViewportBox,s=e.render,u=e.readValueFromInstance,l=e.removeValueFromRenderState,c=e.sortNodePosition,f=e.scrapeMotionValuesFromProps;return function(e,t){var d=e.parent,p=e.props,h=e.presenceId,v=e.blockInitialAnimation,m=e.visualState,g=e.shouldReduceMotion;void 0===t&&(t={});var y,b,x=!1,w=m.latestValues,C=m.renderState,E=function(){var e=sk.map((function(){return new Uw})),t={},n={clearAllListeners:function(){return e.forEach((function(e){return e.clear()}))},updatePropListeners:function(e){sk.forEach((function(r){var o,i="on"+r,a=e[i];null===(o=t[r])||void 0===o||o.call(t),a&&(t[r]=n[i](a))}))}};return e.forEach((function(e,t){n["on"+sk[t]]=function(t){return e.add(t)},n["notify"+sk[t]]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.notify.apply(e,ab([],ib(t),!1))}})),n}(),S=new Map,k=new Map,_={},R=rb({},w);function I(){y&&x&&(T(),s(y,C,p.style,L.projection))}function T(){r(L,C,w,t,p)}function A(){E.notifyUpdate(w)}function D(e,t){var n=t.onChange((function(t){w[e]=t,p.onUpdate&&Jx.update(A,!1,!0)})),r=t.onRenderRequest(L.scheduleRender);k.set(e,(function(){n(),r()}))}var N=f(p);for(var P in N){var M=N[P];void 0!==w[P]&&$C(M)&&M.set(w[P],!1)}var O=eC(p),F=tC(p),L=rb(rb({treeType:n,current:null,depth:d?d.depth+1:0,parent:d,children:new Set,presenceId:h,shouldReduceMotion:g,variantChildren:F?new Set:void 0,isVisible:void 0,manuallyAnimateOnMount:Boolean(null===d||void 0===d?void 0:d.isMounted()),blockInitialAnimation:v,isMounted:function(){return Boolean(y)},mount:function(e){x=!0,y=L.current=e,L.projection&&L.projection.mount(e),F&&d&&!O&&(b=null===d||void 0===d?void 0:d.addVariantChild(L)),S.forEach((function(e,t){return D(t,e)})),null===d||void 0===d||d.children.add(L),L.setProps(p)},unmount:function(){var e;null===(e=L.projection)||void 0===e||e.unmount(),qx.update(A),qx.render(I),k.forEach((function(e){return e()})),null===b||void 0===b||b(),null===d||void 0===d||d.children.delete(L),E.clearAllListeners(),y=void 0,x=!1},addVariantChild:function(e){var t,n=L.getClosestVariantNode();if(n)return null===(t=n.variantChildren)||void 0===t||t.add(e),function(){return n.variantChildren.delete(e)}},sortNodePosition:function(e){return c&&n===e.treeType?c(L.getInstance(),e.getInstance()):0},getClosestVariantNode:function(){return F?L:null===d||void 0===d?void 0:d.getClosestVariantNode()},getLayoutId:function(){return p.layoutId},getInstance:function(){return y},getStaticValue:function(e){return w[e]},setStaticValue:function(e,t){return w[e]=t},getLatestValues:function(){return w},setVisibility:function(e){L.isVisible!==e&&(L.isVisible=e,L.scheduleRender())},makeTargetAnimatable:function(e,t){return void 0===t&&(t=!0),i(L,e,p,t)},measureViewportBox:function(){return a(y,p)},addValue:function(e,t){L.hasValue(e)&&L.removeValue(e),S.set(e,t),w[e]=t.get(),D(e,t)},removeValue:function(e){var t;S.delete(e),null===(t=k.get(e))||void 0===t||t(),k.delete(e),delete w[e],l(e,C)},hasValue:function(e){return S.has(e)},getValue:function(e,t){var n=S.get(e);return void 0===n&&void 0!==t&&(n=Hw(t),L.addValue(e,n)),n},forEachValue:function(e){return S.forEach(e)},readValue:function(e){var n;return null!==(n=w[e])&&void 0!==n?n:u(y,e,t)},setBaseTarget:function(e,t){R[e]=t},getBaseTarget:function(e){if(o){var t=o(p,e);if(void 0!==t&&!$C(t))return t}return R[e]}},E),{build:function(){return T(),C},scheduleRender:function(){Jx.render(I,!1,!0)},syncRender:I,setProps:function(e){(e.transformTemplate||p.transformTemplate)&&L.scheduleRender(),p=e,E.updatePropListeners(e),_=function(e,t,n){var r;for(var o in t){var i=t[o],a=n[o];if($C(i))e.addValue(o,i);else if($C(a))e.addValue(o,Hw(i));else if(a!==i)if(e.hasValue(o)){var s=e.getValue(o);!s.hasAnimated&&s.set(i)}else e.addValue(o,Hw(null!==(r=e.getStaticValue(o))&&void 0!==r?r:i))}for(var o in n)void 0===t[o]&&e.removeValue(o);return t}(L,f(p),_)},getProps:function(){return p},getVariant:function(e){var t;return null===(t=p.variants)||void 0===t?void 0:t[e]},getDefaultTransition:function(){return p.transition},getTransformPagePoint:function(){return p.transformPagePoint},getVariantContext:function(e){if(void 0===e&&(e=!1),e)return null===d||void 0===d?void 0:d.getVariantContext();if(!O){var t=(null===d||void 0===d?void 0:d.getVariantContext())||{};return void 0!==p.initial&&(t.initial=p.initial),t}for(var n={},r=0;r<ck;r++){var o=lk[r],i=p[o];(Qw(i)||!1===i)&&(n[o]=i)}return n}});return L}},lk=ab(["initial"],ib(dS),!1),ck=lk.length;function fk(e){return"string"===typeof e&&e.startsWith("var(--")}var dk=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function pk(e,t,n){void 0===n&&(n=1),'Max CSS variable fallback depth detected in property "'.concat(e,'". This may indicate a circular fallback dependency.');var r=ib(function(e){var t=dk.exec(e);if(!t)return[,];var n=ib(t,3);return[n[1],n[2]]}(e),2),o=r[0],i=r[1];if(o){var a=window.getComputedStyle(t).getPropertyValue(o);return a?a.trim():fk(i)?pk(i,t,n+1):i}}var hk,vk=new Set(["width","height","top","left","right","bottom","x","y"]),mk=function(e){return vk.has(e)},gk=function(e,t){e.set(t,!1),e.set(t)},yk=function(e){return e===kb||e===Lb};!function(e){e.width="width",e.height="height",e.left="left",e.right="right",e.top="top",e.bottom="bottom"}(hk||(hk={}));var bk=function(e,t){return parseFloat(e.split(", ")[t])},xk=function(e,t){return function(n,r){var o=r.transform;if("none"===o||!o)return 0;var i=o.match(/^matrix3d\((.+)\)$/);if(i)return bk(i[1],t);var a=o.match(/^matrix\((.+)\)$/);return a?bk(a[1],e):0}},wk=new Set(["x","y","z"]),Ck=sC.filter((function(e){return!wk.has(e)}));var Ek={width:function(e,t){var n=e.x,r=t.paddingLeft,o=void 0===r?"0":r,i=t.paddingRight,a=void 0===i?"0":i;return n.max-n.min-parseFloat(o)-parseFloat(a)},height:function(e,t){var n=e.y,r=t.paddingTop,o=void 0===r?"0":r,i=t.paddingBottom,a=void 0===i?"0":i;return n.max-n.min-parseFloat(o)-parseFloat(a)},top:function(e,t){var n=t.top;return parseFloat(n)},left:function(e,t){var n=t.left;return parseFloat(n)},bottom:function(e,t){var n=e.y,r=t.top;return parseFloat(r)+(n.max-n.min)},right:function(e,t){var n=e.x,r=t.left;return parseFloat(r)+(n.max-n.min)},x:xk(4,13),y:xk(5,14)},Sk=function(e,t,n,r){void 0===n&&(n={}),void 0===r&&(r={}),t=rb({},t),r=rb({},r);var o=Object.keys(t).filter(mk),i=[],a=!1,s=[];if(o.forEach((function(o){var u=e.getValue(o);if(e.hasValue(o)){var l,c=n[o],f=Kw(c),d=t[o];if(hw(d)){var p=d.length,h=null===d[0]?1:0;c=d[h],f=Kw(c);for(var v=h;v<p;v++)l?Kw(d[v]):(l=Kw(d[v]))===f||yk(f)&&yk(l)}else l=Kw(d);if(f!==l)if(yk(f)&&yk(l)){var m=u.get();"string"===typeof m&&u.set(parseFloat(m)),"string"===typeof d?t[o]=parseFloat(d):Array.isArray(d)&&l===Lb&&(t[o]=d.map(parseFloat))}else(null===f||void 0===f?void 0:f.transform)&&(null===l||void 0===l?void 0:l.transform)&&(0===c||0===d)?0===c?u.set(l.transform(c)):t[o]=f.transform(d):(a||(i=function(e){var t=[];return Ck.forEach((function(n){var r=e.getValue(n);void 0!==r&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))})),t.length&&e.syncRender(),t}(e),a=!0),s.push(o),r[o]=void 0!==r[o]?r[o]:t[o],gk(u,d))}})),s.length){var u=s.indexOf("height")>=0?window.pageYOffset:null,l=function(e,t,n){var r=t.measureViewportBox(),o=t.getInstance(),i=getComputedStyle(o),a=i.display,s={};"none"===a&&t.setStaticValue("display",e.display||"block"),n.forEach((function(e){s[e]=Ek[e](r,i)})),t.syncRender();var u=t.measureViewportBox();return n.forEach((function(n){var r=t.getValue(n);gk(r,s[n]),e[n]=Ek[n](u,i)})),e}(t,e,s);return i.length&&i.forEach((function(t){var n=ib(t,2),r=n[0],o=n[1];e.getValue(r).set(o)})),e.syncRender(),null!==u&&window.scrollTo({top:u}),{target:l,transitionEnd:r}}return{target:t,transitionEnd:r}};function kk(e,t,n,r){return function(e){return Object.keys(e).some(mk)}(t)?Sk(e,t,n,r):{target:t,transitionEnd:r}}var _k=function(e,t,n,r){var o=function(e,t,n){var r,o=ob(t,[]),i=e.getInstance();if(!(i instanceof Element))return{target:o,transitionEnd:n};for(var a in n&&(n=rb({},n)),e.forEachValue((function(e){var t=e.get();if(fk(t)){var n=pk(t,i);n&&e.set(n)}})),o){var s=o[a];if(fk(s)){var u=pk(s,i);u&&(o[a]=u,n&&(null!==(r=n[a])&&void 0!==r||(n[a]=s)))}}return{target:o,transitionEnd:n}}(e,t,r);return kk(e,t=o.target,n,r=o.transitionEnd)};var Rk={treeType:"dom",readValueFromInstance:function(e,t){if(cC(t)){var n=Rw(t);return n&&n.default||0}var r,o=(r=e,window.getComputedStyle(r));return(QC(t)?o.getPropertyValue(t):o[t])||0},sortNodePosition:function(e,t){return 2&e.compareDocumentPosition(t)?1:-1},getBaseTarget:function(e,t){var n;return null===(n=e.style)||void 0===n?void 0:n[t]},measureViewportBox:function(e,t){return nk(e,t.transformPagePoint)},resetTransform:function(e,t,n){var r=n.transformTemplate;t.style.transform=r?r({},""):"none",e.scheduleRender()},restoreTransform:function(e,t){e.style.transform=t.style.transform},removeValueFromRenderState:function(e,t){var n=t.vars,r=t.style;delete n[e],delete r[e]},makeTargetAnimatable:function(e,t,n,r){var o=n.transformValues;void 0===r&&(r=!0);var i=t.transition,a=t.transitionEnd,s=ob(t,["transition","transitionEnd"]),u=function(e,t,n){var r,o,i={};for(var a in e)i[a]=null!==(r=iC(a,t))&&void 0!==r?r:null===(o=n.getValue(a))||void 0===o?void 0:o.get();return i}(s,i||{},e);if(o&&(a&&(a=o(a)),s&&(s=o(s)),u&&(u=o(u))),r){!function(e,t,n){var r,o,i,a,s=Object.keys(t).filter((function(t){return!e.hasValue(t)})),u=s.length;if(u)for(var l=0;l<u;l++){var c=s[l],f=t[c],d=null;Array.isArray(f)&&(d=f[0]),null===d&&(d=null!==(o=null!==(r=n[c])&&void 0!==r?r:e.readValue(c))&&void 0!==o?o:t[c]),void 0!==d&&null!==d&&("string"===typeof d&&(Bw(d)||zw(d))?d=parseFloat(d):!$w(d)&&nx.test(f)&&(d=Iw(c,f)),e.addValue(c,Hw(d)),null!==(i=(a=n)[c])&&void 0!==i||(a[c]=d),e.setBaseTarget(c,d))}}(e,s,u);var l=_k(e,s,u,a);a=l.transitionEnd,s=l.target}return rb({transition:i,transitionEnd:a},s)},scrapeMotionValuesFromProps:xE,build:function(e,t,n,r,o){void 0!==e.isVisible&&(t.style.visibility=e.isVisible?"visible":"hidden"),ZC(t,n,r,o.transformTemplate)},render:gE},Ik=uk(Rk),Tk=uk(rb(rb({},Rk),{getBaseTarget:function(e,t){return e[t]},readValueFromInstance:function(e,t){var n;return cC(t)?(null===(n=Rw(t))||void 0===n?void 0:n.default)||0:(t=yE.has(t)?t:mE(t),e.getAttribute(t))},scrapeMotionValuesFromProps:wE,build:function(e,t,n,r,o){fE(t,n,r,o.transformTemplate)},render:bE})),Ak=function(e,t){return qC(e)?Tk(t,{enableHardwareAcceleration:!1}):Ik(t,{enableHardwareAcceleration:!0})};function Dk(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}var Nk={correct:function(e,t){if(!t.target)return e;if("string"===typeof e){if(!Lb.test(e))return e;e=parseFloat(e)}var n=Dk(e,t.target.x),r=Dk(e,t.target.y);return"".concat(n,"% ").concat(r,"%")}},Pk="_$css",Mk={correct:function(e,t){var n=t.treeScale,r=t.projectionDelta,o=e,i=e.includes("var("),a=[];i&&(e=e.replace(dk,(function(e){return a.push(e),Pk})));var s=nx.parse(e);if(s.length>5)return o;var u=nx.createTransformer(e),l="number"!==typeof s[0]?1:0,c=r.x.scale*n.x,f=r.y.scale*n.y;s[0+l]/=c,s[1+l]/=f;var d=yb(c,f,.5);"number"===typeof s[2+l]&&(s[2+l]/=d),"number"===typeof s[3+l]&&(s[3+l]/=d);var p=u(s);if(i){var h=0;p=p.replace(Pk,(function(){var e=a[h];return h++,e}))}return p}},Ok=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return nb(t,e),t.prototype.componentDidMount=function(){var e,t=this,n=this.props,r=n.visualElement,o=n.layoutGroup,i=n.switchLayoutGroup,a=n.layoutId,s=r.projection;e=Fk,Object.assign(KC,e),s&&((null===o||void 0===o?void 0:o.group)&&o.group.add(s),(null===i||void 0===i?void 0:i.register)&&a&&i.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",(function(){t.safeToRemove()})),s.setOptions(rb(rb({},s.options),{onExitComplete:function(){return t.safeToRemove()}}))),BC.hasEverUpdated=!0},t.prototype.getSnapshotBeforeUpdate=function(e){var t=this,n=this.props,r=n.layoutDependency,o=n.visualElement,i=n.drag,a=n.isPresent,s=o.projection;return s?(s.isPresent=a,i||e.layoutDependency!==r||void 0===r?s.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?s.promote():s.relegate()||Jx.postRender((function(){var e;(null===(e=s.getStack())||void 0===e?void 0:e.members.length)||t.safeToRemove()}))),null):null},t.prototype.componentDidUpdate=function(){var e=this.props.visualElement.projection;e&&(e.root.didUpdate(),!e.currentAnimation&&e.isLead()&&this.safeToRemove())},t.prototype.componentWillUnmount=function(){var e=this.props,t=e.visualElement,n=e.layoutGroup,r=e.switchLayoutGroup,o=t.projection;o&&(o.scheduleCheckAfterUnmount(),(null===n||void 0===n?void 0:n.group)&&n.group.remove(o),(null===r||void 0===r?void 0:r.deregister)&&r.deregister(o))},t.prototype.safeToRemove=function(){var e=this.props.safeToRemove;null===e||void 0===e||e()},t.prototype.render=function(){return null},t}(e.Component);var Fk={borderRadius:rb(rb({},Nk),{applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]}),borderTopLeftRadius:Nk,borderTopRightRadius:Nk,borderBottomLeftRadius:Nk,borderBottomRightRadius:Nk,boxShadow:Mk},Lk={measureLayout:function(t){var n=ib(cS(),2),r=n[0],o=n[1],i=(0,e.useContext)(WC);return e.createElement(Ok,rb({},t,{layoutGroup:i,switchLayoutGroup:(0,e.useContext)(VC),isPresent:r,safeToRemove:o}))}};var Bk=["TopLeft","TopRight","BottomLeft","BottomRight"],zk=Bk.length,Wk=function(e){return"string"===typeof e?parseFloat(e):e},Vk=function(e){return"number"===typeof e||Lb.test(e)};function Uk(e,t){var n;return null!==(n=e[t])&&void 0!==n?n:e.borderRadius}var jk=Gk(0,.5,kx),Hk=Gk(.5,.95,xx);function Gk(e,t,n){return function(r){return r<e?0:r>t?1:n(gb(e,t,r))}}function qk(e,t){e.min=t.min,e.max=t.max}function Kk(e,t){qk(e.x,t.x),qk(e.y,t.y)}function Xk(e,t,n,r,o){return e=KS(e-=t,1/n,r),void 0!==o&&(e=KS(e,1/o,r)),e}function $k(e,t,n,r,o){var i=ib(n,3),a=i[0],s=i[1],u=i[2];!function(e,t,n,r,o,i,a){if(void 0===t&&(t=0),void 0===n&&(n=1),void 0===r&&(r=.5),void 0===i&&(i=e),void 0===a&&(a=e),Fb.test(t)&&(t=parseFloat(t),t=yb(a.min,a.max,t/100)-a.min),"number"===typeof t){var s=yb(i.min,i.max,r);e===i&&(s-=t),e.min=Xk(e.min,t,n,s,o),e.max=Xk(e.max,t,n,s,o)}}(e,t[a],t[s],t[u],t.scale,r,o)}var Yk=["x","scaleX","originX"],Qk=["y","scaleY","originY"];function Jk(e,t,n,r){$k(e.x,t,Yk,null===n||void 0===n?void 0:n.x,null===r||void 0===r?void 0:r.x),$k(e.y,t,Qk,null===n||void 0===n?void 0:n.y,null===r||void 0===r?void 0:r.y)}function Zk(e){return 0===e.translate&&1===e.scale}function e_(e){return Zk(e.x)&&Zk(e.y)}function t_(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}var n_=function(){function e(){this.members=[]}return e.prototype.add=function(e){Ww(this.members,e),e.scheduleRender()},e.prototype.remove=function(e){if(Vw(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){var t=this.members[this.members.length-1];t&&this.promote(t)}},e.prototype.relegate=function(e){var t,n=this.members.findIndex((function(t){return e===t}));if(0===n)return!1;for(var r=n;r>=0;r--){var o=this.members[r];if(!1!==o.isPresent){t=o;break}}return!!t&&(this.promote(t),!0)},e.prototype.promote=function(e,t){var n,r=this.lead;e!==r&&(this.prevLead=r,this.lead=e,e.show(),r&&(r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues,e.snapshot.isShared=!0),(null===(n=e.root)||void 0===n?void 0:n.isUpdating)&&(e.isLayoutDirty=!0),!1===e.options.crossfade&&r.hide()))},e.prototype.exitAnimationComplete=function(){this.members.forEach((function(e){var t,n,r,o,i;null===(n=(t=e.options).onExitComplete)||void 0===n||n.call(t),null===(i=null===(r=e.resumingFrom)||void 0===r?void 0:(o=r.options).onExitComplete)||void 0===i||i.call(o)}))},e.prototype.scheduleRender=function(){this.members.forEach((function(e){e.instance&&e.scheduleRender(!1)}))},e.prototype.removeLeadSnapshot=function(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)},e}();function r_(e,t,n){var r=e.x.translate/t.x,o=e.y.translate/t.y,i="translate3d(".concat(r,"px, ").concat(o,"px, 0) ");if(i+="scale(".concat(1/t.x,", ").concat(1/t.y,") "),n){var a=n.rotate,s=n.rotateX,u=n.rotateY;a&&(i+="rotate(".concat(a,"deg) ")),s&&(i+="rotateX(".concat(s,"deg) ")),u&&(i+="rotateY(".concat(u,"deg) "))}var l=e.x.scale*t.x,c=e.y.scale*t.y;return"translate3d(0px, 0px, 0) scale(1, 1) scale(1, 1)"===(i+="scale(".concat(l,", ").concat(c,")"))?"none":i}var o_=function(e,t){return e.depth-t.depth},i_=function(){function e(){this.children=[],this.isDirty=!1}return e.prototype.add=function(e){Ww(this.children,e),this.isDirty=!0},e.prototype.remove=function(e){Vw(this.children,e),this.isDirty=!0},e.prototype.forEach=function(e){this.isDirty&&this.children.sort(o_),this.isDirty=!1,this.children.forEach(e)},e}();function a_(e){var t=e.attachResizeListener,n=e.defaultParent,r=e.measureScroll,o=e.checkIsScrollRoot,i=e.resetTransform;return function(){function e(e,t,r){var o=this;void 0===t&&(t={}),void 0===r&&(r=null===n||void 0===n?void 0:n()),this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.potentialNodes=new Map,this.checkUpdateFailed=function(){o.isUpdating&&(o.isUpdating=!1,o.clearAllSnapshots())},this.updateProjection=function(){o.nodes.forEach(p_),o.nodes.forEach(h_)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.id=e,this.latestValues=t,this.root=r?r.root||r:this,this.path=r?ab(ab([],ib(r.path),!1),[r],!1):[],this.parent=r,this.depth=r?r.depth+1:0,e&&this.root.registerPotentialNode(e,this);for(var i=0;i<this.path.length;i++)this.path[i].shouldResetTransform=!0;this.root===this&&(this.nodes=new i_)}return e.prototype.addEventListener=function(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new Uw),this.eventHandlers.get(e).add(t)},e.prototype.notifyListeners=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this.eventHandlers.get(e);null===r||void 0===r||r.notify.apply(r,ab([],ib(t),!1))},e.prototype.hasListeners=function(e){return this.eventHandlers.has(e)},e.prototype.registerPotentialNode=function(e,t){this.potentialNodes.set(e,t)},e.prototype.mount=function(e,n){var r,o=this;if(void 0===n&&(n=!1),!this.instance){this.isSVG=e instanceof SVGElement&&"svg"!==e.tagName,this.instance=e;var i=this.options,a=i.layoutId,s=i.layout,u=i.visualElement;if(u&&!u.getInstance()&&u.mount(e),this.root.nodes.add(this),null===(r=this.parent)||void 0===r||r.children.add(this),this.id&&this.root.potentialNodes.delete(this.id),n&&(s||a)&&(this.isLayoutDirty=!0),t){var l,c=function(){return o.root.updateBlockedByResize=!1};t(e,(function(){o.root.updateBlockedByResize=!0,clearTimeout(l),l=window.setTimeout(c,250),BC.hasAnimatedSinceResize&&(BC.hasAnimatedSinceResize=!1,o.nodes.forEach(d_))}))}a&&this.root.registerSharedNode(a,this),!1!==this.options.animate&&u&&(a||s)&&this.addEventListener("didUpdate",(function(e){var t,n,r,i,a,s=e.delta,l=e.hasLayoutChanged,c=e.hasRelativeTargetChanged,f=e.layout;if(o.isTreeAnimationBlocked())return o.target=void 0,void(o.relativeTarget=void 0);var d=null!==(n=null!==(t=o.options.transition)&&void 0!==t?t:u.getDefaultTransition())&&void 0!==n?n:x_,p=u.getProps(),h=p.onLayoutAnimationStart,v=p.onLayoutAnimationComplete,m=!o.targetLayout||!t_(o.targetLayout,f)||c,g=!l&&c;if((null===(r=o.resumeFrom)||void 0===r?void 0:r.instance)||g||l&&(m||!o.currentAnimation)){o.resumeFrom&&(o.resumingFrom=o.resumeFrom,o.resumingFrom.resumingFrom=void 0),o.setAnimationOrigin(s,g);var y=rb(rb({},Fw(d,"layout")),{onPlay:h,onComplete:v});u.shouldReduceMotion&&(y.delay=0,y.type=!1),o.startAnimation(y)}else l||0!==o.animationProgress||o.finishAnimation(),o.isLead()&&(null===(a=(i=o.options).onExitComplete)||void 0===a||a.call(i));o.targetLayout=f}))}},e.prototype.unmount=function(){var e,t;this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this),null===(e=this.getStack())||void 0===e||e.remove(this),null===(t=this.parent)||void 0===t||t.children.delete(this),this.instance=void 0,qx.preRender(this.updateProjection)},e.prototype.blockUpdate=function(){this.updateManuallyBlocked=!0},e.prototype.unblockUpdate=function(){this.updateManuallyBlocked=!1},e.prototype.isUpdateBlocked=function(){return this.updateManuallyBlocked||this.updateBlockedByResize},e.prototype.isTreeAnimationBlocked=function(){var e;return this.isAnimationBlocked||(null===(e=this.parent)||void 0===e?void 0:e.isTreeAnimationBlocked())||!1},e.prototype.startUpdate=function(){var e;this.isUpdateBlocked()||(this.isUpdating=!0,null===(e=this.nodes)||void 0===e||e.forEach(v_))},e.prototype.willUpdate=function(e){var t,n,r;if(void 0===e&&(e=!0),this.root.isUpdateBlocked())null===(n=(t=this.options).onExitComplete)||void 0===n||n.call(t);else if(!this.root.isUpdating&&this.root.startUpdate(),!this.isLayoutDirty){this.isLayoutDirty=!0;for(var o=0;o<this.path.length;o++){var i=this.path[o];i.shouldResetTransform=!0,i.updateScroll()}var a=this.options,s=a.layoutId,u=a.layout;if(void 0!==s||u){var l=null===(r=this.options.visualElement)||void 0===r?void 0:r.getProps().transformTemplate;this.prevTransformTemplateValue=null===l||void 0===l?void 0:l(this.latestValues,""),this.updateSnapshot(),e&&this.notifyListeners("willUpdate")}}},e.prototype.didUpdate=function(){if(this.isUpdateBlocked())return this.unblockUpdate(),this.clearAllSnapshots(),void this.nodes.forEach(c_);this.isUpdating&&(this.isUpdating=!1,this.potentialNodes.size&&(this.potentialNodes.forEach(w_),this.potentialNodes.clear()),this.nodes.forEach(f_),this.nodes.forEach(s_),this.nodes.forEach(u_),this.clearAllSnapshots(),Kx.update(),Kx.preRender(),Kx.render())},e.prototype.clearAllSnapshots=function(){this.nodes.forEach(l_),this.sharedNodes.forEach(m_)},e.prototype.scheduleUpdateProjection=function(){Jx.preRender(this.updateProjection,!1,!0)},e.prototype.scheduleCheckAfterUnmount=function(){var e=this;Jx.postRender((function(){e.isLayoutDirty?e.root.didUpdate():e.root.checkUpdateFailed()}))},e.prototype.updateSnapshot=function(){if(!this.snapshot&&this.instance){var e=this.measure(),t=this.removeTransform(this.removeElementScroll(e));E_(t),this.snapshot={measured:e,layout:t,latestValues:{}}}},e.prototype.updateLayout=function(){var e;if(this.instance&&(this.updateScroll(),this.options.alwaysMeasureLayout&&this.isLead()||this.isLayoutDirty)){if(this.resumeFrom&&!this.resumeFrom.instance)for(var t=0;t<this.path.length;t++){this.path[t].updateScroll()}var n=this.measure();E_(n);var r=this.layout;this.layout={measured:n,actual:this.removeElementScroll(n)},this.layoutCorrected={x:{min:0,max:0},y:{min:0,max:0}},this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.actual),null===(e=this.options.visualElement)||void 0===e||e.notifyLayoutMeasure(this.layout.actual,null===r||void 0===r?void 0:r.actual)}},e.prototype.updateScroll=function(){this.options.layoutScroll&&this.instance&&(this.isScrollRoot=o(this.instance),this.scroll=r(this.instance))},e.prototype.resetTransform=function(){var e;if(i){var t=this.isLayoutDirty||this.shouldResetTransform,n=this.projectionDelta&&!e_(this.projectionDelta),r=null===(e=this.options.visualElement)||void 0===e?void 0:e.getProps().transformTemplate,o=null===r||void 0===r?void 0:r(this.latestValues,""),a=o!==this.prevTransformTemplateValue;t&&(n||GS(this.latestValues)||a)&&(i(this.instance,o),this.shouldResetTransform=!1,this.scheduleRender())}},e.prototype.measure=function(){var e=this.options.visualElement;if(!e)return{x:{min:0,max:0},y:{min:0,max:0}};var t=e.measureViewportBox(),n=this.root.scroll;return n&&(QS(t.x,n.x),QS(t.y,n.y)),t},e.prototype.removeElementScroll=function(e){var t={x:{min:0,max:0},y:{min:0,max:0}};Kk(t,e);for(var n=0;n<this.path.length;n++){var r=this.path[n],o=r.scroll,i=r.options,a=r.isScrollRoot;if(r!==this.root&&o&&i.layoutScroll){if(a){Kk(t,e);var s=this.root.scroll;s&&(QS(t.x,-s.x),QS(t.y,-s.y))}QS(t.x,o.x),QS(t.y,o.y)}}return t},e.prototype.applyTransform=function(e,t){void 0===t&&(t=!1);var n={x:{min:0,max:0},y:{min:0,max:0}};Kk(n,e);for(var r=0;r<this.path.length;r++){var o=this.path[r];!t&&o.options.layoutScroll&&o.scroll&&o!==o.root&&tk(n,{x:-o.scroll.x,y:-o.scroll.y}),GS(o.latestValues)&&tk(n,o.latestValues)}return GS(this.latestValues)&&tk(n,this.latestValues),n},e.prototype.removeTransform=function(e){var t,n={x:{min:0,max:0},y:{min:0,max:0}};Kk(n,e);for(var r=0;r<this.path.length;r++){var o=this.path[r];if(o.instance&&GS(o.latestValues)){HS(o.latestValues)&&o.updateSnapshot();var i={x:{min:0,max:0},y:{min:0,max:0}};Kk(i,o.measure()),Jk(n,o.latestValues,null===(t=o.snapshot)||void 0===t?void 0:t.layout,i)}}return GS(this.latestValues)&&Jk(n,this.latestValues),n},e.prototype.setTargetDelta=function(e){this.targetDelta=e,this.root.scheduleUpdateProjection()},e.prototype.setOptions=function(e){var t;this.options=rb(rb(rb({},this.options),e),{crossfade:null===(t=e.crossfade)||void 0===t||t})},e.prototype.clearMeasurements=function(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1},e.prototype.resolveTargetDelta=function(){var e,t,n,r,o=this.options,i=o.layout,a=o.layoutId;this.layout&&(i||a)&&(this.targetDelta||this.relativeTarget||(this.relativeParent=this.getClosestProjectingParent(),this.relativeParent&&this.relativeParent.layout&&(this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},OS(this.relativeTargetOrigin,this.layout.actual,this.relativeParent.layout.actual),Kk(this.relativeTarget,this.relativeTargetOrigin))),(this.relativeTarget||this.targetDelta)&&(this.target||(this.target={x:{min:0,max:0},y:{min:0,max:0}},this.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}}),this.relativeTarget&&this.relativeTargetOrigin&&(null===(e=this.relativeParent)||void 0===e?void 0:e.target)?(t=this.target,n=this.relativeTarget,r=this.relativeParent.target,PS(t.x,n.x,r.x),PS(t.y,n.y,r.y)):this.targetDelta?(Boolean(this.resumingFrom)?this.target=this.applyTransform(this.layout.actual):Kk(this.target,this.layout.actual),YS(this.target,this.targetDelta)):Kk(this.target,this.layout.actual),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,this.relativeParent=this.getClosestProjectingParent(),this.relativeParent&&Boolean(this.relativeParent.resumingFrom)===Boolean(this.resumingFrom)&&!this.relativeParent.options.layoutScroll&&this.relativeParent.target&&(this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},OS(this.relativeTargetOrigin,this.target,this.relativeParent.target),Kk(this.relativeTarget,this.relativeTargetOrigin)))))},e.prototype.getClosestProjectingParent=function(){if(this.parent&&!GS(this.parent.latestValues))return(this.parent.relativeTarget||this.parent.targetDelta)&&this.parent.layout?this.parent:this.parent.getClosestProjectingParent()},e.prototype.calcProjection=function(){var e,t=this.options,n=t.layout,r=t.layoutId;if(this.isTreeAnimating=Boolean((null===(e=this.parent)||void 0===e?void 0:e.isTreeAnimating)||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),this.layout&&(n||r)){var o=this.getLead();Kk(this.layoutCorrected,this.layout.actual),function(e,t,n,r){var o,i;void 0===r&&(r=!1);var a=n.length;if(a){var s,u;t.x=t.y=1;for(var l=0;l<a;l++)u=(s=n[l]).projectionDelta,"contents"!==(null===(i=null===(o=s.instance)||void 0===o?void 0:o.style)||void 0===i?void 0:i.display)&&(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&tk(e,{x:-s.scroll.x,y:-s.scroll.y}),u&&(t.x*=u.x.scale,t.y*=u.y.scale,YS(e,u)),r&&GS(s.latestValues)&&tk(e,s.latestValues))}}(this.layoutCorrected,this.treeScale,this.path,Boolean(this.resumingFrom)||this!==o);var i=o.target;if(i){this.projectionDelta||(this.projectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDeltaWithTransform={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}});var a=this.treeScale.x,s=this.treeScale.y,u=this.projectionTransform;NS(this.projectionDelta,this.layoutCorrected,i,this.latestValues),this.projectionTransform=r_(this.projectionDelta,this.treeScale),this.projectionTransform===u&&this.treeScale.x===a&&this.treeScale.y===s||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",i))}}},e.prototype.hide=function(){this.isVisible=!1},e.prototype.show=function(){this.isVisible=!0},e.prototype.scheduleRender=function(e){var t,n,r;void 0===e&&(e=!0),null===(n=(t=this.options).scheduleRender)||void 0===n||n.call(t),e&&(null===(r=this.getStack())||void 0===r||r.scheduleRender()),this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)},e.prototype.setAnimationOrigin=function(e,t){var n,r=this;void 0===t&&(t=!1);var o=this.snapshot,i=(null===o||void 0===o?void 0:o.latestValues)||{},a=rb({},this.latestValues),s={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};this.relativeTarget=this.relativeTargetOrigin=void 0,this.attemptToResolveRelativeTarget=!t;var u={x:{min:0,max:0},y:{min:0,max:0}},l=null===o||void 0===o?void 0:o.isShared,c=((null===(n=this.getStack())||void 0===n?void 0:n.members.length)||0)<=1,f=Boolean(l&&!c&&!0===this.options.crossfade&&!this.path.some(b_));this.animationProgress=0,this.mixTargetDelta=function(t){var n,o=t/1e3;g_(s.x,e.x,o),g_(s.y,e.y,o),r.setTargetDelta(s),r.relativeTarget&&r.relativeTargetOrigin&&r.layout&&(null===(n=r.relativeParent)||void 0===n?void 0:n.layout)&&(OS(u,r.layout.actual,r.relativeParent.layout.actual),function(e,t,n,r){y_(e.x,t.x,n.x,r),y_(e.y,t.y,n.y,r)}(r.relativeTarget,r.relativeTargetOrigin,u,o)),l&&(r.animationValues=a,function(e,t,n,r,o,i){var a,s,u,l;o?(e.opacity=yb(0,null!==(a=n.opacity)&&void 0!==a?a:1,jk(r)),e.opacityExit=yb(null!==(s=t.opacity)&&void 0!==s?s:1,0,Hk(r))):i&&(e.opacity=yb(null!==(u=t.opacity)&&void 0!==u?u:1,null!==(l=n.opacity)&&void 0!==l?l:1,r));for(var c=0;c<zk;c++){var f="border".concat(Bk[c],"Radius"),d=Uk(t,f),p=Uk(n,f);void 0===d&&void 0===p||(d||(d=0),p||(p=0),0===d||0===p||Vk(d)===Vk(p)?(e[f]=Math.max(yb(Wk(d),Wk(p),r),0),(Fb.test(p)||Fb.test(d))&&(e[f]+="%")):e[f]=p)}(t.rotate||n.rotate)&&(e.rotate=yb(t.rotate||0,n.rotate||0,r))}(a,i,r.latestValues,o,f,c)),r.root.scheduleUpdateProjection(),r.scheduleRender(),r.animationProgress=o},this.mixTargetDelta(0)},e.prototype.startAnimation=function(e){var t,n,r=this;this.notifyListeners("animationStart"),null===(t=this.currentAnimation)||void 0===t||t.stop(),this.resumingFrom&&(null===(n=this.resumingFrom.currentAnimation)||void 0===n||n.stop()),this.pendingAnimation&&(qx.update(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Jx.update((function(){BC.hasAnimatedSinceResize=!0,r.currentAnimation=function(e,t,n){void 0===n&&(n={});var r=$C(e)?e:Hw(e);return Lw("",r,t,n),{stop:function(){return r.stop()},isAnimating:function(){return r.isAnimating()}}}(0,1e3,rb(rb({},e),{onUpdate:function(t){var n;r.mixTargetDelta(t),null===(n=e.onUpdate)||void 0===n||n.call(e,t)},onComplete:function(){var t;null===(t=e.onComplete)||void 0===t||t.call(e),r.completeAnimation()}})),r.resumingFrom&&(r.resumingFrom.currentAnimation=r.currentAnimation),r.pendingAnimation=void 0}))},e.prototype.completeAnimation=function(){var e;this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0),null===(e=this.getStack())||void 0===e||e.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")},e.prototype.finishAnimation=function(){var e;this.currentAnimation&&(null===(e=this.mixTargetDelta)||void 0===e||e.call(this,1e3),this.currentAnimation.stop()),this.completeAnimation()},e.prototype.applyTransformsToTarget=function(){var e=this.getLead(),t=e.targetWithTransforms,n=e.target,r=e.layout,o=e.latestValues;t&&n&&r&&(Kk(t,n),tk(t,o),NS(this.projectionDeltaWithTransform,this.layoutCorrected,t,o))},e.prototype.registerSharedNode=function(e,t){var n,r,o;this.sharedNodes.has(e)||this.sharedNodes.set(e,new n_),this.sharedNodes.get(e).add(t),t.promote({transition:null===(n=t.options.initialPromotionConfig)||void 0===n?void 0:n.transition,preserveFollowOpacity:null===(o=null===(r=t.options.initialPromotionConfig)||void 0===r?void 0:r.shouldPreserveFollowOpacity)||void 0===o?void 0:o.call(r,t)})},e.prototype.isLead=function(){var e=this.getStack();return!e||e.lead===this},e.prototype.getLead=function(){var e;return this.options.layoutId&&(null===(e=this.getStack())||void 0===e?void 0:e.lead)||this},e.prototype.getPrevLead=function(){var e;return this.options.layoutId?null===(e=this.getStack())||void 0===e?void 0:e.prevLead:void 0},e.prototype.getStack=function(){var e=this.options.layoutId;if(e)return this.root.sharedNodes.get(e)},e.prototype.promote=function(e){var t=void 0===e?{}:e,n=t.needsReset,r=t.transition,o=t.preserveFollowOpacity,i=this.getStack();i&&i.promote(this,o),n&&(this.projectionDelta=void 0,this.needsReset=!0),r&&this.setOptions({transition:r})},e.prototype.relegate=function(){var e=this.getStack();return!!e&&e.relegate(this)},e.prototype.resetRotation=function(){var e=this.options.visualElement;if(e){for(var t=!1,n={},r=0;r<aC.length;r++){var o="rotate"+aC[r];e.getStaticValue(o)&&(t=!0,n[o]=e.getStaticValue(o),e.setStaticValue(o,0))}if(t){for(var o in null===e||void 0===e||e.syncRender(),n)e.setStaticValue(o,n[o]);e.scheduleRender()}}},e.prototype.getProjectionStyles=function(e){var t,n,r,o,i,a;void 0===e&&(e={});var s={};if(!this.instance||this.isSVG)return s;if(!this.isVisible)return{visibility:"hidden"};s.visibility="";var u=null===(t=this.options.visualElement)||void 0===t?void 0:t.getProps().transformTemplate;if(this.needsReset)return this.needsReset=!1,s.opacity="",s.pointerEvents=EE(e.pointerEvents)||"",s.transform=u?u(this.latestValues,""):"none",s;var l=this.getLead();if(!this.projectionDelta||!this.layout||!l.target){var c={};return this.options.layoutId&&(c.opacity=null!==(n=this.latestValues.opacity)&&void 0!==n?n:1,c.pointerEvents=EE(e.pointerEvents)||""),this.hasProjected&&!GS(this.latestValues)&&(c.transform=u?u({},""):"none",this.hasProjected=!1),c}var f=l.animationValues||l.latestValues;this.applyTransformsToTarget(),s.transform=r_(this.projectionDeltaWithTransform,this.treeScale,f),u&&(s.transform=u(f,s.transform));var d=this.projectionDelta,p=d.x,h=d.y;for(var v in s.transformOrigin="".concat(100*p.origin,"% ").concat(100*h.origin,"% 0"),l.animationValues?s.opacity=l===this?null!==(o=null!==(r=f.opacity)&&void 0!==r?r:this.latestValues.opacity)&&void 0!==o?o:1:this.preserveOpacity?this.latestValues.opacity:f.opacityExit:s.opacity=l===this?null!==(i=f.opacity)&&void 0!==i?i:"":null!==(a=f.opacityExit)&&void 0!==a?a:0,KC)if(void 0!==f[v]){var m=KC[v],g=m.correct,y=m.applyTo,b=g(f[v],l);if(y)for(var x=y.length,w=0;w<x;w++)s[y[w]]=b;else s[v]=b}return this.options.layoutId&&(s.pointerEvents=l===this?EE(e.pointerEvents)||"":"none"),s},e.prototype.clearSnapshot=function(){this.resumeFrom=this.snapshot=void 0},e.prototype.resetTree=function(){this.root.nodes.forEach((function(e){var t;return null===(t=e.currentAnimation)||void 0===t?void 0:t.stop()})),this.root.nodes.forEach(c_),this.root.sharedNodes.clear()},e}()}function s_(e){e.updateLayout()}function u_(e){var t,n,r,o,i=null!==(n=null===(t=e.resumeFrom)||void 0===t?void 0:t.snapshot)&&void 0!==n?n:e.snapshot;if(e.isLead()&&e.layout&&i&&e.hasListeners("didUpdate")){var a=e.layout,s=a.actual,u=a.measured;"size"===e.options.animationType?VS((function(e){var t=i.isShared?i.measured[e]:i.layout[e],n=TS(t);t.min=s[e].min,t.max=t.min+n})):"position"===e.options.animationType&&VS((function(e){var t=i.isShared?i.measured[e]:i.layout[e],n=TS(s[e]);t.max=t.min+n}));var l={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};NS(l,s,i.layout);var c={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};i.isShared?NS(c,e.applyTransform(u,!0),i.measured):NS(c,s,i.layout);var f=!e_(l),d=!1;if(!e.resumeFrom&&(e.relativeParent=e.getClosestProjectingParent(),e.relativeParent&&!e.relativeParent.resumeFrom)){var p=e.relativeParent,h=p.snapshot,v=p.layout;if(h&&v){var m={x:{min:0,max:0},y:{min:0,max:0}};OS(m,i.layout,h.layout);var g={x:{min:0,max:0},y:{min:0,max:0}};OS(g,s,v.actual),t_(m,g)||(d=!0)}}e.notifyListeners("didUpdate",{layout:s,snapshot:i,delta:c,layoutDelta:l,hasLayoutChanged:f,hasRelativeTargetChanged:d})}else e.isLead()&&(null===(o=(r=e.options).onExitComplete)||void 0===o||o.call(r));e.options.transition=void 0}function l_(e){e.clearSnapshot()}function c_(e){e.clearMeasurements()}function f_(e){var t=e.options.visualElement;(null===t||void 0===t?void 0:t.getProps().onBeforeLayoutMeasure)&&t.notifyBeforeLayoutMeasure(),e.resetTransform()}function d_(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0}function p_(e){e.resolveTargetDelta()}function h_(e){e.calcProjection()}function v_(e){e.resetRotation()}function m_(e){e.removeLeadSnapshot()}function g_(e,t,n){e.translate=yb(t.translate,0,n),e.scale=yb(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function y_(e,t,n,r){e.min=yb(t.min,n.min,r),e.max=yb(t.max,n.max,r)}function b_(e){return e.animationValues&&void 0!==e.animationValues.opacityExit}var x_={duration:.45,ease:[.4,0,.1,1]};function w_(e,t){for(var n=e.root,r=e.path.length-1;r>=0;r--)if(Boolean(e.path[r].instance)){n=e.path[r];break}var o=(n&&n!==e.root?n.instance:document).querySelector('[data-projection-id="'.concat(t,'"]'));o&&e.mount(o,!0)}function C_(e){e.min=Math.round(e.min),e.max=Math.round(e.max)}function E_(e){C_(e.x),C_(e.y)}var S_=a_({attachResizeListener:function(e,t){return AE(e,"resize",t)},measureScroll:function(){return{x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}},checkIsScrollRoot:function(){return!0}}),k_={current:void 0},__=a_({measureScroll:function(e){return{x:e.scrollLeft,y:e.scrollTop}},defaultParent:function(){if(!k_.current){var e=new S_(0,{});e.mount(window),e.setOptions({layoutScroll:!0}),k_.current=e}return k_.current},resetTransform:function(e,t){e.style.transform=null!==t&&void 0!==t?t:"none"},checkIsScrollRoot:function(e){return Boolean("fixed"===window.getComputedStyle(e).position)}}),R_=rb(rb(rb(rb({},gS),sS),ak),Lk),I_=HC((function(e,t){return function(e,t,n,r,o){var i=t.forwardMotionProps,a=void 0!==i&&i,s=qC(e)?IE:TE;return rb(rb({},s),{preloadedFeatures:n,useRender:hE(a),createVisualElement:r,projectionNodeConstructor:o,Component:e})}(e,t,R_,Ak,__)}));var T_,A_,D_,N_,P_,M_,O_,F_,L_={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},B_=e.createContext&&e.createContext(L_),z_=function(){return z_=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},z_.apply(this,arguments)},W_=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};function V_(t){return t&&t.map((function(t,n){return e.createElement(t.tag,z_({key:n},t.attr),V_(t.child))}))}function U_(t){return function(n){return e.createElement(j_,z_({attr:z_({},t.attr)},n),V_(t.child))}}function j_(t){var n=function(n){var r,o=t.attr,i=t.size,a=t.title,s=W_(t,["attr","size","title"]),u=i||n.size||"1em";return n.className&&(r=n.className),t.className&&(r=(r?r+" ":"")+t.className),e.createElement("svg",z_({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,o,s,{className:r,style:z_(z_({color:t.color||n.color},n.style),t.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),a&&e.createElement("title",null,a),t.children)};return void 0!==B_?e.createElement(B_.Consumer,null,(function(e){return n(e)})):n(L_)}function H_(e){return U_({tag:"svg",attr:{viewBox:"0 0 20 20",fill:"currentColor"},child:[{tag:"path",attr:{d:"M8 9a3 3 0 100-6 3 3 0 000 6zM8 11a6 6 0 016 6H2a6 6 0 016-6zM16 7a1 1 0 10-2 0v1h-1a1 1 0 100 2h1v1a1 1 0 102 0v-1h1a1 1 0 100-2h-1V7z"}}]})(e)}function G_(e){return U_({tag:"svg",attr:{viewBox:"0 0 20 20",fill:"currentColor"},child:[{tag:"path",attr:{d:"M2 6a2 2 0 012-2h6a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V6zM14.553 7.106A1 1 0 0014 8v4a1 1 0 00.553.894l2 1A1 1 0 0018 13V7a1 1 0 00-1.447-.894l-2 1z"}}]})(e)}function q_(e){return U_({tag:"svg",attr:{version:"1.1",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M15.897 9c0.125 0.867 0.207 2.053-0.182 2.507-0.643 0.751-4.714 0.751-4.714-0.751 0-0.756 0.67-1.252 0.027-2.003-0.632-0.738-1.766-0.75-3.027-0.751s-2.394 0.012-3.027 0.751c-0.643 0.751 0.027 1.247 0.027 2.003 0 1.501-4.071 1.501-4.714 0.751-0.389-0.454-0.307-1.64-0.182-2.507 0.096-0.579 0.339-1.203 1.118-2 0-0 0-0 0-0 1.168-1.090 2.935-1.98 6.716-2v-0c0.021 0 0.042 0 0.063 0s0.041-0 0.063-0v0c3.781 0.019 5.548 0.91 6.716 2 0 0 0 0 0 0 0.778 0.797 1.022 1.421 1.118 2z"}}]})(e)}var K_,X_,$_,Y_,Q_,J_,Z_,eR=Ly.div(T_||(T_=en(["\n  width: 100%;\n  height: 64px;\n  background: #252525;\n"]))),tR=Ly.div(A_||(A_=en(["\n  height: 30px;\n  width: 1px;\n  background: #666666;\n  margin-right: 10px;\n"]))),nR=Ly.div(D_||(D_=en(["\n  float: right;\n  height: 100%;\n  display: flex;\n  align-items: center;\n"]))),rR=Ly.div(N_||(N_=en(["\n  width: 60px;\n  height: 64px;\n  color: #fff;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n"]))),oR=Ly(G_)(P_||(P_=en(["\n  width: 25px;\n  height: 25px;\n"]))),iR=Ly((function(e){return U_({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M176 352c53.02 0 96-42.98 96-96V96c0-53.02-42.98-96-96-96S80 42.98 80 96v160c0 53.02 42.98 96 96 96zm160-160h-16c-8.84 0-16 7.16-16 16v48c0 74.8-64.49 134.82-140.79 127.38C96.71 376.89 48 317.11 48 250.3V208c0-8.84-7.16-16-16-16H16c-8.84 0-16 7.16-16 16v40.16c0 89.64 63.97 169.55 152 181.69V464H96c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h160c8.84 0 16-7.16 16-16v-16c0-8.84-7.16-16-16-16h-56v-33.77C285.71 418.47 352 344.9 352 256v-48c0-8.84-7.16-16-16-16z"}}]})(e)}))(M_||(M_=en(["\n  width: 20px;\n  height: 20px;\n  margin-top: 3px;\n  margin-bottom: 3px;\n"]))),aR=Ly.div(O_||(O_=en(["\n  font-size: 11px;\n"]))),sR=Ly.div(F_||(F_=en(["\n  width: 128px;\n  height: 34px;\n  margin-left: 100px;\n  margin-right: 10px;\n  border-radius: 3px;\n  background: #c4314b;\n  color: #fff;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  > svg {\n    margin: 0 5px 0 0;\n  }\n\n  > span {\n    margin: 0 5px;\n  }\n"]))),uR=function(){return(0,Zy.jsx)(Zy.Fragment,{children:(0,Zy.jsx)(eR,{children:(0,Zy.jsxs)(nR,{children:[(0,Zy.jsx)(tR,{}),(0,Zy.jsxs)(rR,{children:[(0,Zy.jsx)(oR,{}),(0,Zy.jsx)(aR,{children:"Kamera"})]}),(0,Zy.jsxs)(rR,{children:[(0,Zy.jsx)(iR,{}),(0,Zy.jsx)(aR,{children:"Mikrofon"})]}),(0,Zy.jsxs)(sR,{children:[(0,Zy.jsx)(q_,{}),(0,Zy.jsx)("span",{children:"Opu\u015b\u0107"})]})]})})})};function lR(e){return U_({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",stroke:"#000",strokeWidth:"2",d:"M3,3 L21,21 M3,21 L21,3"}}]})(e)}function cR(e){return U_({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"}},{tag:"path",attr:{d:"M14.06 9.02l.92.92L5.92 19H5v-.92l9.06-9.06M17.66 3c-.25 0-.51.1-.7.29l-1.83 1.83 3.75 3.75 1.83-1.83a.996.996 0 000-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29zm-3.6 3.19L3 17.25V21h3.75L17.81 9.94l-3.75-3.75z"}}]})(e)}var fR,dR,pR,hR,vR,mR=Ly.div(K_||(K_=en(["\n  background: #1f1f1f;\n"]))),gR=Ly.div(X_||(X_=en(["\n  display: flex;\n  background: #d6d6d6;\n  font-size: 12px;\n  padding: 5px 15px;\n\n  > span {\n    flex: 1 0;\n    color: #242424;\n  }\n\n  > span > span {\n    margin-left: 5px;\n    font-weight: 600;\n    color: #4a4794;\n  }\n\n  svg {\n    width: 18px;\n    height: 18px;\n    margin-right: -5px;\n  }\n\n  path {\n    stroke: #989898;\n  }\n"]))),yR=Ly.div($_||($_=en(["\n  display: flex;\n  padding: 20px 15px;\n  color: #fff;\n  font-weight: 600;\n  border-bottom: 1px solid #000;\n  font-size: 18px;\n\n  span {\n    flex: 1 1;\n  }\n\n  path {\n    stroke: #989898;\n  }\n"]))),bR=Ly.div(Y_||(Y_=en(["\n  display: flex;\n  flex-direction: column;\n"]))),xR=Ly.div(Q_||(Q_=en(["\n  display: flex;\n  padding: 5px 30px;\n  color: #989898;\n  margin: 10px 0;\n"]))),wR=Ly.div(J_||(J_=en(["\n  svg {\n    width: 25px;\n    height: 25px;\n  }\n\n  ","\n"])),(function(e){return e.purple?"color: #7F85F5;":""})),CR=Ly.div(Z_||(Z_=en(["\n  font-size: 14px;\n  font-weight: 600;\n  padding-left: 10px;\n  padding-top: 2px;\n"]))),ER=function(e){var t=e.className;return(0,Zy.jsxs)(mR,{className:t,children:[(0,Zy.jsxs)(gR,{children:[(0,Zy.jsxs)("span",{children:["Ten czat jest wyciszony.",(0,Zy.jsx)("span",{children:"Ustawienia"})]}),(0,Zy.jsx)(lR,{})]}),(0,Zy.jsxs)(yR,{children:[(0,Zy.jsx)("span",{children:"Czat spotkania"}),(0,Zy.jsx)(lR,{})]}),(0,Zy.jsxs)(bR,{children:[(0,Zy.jsxs)(xR,{children:[(0,Zy.jsx)(wR,{children:(0,Zy.jsx)(H_,{})}),(0,Zy.jsx)(CR,{children:"U\u017cytkownik Marianna Lisiecka-Syska do\u0142\u0105czy\u0142a do konwersacji."})]}),(0,Zy.jsxs)(xR,{children:[(0,Zy.jsx)(wR,{children:(0,Zy.jsx)(cR,{})}),(0,Zy.jsx)(CR,{children:"U\u017cytkownik Marianna Lisiecka-Syska nada\u0142a nazw\u0119 Spotkanie z u\u017cytkownikiem Marianna Lisiecka-Syska"})]}),(0,Zy.jsxs)(xR,{children:[(0,Zy.jsx)(wR,{purple:!0,children:(0,Zy.jsx)(G_,{})}),(0,Zy.jsx)(CR,{children:"Spotkanie rozpocz\u0119\u0142o si\u0119"})]})]})]})},SR=Ly.div(fR||(fR=en(["\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n"]))),kR=Ly.div(dR||(dR=en(["\n  flex: 1 1;\n  display: flex;\n"]))),_R=Ly.div(pR||(pR=en(["\n  flex: 1 1;\n  display: flex;\n  flex-wrap: wrap;\n  position: relative;\n  align-items: center;\n  justify-content: center;\n"]))),RR=Ly.div(hR||(hR=en(["\n  width: 30%;\n  position: relative;\n  margin: 5px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  overflow: hidden;\n\n  border: 3px solid\n    ",";\n\n  &::after {\n    content: '';\n    display: block;\n    position: relative;\n    width: 100%;\n    height: 0;\n    padding-top: 56%;\n  }\n\n  video {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n  }\n\n  canvas {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    transform-origin: top right;\n  }\n\n  #test {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n  }\n"])),(function(e){return e.selected?"#69ffac":"transparent"})),IR=Ly(ER)(vR||(vR=en(["\n  flex: 0 0 350px;\n"]))),TR=1e4;var AR,DR=function(t){var n=t.firstClick,r=t.onInitialized,o=gt((0,e.useState)(!1),2),i=o[0],a=o[1],s=(0,e.useRef)(),u=(0,e.useRef)(),l=(0,e.useRef)(),c=(0,e.useRef)(!1),f=xC();(0,e.useEffect)((function(){i&&r()}),[i,r]);var d=(0,e.useCallback)((function(){console.log("click root");var e=s.current,t=u.current,n=l.current,r=e.videoHeight,o=e.videoWidth;if(o&&r){f.set({opacity:0,filter:"brightness(0)",scale:1});var p,h,v,m,g=e.getBoundingClientRect(),y=g.width,b=g.height;y/b>o/r?(h=b*(o/r),p=b):(h=y,p=y*(o/r)),t.width=h,t.height=p,n.width=h,n.height=p,u.current.getContext("2d").drawImage(s.current,0,0,u.current.width,u.current.height),console.log("------",i),(v=u.current,void 0===m&&(m=new _g),new Ry(v,m)).then((function(e){if(console.log("------",i),a(!0),!e.length)return c.current=!0,void setTimeout(d,TR);var t=l.current,n=t.width,r=t.height,o=l.current.getContext("2d"),s=e[0].box,u=s.left,p=s.top,h=s.width,v=s.height;o.clearRect(0,0,n,r),o.beginPath(),o.strokeStyle="red",o.lineWidth=2,o.rect(u,p,h,v),o.stroke(),o.closePath(),c.current&&f.start({opacity:[0,1,1,1,1],filter:["brightness(0)","brightness(4)","brightness(1)","brightness(1)","brightness(1)"],scale:[1,1,1,1,0],transition:{times:[0,.02,.06,.8,1],duration:3.5}}),c.current=!0,setTimeout(d,TR)}))}}),[f,i]);(0,e.useEffect)((function(){n&&!i&&(console.log("get media devices"),navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then((function(e){s.current.srcObject=e,s.current.play(),setTimeout(d,TR)})))}),[n,i]);var p=[{id:0,type:"video/mp4",src:"https://www.w3schools.com/html/mov_bbb.mp4"},{id:1,type:"video/webm",src:"https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.webm"},{id:2,type:"video/mp4",src:"https://www.w3schools.com/html/mov_bbb.mp4"},{id:3,type:"video/webm",src:"https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.webm"},{id:4,type:"video/mp4",src:"https://www.w3schools.com/html/mov_bbb.mp4"},{id:5,type:"video/webm",src:"https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.webm"},{id:6,ref:s},{id:7,type:"video/mp4",src:"https://www.w3schools.com/html/mov_bbb.mp4"}];return(0,Zy.jsxs)(SR,{children:[(0,Zy.jsx)(uR,{}),(0,Zy.jsxs)(kR,{children:[(0,Zy.jsx)(_R,{children:p.map((function(e){var t=e.id,n=e.type,r=e.src,o=e.ref;return(0,Zy.jsxs)(RR,{selected:!!o,children:[(0,Zy.jsx)("video",{loop:!0,autoPlay:!0,ref:o,muted:!0,children:r&&n?(0,Zy.jsx)("source",{src:r,type:n}):null}),o?(0,Zy.jsxs)(Zy.Fragment,{children:[(0,Zy.jsx)(I_.canvas,{ref:u,animate:f,transformTemplate:function(e){var t=e.scale;return"translate(-50%, -50%) scale(".concat(t,")")}}),(0,Zy.jsx)(I_.canvas,{ref:l,animate:f,transformTemplate:function(e){var t=e.scale;return"translate(-50%, -50%) scale(".concat(t,")")}}),(0,Zy.jsx)(I_.div,{id:"test",animate:f})]}):null]},t)}))}),(0,Zy.jsx)(IR,{})]})]})},NR=Ly.div(AR||(AR=en(["\n  position: relative;\n  width: 100%;\n  height: 100%;\n"]))),PR=function(){var t=gt((0,e.useState)(!1),2),n=t[0],r=t[1],o=gt((0,e.useState)(!1),2),i=o[0],a=o[1],s=gt((0,e.useState)(!1),2),u=(s[0],s[1],gt((0,e.useState)(!1),2)),l=u[0],c=u[1],f=gt((0,e.useState)(!1),2),d=f[0],p=f[1];(0,e.useEffect)((function(){uy("/models").then((function(e){r(!0)})).catch((function(e){console.error(e)}))}),[]),(0,e.useEffect)((function(){setTimeout((function(){a(!0)}),2e3)}),[]);var h=d&&i&&n;return(0,Zy.jsxs)(NR,{children:[(0,Zy.jsx)(DR,{firstClick:l,onInitialized:function(){console.log("setVideoInitialized"),p(!0)}}),h?null:(0,Zy.jsx)(eb,{onClick:function(){l||c(!0)}})]})},MR=function(e){e&&e instanceof Function&&n.e(787).then(n.bind(n,787)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,i=t.getLCP,a=t.getTTFB;n(e),r(e),o(e),i(e),a(e)}))};r.createRoot(document.getElementById("root")).render((0,Zy.jsx)(e.StrictMode,{children:(0,Zy.jsx)(Zt,{theme:{fonts:{body:'"Poppins", sans-serif'},text:{caps:{textTransform:"uppercase",letterSpacing:"0.2em"},heading:{fontFamily:"body",fontWeight:"body",lineHeight:"body"}},colors:{primary:"#1d3557",secondary:"#457b9d",highlight:"#f1faee",accent:"#a8dadc"},buttons:{primary:{color:"highlight",bg:"primary","&:disabled":{opacity:.4},"&:hover:not(:disabled)":{bg:"accent"}}}},children:(0,Zy.jsx)(PR,{})})})),MR()}()}();
//# sourceMappingURL=main.0b93bf03.js.map